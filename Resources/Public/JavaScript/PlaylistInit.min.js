import{Player as e,PlaylistManager as o}from"./vidply/vidply.esm.min.js";const t=[100,500,1e3,2e3],i={youtube:"https://policies.google.com/privacy",vimeo:"https://vimeo.com/privacy",soundcloud:"https://soundcloud.com/pages/privacy"},l=new WeakSet,n=console.log,a=e=>{console.log=(...e)=>{e[0]?.toString().startsWith("VidPly")||n.apply(console,e)};try{e()}finally{console.log=n}};window.VidPlyPrivacyConsent=window.VidPlyPrivacyConsent||{youtube:!1,vimeo:!1,soundcloud:!1,hasConsent(e){return!!this[e]},setConsent(e){this[e]=!0,document.dispatchEvent(new CustomEvent("vidply:privacy:consent",{detail:{service:e}}))}};const r=window.VidPlyPrivacyConsent,d=e=>i[e]||"#",c={en:{videoIntro:"To activate the video, you must click on the button. After activating the button,",widgetIntro:"To activate the widget, you must click on the button. After activating the button,",applies:"applies.",googlePolicy:"Google's privacy policy",vimeoPolicy:"Vimeo's privacy policy",soundcloudPolicy:"SoundCloud's privacy policy",loadYoutube:"Load and play YouTube content",loadVimeo:"Load and play Vimeo content",loadSoundcloud:"Load and play SoundCloud content",loadDefault:"Load and play content"},de:{videoIntro:"Um das Video zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",widgetIntro:"Um das Widget zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",applies:".",googlePolicy:"die Datenschutzerklärung von Google",vimeoPolicy:"die Datenschutzerklärung von Vimeo",soundcloudPolicy:"die Datenschutzerklärung von SoundCloud",loadYoutube:"YouTube-Inhalt laden und abspielen",loadVimeo:"Vimeo-Inhalt laden und abspielen",loadSoundcloud:"SoundCloud-Inhalt laden und abspielen",loadDefault:"Inhalt laden und abspielen"},es:{videoIntro:"Para activar el vídeo, debe hacer clic en el botón. Después de activar el botón,",widgetIntro:"Para activar el widget, debe hacer clic en el botón. Después de activar el botón,",applies:"se aplica.",googlePolicy:"la política de privacidad de Google",vimeoPolicy:"la política de privacidad de Vimeo",soundcloudPolicy:"la política de privacidad de SoundCloud",loadYoutube:"Cargar y reproducir contenido de YouTube",loadVimeo:"Cargar y reproducir contenido de Vimeo",loadSoundcloud:"Cargar y reproducir contenido de SoundCloud",loadDefault:"Cargar y reproducir contenido"},it:{videoIntro:"Per attivare il video, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",widgetIntro:"Per attivare il widget, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",applies:"si applica.",googlePolicy:"l'informativa sulla privacy di Google",vimeoPolicy:"l'informativa sulla privacy di Vimeo",soundcloudPolicy:"l'informativa sulla privacy di SoundCloud",loadYoutube:"Carica e riproduci contenuto YouTube",loadVimeo:"Carica e riproduci contenuto Vimeo",loadSoundcloud:"Carica e riproduci contenuto SoundCloud",loadDefault:"Carica e riproduci contenuto"},ja:{videoIntro:"動画を有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",widgetIntro:"ウィジェットを有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",applies:"が適用されます。",googlePolicy:"Googleのプライバシーポリシー",vimeoPolicy:"Vimeoのプライバシーポリシー",soundcloudPolicy:"SoundCloudのプライバシーポリシー",loadYoutube:"YouTubeコンテンツを読み込んで再生",loadVimeo:"Vimeoコンテンツを読み込んで再生",loadSoundcloud:"SoundCloudコンテンツを読み込んで再生",loadDefault:"コンテンツを読み込んで再生"},fr:{videoIntro:"Pour activer la vidéo, vous devez cliquer sur le bouton. Après avoir activé le bouton,",widgetIntro:"Pour activer le widget, vous devez cliquer sur le bouton. Après avoir activé le bouton,",applies:"s'applique.",googlePolicy:"la politique de confidentialité de Google",vimeoPolicy:"la politique de confidentialité de Vimeo",soundcloudPolicy:"la politique de confidentialité de SoundCloud",loadYoutube:"Charger et lire le contenu YouTube",loadVimeo:"Charger et lire le contenu Vimeo",loadSoundcloud:"Charger et lire le contenu SoundCloud",loadDefault:"Charger et lire le contenu"}},u={introText:{youtube:"videoIntro",vimeo:"videoIntro",soundcloud:"widgetIntro"},policyText:{youtube:"googlePolicy",vimeo:"vimeoPolicy",soundcloud:"soundcloudPolicy"},buttonLabel:{youtube:"loadYoutube",vimeo:"loadVimeo",soundcloud:"loadSoundcloud"}},s=e=>{const o=(document.documentElement.lang||"en").split("-")[0].toLowerCase();return(c[o]||c.en)[e]||c.en[e]},p=e=>s(u.introText[e]||"videoIntro"),y=e=>s(u.policyText[e]||"googlePolicy"),v=e=>s(u.buttonLabel[e]||"loadDefault");function f(e,o,t,i=null){const l=function(e,o){const t=o?.[e];return t?{headline:t.headline||"",intro_text:t.intro_text||p(e),outro_text:t.outro_text||s("applies"),policy_link:t.policy_link||d(e),link_text:t.link_text||y(e),button_label:t.button_label||v(e)}:{headline:"",intro_text:p(e),outro_text:s("applies"),policy_link:d(e),link_text:y(e),button_label:v(e)}}(e,i),n=document.createElement("div");n.className=`vidply-playlist-privacy-overlay vidply-privacy-layer vidply-privacy-${e}`,n.setAttribute("data-privacy-service",e),o.poster&&(n.style.backgroundImage=`url('${o.poster}')`,n.style.backgroundSize="cover",n.style.backgroundPosition="center");const a=document.createElement("div");a.className="vidply-privacy-inner-container";const c=document.createElement("button");c.className="vidply-privacy-button",c.type="button",c.setAttribute("aria-label",l.button_label);const u=`vidply-play-shadow-privacy-${Date.now()}`;c.innerHTML=`\n        <svg class="vidply-play-overlay" viewBox="0 0 80 80" width="80" height="80" aria-hidden="true">\n            <defs>\n                <filter id="${u}" x="-50%" y="-50%" width="200%" height="200%">\n                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"></feGaussianBlur>\n                    <feOffset dx="0" dy="2" result="offsetblur"></feOffset>\n                    <feComponentTransfer><feFuncA type="linear" slope="0.3"></feFuncA></feComponentTransfer>\n                    <feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge>\n                </filter>\n            </defs>\n            <circle cx="40" cy="40" r="40" fill="rgba(255, 255, 255, 0.95)" filter="url(#${u})" class="vidply-play-overlay-bg"></circle>\n            <polygon points="32,28 32,52 54,40" fill="#0a406e" class="vidply-play-overlay-icon"></polygon>\n        </svg>\n    `,a.appendChild(c);const f=document.createElement("div");f.className="vidply-privacy-text";let m="<p>";return l.headline&&(m+=`<span class="h6">${l.headline}</span> `),m+=`${l.intro_text} `,m+=`<a href="${l.policy_link}" target="_blank" rel="noreferrer" class="external-link">`,m+=`${l.link_text}</a> ${l.outro_text}`,m+="</p>",f.innerHTML=m,a.appendChild(f),n.appendChild(a),c.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),r.setConsent(e),n.remove(),t()}),n}function m(o){if(!l.has(o))try{const t=o.dataset.vidplySrc,i=t?.includes(".m3u8");if(i){const e=document.createElement("source");e.src=t,e.type="application/x-mpegURL",o.appendChild(e)}else t&&(o.src=t);const n=o.dataset.vidplyOptions?JSON.parse(o.dataset.vidplyOptions):{};let r;a(()=>{r=new e(o,n)}),i&&function(e){e.on("ready",()=>{const o=(t=0)=>{t>=10||(e.renderer?.hls?.levels?.length>0?(e.controls?.buildControlBar?.(),window.dispatchEvent(new Event("resize"))):setTimeout(()=>o(t+1),500))};setTimeout(o,500)})}(r),l.add(o),o._vidplyPlayer=r}catch(e){console.error("[VidPly Init] Error:",e)}}function h(t){if(t.id&&!l.has(t))try{const i=t.dataset.playlist?JSON.parse(t.dataset.playlist):[];if(!i.length)return;const n=t.dataset.vidplyOptions?JSON.parse(t.dataset.vidplyOptions):{},r="true"===t.dataset.playlistHasExternal,d=t.closest(".vidply-wrapper")||t.parentElement,c=function(e){return"DIV"===e.tagName?e.dataset.vidplyMediaType||"video":"AUDIO"===e.tagName?"audio":"video"}(t),u="true"===t.dataset.playlistAutoPlayFirst,s="false"!==t.dataset.playlistAutoAdvance,p=t.dataset.playlistPrivacySettings?JSON.parse(t.dataset.playlistPrivacySettings):null;let y;r&&t.removeAttribute("data-playlist"),a(()=>{y=new e(t,{...n,mediaType:c})}),y.on("ready",()=>{const l={autoAdvance:s,autoPlayFirst:!r&&u,loop:"true"===t.dataset.playlistLoop,showPanel:"false"!==t.dataset.playlistShowPanel,tracks:r?[]:i,recreatePlayers:r&&"DIV"===t.tagName,hostElement:"DIV"===t.tagName?t:null,PlayerClass:e};let n;a(()=>{n=new o(y,l)}),t._vidplyPlaylist=n;const c=e=>{if(!e)return;const o=!0===e.hideSpeedButton;y.options.speedButton=!o,y.controls?.buildControlBar?.()};try{c(n.getCurrentTrack?.()||i[0])}catch(e){}(()=>{const e=n.loadTrack?.bind(n);"function"==typeof e&&(n.loadTrack=function(o){const t=n.tracks?.[o];return c(t),e(o)});const o=n.play?.bind(n);"function"==typeof o&&(n.play=function(e,t){const i="number"==typeof e?e:n.currentIndex,l=n.tracks?.[i];return c(l),o(e,t)})})(),y.off("error",n.handleTrackError),n.handleTrackError=function(e,o){return function(e){const t=this.getCurrentTrack();t?.src&&(e=>{if(!e)return!1;const o=e.toLowerCase();return o.includes("youtube.com")||o.includes("youtu.be")||o.includes("vimeo.com")||o.includes("soundcloud.com")||o.includes(".m3u8")})(t.src)||o&&setTimeout(()=>this.next(),1e3)}.bind(e)}(n,s),y.on("error",n.handleTrackError),r&&function(e,o,t,i,l,n=null,r=null){const d=e.loadTrack.bind(e),c=e.play.bind(e);e.loadTrack=function(i){return b(e,o,t,e=>d(e),n,r)(i)},e.play=function(i,l){return b(e,o,t,(e,o)=>c(e,o),n,r)(i,l)},e.options.autoPlayFirst=l,a(()=>{e.loadPlaylist(i)})}(n,t,d,i,u,p,c)}),l.add(t),t._vidplyPlayer=y}catch(e){console.error("[VidPly Init] Playlist error:",e)}}function g(e){setTimeout(()=>{const o=e.player;if(!o)return;const i=()=>{try{o.play?.()}catch(e){}};"function"==typeof o.on&&o.on("ready",()=>setTimeout(i,t[0])),t.forEach(e=>setTimeout(i,e))},300)}function b(e,o,t,i,l=null,n=null){return(a,d)=>{const c=e.tracks[a];if(!c)return i(a,d);"function"==typeof n&&n(c);const u=(e=>{if(!e)return null;const o=e.toLowerCase();return o.includes("youtube.com")||o.includes("youtu.be")?"youtube":o.includes("vimeo.com")?"vimeo":o.includes("soundcloud.com")?"soundcloud":null})(c.src);if(u&&!r.hasConsent(u))return void function(e,o,t,i,l,n,a,r=null){!function(e,o){const t=e.player;if(t)try{t.pause(),t.videoWrapper&&(t.videoWrapper.style.display="none",t.videoWrapper.setAttribute("data-vidply-hidden","true"));const e=o.querySelector(".vidply-track-artwork");e&&(e.setAttribute("data-vidply-hidden","true"),e.style.setProperty("display","none"))}catch(e){}}(e,o),[o,o.parentElement,t].forEach(e=>{e?.querySelector(".vidply-playlist-privacy-overlay")?.remove()}),e.currentIndex=n,e.updatePlaylistUI?.(),e.updateTrackInfo?.(l);const d=f(i,l,()=>{!function(e,o){const t=e.player;t?.videoWrapper&&(t.videoWrapper.style.display="",t.videoWrapper.removeAttribute("data-vidply-hidden")),o.querySelectorAll("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(e,o),a(),g(e)},r);!function(e,o){const t=function(e){for(const o of e.children)if(o.classList.contains("vidply-video-wrapper")||o.classList.contains("vidply-player"))return o;return e.firstChild}(o);t?o.insertBefore(e,t):o.appendChild(e)}(d,o)}(e,o,t,u,c,a,()=>i(a,d),l);!function(e,o){e.querySelector(".vidply-playlist-privacy-overlay")?.remove();const t=o.player;t?.videoWrapper&&(t.videoWrapper.style.display="",t.videoWrapper.removeAttribute("data-vidply-hidden")),e.querySelectorAll("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(o,e);const s=i(a,d);return u&&g(e),s}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-vidply-init]:not([data-playlist])").forEach(m),document.querySelectorAll("[data-playlist]:not([data-vidply])").forEach(h)});