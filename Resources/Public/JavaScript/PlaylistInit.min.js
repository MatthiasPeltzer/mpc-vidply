import{Player as e,PlaylistManager as t}from"./vidply/vidply.esm.min.js";const o=[100,500,1e3,2e3],n={youtube:"https://policies.google.com/privacy",vimeo:"https://vimeo.com/privacy",soundcloud:"https://soundcloud.com/pages/privacy"},i=new WeakSet,l=console.log,a=e=>{console.log=(...e)=>{e[0]?.toString().startsWith("VidPly")||l.apply(console,e)};try{e()}finally{console.log=l}};window.VidPlyPrivacyConsent=window.VidPlyPrivacyConsent||{youtube:!1,vimeo:!1,soundcloud:!1,hasConsent(e){return!!this[e]},setConsent(e){this[e]=!0,document.dispatchEvent(new CustomEvent("vidply:privacy:consent",{detail:{service:e}}))}};const r=window.VidPlyPrivacyConsent,d=e=>n[e]||"#",c={en:{videoIntro:"To activate the video, you must click on the button. After activating the button,",widgetIntro:"To activate the widget, you must click on the button. After activating the button,",applies:"applies.",googlePolicy:"Google's privacy policy",vimeoPolicy:"Vimeo's privacy policy",soundcloudPolicy:"SoundCloud's privacy policy",loadYoutube:"Load and play YouTube content",loadVimeo:"Load and play Vimeo content",loadSoundcloud:"Load and play SoundCloud content",loadDefault:"Load and play content"},de:{videoIntro:"Um das Video zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",widgetIntro:"Um das Widget zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",applies:".",googlePolicy:"die Datenschutzerklärung von Google",vimeoPolicy:"die Datenschutzerklärung von Vimeo",soundcloudPolicy:"die Datenschutzerklärung von SoundCloud",loadYoutube:"YouTube-Inhalt laden und abspielen",loadVimeo:"Vimeo-Inhalt laden und abspielen",loadSoundcloud:"SoundCloud-Inhalt laden und abspielen",loadDefault:"Inhalt laden und abspielen"},es:{videoIntro:"Para activar el vídeo, debe hacer clic en el botón. Después de activar el botón,",widgetIntro:"Para activar el widget, debe hacer clic en el botón. Después de activar el botón,",applies:"se aplica.",googlePolicy:"la política de privacidad de Google",vimeoPolicy:"la política de privacidad de Vimeo",soundcloudPolicy:"la política de privacidad de SoundCloud",loadYoutube:"Cargar y reproducir contenido de YouTube",loadVimeo:"Cargar y reproducir contenido de Vimeo",loadSoundcloud:"Cargar y reproducir contenido de SoundCloud",loadDefault:"Cargar y reproducir contenido"},it:{videoIntro:"Per attivare il video, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",widgetIntro:"Per attivare il widget, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",applies:"si applica.",googlePolicy:"l'informativa sulla privacy di Google",vimeoPolicy:"l'informativa sulla privacy di Vimeo",soundcloudPolicy:"l'informativa sulla privacy di SoundCloud",loadYoutube:"Carica e riproduci contenuto YouTube",loadVimeo:"Carica e riproduci contenuto Vimeo",loadSoundcloud:"Carica e riproduci contenuto SoundCloud",loadDefault:"Carica e riproduci contenuto"},ja:{videoIntro:"動画を有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",widgetIntro:"ウィジェットを有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",applies:"が適用されます。",googlePolicy:"Googleのプライバシーポリシー",vimeoPolicy:"Vimeoのプライバシーポリシー",soundcloudPolicy:"SoundCloudのプライバシーポリシー",loadYoutube:"YouTubeコンテンツを読み込んで再生",loadVimeo:"Vimeoコンテンツを読み込んで再生",loadSoundcloud:"SoundCloudコンテンツを読み込んで再生",loadDefault:"コンテンツを読み込んで再生"},fr:{videoIntro:"Pour activer la vidéo, vous devez cliquer sur le bouton. Après avoir activé le bouton,",widgetIntro:"Pour activer le widget, vous devez cliquer sur le bouton. Après avoir activé le bouton,",applies:"s'applique.",googlePolicy:"la politique de confidentialité de Google",vimeoPolicy:"la politique de confidentialité de Vimeo",soundcloudPolicy:"la politique de confidentialité de SoundCloud",loadYoutube:"Charger et lire le contenu YouTube",loadVimeo:"Charger et lire le contenu Vimeo",loadSoundcloud:"Charger et lire le contenu SoundCloud",loadDefault:"Charger et lire le contenu"}},u={introText:{youtube:"videoIntro",vimeo:"videoIntro",soundcloud:"widgetIntro"},policyText:{youtube:"googlePolicy",vimeo:"vimeoPolicy",soundcloud:"soundcloudPolicy"},buttonLabel:{youtube:"loadYoutube",vimeo:"loadVimeo",soundcloud:"loadSoundcloud"}},s=e=>{const t=(document.documentElement.lang||"en").split("-")[0].toLowerCase();return(c[t]||c.en)[e]||c.en[e]},p=e=>s(u.introText[e]||"videoIntro"),y=e=>s(u.policyText[e]||"googlePolicy"),v=e=>s(u.buttonLabel[e]||"loadDefault");function f(e){const t=e?.closest?.(".vidply-wrapper")||e,o=t?.querySelector?.("template.mpc-vidply-play-inline-svg"),n=o?.innerHTML?.trim?.()||"";return""!==n?n:null}function m(e){const t=f(e);if(!t)return;const o=function(e){return e&&(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg")||null}(t);if(!o)return;const n=(e||document).querySelectorAll?.("svg.vidply-play-overlay");n?.forEach?.(e=>{if(!e||"1"===e.dataset?.mpcVidplyIconReplaced)return;const t=o.getAttribute("viewBox");t&&e.setAttribute("viewBox",t),e.innerHTML=o.innerHTML,e.dataset.mpcVidplyIconReplaced="1"})}function h(e){const t=e?.closest?.(".vidply-wrapper")||e;if(!t)return;if(!t.hasAttribute("data-vidply-play-inline-svg"))return;m(t);const o=new MutationObserver(()=>{m(t)});o.observe(t,{childList:!0,subtree:!0}),t._mpcVidplyPlayIconObserver=o}function g(e,t,o,n=null,i=null,l="center",a=null){const c=function(e,t){const o=t?.[e];return o?{headline:o.headline||"",intro_text:o.intro_text||p(e),outro_text:o.outro_text||s("applies"),policy_link:o.policy_link||d(e),link_text:o.link_text||y(e),button_label:o.button_label||v(e)}:{headline:"",intro_text:p(e),outro_text:s("applies"),policy_link:d(e),link_text:y(e),button_label:v(e)}}(e,n),u=document.createElement("div");u.className=`vidply-playlist-privacy-overlay vidply-privacy-layer vidply-privacy-${e}`,u.setAttribute("data-privacy-service",e),t.poster&&(u.style.backgroundImage=`url('${t.poster}')`,u.style.backgroundSize="cover",u.style.backgroundPosition="center");const f=document.createElement("div");f.className="vidply-privacy-inner-container";const m=document.createElement("button"),h=l||"center";if(m.className=`vidply-privacy-button vidply-privacy-button--pos-${h}`,m.type="button",m.setAttribute("aria-label",c.button_label),a)m.innerHTML=a;else if(i){const e=document.createElement("img");e.className="vidply-play-overlay-image",e.src=i,e.alt="",e.setAttribute("aria-hidden","true"),m.appendChild(e)}else{const e=`vidply-play-shadow-privacy-${Date.now()}`;m.innerHTML=`\n            <svg class="vidply-play-overlay" viewBox="0 0 80 80" width="80" height="80" aria-hidden="true">\n                <defs>\n                    <filter id="${e}" x="-50%" y="-50%" width="200%" height="200%">\n                        <feGaussianBlur in="SourceAlpha" stdDeviation="3"></feGaussianBlur>\n                        <feOffset dx="0" dy="2" result="offsetblur"></feOffset>\n                        <feComponentTransfer><feFuncA type="linear" slope="0.3"></feFuncA></feComponentTransfer>\n                        <feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge>\n                    </filter>\n                </defs>\n                <circle cx="40" cy="40" r="40" fill="rgba(255, 255, 255, 0.95)" filter="url(#${e})" class="vidply-play-overlay-bg"></circle>\n                <polygon points="32,28 32,52 54,40" fill="#0a406e" class="vidply-play-overlay-icon"></polygon>\n            </svg>\n        `}f.appendChild(m);const g=document.createElement("div");g.className="vidply-privacy-text";let b="<p>";return c.headline&&(b+=`<span class="h6">${c.headline}</span> `),b+=`${c.intro_text} `,b+=`<a href="${c.policy_link}" target="_blank" rel="noreferrer" class="external-link">`,b+=`${c.link_text}</a> ${c.outro_text}`,b+="</p>",g.innerHTML=b,f.appendChild(g),u.appendChild(f),m.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),r.setConsent(e),u.remove(),o()}),u}function b(t){if(!i.has(t))try{const o=t.dataset.vidplySrc,n=o?.includes(".m3u8");if(n){const e=document.createElement("source");e.src=o,e.type="application/x-mpegURL",t.appendChild(e)}else o&&(t.src=o);const l=t.dataset.vidplyOptions?JSON.parse(t.dataset.vidplyOptions):{};let r;a(()=>{r=new e(t,l)}),n&&function(e){e.on("ready",()=>{const t=(o=0)=>{o>=10||(e.renderer?.hls?.levels?.length>0?(e.controls?.buildControlBar?.(),window.dispatchEvent(new Event("resize"))):setTimeout(()=>t(o+1),500))};setTimeout(t,500)})}(r),i.add(t),t._vidplyPlayer=r}catch(e){console.error("[VidPly Init] Error:",e)}}function P(o){if(o.id&&!i.has(o))try{const n=o.dataset.playlist?JSON.parse(o.dataset.playlist):[];if(!n.length)return;const l=o.dataset.vidplyOptions?JSON.parse(o.dataset.vidplyOptions):{},r="true"===o.dataset.playlistHasExternal,d=o.closest(".vidply-wrapper")||o.parentElement,c=function(e){return"DIV"===e.tagName?e.dataset.vidplyMediaType||"video":"AUDIO"===e.tagName?"audio":"video"}(o),u="true"===o.dataset.playlistAutoPlayFirst,s="false"!==o.dataset.playlistAutoAdvance,p=o.dataset.playlistPrivacySettings?JSON.parse(o.dataset.playlistPrivacySettings):null;let y;r&&o.removeAttribute("data-playlist"),a(()=>{y=new e(o,{...l,mediaType:c})}),y.on("ready",()=>{const i={autoAdvance:s,autoPlayFirst:!r&&u,loop:"true"===o.dataset.playlistLoop,showPanel:"false"!==o.dataset.playlistShowPanel,tracks:r?[]:n,recreatePlayers:r&&"DIV"===o.tagName,hostElement:"DIV"===o.tagName?o:null,PlayerClass:e};let l;a(()=>{l=new t(y,i)}),o._vidplyPlaylist=l;const c=e=>{if(!e)return;const t=!0===e.hideSpeedButton;y.options.speedButton=!t,y.controls?.buildControlBar?.()};try{c(l.getCurrentTrack?.()||n[0])}catch(e){}(()=>{const e=l.loadTrack?.bind(l);"function"==typeof e&&(l.loadTrack=function(t){const o=l.tracks?.[t];return c(o),e(t)});const t=l.play?.bind(l);"function"==typeof t&&(l.play=function(e,o){const n="number"==typeof e?e:l.currentIndex,i=l.tracks?.[n];return c(i),t(e,o)})})(),y.off("error",l.handleTrackError),l.handleTrackError=function(e,t){return function(e){const o=this.getCurrentTrack();o?.src&&(e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("youtube.com")||t.includes("youtu.be")||t.includes("vimeo.com")||t.includes("soundcloud.com")||t.includes(".m3u8")})(o.src)||t&&setTimeout(()=>this.next(),1e3)}.bind(e)}(l,s),y.on("error",l.handleTrackError),r&&function(e,t,o,n,i,l=null,r=null){const d=e.loadTrack.bind(e),c=e.play.bind(e);e.loadTrack=function(n){return A(e,t,o,e=>d(e),l,r)(n)},e.play=function(n,i){return A(e,t,o,(e,t)=>c(e,t),l,r)(n,i)},e.options.autoPlayFirst=i,a(()=>{e.loadPlaylist(n)})}(l,o,d,n,u,p,c)}),i.add(o),o._vidplyPlayer=y}catch(e){console.error("[VidPly Init] Playlist error:",e)}}function w(e,t,o=null){const n=e?.player,i=[n?.container,n?.videoWrapper?.parentElement,o,t.closest?.(".vidply-wrapper"),t.parentElement,t].filter(Boolean);for(const e of i){const t=e.querySelector?.(".vidply-track-artwork");if(t)return t}return null}function C(e,t,o,n){const i=w(e,t,o);if(i)return n?(i.setAttribute("data-vidply-artwork-forced-hidden","true"),i.style.setProperty("display","none"),void i.setAttribute("aria-hidden","true")):void("true"===i.getAttribute("data-vidply-artwork-forced-hidden")&&(i.removeAttribute("data-vidply-artwork-forced-hidden"),i.style.removeProperty("display"),i.removeAttribute("aria-hidden")))}function S(e){setTimeout(()=>{const t=e.player;if(!t)return;const n=()=>{try{t.play?.()}catch(e){}};"function"==typeof t.on&&t.on("ready",()=>setTimeout(n,o[0])),o.forEach(e=>setTimeout(n,e))},300)}function k(e,t,o,n,i,l,a,r=null){C(e,t,o,!0),function(e,t,o=null){const n=e.player;if(n)try{n.pause(),n.videoWrapper&&(n.videoWrapper.style.display="none",n.videoWrapper.setAttribute("data-vidply-hidden","true"));const i=w(e,t,o);i&&(i.setAttribute("data-vidply-hidden","true"),i.style.setProperty("display","none"))}catch(e){}}(e,t,o),[t,t.parentElement,o].forEach(e=>{e?.querySelector(".vidply-playlist-privacy-overlay")?.remove()}),e.currentIndex=l,e.updatePlaylistUI?.(),e.updateTrackInfo?.(i);const d=g(n,i,()=>{!function(e,t,o=null){const n=e.player;n?.videoWrapper&&(n.videoWrapper.style.display="",n.videoWrapper.removeAttribute("data-vidply-hidden"));const i=[n?.container,n?.videoWrapper?.parentElement,o,t.closest?.(".vidply-wrapper"),t.parentElement,t].filter(Boolean);for(const e of i)e.querySelectorAll?.("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(e,t,o),a(),S(e)},r,o?.dataset?.vidplyPlayIcon||t?.dataset?.vidplyPlayIcon||null,o?.dataset?.vidplyPlayPosition||t?.dataset?.vidplyPlayPosition||"center",f(o));!function(e,t){const o=function(e){for(const t of e.children)if(t.classList.contains("vidply-video-wrapper")||t.classList.contains("vidply-player"))return t;return e.firstChild}(t);o?t.insertBefore(e,o):t.appendChild(e)}(d,t)}function A(e,t,o,n,i=null,l=null){return(a,d)=>{const c=e.tracks[a];if(!c)return n(a,d);"function"==typeof l&&l(c);const u=(e=>{if(!e)return null;const t=e.toLowerCase();return t.includes("youtube.com")||t.includes("youtu.be")?"youtube":t.includes("vimeo.com")?"vimeo":t.includes("soundcloud.com")?"soundcloud":null})(c.src);if(C(e,t,o,!!u),u&&!r.hasConsent(u))return void k(e,t,o,u,c,a,()=>n(a,d),i);!function(e,t){e.querySelector(".vidply-playlist-privacy-overlay")?.remove();const o=t.player;o?.videoWrapper&&(o.videoWrapper.style.display="",o.videoWrapper.removeAttribute("data-vidply-hidden"));const n=[o?.container,o?.videoWrapper?.parentElement,e.closest(".vidply-wrapper"),e.parentElement,e].filter(Boolean);for(const e of n)e.querySelectorAll?.("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(t,e);const s=n(a,d);return u&&S(e),s}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-vidply-init]:not([data-playlist])").forEach(b),document.querySelectorAll("[data-playlist]:not([data-vidply])").forEach(P),document.querySelectorAll(".vidply-wrapper[data-vidply-play-inline-svg]").forEach(h)});