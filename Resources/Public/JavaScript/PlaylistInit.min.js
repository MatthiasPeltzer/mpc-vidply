import{Player as e,PlaylistManager as o}from"./vidply/vidply.esm.min.js";const t=[100,500,1e3,2e3],i={youtube:"https://policies.google.com/privacy",vimeo:"https://vimeo.com/privacy",soundcloud:"https://soundcloud.com/pages/privacy"},n=new WeakSet,a=console.log,l=e=>{console.log=(...e)=>{e[0]?.toString().startsWith("VidPly")||a.apply(console,e)};try{e()}finally{console.log=a}};window.VidPlyPrivacyConsent=window.VidPlyPrivacyConsent||{youtube:!1,vimeo:!1,soundcloud:!1,hasConsent(e){return!!this[e]},setConsent(e){this[e]=!0,document.dispatchEvent(new CustomEvent("vidply:privacy:consent",{detail:{service:e}}))}};const r=window.VidPlyPrivacyConsent,d={en:{videoIntro:"To activate the video, you must click on the button. After activating the button,",widgetIntro:"To activate the widget, you must click on the button. After activating the button,",applies:"applies.",googlePolicy:"Google's privacy policy",vimeoPolicy:"Vimeo's privacy policy",soundcloudPolicy:"SoundCloud's privacy policy",loadYoutube:"Load and play YouTube content",loadVimeo:"Load and play Vimeo content",loadSoundcloud:"Load and play SoundCloud content",loadDefault:"Load and play content"},de:{videoIntro:"Um das Video zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",widgetIntro:"Um das Widget zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",applies:".",googlePolicy:"die Datenschutzerklärung von Google",vimeoPolicy:"die Datenschutzerklärung von Vimeo",soundcloudPolicy:"die Datenschutzerklärung von SoundCloud",loadYoutube:"YouTube-Inhalt laden und abspielen",loadVimeo:"Vimeo-Inhalt laden und abspielen",loadSoundcloud:"SoundCloud-Inhalt laden und abspielen",loadDefault:"Inhalt laden und abspielen"},es:{videoIntro:"Para activar el vídeo, debe hacer clic en el botón. Después de activar el botón,",widgetIntro:"Para activar el widget, debe hacer clic en el botón. Después de activar el botón,",applies:"se aplica.",googlePolicy:"la política de privacidad de Google",vimeoPolicy:"la política de privacidad de Vimeo",soundcloudPolicy:"la política de privacidad de SoundCloud",loadYoutube:"Cargar y reproducir contenido de YouTube",loadVimeo:"Cargar y reproducir contenido de Vimeo",loadSoundcloud:"Cargar y reproducir contenido de SoundCloud",loadDefault:"Cargar y reproducir contenido"},it:{videoIntro:"Per attivare il video, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",widgetIntro:"Per attivare il widget, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",applies:"si applica.",googlePolicy:"l'informativa sulla privacy di Google",vimeoPolicy:"l'informativa sulla privacy di Vimeo",soundcloudPolicy:"l'informativa sulla privacy di SoundCloud",loadYoutube:"Carica e riproduci contenuto YouTube",loadVimeo:"Carica e riproduci contenuto Vimeo",loadSoundcloud:"Carica e riproduci contenuto SoundCloud",loadDefault:"Carica e riproduci contenuto"},ja:{videoIntro:"動画を有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",widgetIntro:"ウィジェットを有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",applies:"が適用されます。",googlePolicy:"Googleのプライバシーポリシー",vimeoPolicy:"Vimeoのプライバシーポリシー",soundcloudPolicy:"SoundCloudのプライバシーポリシー",loadYoutube:"YouTubeコンテンツを読み込んで再生",loadVimeo:"Vimeoコンテンツを読み込んで再生",loadSoundcloud:"SoundCloudコンテンツを読み込んで再生",loadDefault:"コンテンツを読み込んで再生"},fr:{videoIntro:"Pour activer la vidéo, vous devez cliquer sur le bouton. Après avoir activé le bouton,",widgetIntro:"Pour activer le widget, vous devez cliquer sur le bouton. Après avoir activé le bouton,",applies:"s'applique.",googlePolicy:"la politique de confidentialité de Google",vimeoPolicy:"la politique de confidentialité de Vimeo",soundcloudPolicy:"la politique de confidentialité de SoundCloud",loadYoutube:"Charger et lire le contenu YouTube",loadVimeo:"Charger et lire le contenu Vimeo",loadSoundcloud:"Charger et lire le contenu SoundCloud",loadDefault:"Charger et lire le contenu"}},c={introText:{youtube:"videoIntro",vimeo:"videoIntro",soundcloud:"widgetIntro"},policyText:{youtube:"googlePolicy",vimeo:"vimeoPolicy",soundcloud:"soundcloudPolicy"},buttonLabel:{youtube:"loadYoutube",vimeo:"loadVimeo",soundcloud:"loadSoundcloud"}},s=e=>{const o=(document.documentElement.lang||"en").split("-")[0].toLowerCase();return(d[o]||d.en)[e]||d.en[e]};function u(e,o,t){const n=document.createElement("div");n.className=`vidply-playlist-privacy-overlay vidply-privacy-layer vidply-privacy-${e}`,n.setAttribute("data-privacy-service",e);const a=o.poster?`background-color: #1a1a1a; background-image: url('${o.poster}'); background-size: cover; background-position: center;`:"background-color: #1a1a1a;";n.style.cssText=`\n        position: relative !important; padding-bottom: 56.25% !important; height: 0 !important;\n        width: 100% !important; z-index: 9999 !important; overflow: visible !important;\n        pointer-events: auto !important; ${a}\n    `;const l=document.createElement("div");l.style.cssText="\n        position: absolute; top: 0; left: 0; right: 0; bottom: 0;\n        display: flex; flex-direction: column; align-items: center; justify-content: center;\n    ";const d=document.createElement("button");d.className="vidply-privacy-button",d.type="button",d.setAttribute("aria-label",(e=>s(c.buttonLabel[e]||"loadDefault"))(e)),d.style.cssText="\n        background: transparent; border: none; cursor: pointer; padding: 0;\n        transition: transform 0.3s ease; position: absolute; top: 50%; left: 50%;\n        transform: translate(-50%, -50%); z-index: 10;\n    ";const u=`vidply-play-shadow-privacy-${Date.now()}`;d.innerHTML=`\n        <svg class="vidply-play-overlay" viewBox="0 0 80 80" width="80" height="80" aria-hidden="true" style="cursor: pointer;">\n            <defs>\n                <filter id="${u}" x="-50%" y="-50%" width="200%" height="200%">\n                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"></feGaussianBlur>\n                    <feOffset dx="0" dy="2" result="offsetblur"></feOffset>\n                    <feComponentTransfer><feFuncA type="linear" slope="0.3"></feFuncA></feComponentTransfer>\n                    <feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge>\n                </filter>\n            </defs>\n            <circle cx="40" cy="40" r="40" fill="rgba(255, 255, 255, 0.95)" filter="url(#${u})"></circle>\n            <polygon points="32,28 32,52 54,40" fill="currentColor" class="vidply-play-overlay-icon"></polygon>\n        </svg>\n    `,d.addEventListener("mouseenter",()=>d.style.transform="translate(-50%, -50%) scale(1.1)"),d.addEventListener("mouseleave",()=>d.style.transform="translate(-50%, -50%) scale(1)"),l.appendChild(d);const p=document.createElement("div");return p.className="vidply-privacy-text",p.style.cssText="\n        position: absolute; bottom: 0; left: 0; right: 0; color: #fff;\n        background: rgba(0, 0, 0, 0.8); padding: 1rem; text-align: center; z-index: 9;\n    ",p.innerHTML=`<p style="margin: 0; font-size: 0.85rem;">\n        ${(e=>s(c.introText[e]||"videoIntro"))(e)} \n        <a href="${(e=>i[e]||"#")(e)}" target="_blank" rel="noopener noreferrer" style="color: #fff; text-decoration: underline;">\n            ${(e=>s(c.policyText[e]||"googlePolicy"))(e)}\n        </a> ${s("applies")}\n    </p>`,l.appendChild(p),n.appendChild(l),d.addEventListener("click",o=>{o.preventDefault(),o.stopPropagation(),r.setConsent(e),n.remove(),t()}),n}function p(o){if(!n.has(o))try{const t=o.dataset.vidplySrc,i=t?.includes(".m3u8");if(i){const e=document.createElement("source");e.src=t,e.type="application/x-mpegURL",o.appendChild(e)}else t&&(o.src=t);const a=o.dataset.vidplyOptions?JSON.parse(o.dataset.vidplyOptions):{};let r;l(()=>{r=new e(o,a)}),i&&function(e){e.on("ready",()=>{const o=(t=0)=>{t>=10||(e.renderer?.hls?.levels?.length>0?(e.controls?.buildControlBar?.(),window.dispatchEvent(new Event("resize"))):setTimeout(()=>o(t+1),500))};setTimeout(o,500)})}(r),n.add(o),o._vidplyPlayer=r}catch(e){console.error("[VidPly Init] Error:",e)}}function y(t){if(t.id&&!n.has(t))try{const i=t.dataset.playlist?JSON.parse(t.dataset.playlist):[];if(!i.length)return;const a=t.dataset.vidplyOptions?JSON.parse(t.dataset.vidplyOptions):{},r="true"===t.dataset.playlistHasExternal,d=t.closest(".vidply-wrapper")||t.parentElement,c=function(e){return"DIV"===e.tagName?e.dataset.vidplyMediaType||"video":"AUDIO"===e.tagName?"audio":"video"}(t),s="true"===t.dataset.playlistAutoPlayFirst,u="false"!==t.dataset.playlistAutoAdvance;let p;r&&t.removeAttribute("data-playlist"),l(()=>{p=new e(t,{...a,mediaType:c})}),p.on("ready",()=>{const n={autoAdvance:u,autoPlayFirst:!r&&s,loop:"true"===t.dataset.playlistLoop,showPanel:"false"!==t.dataset.playlistShowPanel,tracks:r?[]:i,recreatePlayers:r&&"DIV"===t.tagName,hostElement:"DIV"===t.tagName?t:null,PlayerClass:e};let a;l(()=>{a=new o(p,n)}),t._vidplyPlaylist=a,p.off("error",a.handleTrackError),a.handleTrackError=function(e,o){return function(e){const t=this.getCurrentTrack();t?.src&&(e=>{if(!e)return!1;const o=e.toLowerCase();return o.includes("youtube.com")||o.includes("youtu.be")||o.includes("vimeo.com")||o.includes("soundcloud.com")||o.includes(".m3u8")})(t.src)||o&&setTimeout(()=>this.next(),1e3)}.bind(e)}(a,u),p.on("error",a.handleTrackError),r&&function(e,o,t,i,n){const a=e.loadTrack.bind(e),r=e.play.bind(e);e.loadTrack=function(i){return m(e,o,t,e=>a(e))(i)},e.play=function(i,n){return m(e,o,t,(e,o)=>r(e,o))(i,n)},e.options.autoPlayFirst=n,l(()=>{e.loadPlaylist(i)})}(a,t,d,i,s)}),n.add(t),t._vidplyPlayer=p}catch(e){console.error("[VidPly Init] Playlist error:",e)}}function v(e){setTimeout(()=>{const o=e.player;if(!o)return;const i=()=>{try{o.play?.()}catch(e){}};"function"==typeof o.on&&o.on("ready",()=>setTimeout(i,t[0])),t.forEach(e=>setTimeout(i,e))},300)}function m(e,o,t,i){return(n,a)=>{const l=e.tracks[n];if(!l)return i(n,a);const d=(e=>{if(!e)return null;const o=e.toLowerCase();return o.includes("youtube.com")||o.includes("youtu.be")?"youtube":o.includes("vimeo.com")?"vimeo":o.includes("soundcloud.com")?"soundcloud":null})(l.src);if(d&&!r.hasConsent(d))return void function(e,o,t,i,n,a,l){!function(e,o){const t=e.player;if(t)try{t.pause(),t.videoWrapper&&(t.videoWrapper.style.display="none",t.videoWrapper.setAttribute("data-vidply-hidden","true"));const e=o.querySelector(".vidply-track-artwork");e&&(e.setAttribute("data-vidply-hidden","true"),e.style.setProperty("display","none"))}catch(e){}}(e,o),[o,o.parentElement,t].forEach(e=>{e?.querySelector(".vidply-playlist-privacy-overlay")?.remove()}),e.currentIndex=a,e.updatePlaylistUI?.(),e.updateTrackInfo?.(n);const r=u(i,n,()=>{!function(e,o){const t=e.player;t?.videoWrapper&&(t.videoWrapper.style.display="",t.videoWrapper.removeAttribute("data-vidply-hidden")),o.querySelectorAll("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(e,o),l(),v(e)});!function(e,o){const t=function(e){for(const o of e.children)if(o.classList.contains("vidply-video-wrapper")||o.classList.contains("vidply-player"))return o;return e.firstChild}(o);t?o.insertBefore(e,t):o.appendChild(e)}(r,o)}(e,o,t,d,l,n,()=>i(n,a));!function(e,o){e.querySelector(".vidply-playlist-privacy-overlay")?.remove();const t=o.player;t?.videoWrapper&&(t.videoWrapper.style.display="",t.videoWrapper.removeAttribute("data-vidply-hidden")),e.querySelectorAll("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(o,e);const c=i(n,a);return d&&v(e),c}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-vidply-init]:not([data-playlist])").forEach(p),document.querySelectorAll("[data-playlist]:not([data-vidply])").forEach(y)});