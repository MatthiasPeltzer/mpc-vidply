import{Player as e,PlaylistManager as t}from"./vidply/vidply.esm.min.js";const o=[100,500,1e3,2e3],i={youtube:"https://policies.google.com/privacy",vimeo:"https://vimeo.com/privacy",soundcloud:"https://soundcloud.com/pages/privacy"},n=new WeakSet,a=new Set,l=console.log,r=e=>{console.log=(...e)=>{e[0]?.toString().startsWith("VidPly")||l.apply(console,e)};try{e()}finally{console.log=l}};window.VidPlyPrivacyConsent=window.VidPlyPrivacyConsent||{youtube:!1,vimeo:!1,soundcloud:!1,hasConsent(e){return!!this[e]},setConsent(e){this[e]=!0,document.dispatchEvent(new CustomEvent("vidply:privacy:consent",{detail:{service:e}}))}};const d=window.VidPlyPrivacyConsent,c=e=>i[e]||"#",s={en:{videoIntro:"To activate the video, you must click on the button. After activating the button,",widgetIntro:"To activate the widget, you must click on the button. After activating the button,",applies:"applies.",googlePolicy:"Google's privacy policy",vimeoPolicy:"Vimeo's privacy policy",soundcloudPolicy:"SoundCloud's privacy policy",loadYoutube:"Load and play YouTube content",loadVimeo:"Load and play Vimeo content",loadSoundcloud:"Load and play SoundCloud content",loadDefault:"Load and play content"},de:{videoIntro:"Um das Video zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",widgetIntro:"Um das Widget zu aktivieren, müssen Sie auf die Schaltfläche klicken. Nach der Aktivierung gilt",applies:".",googlePolicy:"die Datenschutzerklärung von Google",vimeoPolicy:"die Datenschutzerklärung von Vimeo",soundcloudPolicy:"die Datenschutzerklärung von SoundCloud",loadYoutube:"YouTube-Inhalt laden und abspielen",loadVimeo:"Vimeo-Inhalt laden und abspielen",loadSoundcloud:"SoundCloud-Inhalt laden und abspielen",loadDefault:"Inhalt laden und abspielen"},es:{videoIntro:"Para activar el vídeo, debe hacer clic en el botón. Después de activar el botón,",widgetIntro:"Para activar el widget, debe hacer clic en el botón. Después de activar el botón,",applies:"se aplica.",googlePolicy:"la política de privacidad de Google",vimeoPolicy:"la política de privacidad de Vimeo",soundcloudPolicy:"la política de privacidad de SoundCloud",loadYoutube:"Cargar y reproducir contenido de YouTube",loadVimeo:"Cargar y reproducir contenido de Vimeo",loadSoundcloud:"Cargar y reproducir contenido de SoundCloud",loadDefault:"Cargar y reproducir contenido"},it:{videoIntro:"Per attivare il video, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",widgetIntro:"Per attivare il widget, è necessario fare clic sul pulsante. Dopo aver attivato il pulsante,",applies:"si applica.",googlePolicy:"l'informativa sulla privacy di Google",vimeoPolicy:"l'informativa sulla privacy di Vimeo",soundcloudPolicy:"l'informativa sulla privacy di SoundCloud",loadYoutube:"Carica e riproduci contenuto YouTube",loadVimeo:"Carica e riproduci contenuto Vimeo",loadSoundcloud:"Carica e riproduci contenuto SoundCloud",loadDefault:"Carica e riproduci contenuto"},ja:{videoIntro:"動画を有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",widgetIntro:"ウィジェットを有効にするには、ボタンをクリックしてください。ボタンを有効にすると、",applies:"が適用されます。",googlePolicy:"Googleのプライバシーポリシー",vimeoPolicy:"Vimeoのプライバシーポリシー",soundcloudPolicy:"SoundCloudのプライバシーポリシー",loadYoutube:"YouTubeコンテンツを読み込んで再生",loadVimeo:"Vimeoコンテンツを読み込んで再生",loadSoundcloud:"SoundCloudコンテンツを読み込んで再生",loadDefault:"コンテンツを読み込んで再生"},fr:{videoIntro:"Pour activer la vidéo, vous devez cliquer sur le bouton. Après avoir activé le bouton,",widgetIntro:"Pour activer le widget, vous devez cliquer sur le bouton. Après avoir activé le bouton,",applies:"s'applique.",googlePolicy:"la politique de confidentialité de Google",vimeoPolicy:"la politique de confidentialité de Vimeo",soundcloudPolicy:"la politique de confidentialité de SoundCloud",loadYoutube:"Charger et lire le contenu YouTube",loadVimeo:"Charger et lire le contenu Vimeo",loadSoundcloud:"Charger et lire le contenu SoundCloud",loadDefault:"Charger et lire le contenu"}},u={introText:{youtube:"videoIntro",vimeo:"videoIntro",soundcloud:"widgetIntro"},policyText:{youtube:"googlePolicy",vimeo:"vimeoPolicy",soundcloud:"soundcloudPolicy"},buttonLabel:{youtube:"loadYoutube",vimeo:"loadVimeo",soundcloud:"loadSoundcloud"}},p=e=>{const t=(document.documentElement.lang||"en").split("-")[0].toLowerCase();return(s[t]||s.en)[e]||s.en[e]},y=e=>p(u.introText[e]||"videoIntro"),v=e=>p(u.policyText[e]||"googlePolicy"),m=e=>p(u.buttonLabel[e]||"loadDefault");function h(e){const t=e?.closest?.(".vidply-wrapper")||e,o=t?.querySelector?.("template.mpc-vidply-play-inline-svg"),i=o?.innerHTML?.trim?.()||"";return""!==i?i:null}function f(e){const t=h(e);if(!t)return;const o=function(e){return e&&(new DOMParser).parseFromString(e,"image/svg+xml").querySelector("svg")||null}(t);if(!o)return;const i=(e||document).querySelectorAll?.("svg.vidply-play-overlay");i?.forEach?.(e=>{if(!e||"1"===e.dataset?.mpcVidplyIconReplaced)return;const t=o.getAttribute("viewBox");t&&e.setAttribute("viewBox",t),e.innerHTML=o.innerHTML,e.dataset.mpcVidplyIconReplaced="1"})}function g(e){const t=e?.closest?.(".vidply-wrapper")||e;if(!t)return;if(!t.hasAttribute("data-vidply-play-inline-svg"))return;f(t);const o=new MutationObserver(()=>{f(t)});o.observe(t,{childList:!0,subtree:!0}),t._mpcVidplyPlayIconObserver=o}function b(e,t,o,i=null,n=null,a="center",l=null){const r=function(e,t){const o=t?.[e];return o?{headline:o.headline||"",intro_text:o.intro_text||y(e),outro_text:o.outro_text||p("applies"),policy_link:o.policy_link||c(e),link_text:o.link_text||v(e),button_label:o.button_label||m(e)}:{headline:"",intro_text:y(e),outro_text:p("applies"),policy_link:c(e),link_text:v(e),button_label:m(e)}}(e,i),s=document.createElement("div");s.className=`vidply-playlist-privacy-overlay vidply-privacy-layer vidply-privacy-${e}`,s.setAttribute("data-privacy-service",e),t.poster&&(s.style.backgroundImage=`url('${t.poster}')`,s.style.backgroundSize="cover",s.style.backgroundPosition="center");const u=document.createElement("div");u.className="vidply-privacy-inner-container";const h=document.createElement("button"),f=a||"center";if(h.className=`vidply-privacy-button vidply-privacy-button--pos-${f}`,h.type="button",h.setAttribute("aria-label",r.button_label),l)h.innerHTML=l;else if(n){const e=document.createElement("img");e.className="vidply-play-overlay-image",e.src=n,e.alt="",e.setAttribute("aria-hidden","true"),h.appendChild(e)}else{const e=`vidply-play-shadow-privacy-${Date.now()}`;h.innerHTML=`\n            <svg class="vidply-play-overlay" viewBox="0 0 80 80" width="80" height="80" aria-hidden="true">\n                <defs>\n                    <filter id="${e}" x="-50%" y="-50%" width="200%" height="200%">\n                        <feGaussianBlur in="SourceAlpha" stdDeviation="3"></feGaussianBlur>\n                        <feOffset dx="0" dy="2" result="offsetblur"></feOffset>\n                        <feComponentTransfer><feFuncA type="linear" slope="0.3"></feFuncA></feComponentTransfer>\n                        <feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge>\n                    </filter>\n                </defs>\n                <circle cx="40" cy="40" r="40" fill="rgba(255, 255, 255, 0.95)" filter="url(#${e})" class="vidply-play-overlay-bg"></circle>\n                <polygon points="32,28 32,52 54,40" fill="#0a406e" class="vidply-play-overlay-icon"></polygon>\n            </svg>\n        `}u.appendChild(h);const g=document.createElement("div");g.className="vidply-privacy-text";let b="<p>";return r.headline&&(b+=`<span class="h6">${r.headline}</span> `),b+=`${r.intro_text} `,b+=`<a href="${r.policy_link}" target="_blank" rel="noreferrer" class="external-link">`,b+=`${r.link_text}</a> ${r.outro_text}`,b+="</p>",g.innerHTML=b,u.appendChild(g),s.appendChild(u),h.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),d.setConsent(e),s.remove(),o()}),s}function k(t){if(!n.has(t))try{const o=t.dataset.vidplySrc,i=o?.includes(".m3u8");if(i){const e=document.createElement("source");e.src=o,e.type="application/x-mpegURL",t.appendChild(e)}else o&&(t.src=o);const l=t.dataset.vidplyOptions?JSON.parse(t.dataset.vidplyOptions):{};let d;r(()=>{d=new e(t,l)}),i&&function(e){e.on("ready",()=>{const t=(o=0)=>{o>=10||(e.renderer?.hls?.levels?.length>0?(e.controls?.buildControlBar?.(),window.dispatchEvent(new Event("resize"))):setTimeout(()=>t(o+1),500))};setTimeout(t,500)})}(d),n.add(t),t._vidplyPlayer=d,a.add(d)}catch(e){console.error("[VidPly Init] Error:",e)}}function P(o){if(o.id&&!n.has(o))try{const i=o.dataset.playlist?JSON.parse(o.dataset.playlist):[];if(!i.length)return;const l=o.dataset.vidplyOptions?JSON.parse(o.dataset.vidplyOptions):{},d="true"===o.dataset.playlistHasExternal,c=o.closest(".vidply-wrapper")||o.parentElement,s=function(e){return"DIV"===e.tagName?e.dataset.vidplyMediaType||"video":"AUDIO"===e.tagName?"audio":"video"}(o),u="true"===o.dataset.playlistAutoPlayFirst,p="false"!==o.dataset.playlistAutoAdvance,y=o.dataset.playlistPrivacySettings?JSON.parse(o.dataset.playlistPrivacySettings):null;let v;d&&o.removeAttribute("data-playlist"),r(()=>{v=new e(o,{...l,mediaType:s})}),v.on("ready",()=>{const n={autoAdvance:p,autoPlayFirst:!d&&u,loop:"true"===o.dataset.playlistLoop,showPanel:"false"!==o.dataset.playlistShowPanel,tracks:d?[]:i,recreatePlayers:d&&"DIV"===o.tagName,hostElement:"DIV"===o.tagName?o:null,PlayerClass:e};let a;r(()=>{a=new t(v,n)}),o._vidplyPlaylist=a;const l=e=>{if(!e)return;const t=!0===e.hideSpeedButton;v.options.speedButton=!t,v.controls?.buildControlBar?.()};try{l(a.getCurrentTrack?.()||i[0])}catch(e){}(()=>{const e=a.loadTrack?.bind(a);"function"==typeof e&&(a.loadTrack=function(t){const o=a.tracks?.[t];return l(o),e(t)});const t=a.play?.bind(a);"function"==typeof t&&(a.play=function(e,o){const i="number"==typeof e?e:a.currentIndex,n=a.tracks?.[i];return l(n),t(e,o)})})(),v.off("error",a.handleTrackError),a.handleTrackError=function(e,t){return function(e){const o=this.getCurrentTrack();o?.src&&(e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("youtube.com")||t.includes("youtu.be")||t.includes("vimeo.com")||t.includes("soundcloud.com")||t.includes(".m3u8")})(o.src)||t&&setTimeout(()=>this.next(),1e3)}.bind(e)}(a,p),v.on("error",a.handleTrackError),d&&function(e,t,o,i,n,a=null,l=null){const d=e.loadTrack.bind(e),c=e.play.bind(e);e.loadTrack=function(i){return T(e,t,o,e=>d(e),a,l)(i)},e.play=function(i,n){return T(e,t,o,(e,t)=>c(e,t),a,l)(i,n)},e.options.autoPlayFirst=n,r(()=>{e.loadPlaylist(i)})}(a,o,c,i,u,y,l)}),n.add(o),o._vidplyPlayer=v,a.add(v)}catch(e){console.error("[VidPly Init] Playlist error:",e)}}function w(e,t,o=null){const i=e?.player,n=[i?.container,i?.videoWrapper?.parentElement,o,t.closest?.(".vidply-wrapper"),t.parentElement,t].filter(Boolean);for(const e of n){const t=e.querySelector?.(".vidply-track-artwork");if(t)return t}return null}function S(e,t,o,i){const n=w(e,t,o);if(n)return i?(n.setAttribute("data-vidply-artwork-forced-hidden","true"),n.style.setProperty("display","none"),void n.setAttribute("aria-hidden","true")):void("true"===n.getAttribute("data-vidply-artwork-forced-hidden")&&(n.removeAttribute("data-vidply-artwork-forced-hidden"),n.style.removeProperty("display"),n.removeAttribute("aria-hidden")))}function C(e){setTimeout(()=>{const t=e.player;if(!t)return;const i=()=>{try{t.play?.()}catch(e){}};"function"==typeof t.on&&t.on("ready",()=>setTimeout(i,o[0])),o.forEach(e=>setTimeout(i,e))},300)}function E(e,t,o,i,n,a,l,r=null){S(e,t,o,!0),function(e,t,o=null){const i=e.player;if(i)try{i.pause(),i.videoWrapper&&(i.videoWrapper.style.display="none",i.videoWrapper.setAttribute("data-vidply-hidden","true"));const n=w(e,t,o);n&&(n.setAttribute("data-vidply-hidden","true"),n.style.setProperty("display","none"))}catch(e){}}(e,t,o),[t,t.parentElement,o].forEach(e=>{e?.querySelector(".vidply-playlist-privacy-overlay")?.remove()}),e.currentIndex=a,e.updatePlaylistUI?.(),e.updateTrackInfo?.(n);const d=b(i,n,()=>{!function(e,t,o=null){const i=e.player;i?.videoWrapper&&(i.videoWrapper.style.display="",i.videoWrapper.removeAttribute("data-vidply-hidden"));const n=[i?.container,i?.videoWrapper?.parentElement,o,t.closest?.(".vidply-wrapper"),t.parentElement,t].filter(Boolean);for(const e of n)e.querySelectorAll?.("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(e,t,o),l(),C(e)},r,o?.dataset?.vidplyPlayIcon||t?.dataset?.vidplyPlayIcon||null,o?.dataset?.vidplyPlayPosition||t?.dataset?.vidplyPlayPosition||"center",h(o));!function(e,t){const o=function(e){for(const t of e.children)if(t.classList.contains("vidply-video-wrapper")||t.classList.contains("vidply-player"))return t;return e.firstChild}(t);o?t.insertBefore(e,o):t.appendChild(e)}(d,t)}function T(e,t,o,i,n=null,a=null){return(l,r)=>{const c=e.tracks[l];if(!c)return i(l,r);"function"==typeof a&&a(c);const s=(e=>{if(!e)return null;const t=e.toLowerCase();return t.includes("youtube.com")||t.includes("youtu.be")?"youtube":t.includes("vimeo.com")?"vimeo":t.includes("soundcloud.com")?"soundcloud":null})(c.src);if(S(e,t,o,!!s),s&&!d.hasConsent(s))return void E(e,t,o,s,c,l,()=>i(l,r),n);!function(e,t){e.querySelector(".vidply-playlist-privacy-overlay")?.remove();const o=t.player;o?.videoWrapper&&(o.videoWrapper.style.display="",o.videoWrapper.removeAttribute("data-vidply-hidden"));const i=[o?.container,o?.videoWrapper?.parentElement,e.closest(".vidply-wrapper"),e.parentElement,e].filter(Boolean);for(const e of i)e.querySelectorAll?.("[data-vidply-hidden]").forEach(e=>{e.style.display="",e.removeAttribute("data-vidply-hidden")})}(t,e);const u=i(l,r);return s&&C(e),u}}function A(){const e=document.documentElement,t=document.body,o=e.getAttribute("data-bs-theme");if("light"===o)return"light";if("dark"===o)return"dark";const i=document.getElementById("themeSwitch");if(i&&"checkbox"===i.type)return i.checked?"dark":"light";const n=[t.classList.contains("light-mode"),t.classList.contains("light"),t.classList.contains("theme-light"),e.classList.contains("light-mode"),e.classList.contains("light"),e.classList.contains("theme-light"),"light"===t.dataset.theme,"light"===e.dataset.theme],a=[t.classList.contains("dark-mode"),t.classList.contains("dark"),t.classList.contains("theme-dark"),e.classList.contains("dark-mode"),e.classList.contains("dark"),e.classList.contains("theme-dark"),"dark"===t.dataset.theme,"dark"===e.dataset.theme];return n.some(Boolean)?"light":a.some(Boolean)?"dark":window.matchMedia?.("(prefers-color-scheme: light)")?.matches?"light":"dark"}function L(e){const t="light"===e?"light":"dark";a.forEach(e=>{if(e&&"function"==typeof e.setTheme)try{e.setTheme(t)}catch(e){}}),document.querySelectorAll(".vidply-player").forEach(e=>{e.classList.remove("vidply-theme-dark","vidply-theme-light"),e.classList.add(`vidply-theme-${t}`)}),document.querySelectorAll("[data-vidply-init], [data-playlist]").forEach(e=>{const o=e._vidplyPlayer;if(o&&"function"==typeof o.setTheme)try{o.setTheme(t)}catch(e){}}),document.dispatchEvent(new CustomEvent("vidply:themechange",{detail:{theme:t}}))}window.VidPlyTheme={setTheme:L,getPlayers:()=>Array.from(a),detectPageTheme:A},document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll("[data-vidply-init]:not([data-playlist])").forEach(k),document.querySelectorAll("[data-playlist]:not([data-vidply])").forEach(P),document.querySelectorAll(".vidply-wrapper[data-vidply-play-inline-svg]").forEach(g),function(){const e=document.documentElement,t=document.getElementById("themeSwitch"),o=A();setTimeout(()=>L(o),200);const i=new MutationObserver(t=>{for(const o of t)if("data-bs-theme"===o.attributeName){const t=e.getAttribute("data-bs-theme");return void("light"!==t&&"dark"!==t||L(t))}L(A())});i.observe(e,{attributes:!0,attributeFilter:["data-bs-theme","class","data-theme"]}),i.observe(document.body,{attributes:!0,attributeFilter:["class","data-theme","data-color-scheme"]}),t&&"checkbox"===t.type&&t.addEventListener("change",()=>{L(t.checked?"dark":"light")}),document.addEventListener("theme:change",e=>{const t=e.detail?.theme;"light"!==t&&"dark"!==t||L(t)})}()});