{
  "version": 3,
  "sources": ["../../src/utils/DOMUtils.js", "../../src/i18n/languages/en.js", "../../src/i18n/languages/de.js", "../../src/i18n/languages/es.js", "../../src/i18n/languages/fr.js", "../../src/i18n/languages/ja.js", "../../src/i18n/translations.js", "../../src/i18n/i18n.js", "../../src/utils/TimeUtils.js", "../../src/icons/Icons.js", "../../src/utils/FocusUtils.js", "../../src/utils/StorageManager.js", "../../src/renderers/HTML5Renderer.js", "../../src/utils/DraggableResizable.js", "../../src/utils/MenuUtils.js", "../../src/utils/FormUtils.js", "../../src/controls/TranscriptManager.js", "../../src/renderers/YouTubeRenderer.js", "../../src/renderers/VimeoRenderer.js", "../../src/renderers/HLSRenderer.js", "../../src/renderers/SoundCloudRenderer.js", "../../src/utils/EventEmitter.js", "../../src/core/Player.js", "../../src/controls/ControlBar.js", "../../src/utils/PerformanceUtils.js", "../../src/utils/VideoFrameCapture.js", "../../src/controls/CaptionManager.js", "../../src/controls/KeyboardManager.js", "../../src/core/AudioDescriptionManager.js", "../../src/core/SignLanguageManager.js", "../../src/features/PlaylistManager.js", "../../src/index.js"],
  "sourcesContent": ["/**\r\n * DOM manipulation utilities\r\n * Optimized for performance with CSS transitions\r\n */\r\n\r\nexport const DOMUtils = {\r\n  /**\r\n   * Create an element with options\r\n   * @param {string} tag - HTML tag name\r\n   * @param {Object} options - Element options\r\n   * @returns {HTMLElement}\r\n   */\r\n  createElement(tag, options = {}) {\r\n    const element = document.createElement(tag);\r\n    \r\n    if (options.className) {\r\n      element.className = options.className;\r\n    }\r\n    \r\n    if (options.attributes) {\r\n      for (const [key, value] of Object.entries(options.attributes)) {\r\n        element.setAttribute(key, value);\r\n      }\r\n    }\r\n    \r\n    if (options.innerHTML) {\r\n      element.innerHTML = options.innerHTML;\r\n    }\r\n    \r\n    if (options.textContent) {\r\n      element.textContent = options.textContent;\r\n    }\r\n    \r\n    if (options.style) {\r\n      Object.assign(element.style, options.style);\r\n    }\r\n    \r\n    if (options.children) {\r\n      for (const child of options.children) {\r\n        if (child) element.appendChild(child);\r\n      }\r\n    }\r\n    \r\n    return element;\r\n  },\r\n\r\n  /**\r\n   * Show element (remove display:none)\r\n   * @param {HTMLElement} element\r\n   */\r\n  show(element) {\r\n    element?.style && (element.style.display = '');\r\n  },\r\n\r\n  /**\r\n   * Hide element\r\n   * @param {HTMLElement} element\r\n   */\r\n  hide(element) {\r\n    element?.style && (element.style.display = 'none');\r\n  },\r\n\r\n  /**\r\n   * Fade in element using CSS transitions (GPU accelerated)\r\n   * @param {HTMLElement} element\r\n   * @param {number} duration - Duration in ms\r\n   * @param {Function} [onComplete] - Callback when complete\r\n   */\r\n  fadeIn(element, duration = 300, onComplete) {\r\n    if (!element) return;\r\n    \r\n    // Set up initial state\r\n    element.style.opacity = '0';\r\n    element.style.display = '';\r\n    element.style.transition = `opacity ${duration}ms ease`;\r\n    \r\n    // Force reflow to ensure transition works\r\n    element.offsetHeight;\r\n    \r\n    // Trigger transition\r\n    element.style.opacity = '1';\r\n    \r\n    // Cleanup after transition\r\n    if (onComplete) {\r\n      const cleanup = () => {\r\n        element.removeEventListener('transitionend', cleanup);\r\n        onComplete();\r\n      };\r\n      element.addEventListener('transitionend', cleanup, { once: true });\r\n      // Fallback timeout in case transitionend doesn't fire\r\n      setTimeout(cleanup, duration + 50);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Fade out element using CSS transitions (GPU accelerated)\r\n   * @param {HTMLElement} element\r\n   * @param {number} duration - Duration in ms\r\n   * @param {Function} [onComplete] - Callback when complete\r\n   */\r\n  fadeOut(element, duration = 300, onComplete) {\r\n    if (!element) return;\r\n    \r\n    element.style.transition = `opacity ${duration}ms ease`;\r\n    element.style.opacity = '0';\r\n    \r\n    const cleanup = () => {\r\n      element.removeEventListener('transitionend', cleanup);\r\n      element.style.display = 'none';\r\n      if (onComplete) onComplete();\r\n    };\r\n    \r\n    element.addEventListener('transitionend', cleanup, { once: true });\r\n    // Fallback timeout in case transitionend doesn't fire\r\n    setTimeout(cleanup, duration + 50);\r\n  },\r\n\r\n  /**\r\n   * Get element's offset position and dimensions\r\n   * @param {HTMLElement} element\r\n   * @returns {Object} { top, left, width, height }\r\n   */\r\n  offset(element) {\r\n    if (!element) return { top: 0, left: 0, width: 0, height: 0 };\r\n    \r\n    const rect = element.getBoundingClientRect();\r\n    return {\r\n      top: rect.top + window.scrollY,\r\n      left: rect.left + window.scrollX,\r\n      width: rect.width,\r\n      height: rect.height\r\n    };\r\n  },\r\n\r\n  /**\r\n   * Escape HTML special characters\r\n   * @param {string} str - String to escape\r\n   * @returns {string} Escaped string\r\n   */\r\n  escapeHTML(str) {\r\n    const escapeMap = {\r\n      '&': '&amp;',\r\n      '<': '&lt;',\r\n      '>': '&gt;',\r\n      '\"': '&quot;',\r\n      \"'\": '&#x27;'\r\n    };\r\n    return str.replace(/[&<>\"']/g, char => escapeMap[char]);\r\n  },\r\n\r\n  /**\r\n   * Basic HTML sanitization for VTT captions\r\n   * Allows safe formatting tags, removes dangerous content\r\n   * @param {string} html - HTML string to sanitize\r\n   * @returns {string} Sanitized HTML\r\n   */\r\n  sanitizeHTML(html) {\r\n    // Remove dangerous content\r\n    const safeHtml = html\r\n      .replace(/<script\\b[^<]*(?:(?!<\\/script>)<[^<]*)*<\\/script>/gi, '')\r\n      .replace(/<iframe\\b[^<]*(?:(?!<\\/iframe>)<[^<]*)*<\\/iframe>/gi, '')\r\n      .replace(/on\\w+\\s*=/gi, '') // Event handlers\r\n      .replace(/javascript:/gi, ''); // javascript: protocol\r\n    \r\n    // Use DOM parser for final sanitization\r\n    const temp = document.createElement('div');\r\n    temp.innerHTML = safeHtml;\r\n    return temp.innerHTML;\r\n  },\r\n\r\n  /**\r\n   * Create a tooltip element (aria-hidden)\r\n   * @param {string} text - Tooltip text\r\n   * @param {string} classPrefix - Class prefix\r\n   * @returns {HTMLElement}\r\n   */\r\n  createTooltip(text, classPrefix = 'vidply') {\r\n    return this.createElement('span', {\r\n      className: `${classPrefix}-tooltip`,\r\n      textContent: text,\r\n      attributes: { 'aria-hidden': 'true' }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Attach a tooltip to an element with hover/focus behavior\r\n   * @param {HTMLElement} element - Target element\r\n   * @param {string} text - Tooltip text\r\n   * @param {string} classPrefix - Class prefix\r\n   */\r\n  attachTooltip(element, text, classPrefix = 'vidply') {\r\n    if (!element || !text) return;\r\n    \r\n    // Remove existing tooltip\r\n    element.querySelector(`.${classPrefix}-tooltip`)?.remove();\r\n    \r\n    const tooltip = this.createTooltip(text, classPrefix);\r\n    element.appendChild(tooltip);\r\n    \r\n    const visibleClass = `${classPrefix}-tooltip-visible`;\r\n    const show = () => tooltip.classList.add(visibleClass);\r\n    const hide = () => tooltip.classList.remove(visibleClass);\r\n    \r\n    element.addEventListener('mouseenter', show);\r\n    element.addEventListener('mouseleave', hide);\r\n    element.addEventListener('focus', show);\r\n    element.addEventListener('blur', hide);\r\n  },\r\n\r\n  /**\r\n   * Create button text element (visible when CSS disabled)\r\n   * @param {string} text - Button text\r\n   * @param {string} classPrefix - Class prefix\r\n   * @returns {HTMLElement}\r\n   */\r\n  createButtonText(text, classPrefix = 'vidply') {\r\n    return this.createElement('span', {\r\n      className: `${classPrefix}-button-text`,\r\n      textContent: text,\r\n      attributes: { 'aria-hidden': 'true' }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Add class to element (null-safe)\r\n   * @param {HTMLElement} element\r\n   * @param {string} className\r\n   */\r\n  addClass(element, className) {\r\n    element?.classList?.add(className);\r\n  },\r\n\r\n  /**\r\n   * Remove class from element (null-safe)\r\n   * @param {HTMLElement} element\r\n   * @param {string} className\r\n   */\r\n  removeClass(element, className) {\r\n    element?.classList?.remove(className);\r\n  },\r\n\r\n  /**\r\n   * Toggle class on element (null-safe)\r\n   * @param {HTMLElement} element\r\n   * @param {string} className\r\n   */\r\n  toggleClass(element, className) {\r\n    element?.classList?.toggle(className);\r\n  },\r\n\r\n  /**\r\n   * Check if element has class (null-safe)\r\n   * @param {HTMLElement} element\r\n   * @param {string} className\r\n   * @returns {boolean}\r\n   */\r\n  hasClass(element, className) {\r\n    return element?.classList?.contains(className) ?? false;\r\n  }\r\n};\r\n", "/**\r\n * English translations for VidPly\r\n */\r\n\r\nexport const en = {\r\n  player: {\r\n    label: 'Video Player',\r\n    play: 'Play',\r\n    pause: 'Pause',\r\n    stop: 'Stop',\r\n    restart: 'Restart from beginning',\r\n    rewind: 'Rewind',\r\n    forward: 'Forward',\r\n    rewindSeconds: 'Rewind {seconds} seconds',\r\n    forwardSeconds: 'Forward {seconds} seconds',\r\n    previous: 'Previous track',\r\n    next: 'Next track',\r\n    playlist: 'Toggle playlist',\r\n    volume: 'Volume',\r\n    mute: 'Mute',\r\n    unmute: 'Unmute',\r\n    fullscreen: 'Fullscreen',\r\n    exitFullscreen: 'Exit Fullscreen',\r\n    captions: 'Captions',\r\n    chapters: 'Chapters',\r\n    quality: 'Quality',\r\n    captionStyling: 'Caption styling',\r\n    transcript: 'Toggle transcript',\r\n    audioDescription: 'Audio description',\r\n    signLanguage: 'Sign language video',\r\n    settings: 'Settings',\r\n    speed: 'Playback Speed',\r\n    pip: 'Picture in Picture',\r\n    currentTime: 'Current time',\r\n    duration: 'Duration',\r\n    progress: 'Progress',\r\n    seekForward: 'Seek forward {seconds} seconds',\r\n    seekBackward: 'Seek backward {seconds} seconds',\r\n    volumeUp: 'Volume up',\r\n    volumeDown: 'Volume down',\r\n    loading: 'Loading...',\r\n    loadingChapters: 'Loading chapters...',\r\n    error: 'Error loading media',\r\n    buffering: 'Buffering...',\r\n    signLanguageVideo: 'Sign Language Video',\r\n    closeSignLanguage: 'Close sign language video',\r\n    signLanguageSettings: 'Sign language settings',\r\n    startPlaybackFirst: 'Please start playback first.',\r\n    startPlaybackForAudioDescription: 'Please start playback first to use audio description.',\r\n    startPlaybackForSignLanguage: 'Please start playback first to use sign language video.',\r\n    noChapters: 'No chapters available',\r\n    noCaptions: 'No captions available',\r\n    auto: 'Auto',\r\n    autoQuality: 'Auto (no quality selection available)',\r\n    noQuality: 'Quality selection not available',\r\n    signLanguageDragResize: 'Sign Language Video - Press D to drag with keyboard, R to resize',\r\n    signLanguageDragActive: 'Sign Language Video - Drag mode active. Use arrow keys to move, Escape to exit.',\r\n    signLanguageResizeActive: 'Sign Language Video - Resize mode active. Use left/right arrow keys to resize, Escape to exit.',\r\n    enableSignDragMode: 'Enable drag mode. Shortcut: D key',\r\n    disableSignDragMode: 'Disable drag mode. Shortcut: D key',\r\n    enableSignDragModeAria: 'Enable toggle keyboard drag mode with arrow keys. Shortcut: D key',\r\n    disableSignDragModeAria: 'Disable toggle keyboard drag mode with arrow keys. Shortcut: D key',\r\n    enableSignResizeMode: 'Enable resize mode. Shortcut: R key',\r\n    disableSignResizeMode: 'Disable resize mode. Shortcut: R key',\r\n    enableSignResizeModeAria: 'Enable keyboard resize mode with arrow keys. Shortcut: R key',\r\n    disableSignResizeModeAria: 'Disable keyboard resize mode with arrow keys. Shortcut: R key',\r\n    resizeHandle: 'Resize {direction} corner',\r\n    moreOptions: 'More options',\r\n    noMoreOptions: 'No additional options available'\r\n  },\r\n  captions: {\r\n    off: 'Off',\r\n    select: 'Select captions',\r\n    fontSize: 'Font Size',\r\n    fontFamily: 'Font Family',\r\n    color: 'Text Color',\r\n    backgroundColor: 'Background Color',\r\n    opacity: 'Opacity'\r\n  },\r\n  fontSizes: {\r\n    small: 'Small',\r\n    normal: 'Normal',\r\n    large: 'Large',\r\n    xlarge: 'X-Large'\r\n  },\r\n  fontFamilies: {\r\n    sansSerif: 'Sans-serif',\r\n    serif: 'Serif',\r\n    monospace: 'Monospace'\r\n  },\r\n  styleLabels: {\r\n    textColor: 'Text Color',\r\n    background: 'Background',\r\n    font: 'Font',\r\n    fontSize: 'Font Size',\r\n    opacity: 'Opacity'\r\n  },\r\n  audioDescription: {\r\n    enable: 'Enable audio description',\r\n    disable: 'Disable audio description'\r\n  },\r\n  signLanguage: {\r\n    show: 'Show sign language video',\r\n    hide: 'Hide sign language video',\r\n    showInMainView: 'Show sign language in main video',\r\n    hideInMainView: 'Hide sign language from main video'\r\n  },\r\n  transcript: {\r\n    title: 'Transcript',\r\n    ariaLabel: 'Video Transcript',\r\n    close: 'Close transcript',\r\n    loading: 'Loading transcript...',\r\n    noTranscript: 'No transcript available for this video.',\r\n    settings: 'Transcript settings. Press Enter to open menu, or D to enable drag mode',\r\n    keyboardDragMode: 'Toggle keyboard drag mode with arrow keys. Shortcut: D key',\r\n    keyboardDragActive: '⌨️ Keyboard Drag Mode Active (Arrow keys to move, Shift+Arrows for large steps, D or ESC to exit)',\r\n    dragResizePrompt: 'Press D to drag or R to resize. Use Home to reset position, Esc to close.',\r\n    dragModeEnabled: 'Keyboard drag mode enabled. Use arrow keys to move, Shift+Arrow for larger steps. Press D or Esc to exit.',\r\n    dragModeDisabled: 'Keyboard drag mode disabled.',\r\n    enableDragMode: 'Enable drag mode. Shortcut: D key',\r\n    disableDragMode: 'Disable drag mode. Shortcut: D key',\r\n    enableDragModeAria: 'Enable toggle keyboard drag mode with arrow keys. Shortcut: D key',\r\n    disableDragModeAria: 'Disable toggle keyboard drag mode with arrow keys. Shortcut: D key',\r\n    resizeWindow: 'Resize Window',\r\n    disableResizeWindow: 'Disable Resize Mode',\r\n    enableResizeMode: 'Enable resize mode. Shortcut: R key',\r\n    disableResizeMode: 'Disable resize mode. Shortcut: R key',\r\n    enableResizeModeAria: 'Enable keyboard resize mode with arrow keys. Shortcut: R key',\r\n    disableResizeModeAria: 'Disable keyboard resize mode with arrow keys. Shortcut: R key',\r\n    resizeModeHint: 'Resize handles enabled. Drag edges or corners to adjust. Press Esc or R to exit.',\r\n    resizeModeEnabled: 'Resize mode enabled. Drag edges or corners to adjust. Press Esc or R to exit.',\r\n    resizeModeDisabled: 'Resize mode disabled.',\r\n    positionReset: 'Transcript position reset.',\r\n    styleTranscript: 'Open transcript style settings',\r\n    closeMenu: 'Close Menu',\r\n    styleTitle: 'Transcript Style',\r\n    autoscroll: 'Autoscroll',\r\n    settingsMenu: 'Transcript dialog settings',\r\n    showTimestamps: 'Show timestamps',\r\n    hideTimestamps: 'Hide timestamps',\r\n    showTimestampsAria: 'Show timestamps in transcript',\r\n    hideTimestampsAria: 'Hide timestamps in transcript'\r\n  },\r\n  settings: {\r\n    title: 'Settings',\r\n    quality: 'Quality',\r\n    speed: 'Speed',\r\n    captions: 'Captions',\r\n    language: 'Language',\r\n    reset: 'Reset to defaults',\r\n    close: 'Close'\r\n  },\r\n  speeds: {\r\n    normal: 'Normal'\r\n  },\r\n  time: {\r\n    display: 'Time display',\r\n    durationPrefix: 'Duration: ',\r\n    of: 'of',\r\n    hour: '{count} hour',\r\n    hours: '{count} hours',\r\n    minute: '{count} minute',\r\n    minutes: '{count} minutes',\r\n    second: '{count} second',\r\n    seconds: '{count} seconds'\r\n  },\r\n  playlist: {\r\n    title: 'Playlist',\r\n    trackOf: 'Track {current} of {total}',\r\n    nowPlaying: 'Now playing: Track {current} of {total}. {title}{artist}',\r\n    by: ' by ',\r\n    untitled: 'Untitled',\r\n    trackUntitled: 'Track {number}',\r\n    currentlyPlaying: 'Currently playing',\r\n    notPlaying: 'Not playing',\r\n    pressEnterPlay: 'Press Enter to play',\r\n    pressEnterRestart: 'Press Enter to restart',\r\n    keyboardInstructions: 'Playlist navigation: Use Up and Down arrow keys to move between tracks. Press Page Up or Page Down to skip 5 tracks. Press Home to go to first track, End to go to last track. Press Enter or Space to play the selected track.',\r\n    endOfPlaylist: 'End of playlist. {current} of {total}.',\r\n    beginningOfPlaylist: 'Beginning of playlist. 1 of {total}.',\r\n    jumpedToLastTrack: 'Jumped to last track. {current} of {total}.',\r\n    jumpedToFirstTrack: 'Jumped to first track. 1 of {total}.',\r\n    firstTrack: 'First track. 1 of {total}.',\r\n    lastTrack: 'Last track. {current} of {total}.'\r\n  }\r\n};\r\n\r\n", "/**\r\n * German translations for VidPly\r\n */\r\n\r\nexport const de = {\r\n    player: {\r\n        label: 'Videoplayer',\r\n        play: 'Abspielen',\r\n        pause: 'Pause',\r\n        stop: 'Stopp',\r\n        restart: 'Von vorne beginnen',\r\n        rewind: 'Zurückspulen',\r\n        forward: 'Vorspulen',\r\n        rewindSeconds: '{seconds} Sekunden zurückspulen',\r\n        forwardSeconds: '{seconds} Sekunden vorspulen',\r\n        previous: 'Vorheriger Titel',\r\n        next: 'Nächster Titel',\r\n        playlist: 'Wiedergabeliste umschalten',\r\n        volume: 'Lautstärke',\r\n        mute: 'Stumm',\r\n        unmute: 'Ton ein',\r\n        fullscreen: 'Vollbild',\r\n        exitFullscreen: 'Vollbild beenden',\r\n        captions: 'Untertitel',\r\n        chapters: 'Kapitel',\r\n        quality: 'Qualität',\r\n        captionStyling: 'Untertitel-Stil',\r\n        transcript: 'Transkript umschalten',\r\n        audioDescription: 'Audiodeskription',\r\n        signLanguage: 'Gebärdensprache-Video',\r\n        settings: 'Einstellungen',\r\n        speed: 'Wiedergabegeschwindigkeit',\r\n        pip: 'Bild-in-Bild',\r\n        currentTime: 'Aktuelle Zeit',\r\n        duration: 'Dauer',\r\n        progress: 'Fortschritt',\r\n        seekForward: '{seconds} Sekunden vorspulen',\r\n        seekBackward: '{seconds} Sekunden zurückspulen',\r\n        volumeUp: 'Lauter',\r\n        volumeDown: 'Leiser',\r\n        loading: 'Lädt...',\r\n        loadingChapters: 'Kapitel werden geladen...',\r\n        error: 'Fehler beim Laden',\r\n        buffering: 'Puffern...',\r\n        signLanguageVideo: 'Gebärdensprache-Video',\r\n        closeSignLanguage: 'Gebärdensprache-Video schließen',\r\n        signLanguageSettings: 'Gebärdensprache-Einstellungen',\r\n        startPlaybackFirst: 'Bitte starten Sie die Wiedergabe zuerst.',\r\n        startPlaybackForAudioDescription: 'Bitte starten Sie die Wiedergabe zuerst, um die Audiodeskription zu nutzen.',\r\n        startPlaybackForSignLanguage: 'Bitte starten Sie die Wiedergabe zuerst, um das Gebärdensprache-Video zu nutzen.',\r\n        noChapters: 'Keine Kapitel verfügbar',\r\n        noCaptions: 'Keine Untertitel verfügbar',\r\n        auto: 'Automatisch',\r\n        autoQuality: 'Automatisch (keine Qualitätsauswahl verfügbar)',\r\n        noQuality: 'Qualitätsauswahl nicht verfügbar',\r\n        signLanguageDragResize: 'Gebärdensprache-Video - Drücken Sie D zum Verschieben per Tastatur, R zum Ändern der Größe',\r\n        signLanguageDragActive: 'Gebärdensprache-Video - Verschiebemodus aktiv. Pfeiltasten zum Bewegen, Escape zum Beenden.',\r\n        signLanguageResizeActive: 'Gebärdensprache-Video - Größenänderungsmodus aktiv. Links-/Rechts-Pfeiltasten zum Ändern der Größe, Escape zum Beenden.',\r\n        enableSignDragMode: 'Verschiebemodus aktivieren. Tastenkombination: D-Taste',\r\n        disableSignDragMode: 'Verschiebemodus deaktivieren. Tastenkombination: D-Taste',\r\n        enableSignDragModeAria: 'Tastatur-Verschiebemodus mit Pfeiltasten aktivieren. Tastenkombination: D-Taste',\r\n        disableSignDragModeAria: 'Tastatur-Verschiebemodus mit Pfeiltasten deaktivieren. Tastenkombination: D-Taste',\r\n        enableSignResizeMode: 'Größenänderungsmodus aktivieren. Tastenkombination: R-Taste',\r\n        disableSignResizeMode: 'Größenänderungsmodus deaktivieren. Tastenkombination: R-Taste',\r\n        enableSignResizeModeAria: 'Tastatur-Größenänderungsmodus mit Pfeiltasten aktivieren. Tastenkombination: R-Taste',\r\n        disableSignResizeModeAria: 'Tastatur-Größenänderungsmodus mit Pfeiltasten deaktivieren. Tastenkombination: R-Taste',\r\n        resizeHandle: 'Größenänderung {direction}-Ecke',\r\n        moreOptions: 'Weitere Optionen',\r\n        noMoreOptions: 'Keine weiteren Optionen verfügbar'\r\n    },\r\n    captions: {\r\n        off: 'Aus',\r\n        select: 'Untertitel auswählen',\r\n        fontSize: 'Schriftgröße',\r\n        fontFamily: 'Schriftart',\r\n        color: 'Textfarbe',\r\n        backgroundColor: 'Hintergrundfarbe',\r\n        opacity: 'Deckkraft'\r\n    },\r\n    fontSizes: {\r\n        small: 'Klein',\r\n        normal: 'Normal',\r\n        large: 'Groß',\r\n        xlarge: 'Sehr groß'\r\n    },\r\n    fontFamilies: {\r\n        sansSerif: 'Sans-serif',\r\n        serif: 'Serif',\r\n        monospace: 'Monospace'\r\n    },\r\n    styleLabels: {\r\n        textColor: 'Textfarbe',\r\n        background: 'Hintergrund',\r\n        font: 'Schrift',\r\n        fontSize: 'Schriftgröße',\r\n        opacity: 'Deckkraft'\r\n    },\r\n    audioDescription: {\r\n        enable: 'Audiodeskription aktivieren',\r\n        disable: 'Audiodeskription deaktivieren'\r\n    },\r\n    signLanguage: {\r\n        show: 'Gebärdensprache-Video anzeigen',\r\n        hide: 'Gebärdensprache-Video ausblenden',\r\n        showInMainView: 'Gebärdensprache im Hauptvideo anzeigen',\r\n        hideInMainView: 'Gebärdensprache aus Hauptvideo entfernen'\r\n    },\r\n    transcript: {\r\n        title: 'Transkript',\r\n        ariaLabel: 'Video-Transkript',\r\n        close: 'Transkript schließen',\r\n        loading: 'Transkript wird geladen...',\r\n        noTranscript: 'Kein Transkript für dieses Video verfügbar.',\r\n        settings: 'Transkript-Einstellungen. Eingabetaste zum Öffnen des Menüs drücken oder D zum Aktivieren des Verschiebemodus',\r\n        keyboardDragMode: 'Tastatur-Verschiebemodus mit Pfeiltasten umschalten. Tastenkombination: D-Taste',\r\n        keyboardDragActive: '⌨️ Tastatur-Verschiebemodus aktiv (Pfeiltasten zum Bewegen, Umschalt+Pfeiltasten für große Schritte, D oder ESC zum Beenden)',\r\n        dragResizePrompt: 'Drücken Sie D zum Verschieben oder R zur Größenänderung. Home setzt die Position zurück, Esc schließt.',\r\n        dragModeEnabled: 'Tastatur-Verschiebemodus aktiviert. Pfeiltasten zum Bewegen, Umschalt+Pfeiltasten für größere Schritte. D oder Esc zum Beenden.',\r\n        dragModeDisabled: 'Tastatur-Verschiebemodus deaktiviert.',\r\n        enableDragMode: 'Verschiebemodus aktivieren. Tastenkombination: D-Taste',\r\n        disableDragMode: 'Verschiebemodus deaktivieren. Tastenkombination: D-Taste',\r\n        enableDragModeAria: 'Tastatur-Verschiebemodus mit Pfeiltasten aktivieren. Tastenkombination: D-Taste',\r\n        disableDragModeAria: 'Tastatur-Verschiebemodus mit Pfeiltasten deaktivieren. Tastenkombination: D-Taste',\r\n        resizeWindow: 'Fenster vergrößern/verkleinern',\r\n        disableResizeWindow: 'Resize-Modus deaktivieren',\r\n        enableResizeMode: 'Größenänderungsmodus aktivieren. Tastenkombination: R-Taste',\r\n        disableResizeMode: 'Größenänderungsmodus deaktivieren. Tastenkombination: R-Taste',\r\n        enableResizeModeAria: 'Tastatur-Größenänderungsmodus mit Pfeiltasten aktivieren. Tastenkombination: R-Taste',\r\n        disableResizeModeAria: 'Tastatur-Größenänderungsmodus mit Pfeiltasten deaktivieren. Tastenkombination: R-Taste',\r\n        resizeModeHint: 'Griffe aktiviert. Ziehen Sie Kanten oder Ecken zum Anpassen. Esc oder R zum Beenden.',\r\n        resizeModeEnabled: 'Resize-Modus aktiviert. Kanten oder Ecken ziehen; Esc oder R beendet.',\r\n        resizeModeDisabled: 'Resize-Modus deaktiviert.',\r\n        positionReset: 'Transkriptposition zurückgesetzt.',\r\n        styleTranscript: 'Transkript-Stileinstellungen öffnen',\r\n        closeMenu: 'Menü schließen',\r\n        styleTitle: 'Transkript-Stil',\r\n        autoscroll: 'Auto-Scroll',\r\n        settingsMenu: 'Transkript-Dialog-Einstellungen',\r\n        showTimestamps: 'Zeitstempel anzeigen',\r\n        hideTimestamps: 'Zeitstempel ausblenden',\r\n        showTimestampsAria: 'Zeitstempel im Transkript anzeigen',\r\n        hideTimestampsAria: 'Zeitstempel im Transkript ausblenden'\r\n    },\r\n    settings: {\r\n        title: 'Einstellungen',\r\n        quality: 'Qualität',\r\n        speed: 'Geschwindigkeit',\r\n        captions: 'Untertitel',\r\n        language: 'Sprache',\r\n        reset: 'Zurücksetzen',\r\n        close: 'Schließen'\r\n    },\r\n    speeds: {\r\n        normal: 'Normal'\r\n    },\r\n    time: {\r\n        display: 'Zeitanzeige',\r\n        durationPrefix: 'Dauer: ',\r\n        of: 'von',\r\n        hour: '{count} Stunde',\r\n        hours: '{count} Stunden',\r\n        minute: '{count} Minute',\r\n        minutes: '{count} Minuten',\r\n        second: '{count} Sekunde',\r\n        seconds: '{count} Sekunden'\r\n    },\r\n    playlist: {\r\n        title: 'Wiedergabeliste',\r\n        trackOf: 'Titel {current} von {total}',\r\n        nowPlaying: 'Läuft gerade: Titel {current} von {total}. {title}{artist}',\r\n        by: ' von ',\r\n        untitled: 'Ohne Titel',\r\n        trackUntitled: 'Titel {number}',\r\n        currentlyPlaying: 'Wird gerade abgespielt',\r\n        notPlaying: 'Nicht aktiv',\r\n        pressEnterPlay: 'Eingabetaste zum Abspielen',\r\n        pressEnterRestart: 'Eingabetaste zum Neustart',\r\n        keyboardInstructions: 'Wiedergabelisten-Navigation: Verwenden Sie die Pfeiltasten nach oben und unten, um zwischen Titeln zu wechseln. Drücken Sie Bild auf oder Bild ab, um 5 Titel zu überspringen. Drücken Sie Pos1, um zum ersten Titel zu springen, Ende für den letzten Titel. Drücken Sie die Eingabetaste oder Leertaste, um den ausgewählten Titel abzuspielen.',\r\n        endOfPlaylist: 'Ende der Wiedergabeliste. {current} von {total}.',\r\n        beginningOfPlaylist: 'Anfang der Wiedergabeliste. 1 von {total}.',\r\n        jumpedToLastTrack: 'Zum letzten Titel gesprungen. {current} von {total}.',\r\n        jumpedToFirstTrack: 'Zum ersten Titel gesprungen. 1 von {total}.',\r\n        firstTrack: 'Erster Titel. 1 von {total}.',\r\n        lastTrack: 'Letzter Titel. {current} von {total}.'\r\n    }\r\n};\r\n\r\n", "/**\r\n * Spanish translations for VidPly\r\n */\r\n\r\nexport const es = {\r\n  player: {\r\n    label: 'Reproductor de video',\r\n    play: 'Reproducir',\r\n    pause: 'Pausa',\r\n    stop: 'Detener',\r\n    restart: 'Reiniciar desde el principio',\r\n    rewind: 'Retroceder',\r\n    forward: 'Avanzar',\r\n    rewindSeconds: 'Retroceder {seconds} segundos',\r\n    forwardSeconds: 'Avanzar {seconds} segundos',\r\n    previous: 'Pista anterior',\r\n    next: 'Siguiente pista',\r\n    playlist: 'Alternar lista de reproducción',\r\n    volume: 'Volumen',\r\n    mute: 'Silenciar',\r\n    unmute: 'Activar sonido',\r\n    fullscreen: 'Pantalla completa',\r\n    exitFullscreen: 'Salir de pantalla completa',\r\n    captions: 'Subtítulos',\r\n    chapters: 'Capítulos',\r\n    quality: 'Calidad',\r\n    captionStyling: 'Estilo de subtítulos',\r\n    transcript: 'Alternar transcripción',\r\n    audioDescription: 'Audiodescripción',\r\n    signLanguage: 'Video en lengua de señas',\r\n    settings: 'Configuración',\r\n    speed: 'Velocidad de reproducción',\r\n    pip: 'Imagen en imagen',\r\n    currentTime: 'Tiempo actual',\r\n    duration: 'Duración',\r\n    progress: 'Progreso',\r\n    seekForward: 'Avanzar {seconds} segundos',\r\n    seekBackward: 'Retroceder {seconds} segundos',\r\n    volumeUp: 'Subir volumen',\r\n    volumeDown: 'Bajar volumen',\r\n    loading: 'Cargando...',\r\n    loadingChapters: 'Cargando capítulos...',\r\n    error: 'Error al cargar',\r\n    buffering: 'Almacenando en búfer...',\r\n    signLanguageVideo: 'Video en Lengua de Señas',\r\n    closeSignLanguage: 'Cerrar video en lengua de señas',\r\n    signLanguageSettings: 'Configuración de lengua de señas',\r\n    noChapters: 'No hay capítulos disponibles',\r\n    noCaptions: 'No hay subtítulos disponibles',\r\n    auto: 'Automático',\r\n    autoQuality: 'Automático (selección de calidad no disponible)',\r\n    noQuality: 'Selección de calidad no disponible',\r\n    signLanguageDragResize: 'Video en Lengua de Señas - Presione D para arrastrar con el teclado, R para cambiar el tamaño',\r\n    signLanguageDragActive: 'Video en Lengua de Señas - Modo de arrastre activo. Use las teclas de flecha para mover, Escape para salir.',\r\n    signLanguageResizeActive: 'Video en Lengua de Señas - Modo de cambio de tamaño activo. Use las teclas de flecha izquierda/derecha para cambiar el tamaño, Escape para salir.',\r\n    enableSignDragMode: 'Activar modo de arrastre. Atajo: tecla D',\r\n    disableSignDragMode: 'Desactivar modo de arrastre. Atajo: tecla D',\r\n    enableSignDragModeAria: 'Activar modo de arrastre con teclado usando teclas de flecha. Atajo: tecla D',\r\n    disableSignDragModeAria: 'Desactivar modo de arrastre con teclado usando teclas de flecha. Atajo: tecla D',\r\n    enableSignResizeMode: 'Activar modo de cambio de tamaño. Atajo: tecla R',\r\n    disableSignResizeMode: 'Desactivar modo de cambio de tamaño. Atajo: tecla R',\r\n    enableSignResizeModeAria: 'Activar modo de cambio de tamaño con teclado usando teclas de flecha. Atajo: tecla R',\r\n    disableSignResizeModeAria: 'Desactivar modo de cambio de tamaño con teclado usando teclas de flecha. Atajo: tecla R',\r\n    resizeHandle: 'Cambiar tamaño esquina {direction}',\r\n    moreOptions: 'Más opciones',\r\n    noMoreOptions: 'No hay opciones adicionales disponibles'\r\n  },\r\n  captions: {\r\n    off: 'Desactivado',\r\n    select: 'Seleccionar subtítulos',\r\n    fontSize: 'Tamaño de fuente',\r\n    fontFamily: 'Familia de fuente',\r\n    color: 'Color de texto',\r\n    backgroundColor: 'Color de fondo',\r\n    opacity: 'Opacidad'\r\n  },\r\n  fontSizes: {\r\n    small: 'Pequeño',\r\n    normal: 'Normal',\r\n    large: 'Grande',\r\n    xlarge: 'Muy grande'\r\n  },\r\n  fontFamilies: {\r\n    sansSerif: 'Sans-serif',\r\n    serif: 'Serif',\r\n    monospace: 'Monospace'\r\n  },\r\n  styleLabels: {\r\n    textColor: 'Color de texto',\r\n    background: 'Fondo',\r\n    font: 'Fuente',\r\n    fontSize: 'Tamaño de fuente',\r\n    opacity: 'Opacidad'\r\n  },\r\n  audioDescription: {\r\n    enable: 'Activar audiodescripción',\r\n    disable: 'Desactivar audiodescripción'\r\n  },\r\n  signLanguage: {\r\n    show: 'Mostrar video en lengua de señas',\r\n    hide: 'Ocultar video en lengua de señas',\r\n    showInMainView: 'Mostrar lengua de señas en video principal',\r\n    hideInMainView: 'Ocultar lengua de señas del video principal'\r\n  },\r\n  transcript: {\r\n    title: 'Transcripción',\r\n    ariaLabel: 'Transcripción de video',\r\n    close: 'Cerrar transcripción',\r\n    loading: 'Cargando transcripción...',\r\n    noTranscript: 'No hay transcripción disponible para este video.',\r\n    settings: 'Configuración de transcripción. Presione Enter para abrir el menú o D para activar el modo de arrastre',\r\n    keyboardDragMode: 'Alternar modo de arrastre con teclado usando teclas de flecha. Atajo: tecla D',\r\n    keyboardDragActive: '⌨️ Modo de Arrastre con Teclado Activo (Teclas de flecha para mover, Mayús+Flechas para pasos grandes, D o ESC para salir)',\r\n    dragResizePrompt: 'Pulsa D para mover o R para cambiar el tamaño. Home restablece la posición; Esc cierra.',\r\n    dragModeEnabled: 'Modo de arrastre con teclado activado. Usa flechas para mover, Mayús+Flechas para pasos grandes. Pulsa D o Esc para salir.',\r\n    dragModeDisabled: 'Modo de arrastre con teclado desactivado.',\r\n    enableDragMode: 'Activar modo de arrastre. Atajo: tecla D',\r\n    disableDragMode: 'Desactivar modo de arrastre. Atajo: tecla D',\r\n    enableDragModeAria: 'Activar modo de arrastre con teclado usando teclas de flecha. Atajo: tecla D',\r\n    disableDragModeAria: 'Desactivar modo de arrastre con teclado usando teclas de flecha. Atajo: tecla D',\r\n    resizeWindow: 'Cambiar tamaño de ventana',\r\n    disableResizeWindow: 'Desactivar modo de cambio de tamaño',\r\n    enableResizeMode: 'Activar modo de cambio de tamaño. Atajo: tecla R',\r\n    disableResizeMode: 'Desactivar modo de cambio de tamaño. Atajo: tecla R',\r\n    enableResizeModeAria: 'Activar modo de cambio de tamaño con teclado usando teclas de flecha. Atajo: tecla R',\r\n    disableResizeModeAria: 'Desactivar modo de cambio de tamaño con teclado usando teclas de flecha. Atajo: tecla R',\r\n    resizeModeHint: 'Controladores habilitados. Arrastra bordes o esquinas para ajustar. Pulsa Esc o R para salir.',\r\n    resizeModeEnabled: 'Modo de cambio de tamaño activado. Arrastra bordes o esquinas. Pulsa Esc o R para salir.',\r\n    resizeModeDisabled: 'Modo de cambio de tamaño desactivado.',\r\n    positionReset: 'Posición de la transcripción restablecida.',\r\n    styleTranscript: 'Abrir configuración de estilo de transcripción',\r\n    closeMenu: 'Cerrar menú',\r\n    styleTitle: 'Estilo de Transcripción',\r\n    autoscroll: 'Desplazamiento automático',\r\n    settingsMenu: 'Configuración del diálogo de transcripción',\r\n    showTimestamps: 'Mostrar marcas de tiempo',\r\n    hideTimestamps: 'Ocultar marcas de tiempo',\r\n    showTimestampsAria: 'Mostrar marcas de tiempo en la transcripción',\r\n    hideTimestampsAria: 'Ocultar marcas de tiempo en la transcripción'\r\n  },\r\n  settings: {\r\n    title: 'Configuración',\r\n    quality: 'Calidad',\r\n    speed: 'Velocidad',\r\n    captions: 'Subtítulos',\r\n    language: 'Idioma',\r\n    reset: 'Restablecer',\r\n    close: 'Cerrar'\r\n  },\r\n  speeds: {\r\n    normal: 'Normal'\r\n  },\r\n  time: {\r\n    display: 'Visualización de tiempo',\r\n    durationPrefix: 'Duración: ',\r\n    of: 'de',\r\n    hour: '{count} hora',\r\n    hours: '{count} horas',\r\n    minute: '{count} minuto',\r\n    minutes: '{count} minutos',\r\n    second: '{count} segundo',\r\n    seconds: '{count} segundos'\r\n  },\r\n  playlist: {\r\n    title: 'Lista de reproducción',\r\n    trackOf: 'Pista {current} de {total}',\r\n    nowPlaying: 'Reproduciendo ahora: Pista {current} de {total}. {title}{artist}',\r\n    by: ' por ',\r\n    untitled: 'Sin título',\r\n    trackUntitled: 'Pista {number}',\r\n    currentlyPlaying: 'Reproduciendo actualmente',\r\n    notPlaying: 'Sin reproducir',\r\n    pressEnterPlay: 'Pulsa Enter para reproducir',\r\n    pressEnterRestart: 'Pulsa Enter para reiniciar',\r\n    keyboardInstructions: 'Navegación de lista de reproducción: Use las teclas de flecha arriba y abajo para moverse entre pistas. Pulse Retroceder página o Avanzar página para saltar 5 pistas. Pulse Inicio para ir a la primera pista, Fin para la última pista. Pulse Intro o Espacio para reproducir la pista seleccionada.',\r\n    endOfPlaylist: 'Fin de la lista de reproducción. {current} de {total}.',\r\n    beginningOfPlaylist: 'Inicio de la lista de reproducción. 1 de {total}.',\r\n    jumpedToLastTrack: 'Saltó a la última pista. {current} de {total}.',\r\n    jumpedToFirstTrack: 'Saltó a la primera pista. 1 de {total}.',\r\n    firstTrack: 'Primera pista. 1 de {total}.',\r\n    lastTrack: 'Última pista. {current} de {total}.'\r\n  }\r\n};\r\n\r\n", "/**\r\n * French translations for VidPly\r\n */\r\n\r\nexport const fr = {\r\n  player: {\r\n    label: 'Lecteur vidéo',\r\n    play: 'Lecture',\r\n    pause: 'Pause',\r\n    stop: 'Arrêt',\r\n    restart: 'Redémarrer du début',\r\n    rewind: 'Reculer',\r\n    forward: 'Avancer',\r\n    rewindSeconds: 'Reculer de {seconds} secondes',\r\n    forwardSeconds: 'Avancer de {seconds} secondes',\r\n    previous: 'Piste précédente',\r\n    next: 'Piste suivante',\r\n    playlist: 'Basculer la liste de lecture',\r\n    volume: 'Volume',\r\n    mute: 'Muet',\r\n    unmute: 'Activer le son',\r\n    fullscreen: 'Plein écran',\r\n    exitFullscreen: 'Quitter le plein écran',\r\n    captions: 'Sous-titres',\r\n    chapters: 'Chapitres',\r\n    quality: 'Qualité',\r\n    captionStyling: 'Style des sous-titres',\r\n    transcript: 'Activer/désactiver la transcription',\r\n    audioDescription: 'Audiodescription',\r\n    signLanguage: 'Vidéo en langue des signes',\r\n    settings: 'Paramètres',\r\n    speed: 'Vitesse de lecture',\r\n    pip: 'Image dans l\\'image',\r\n    currentTime: 'Temps actuel',\r\n    duration: 'Durée',\r\n    progress: 'Progression',\r\n    seekForward: 'Avancer de {seconds} secondes',\r\n    seekBackward: 'Reculer de {seconds} secondes',\r\n    volumeUp: 'Augmenter le volume',\r\n    volumeDown: 'Diminuer le volume',\r\n    loading: 'Chargement...',\r\n    loadingChapters: 'Chargement des chapitres...',\r\n    error: 'Erreur de chargement',\r\n    buffering: 'Mise en mémoire tampon...',\r\n    signLanguageVideo: 'Vidéo en Langue des Signes',\r\n    closeSignLanguage: 'Fermer la vidéo en langue des signes',\r\n    signLanguageSettings: 'Paramètres de la langue des signes',\r\n    noChapters: 'Aucun chapitre disponible',\r\n    noCaptions: 'Aucun sous-titre disponible',\r\n    auto: 'Automatique',\r\n    autoQuality: 'Automatique (sélection de qualité non disponible)',\r\n    noQuality: 'Sélection de qualité non disponible',\r\n    signLanguageDragResize: 'Vidéo en Langue des Signes - Appuyez sur D pour déplacer avec le clavier, R pour redimensionner',\r\n    signLanguageDragActive: 'Vidéo en Langue des Signes - Mode glissement actif. Utilisez les touches fléchées pour déplacer, Échap pour quitter.',\r\n    signLanguageResizeActive: 'Vidéo en Langue des Signes - Mode redimensionnement actif. Utilisez les touches fléchées gauche/droite pour redimensionner, Échap pour quitter.',\r\n    enableSignDragMode: 'Activer le mode glissement. Raccourci : touche D',\r\n    disableSignDragMode: 'Désactiver le mode glissement. Raccourci : touche D',\r\n    enableSignDragModeAria: 'Activer le mode glissement clavier avec les touches fléchées. Raccourci : touche D',\r\n    disableSignDragModeAria: 'Désactiver le mode glissement clavier avec les touches fléchées. Raccourci : touche D',\r\n    enableSignResizeMode: 'Activer le mode redimensionnement. Raccourci : touche R',\r\n    disableSignResizeMode: 'Désactiver le mode redimensionnement. Raccourci : touche R',\r\n    enableSignResizeModeAria: 'Activer le mode redimensionnement clavier avec les touches fléchées. Raccourci : touche R',\r\n    disableSignResizeModeAria: 'Désactiver le mode redimensionnement clavier avec les touches fléchées. Raccourci : touche R',\r\n    resizeHandle: 'Redimensionner coin {direction}',\r\n    moreOptions: 'Plus d\\'options',\r\n    noMoreOptions: 'Aucune option supplémentaire disponible'\r\n  },\r\n  captions: {\r\n    off: 'Désactivé',\r\n    select: 'Sélectionner les sous-titres',\r\n    fontSize: 'Taille de police',\r\n    fontFamily: 'Police',\r\n    color: 'Couleur du texte',\r\n    backgroundColor: 'Couleur de fond',\r\n    opacity: 'Opacité'\r\n  },\r\n  fontSizes: {\r\n    small: 'Petit',\r\n    normal: 'Normal',\r\n    large: 'Grand',\r\n    xlarge: 'Très grand'\r\n  },\r\n  fontFamilies: {\r\n    sansSerif: 'Sans-serif',\r\n    serif: 'Serif',\r\n    monospace: 'Monospace'\r\n  },\r\n  styleLabels: {\r\n    textColor: 'Couleur du texte',\r\n    background: 'Arrière-plan',\r\n    font: 'Police',\r\n    fontSize: 'Taille de police',\r\n    opacity: 'Opacité'\r\n  },\r\n  audioDescription: {\r\n    enable: 'Activer l\\'audiodescription',\r\n    disable: 'Désactiver l\\'audiodescription'\r\n  },\r\n  signLanguage: {\r\n    show: 'Afficher la vidéo en langue des signes',\r\n    hide: 'Masquer la vidéo en langue des signes',\r\n    showInMainView: 'Afficher langue des signes dans la vidéo principale',\r\n    hideInMainView: 'Masquer langue des signes de la vidéo principale'\r\n  },\r\n  transcript: {\r\n    title: 'Transcription',\r\n    ariaLabel: 'Transcription vidéo',\r\n    close: 'Fermer la transcription',\r\n    loading: 'Chargement de la transcription...',\r\n    noTranscript: 'Aucune transcription disponible pour cette vidéo.',\r\n    settings: 'Paramètres de transcription. Appuyez sur Entrée pour ouvrir le menu ou D pour activer le mode glissement',\r\n    keyboardDragMode: 'Basculer le mode glissement avec les touches fléchées. Raccourci: touche D',\r\n    keyboardDragActive: '⌨️ Mode Glissement Clavier Actif (Touches fléchées pour déplacer, Maj+Fléchées pour grands pas, D ou Échap pour quitter)',\r\n    dragResizePrompt: 'Appuyez sur D pour déplacer ou R pour redimensionner. Home réinitialise la position, Échap ferme.',\r\n    dragModeEnabled: 'Mode glissement clavier activé. Utilisez les flèches pour déplacer, Maj+Flèches pour de grands pas. Appuyez sur D ou Échap pour quitter.',\r\n    dragModeDisabled: 'Mode glissement clavier désactivé.',\r\n    enableDragMode: 'Activer le mode glissement. Raccourci : touche D',\r\n    disableDragMode: 'Désactiver le mode glissement. Raccourci : touche D',\r\n    enableDragModeAria: 'Activer le mode glissement clavier avec les touches fléchées. Raccourci : touche D',\r\n    disableDragModeAria: 'Désactiver le mode glissement clavier avec les touches fléchées. Raccourci : touche D',\r\n    resizeWindow: 'Redimensionner la fenêtre',\r\n    disableResizeWindow: 'Désactiver le mode de redimensionnement',\r\n    enableResizeMode: 'Activer le mode redimensionnement. Raccourci : touche R',\r\n    disableResizeMode: 'Désactiver le mode redimensionnement. Raccourci : touche R',\r\n    enableResizeModeAria: 'Activer le mode redimensionnement clavier avec les touches fléchées. Raccourci : touche R',\r\n    disableResizeModeAria: 'Désactiver le mode redimensionnement clavier avec les touches fléchées. Raccourci : touche R',\r\n    resizeModeHint: 'Poignées activées. Faites glisser les bords ou les coins pour ajuster. Appuyez sur Échap ou R pour quitter.',\r\n    resizeModeEnabled: 'Mode redimensionnement activé. Faites glisser les bords ou coins. Appuyez sur Échap ou R pour quitter.',\r\n    resizeModeDisabled: 'Mode redimensionnement désactivé.',\r\n    positionReset: 'Position de la transcription réinitialisée.',\r\n    styleTranscript: 'Ouvrir les paramètres de style de transcription',\r\n    closeMenu: 'Fermer le menu',\r\n    styleTitle: 'Style de Transcription',\r\n    autoscroll: 'Défilement automatique',\r\n    settingsMenu: 'Paramètres de dialogue de transcription',\r\n    showTimestamps: 'Afficher les horodatages',\r\n    hideTimestamps: 'Masquer les horodatages',\r\n    showTimestampsAria: 'Afficher les horodatages dans la transcription',\r\n    hideTimestampsAria: 'Masquer les horodatages dans la transcription'\r\n  },\r\n  settings: {\r\n    title: 'Paramètres',\r\n    quality: 'Qualité',\r\n    speed: 'Vitesse',\r\n    captions: 'Sous-titres',\r\n    language: 'Langue',\r\n    reset: 'Réinitialiser',\r\n    close: 'Fermer'\r\n  },\r\n  speeds: {\r\n    normal: 'Normal'\r\n  },\r\n  time: {\r\n    display: 'Affichage du temps',\r\n    durationPrefix: 'Durée : ',\r\n    of: 'sur',\r\n    hour: '{count} heure',\r\n    hours: '{count} heures',\r\n    minute: '{count} minute',\r\n    minutes: '{count} minutes',\r\n    second: '{count} seconde',\r\n    seconds: '{count} secondes'\r\n  },\r\n  playlist: {\r\n    title: 'Liste de lecture',\r\n    trackOf: 'Piste {current} sur {total}',\r\n    nowPlaying: 'Lecture en cours : Piste {current} sur {total}. {title}{artist}',\r\n    by: ' par ',\r\n    untitled: 'Sans titre',\r\n    trackUntitled: 'Piste {number}',\r\n    currentlyPlaying: 'En cours de lecture',\r\n    notPlaying: 'Non en lecture',\r\n    pressEnterPlay: 'Appuyez sur Entrée pour lire',\r\n    pressEnterRestart: 'Appuyez sur Entrée pour recommencer',\r\n    keyboardInstructions: 'Navigation de la liste de lecture : Utilisez les touches fléchées haut et bas pour naviguer entre les pistes. Appuyez sur Page précédente ou Page suivante pour sauter 5 pistes. Appuyez sur Début pour aller à la première piste, Fin pour la dernière piste. Appuyez sur Entrée ou Espace pour lire la piste sélectionnée.',\r\n    endOfPlaylist: 'Fin de la liste de lecture. {current} sur {total}.',\r\n    beginningOfPlaylist: 'Début de la liste de lecture. 1 sur {total}.',\r\n    jumpedToLastTrack: 'Sauté à la dernière piste. {current} sur {total}.',\r\n    jumpedToFirstTrack: 'Sauté à la première piste. 1 sur {total}.',\r\n    firstTrack: 'Première piste. 1 sur {total}.',\r\n    lastTrack: 'Dernière piste. {current} sur {total}.'\r\n  }\r\n};\r\n\r\n", "/**\r\n * Japanese translations for VidPly\r\n */\r\n\r\nexport const ja = {\r\n  player: {\r\n    label: 'ビデオプレーヤー',\r\n    play: '再生',\r\n    pause: '一時停止',\r\n    stop: '停止',\r\n    restart: '最初から再生',\r\n    rewind: '巻き戻し',\r\n    forward: '早送り',\r\n    rewindSeconds: '{seconds}秒戻す',\r\n    forwardSeconds: '{seconds}秒進める',\r\n    previous: '前のトラック',\r\n    next: '次のトラック',\r\n    playlist: 'プレイリストの切り替え',\r\n    volume: '音量',\r\n    mute: 'ミュート',\r\n    unmute: 'ミュート解除',\r\n    fullscreen: '全画面表示',\r\n    exitFullscreen: '全画面表示を終了',\r\n    captions: '字幕',\r\n    chapters: 'チャプター',\r\n    quality: '画質',\r\n    captionStyling: '字幕スタイル',\r\n    transcript: '文字起こし切り替え',\r\n    audioDescription: '音声解説',\r\n    signLanguage: '手話動画',\r\n    settings: '設定',\r\n    speed: '再生速度',\r\n    pip: 'ピクチャーインピクチャー',\r\n    currentTime: '現在の時間',\r\n    duration: '再生時間',\r\n    progress: '進行状況',\r\n    seekForward: '{seconds}秒進める',\r\n    seekBackward: '{seconds}秒戻す',\r\n    volumeUp: '音量を上げる',\r\n    volumeDown: '音量を下げる',\r\n    loading: '読み込み中...',\r\n    loadingChapters: 'チャプター読み込み中...',\r\n    error: '読み込みエラー',\r\n    buffering: 'バッファリング中...',\r\n    signLanguageVideo: '手話動画',\r\n    closeSignLanguage: '手話動画を閉じる',\r\n    signLanguageSettings: '手話設定',\r\n    noChapters: 'チャプターがありません',\r\n    noCaptions: '字幕がありません',\r\n    auto: '自動',\r\n    autoQuality: '自動（画質選択不可）',\r\n    noQuality: '画質選択不可',\r\n    signLanguageDragResize: '手話動画 - キーボードでドラッグするにはDキーを、サイズ変更するにはRキーを押してください',\r\n    signLanguageDragActive: '手話動画 - ドラッグモードが有効です。矢印キーで移動、Escapeで終了します。',\r\n    signLanguageResizeActive: '手話動画 - サイズ変更モードが有効です。左右の矢印キーでサイズ変更、Escapeで終了します。',\r\n    enableSignDragMode: 'ドラッグモードを有効にする。ショートカット：Dキー',\r\n    disableSignDragMode: 'ドラッグモードを無効にする。ショートカット：Dキー',\r\n    enableSignDragModeAria: '矢印キーでキーボードドラッグモードを有効にする。ショートカット：Dキー',\r\n    disableSignDragModeAria: '矢印キーでキーボードドラッグモードを無効にする。ショートカット：Dキー',\r\n    enableSignResizeMode: 'サイズ変更モードを有効にする。ショートカット：Rキー',\r\n    disableSignResizeMode: 'サイズ変更モードを無効にする。ショートカット：Rキー',\r\n    enableSignResizeModeAria: '矢印キーでキーボードサイズ変更モードを有効にする。ショートカット：Rキー',\r\n    disableSignResizeModeAria: '矢印キーでキーボードサイズ変更モードを無効にする。ショートカット：Rキー',\r\n    resizeHandle: '{direction}コーナーのサイズ変更',\r\n    moreOptions: 'その他のオプション',\r\n    noMoreOptions: '追加のオプションはありません'\r\n  },\r\n  captions: {\r\n    off: 'オフ',\r\n    select: '字幕を選択',\r\n    fontSize: 'フォントサイズ',\r\n    fontFamily: 'フォント',\r\n    color: 'テキストの色',\r\n    backgroundColor: '背景色',\r\n    opacity: '不透明度'\r\n  },\r\n  fontSizes: {\r\n    small: '小',\r\n    normal: '標準',\r\n    large: '大',\r\n    xlarge: '特大'\r\n  },\r\n  fontFamilies: {\r\n    sansSerif: 'サンセリフ',\r\n    serif: 'セリフ',\r\n    monospace: '等幅'\r\n  },\r\n  styleLabels: {\r\n    textColor: 'テキストの色',\r\n    background: '背景',\r\n    font: 'フォント',\r\n    fontSize: 'フォントサイズ',\r\n    opacity: '不透明度'\r\n  },\r\n  audioDescription: {\r\n    enable: '音声解説を有効にする',\r\n    disable: '音声解説を無効にする'\r\n  },\r\n  signLanguage: {\r\n    show: '手話動画を表示',\r\n    hide: '手話動画を非表示',\r\n    showInMainView: 'メイン動画に手話を表示',\r\n    hideInMainView: 'メイン動画から手話を削除'\r\n  },\r\n  transcript: {\r\n    title: '文字起こし',\r\n    ariaLabel: 'ビデオ文字起こし',\r\n    close: '文字起こしを閉じる',\r\n    loading: '文字起こしを読み込み中...',\r\n    noTranscript: 'このビデオの文字起こしはありません。',\r\n    settings: '文字起こし設定。Enterキーでメニューを開く、またはDキーでドラッグモードを有効にする',\r\n    keyboardDragMode: '矢印キーでキーボードドラッグモードを切り替え。ショートカット：Dキー',\r\n    keyboardDragActive: '⌨️ キーボードドラッグモード有効（矢印キーで移動、Shift+矢印キーで大きく移動、DまたはESCで終了）',\r\n    dragResizePrompt: 'Dキーで移動、Rキーでサイズ変更。Homeで位置をリセット、Escで閉じます。',\r\n    dragModeEnabled: 'キーボードドラッグモードを有効にしました。矢印キーで移動、Shift+矢印キーで大きく移動できます。終了するには D または Esc を押します。',\r\n    dragModeDisabled: 'キーボードドラッグモードを無効にしました。',\r\n    enableDragMode: 'ドラッグモードを有効にする。ショートカット：Dキー',\r\n    disableDragMode: 'ドラッグモードを無効にする。ショートカット：Dキー',\r\n    enableDragModeAria: '矢印キーでキーボードドラッグモードを有効にする。ショートカット：Dキー',\r\n    disableDragModeAria: '矢印キーでキーボードドラッグモードを無効にする。ショートカット：Dキー',\r\n    resizeWindow: 'ウィンドウのサイズ変更',\r\n    disableResizeWindow: 'サイズ変更モードを無効にする',\r\n    enableResizeMode: 'サイズ変更モードを有効にする。ショートカット：Rキー',\r\n    disableResizeMode: 'サイズ変更モードを無効にする。ショートカット：Rキー',\r\n    enableResizeModeAria: '矢印キーでキーボードサイズ変更モードを有効にする。ショートカット：Rキー',\r\n    disableResizeModeAria: '矢印キーでキーボードサイズ変更モードを無効にする。ショートカット：Rキー',\r\n    resizeModeHint: 'リサイズハンドルが有効になりました。辺や角をドラッグして調整します。Esc または R で終了します。',\r\n    resizeModeEnabled: 'サイズ変更モードを有効にしました。辺や角をドラッグして調整します。Esc または R で終了します。',\r\n    resizeModeDisabled: 'サイズ変更モードを無効にしました。',\r\n    positionReset: '文字起こしの位置をリセットしました。',\r\n    styleTranscript: '文字起こしスタイル設定を開く',\r\n    closeMenu: 'メニューを閉じる',\r\n    styleTitle: '文字起こしスタイル',\r\n    autoscroll: '自動スクロール',\r\n    settingsMenu: '文字起こしダイアログ設定',\r\n    showTimestamps: 'タイムスタンプを表示',\r\n    hideTimestamps: 'タイムスタンプを非表示',\r\n    showTimestampsAria: '文字起こしにタイムスタンプを表示',\r\n    hideTimestampsAria: '文字起こしのタイムスタンプを非表示'\r\n  },\r\n  settings: {\r\n    title: '設定',\r\n    quality: '画質',\r\n    speed: '速度',\r\n    captions: '字幕',\r\n    language: '言語',\r\n    reset: 'リセット',\r\n    close: '閉じる'\r\n  },\r\n  speeds: {\r\n    normal: '通常'\r\n  },\r\n  time: {\r\n    display: '時間表示',\r\n    durationPrefix: '再生時間: ',\r\n    of: '/',\r\n    hour: '{count}時間',\r\n    hours: '{count}時間',\r\n    minute: '{count}分',\r\n    minutes: '{count}分',\r\n    second: '{count}秒',\r\n    seconds: '{count}秒'\r\n  },\r\n  playlist: {\r\n    title: 'プレイリスト',\r\n    trackOf: 'トラック {current}/{total}',\r\n    nowPlaying: '再生中: トラック {current}/{total}. {title}{artist}',\r\n    by: ' - ',\r\n    untitled: 'タイトルなし',\r\n    trackUntitled: 'トラック {number}',\r\n    currentlyPlaying: '再生中',\r\n    notPlaying: '停止中',\r\n    pressEnterPlay: 'Enterキーで再生',\r\n    pressEnterRestart: 'Enterキーで最初から再生',\r\n    keyboardInstructions: 'プレイリストナビゲーション：上下の矢印キーでトラック間を移動します。Page UpまたはPage Downで5トラックをスキップします。Homeで最初のトラックへ、Endで最後のトラックへ移動します。EnterまたはSpaceで選択したトラックを再生します。',\r\n    endOfPlaylist: 'プレイリストの終わりです。{current}/{total}。',\r\n    beginningOfPlaylist: 'プレイリストの始めです。1/{total}。',\r\n    jumpedToLastTrack: '最後のトラックにジャンプしました。{current}/{total}。',\r\n    jumpedToFirstTrack: '最初のトラックにジャンプしました。1/{total}。',\r\n    firstTrack: '最初のトラックです。1/{total}。',\r\n    lastTrack: '最後のトラックです。{current}/{total}。'\r\n  }\r\n};\r\n\r\n", "/**\r\n * Translation strings for VidPly\r\n * Lazily loads built-in language files to keep the base bundle small.\r\n */\r\n\r\nimport { en } from './languages/en.js';\r\n\r\nconst builtInLanguageLoaders = {\r\n  de: () => import('./languages/de.js'),\r\n  es: () => import('./languages/es.js'),\r\n  fr: () => import('./languages/fr.js'),\r\n  ja: () => import('./languages/ja.js')\r\n};\r\n\r\n/**\r\n * Returns the base translations that are always available in the bundle.\r\n * Currently this is English-only to minimize bundle size.\r\n */\r\nexport function getBaseTranslations() {\r\n  return { en };\r\n}\r\n\r\n/**\r\n * Expose built-in language loaders so they can be loaded on demand.\r\n */\r\nexport function getBuiltInLanguageLoaders() {\r\n  return builtInLanguageLoaders;\r\n}\r\n\r\n/**\r\n * Load a single built-in language asynchronously.\r\n * @param {string} lang Language code to load\r\n * @returns {Promise<Object|null>} Loaded translation object or null if unavailable\r\n */\r\nexport async function loadBuiltInTranslation(lang) {\r\n  const loader = builtInLanguageLoaders[lang];\r\n  if (!loader) return null;\r\n\r\n  const module = await loader();\r\n  return module[lang] || module.default || null;\r\n}\r\n\r\n/**\r\n * Legacy export for backwards compatibility (keeps API surface stable)\r\n * Note: Only English is included by default; other languages are loaded on demand.\r\n */\r\nexport const translations = getBaseTranslations();\r\n\r\n", "/**\r\n * Internationalization system\r\n */\r\n\r\nimport { getBaseTranslations, getBuiltInLanguageLoaders, loadBuiltInTranslation } from './translations.js';\r\n\r\nclass I18n {\r\n  constructor() {\r\n    this.currentLanguage = 'en';\r\n    this.translations = getBaseTranslations();\r\n    this.loadingPromises = new Map(); // Cache for loading promises\r\n    this.builtInLanguageLoaders = getBuiltInLanguageLoaders();\r\n  }\r\n\r\n  setLanguage(lang) {\r\n    if (this.translations[lang]) {\r\n      this.currentLanguage = lang;\r\n    } else {\r\n      console.warn(`Language \"${lang}\" not found, falling back to English`);\r\n      this.currentLanguage = 'en';\r\n    }\r\n  }\r\n\r\n  getLanguage() {\r\n    return this.currentLanguage;\r\n  }\r\n\r\n  /**\r\n   * Ensure a language is available, loading built-ins on demand.\r\n   * @param {string} lang Language code\r\n   * @returns {Promise<string|null>} Normalized language code if available\r\n   */\r\n  async ensureLanguage(lang) {\r\n    const normalizedLang = (lang || '').toLowerCase();\r\n    if (!normalizedLang) return this.currentLanguage;\r\n\r\n    if (this.translations[normalizedLang]) {\r\n      return normalizedLang;\r\n    }\r\n\r\n    if (this.loadingPromises.has(normalizedLang)) {\r\n      await this.loadingPromises.get(normalizedLang);\r\n      return this.translations[normalizedLang] ? normalizedLang : null;\r\n    }\r\n\r\n    if (!this.builtInLanguageLoaders[normalizedLang]) {\r\n      return null;\r\n    }\r\n\r\n    const loadPromise = (async () => {\r\n      try {\r\n        const loaded = await loadBuiltInTranslation(normalizedLang);\r\n        if (loaded) {\r\n          this.translations[normalizedLang] = loaded;\r\n        }\r\n      } catch (error) {\r\n        console.warn(`Language \"${normalizedLang}\" failed to load:`, error);\r\n      } finally {\r\n        this.loadingPromises.delete(normalizedLang);\r\n      }\r\n    })();\r\n\r\n    this.loadingPromises.set(normalizedLang, loadPromise);\r\n    await loadPromise;\r\n\r\n    return this.translations[normalizedLang] ? normalizedLang : null;\r\n  }\r\n\r\n  t(key, replacements = {}) {\r\n    const keys = key.split('.');\r\n    let value = this.translations[this.currentLanguage];\r\n    \r\n    for (const k of keys) {\r\n      if (value && typeof value === 'object' && k in value) {\r\n        value = value[k];\r\n      } else {\r\n        // Fallback to English\r\n        value = this.translations.en;\r\n        for (const fallbackKey of keys) {\r\n          if (value && typeof value === 'object' && fallbackKey in value) {\r\n            value = value[fallbackKey];\r\n          } else {\r\n            return key; // Return key if not found\r\n          }\r\n        }\r\n        break;\r\n      }\r\n    }\r\n    \r\n    // Replace placeholders\r\n    if (typeof value === 'string') {\r\n      Object.entries(replacements).forEach(([placeholder, replacement]) => {\r\n        value = value.replace(new RegExp(`{${placeholder}}`, 'g'), replacement);\r\n      });\r\n    }\r\n    \r\n    return value;\r\n  }\r\n\r\n  addTranslation(lang, translations) {\r\n    if (!this.translations[lang]) {\r\n      this.translations[lang] = {};\r\n    }\r\n    Object.assign(this.translations[lang], translations);\r\n  }\r\n\r\n  /**\r\n   * Load a language file from a URL (JSON or YAML)\r\n   * @param {string} langCode - Language code (e.g., 'pt', 'it')\r\n   * @param {string} url - URL to the language file (JSON or YAML)\r\n   * @returns {Promise<void>}\r\n   */\r\n  async loadLanguageFromUrl(langCode, url) {\r\n    // Return cached promise if already loading\r\n    if (this.loadingPromises.has(url)) {\r\n      return this.loadingPromises.get(url);\r\n    }\r\n\r\n    const loadPromise = (async () => {\r\n      try {\r\n        const response = await fetch(url);\r\n        if (!response.ok) {\r\n          throw new Error(`Failed to load language file: ${response.statusText}`);\r\n        }\r\n\r\n        const contentType = response.headers.get('content-type') || '';\r\n        let translations;\r\n\r\n        const buffer = await response.arrayBuffer();\r\n        const utf8Text = new TextDecoder('utf-8').decode(buffer);\r\n\r\n        if (contentType.includes('application/json') || url.endsWith('.json')) {\r\n          translations = JSON.parse(utf8Text);\r\n        } else if (contentType.includes('text/yaml') || contentType.includes('application/x-yaml') || url.endsWith('.yaml') || url.endsWith('.yml')) {\r\n          // For YAML, we'll need to parse it\r\n          // Note: This requires a YAML parser library in production\r\n          // For now, we'll try to parse as JSON first, then show a warning\r\n          try {\r\n            // Try JSON first (in case server sends JSON with YAML content-type)\r\n            translations = JSON.parse(utf8Text);\r\n          } catch (e) {\r\n            // If JSON parsing fails, try to use a YAML parser if available\r\n            if (typeof window !== 'undefined' && window.jsyaml) {\r\n              translations = window.jsyaml.load(utf8Text);\r\n            } else {\r\n              console.warn('YAML parsing requires js-yaml library. Please include it or use JSON format.');\r\n              throw new Error('YAML parsing not available. Please use JSON format or include js-yaml library.');\r\n            }\r\n          }\r\n        } else {\r\n          // Try to parse as JSON by default\r\n          translations = JSON.parse(utf8Text);\r\n        }\r\n\r\n        this.addTranslation(langCode, translations);\r\n        return translations;\r\n      } catch (error) {\r\n        console.error(`Error loading language file from ${url}:`, error);\r\n        throw error;\r\n      } finally {\r\n        // Remove from cache after loading completes\r\n        this.loadingPromises.delete(url);\r\n      }\r\n    })();\r\n\r\n    this.loadingPromises.set(url, loadPromise);\r\n    return loadPromise;\r\n  }\r\n\r\n  /**\r\n   * Load multiple language files from URLs\r\n   * @param {Object} languageMap - Object mapping language codes to URLs\r\n   * @returns {Promise<void>}\r\n   */\r\n  async loadLanguagesFromUrls(languageMap) {\r\n    const promises = Object.entries(languageMap).map(([langCode, url]) =>\r\n      this.loadLanguageFromUrl(langCode, url)\r\n    );\r\n    await Promise.all(promises);\r\n  }\r\n}\r\n\r\nexport const i18n = new I18n();\r\n\r\n", "/**\r\n * Time formatting and conversion utilities\r\n */\r\n\r\nimport {i18n} from '../i18n/i18n.js';\r\n\r\nexport const TimeUtils = {\r\n  /**\r\n   * Format seconds to time string (HH:MM:SS or MM:SS)\r\n   */\r\n  formatTime(seconds, alwaysShowHours = false) {\r\n    if (!isFinite(seconds) || seconds < 0) {\r\n      return alwaysShowHours ? '00:00:00' : '00:00';\r\n    }\r\n    \r\n    const hours = Math.floor(seconds / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    \r\n    const pad = (num) => String(num).padStart(2, '0');\r\n    \r\n    if (hours > 0 || alwaysShowHours) {\r\n      return `${pad(hours)}:${pad(minutes)}:${pad(secs)}`;\r\n    }\r\n    \r\n    return `${pad(minutes)}:${pad(secs)}`;\r\n  },\r\n\r\n  /**\r\n   * Parse time string to seconds\r\n   */\r\n  parseTime(timeString) {\r\n    const parts = timeString.split(':').map(p => parseInt(p, 10));\r\n    \r\n    if (parts.length === 3) {\r\n      // HH:MM:SS\r\n      return parts[0] * 3600 + parts[1] * 60 + parts[2];\r\n    } else if (parts.length === 2) {\r\n      // MM:SS\r\n      return parts[0] * 60 + parts[1];\r\n    } else if (parts.length === 1) {\r\n      // SS\r\n      return parts[0];\r\n    }\r\n    \r\n    return 0;\r\n  },\r\n\r\n  /**\r\n   * Format seconds to readable duration\r\n   */\r\n  formatDuration(seconds) {\r\n    if (!isFinite(seconds) || seconds < 0) {\r\n      return i18n.t('time.seconds', { count: 0 });\r\n    }\r\n    \r\n    const hours = Math.floor(seconds / 3600);\r\n    const minutes = Math.floor((seconds % 3600) / 60);\r\n    const secs = Math.floor(seconds % 60);\r\n    \r\n    const parts = [];\r\n    \r\n    if (hours > 0) {\r\n      const key = hours === 1 ? 'time.hour' : 'time.hours';\r\n      parts.push(i18n.t(key, { count: hours }));\r\n    }\r\n    if (minutes > 0) {\r\n      const key = minutes === 1 ? 'time.minute' : 'time.minutes';\r\n      parts.push(i18n.t(key, { count: minutes }));\r\n    }\r\n    if (secs > 0 || parts.length === 0) {\r\n      const key = secs === 1 ? 'time.second' : 'time.seconds';\r\n      parts.push(i18n.t(key, { count: secs }));\r\n    }\r\n    \r\n    return parts.join(', ');\r\n  },\r\n\r\n  /**\r\n   * Format percentage\r\n   */\r\n  formatPercentage(value, total) {\r\n    if (total === 0) return 0;\r\n    return Math.round((value / total) * 100);\r\n  }\r\n};\r\n\r\n", "/**\r\n * SVG Icon Library for VidPly\r\n * Optimized with common viewBox and fill attributes\r\n */\r\n\r\n// SVG paths only (viewBox and fill added by wrapper)\r\nconst iconPaths = {\r\n    play: `<path d=\"M8 5v14l11-7z\"/>`,\r\n\r\n    pause: `<path d=\"M6 4h4v16H6V4zm8 0h4v16h-4V4z\"/>`,\r\n\r\n    stop: `<rect x=\"6\" y=\"6\" width=\"12\" height=\"12\"/>`,\r\n\r\n    rewind: `<path d=\"M11 18V6l-8.5 6 8.5 6zm.5-6l8.5 6V6l-8.5 6z\"/>`,\r\n\r\n    forward: `<path d=\"M4 18l8.5-6L4 6v12zm9-12v12l8.5-6L13 6z\"/>`,\r\n\r\n    skipPrevious: `<path d=\"M6 6h2v12H6V6zm3 6l8.5 6V6L9 12z\"/>`,\r\n\r\n    skipNext: `<path d=\"M16 6h2v12h-2V6zM6 6l8.5 6L6 18V6z\"/>`,\r\n\r\n    restart: `<path d=\"M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z\"/>`,\r\n\r\n    volumeHigh: `<path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"/>`,\r\n\r\n    volumeMedium: `<path d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02z\"/>`,\r\n\r\n    volumeLow: `<path d=\"M7 9v6h4l5 5V4l-5 5H7z\"/>`,\r\n\r\n    volumeMuted: `<path d=\"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z\"/>`,\r\n\r\n    fullscreen: `<path d=\"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z\"/>`,\r\n\r\n    fullscreenExit: `<path d=\"M5 16h3v3h2v-5H5v2zm3-8H5v2h5V5H8v3zm6 11h2v-3h3v-2h-5v5zm2-11V5h-2v5h5V8h-3z\"/>`,\r\n\r\n    settings: `<path d=\"M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94L14.4 2.81c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z\"/>`,\r\n\r\n    captions: `<path d=\"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z\"/>`,\r\n\r\n    captionsOff: `<path d=\"M19 4H5c-1.11 0-2 .9-2 2v12c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-8 7H9.5v-.5h-2v3h2V13H11v1c0 .55-.45 1-1 1H7c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1zm7 0h-1.5v-.5h-2v3h2V13H18v1c0 .55-.45 1-1 1h-3c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v1z\"/><path d=\"M0 0h24v24H0z\" fill=\"none\"/>`,\r\n\r\n    pip: `<path d=\"M19 7h-8v6h8V7zm2-4H3c-1.1 0-2 .9-2 2v14c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98V5c0-1.1-.9-2-2-2zm0 16.01H3V4.98h18v14.03z\"/>`,\r\n\r\n    speed: `<path d=\"M20.38 8.57l-1.23 1.85a8 8 0 0 1-.22 7.58H5.07A8 8 0 0 1 15.58 6.85l1.85-1.23A10 10 0 0 0 3.35 19a2 2 0 0 0 1.72 1h13.85a2 2 0 0 0 1.74-1 10 10 0 0 0-.27-10.44z\"/><path d=\"M10.59 15.41a2 2 0 0 0 2.83 0l5.66-8.49-8.49 5.66a2 2 0 0 0 0 2.83z\"/>`,\r\n\r\n    close: `<path d=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"/>`,\r\n\r\n    check: `<path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z\"/>`,\r\n\r\n    loading: `<path d=\"M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z\"/>`,\r\n\r\n    error: `<path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z\"/>`,\r\n\r\n    playlist: `<path d=\"M15 6H3v2h12V6zm0 4H3v2h12v-2zM3 16h8v-2H3v2zM17 6v8.18c-.31-.11-.65-.18-1-.18-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3V8h3V6h-5z\"/>`,\r\n\r\n    hd: `<path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-8 12H9.5v-2h-2v2H6V9h1.5v2.5h2V9H11v6zm7-1c0 .55-.45 1-1 1h-.75v1.5h-1.5V15H14c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1h3c.55 0 1 .45 1 1v4zm-3.5-.5h2v-3h-2v3z\"/>`,\r\n\r\n    transcript: `<path d=\"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z\"/>`,\r\n\r\n    chapters: `<path d=\"M3 5h2v2H3V5zm0 4h2v2H3V9zm0 4h2v2H3v-2zm0 4h2v2H3v-2zM7 5h14v2H7V5zm0 4h14v2H7V9zm0 4h14v2H7v-2zm0 4h14v2H7v-2z\"/>`,\r\n\r\n    audioDescription: `<rect x=\"2\" y=\"5\" width=\"20\" height=\"14\" rx=\"2\" fill=\"#ffffff\" stroke=\"#ffffff\" stroke-width=\"2\"/><text x=\"12\" y=\"16\" font-family=\"Arial, sans-serif\" font-size=\"10\" font-weight=\"bold\" text-anchor=\"middle\" fill=\"#1a1a1a\">AD</text>`,\r\n    \r\n    audioDescriptionOn: `<rect x=\"2\" y=\"5\" width=\"20\" height=\"14\" rx=\"2\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"/><text x=\"12\" y=\"16\" font-family=\"Arial, sans-serif\" font-size=\"10\" font-weight=\"bold\" text-anchor=\"middle\" fill=\"currentColor\">AD</text>`,\r\n\r\n    signLanguage: `<g transform=\"scale(1.5)\"><path d=\"M16 11.3c-.1-.9-4.8 1.3-5.4 1.1-2.6-1 5.8-1.3 5.1-2.9s-5.1 1.5-6 1.4C6.5 9.4 16.5 9.1 13.5 8c-1.9-.6-8.8 2.9-6.8.4.7-.6.7-1.9-.7-1.7-9.7 7.2-.7 12.2 8.8 7 0-1.3-3.5.4-4.1.4-2.6 0 5.6-2 5.4-3ZM3.9 7.8c3.2-4.2 3.7 1.2 6 .1s.2-.2.2-.3c.7-2.7 2.5-7.5-1.5-1.3-1.6 0 1.1-4 1-4.6C8.9-1 7.3 4.4 7.2 4.9c-1.6.7-.9-1.4-.7-1.5 3-6-.6-3.1-.9.4-2.5 1.8 0-2.8 0-3.5C2.8-.9 4 9.4 1.1 4.9S.1 4.6 0 5c-.4 2.7 2.6 7.2 3.9 2.8Z\"/></g>`,\r\n\r\n    signLanguageOn: `<g transform=\"scale(1.5)\"><path d=\"M16 11.3c-.1-.9-4.8 1.3-5.4 1.1-2.6-1 5.8-1.3 5.1-2.9s-5.1 1.5-6 1.4C6.5 9.4 16.5 9.1 13.5 8c-1.9-.6-8.8 2.9-6.8.4.7-.6.7-1.9-.7-1.7-9.7 7.2-.7 12.2 8.8 7 0-1.3-3.5.4-4.1.4-2.6 0 5.6-2 5.4-3ZM3.9 7.8c3.2-4.2 3.7 1.2 6 .1s.2-.2.2-.3c.7-2.7 2.5-7.5-1.5-1.3-1.6 0 1.1-4 1-4.6C8.9-1 7.3 4.4 7.2 4.9c-1.6.7-.9-1.4-.7-1.5 3-6-.6-3.1-.9.4-2.5 1.8 0-2.8 0-3.5C2.8-.9 4 9.4 1.1 4.9S.1 4.6 0 5c-.4 2.7 2.6 7.2 3.9 2.8Z\"/></g>`,\r\n\r\n    signLanguagePip: `<g transform=\"scale(1.2) translate(1, 1)\"><path d=\"M16 11.3c-.1-.9-4.8 1.3-5.4 1.1-2.6-1 5.8-1.3 5.1-2.9s-5.1 1.5-6 1.4C6.5 9.4 16.5 9.1 13.5 8c-1.9-.6-8.8 2.9-6.8.4.7-.6.7-1.9-.7-1.7-9.7 7.2-.7 12.2 8.8 7 0-1.3-3.5.4-4.1.4-2.6 0 5.6-2 5.4-3ZM3.9 7.8c3.2-4.2 3.7 1.2 6 .1s.2-.2.2-.3c.7-2.7 2.5-7.5-1.5-1.3-1.6 0 1.1-4 1-4.6C8.9-1 7.3 4.4 7.2 4.9c-1.6.7-.9-1.4-.7-1.5 3-6-.6-3.1-.9.4-2.5 1.8 0-2.8 0-3.5C2.8-.9 4 9.4 1.1 4.9S.1 4.6 0 5c-.4 2.7 2.6 7.2 3.9 2.8Z\"/></g><polygon points=\"14,23 23,14 23,23\" fill=\"currentColor\"/>`,\r\n\r\n    signLanguagePipOn: `<g transform=\"scale(1.2) translate(1, 1)\"><path d=\"M16 11.3c-.1-.9-4.8 1.3-5.4 1.1-2.6-1 5.8-1.3 5.1-2.9s-5.1 1.5-6 1.4C6.5 9.4 16.5 9.1 13.5 8c-1.9-.6-8.8 2.9-6.8.4.7-.6.7-1.9-.7-1.7-9.7 7.2-.7 12.2 8.8 7 0-1.3-3.5.4-4.1.4-2.6 0 5.6-2 5.4-3ZM3.9 7.8c3.2-4.2 3.7 1.2 6 .1s.2-.2.2-.3c.7-2.7 2.5-7.5-1.5-1.3-1.6 0 1.1-4 1-4.6C8.9-1 7.3 4.4 7.2 4.9c-1.6.7-.9-1.4-.7-1.5 3-6-.6-3.1-.9.4-2.5 1.8 0-2.8 0-3.5C2.8-.9 4 9.4 1.1 4.9S.1 4.6 0 5c-.4 2.7 2.6 7.2 3.9 2.8Z\"/></g><polygon points=\"14,23 23,14 23,23\" fill=\"currentColor\"/>`,\r\n\r\n    music: `<path d=\"M12 3v9.28c-.47-.17-.97-.28-1.5-.28C8.01 12 6 14.01 6 16.5S8.01 21 10.5 21c2.31 0 4.2-1.75 4.45-4H15V6h4V3h-7zm-1.5 16c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z\"/>`,\r\n\r\n    moreVertical: `<path d=\"M12 8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm0 2c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 6c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z\"/>`,\r\n\r\n    move: `<path d=\"M10 9h4V6h3l-5-5-5 5h3v3zm-1 1H6V7l-5 5 5 5v-3h3v-4zm14 2l-5-5v3h-3v4h3v3l5-5zm-9 3h-4v3H7l5 5 5-5h-3v-3z\"/>`,\r\n\r\n    resize: `<path d=\"M21.71 11.29l-9-9c-.39-.39-1.02-.39-1.41 0l-9 9c-.39.39-.39 1.02 0 1.41l9 9c.39.39 1.02.39 1.41 0l9-9c.39-.38.39-1.01 0-1.41zM14 14.5V12h-4v2.5L7 11l3-3.5V10h4V7.5l3 3.5-3 3.5z\"/>`,\r\n\r\n    clock: `<path d=\"M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"/><path d=\"M12.5 7H11v6l5.25 3.15.75-1.23-4.5-2.67z\"/>`\r\n};\r\n\r\n// Optimized wrapper that adds common SVG attributes\r\nconst svgWrapper = (paths) => `<svg viewBox=\"0 0 24 24\" fill=\"currentColor\">${paths}</svg>`;\r\n\r\n// Export Icons object with SVG wrappers\r\nexport const Icons = Object.fromEntries(\r\n    Object.entries(iconPaths).map(([key, value]) => [key, svgWrapper(value)])\r\n);\r\n\r\nexport function getIcon(name) {\r\n    return Icons[name] || Icons.play;\r\n}\r\n\r\nexport function createIconElement(name, className = '') {\r\n    const wrapper = document.createElement('span');\r\n    wrapper.className = `vidply-icon ${className}`.trim();\r\n    wrapper.innerHTML = getIcon(name);\r\n    wrapper.setAttribute('aria-hidden', 'true');\r\n    return wrapper;\r\n}\r\n\r\n/**\r\n * Create the large centered play button overlay (complete SVG)\r\n * @returns {SVGElement} Complete SVG element with circle background and play icon\r\n */\r\nexport function createPlayOverlay() {\r\n    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n    svg.setAttribute('class', 'vidply-play-overlay');\r\n    svg.setAttribute('viewBox', '0 0 80 80');\r\n    svg.setAttribute('width', '80');\r\n    svg.setAttribute('height', '80');\r\n    svg.setAttribute('aria-hidden', 'true');\r\n    svg.setAttribute('role', 'presentation');\r\n    svg.style.cursor = 'pointer';\r\n\r\n    // Create filter for drop shadow\r\n    const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');\r\n    const filterId = `vidply-play-shadow-${Math.random().toString(36).substr(2, 9)}`;\r\n    const filter = document.createElementNS('http://www.w3.org/2000/svg', 'filter');\r\n    filter.setAttribute('id', filterId);\r\n    filter.setAttribute('x', '-50%');\r\n    filter.setAttribute('y', '-50%');\r\n    filter.setAttribute('width', '200%');\r\n    filter.setAttribute('height', '200%');\r\n\r\n    const feGaussianBlur = document.createElementNS('http://www.w3.org/2000/svg', 'feGaussianBlur');\r\n    feGaussianBlur.setAttribute('in', 'SourceAlpha');\r\n    feGaussianBlur.setAttribute('stdDeviation', '3');\r\n\r\n    const feOffset = document.createElementNS('http://www.w3.org/2000/svg', 'feOffset');\r\n    feOffset.setAttribute('dx', '0');\r\n    feOffset.setAttribute('dy', '2');\r\n    feOffset.setAttribute('result', 'offsetblur');\r\n\r\n    const feComponentTransfer = document.createElementNS('http://www.w3.org/2000/svg', 'feComponentTransfer');\r\n    const feFuncA = document.createElementNS('http://www.w3.org/2000/svg', 'feFuncA');\r\n    feFuncA.setAttribute('type', 'linear');\r\n    feFuncA.setAttribute('slope', '0.3');\r\n    feComponentTransfer.appendChild(feFuncA);\r\n\r\n    const feMerge = document.createElementNS('http://www.w3.org/2000/svg', 'feMerge');\r\n    const feMergeNode1 = document.createElementNS('http://www.w3.org/2000/svg', 'feMergeNode');\r\n    const feMergeNode2 = document.createElementNS('http://www.w3.org/2000/svg', 'feMergeNode');\r\n    feMergeNode2.setAttribute('in', 'SourceGraphic');\r\n    feMerge.appendChild(feMergeNode1);\r\n    feMerge.appendChild(feMergeNode2);\r\n\r\n    filter.appendChild(feGaussianBlur);\r\n    filter.appendChild(feOffset);\r\n    filter.appendChild(feComponentTransfer);\r\n    filter.appendChild(feMerge);\r\n    defs.appendChild(filter);\r\n    svg.appendChild(defs);\r\n\r\n    // White circle background\r\n    const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\r\n    circle.setAttribute('cx', '40');\r\n    circle.setAttribute('cy', '40');\r\n    circle.setAttribute('r', '40');\r\n    circle.setAttribute('fill', 'rgba(255, 255, 255, 0.95)');\r\n    circle.setAttribute('filter', `url(#${filterId})`);\r\n    circle.setAttribute('class', 'vidply-play-overlay-bg');\r\n    svg.appendChild(circle);\r\n\r\n    // Play icon triangle (centered with optical adjustment)\r\n    const playTriangle = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');\r\n    playTriangle.setAttribute('points', '32,28 32,52 54,40');\r\n    playTriangle.setAttribute('fill', '#0a406e');\r\n    playTriangle.setAttribute('class', 'vidply-play-overlay-icon');\r\n    svg.appendChild(playTriangle);\r\n\r\n    return svg;\r\n}\r\n\r\n", "/**\r\n * Focus management utilities\r\n */\r\n\r\n/**\r\n * Safely focus an element after DOM updates\r\n * @param {HTMLElement} element - Element to focus\r\n * @param {Object} options - Focus options\r\n * @param {number} options.delay - Delay in milliseconds (default: 0)\r\n * @param {boolean} options.preventScroll - Prevent scroll on focus (default: true)\r\n */\r\nexport function focusElement(element, { delay = 0, preventScroll = true } = {}) {\r\n    if (!element) return;\r\n    \r\n    requestAnimationFrame(() => {\r\n        setTimeout(() => {\r\n            if (element && document.contains(element)) {\r\n                element.focus({ preventScroll });\r\n            }\r\n        }, delay);\r\n    });\r\n}\r\n\r\n/**\r\n * Focus first element matching selector in container\r\n * @param {HTMLElement} container - Container to search in\r\n * @param {string} selector - CSS selector\r\n * @param {Object} options - Focus options\r\n */\r\nexport function focusFirstElement(container, selector, options = {}) {\r\n    if (!container) return;\r\n    const element = container.querySelector(selector);\r\n    if (element) {\r\n        focusElement(element, options);\r\n    }\r\n}\r\n\r\n", "/**\r\n * StorageManager - Handles persistent storage of user preferences\r\n */\r\n\r\nexport class StorageManager {\r\n  constructor(namespace = 'vidply') {\r\n    this.namespace = namespace;\r\n    this.storage = this.isStorageAvailable() ? localStorage : null;\r\n  }\r\n\r\n  /**\r\n   * Check if localStorage is available\r\n   */\r\n  isStorageAvailable() {\r\n    try {\r\n      const test = '__storage_test__';\r\n      localStorage.setItem(test, test);\r\n      localStorage.removeItem(test);\r\n      return true;\r\n    } catch (e) {\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a namespaced key\r\n   */\r\n  getKey(key) {\r\n    return `${this.namespace}_${key}`;\r\n  }\r\n\r\n  /**\r\n   * Save a value to storage\r\n   */\r\n  set(key, value) {\r\n    if (!this.storage) return false;\r\n    \r\n    try {\r\n      const namespacedKey = this.getKey(key);\r\n      this.storage.setItem(namespacedKey, JSON.stringify(value));\r\n      return true;\r\n    } catch (e) {\r\n      console.warn('Failed to save to localStorage:', e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get a value from storage\r\n   */\r\n  get(key, defaultValue = null) {\r\n    if (!this.storage) return defaultValue;\r\n    \r\n    try {\r\n      const namespacedKey = this.getKey(key);\r\n      const value = this.storage.getItem(namespacedKey);\r\n      return value ? JSON.parse(value) : defaultValue;\r\n    } catch (e) {\r\n      console.warn('Failed to read from localStorage:', e);\r\n      return defaultValue;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Remove a value from storage\r\n   */\r\n  remove(key) {\r\n    if (!this.storage) return false;\r\n    \r\n    try {\r\n      const namespacedKey = this.getKey(key);\r\n      this.storage.removeItem(namespacedKey);\r\n      return true;\r\n    } catch (e) {\r\n      console.warn('Failed to remove from localStorage:', e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Clear all namespaced values\r\n   */\r\n  clear() {\r\n    if (!this.storage) return false;\r\n    \r\n    try {\r\n      const keys = Object.keys(this.storage);\r\n      keys.forEach(key => {\r\n        if (key.startsWith(this.namespace)) {\r\n          this.storage.removeItem(key);\r\n        }\r\n      });\r\n      return true;\r\n    } catch (e) {\r\n      console.warn('Failed to clear localStorage:', e);\r\n      return false;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Save transcript preferences\r\n   */\r\n  saveTranscriptPreferences(preferences) {\r\n    return this.set('transcript_preferences', preferences);\r\n  }\r\n\r\n  /**\r\n   * Get transcript preferences\r\n   */\r\n  getTranscriptPreferences() {\r\n    return this.get('transcript_preferences', null);\r\n  }\r\n\r\n  /**\r\n   * Save caption preferences\r\n   */\r\n  saveCaptionPreferences(preferences) {\r\n    return this.set('caption_preferences', preferences);\r\n  }\r\n\r\n  /**\r\n   * Get caption preferences\r\n   */\r\n  getCaptionPreferences() {\r\n    return this.get('caption_preferences', null);\r\n  }\r\n\r\n  /**\r\n   * Save player preferences (volume, speed, etc.)\r\n   */\r\n  savePlayerPreferences(preferences) {\r\n    return this.set('player_preferences', preferences);\r\n  }\r\n\r\n  /**\r\n   * Get player preferences\r\n   */\r\n  getPlayerPreferences() {\r\n    return this.get('player_preferences', null);\r\n  }\r\n\r\n  /**\r\n   * Save sign language preferences (position and size)\r\n   */\r\n  saveSignLanguagePreferences(preferences) {\r\n    return this.set('sign_language_preferences', preferences);\r\n  }\r\n\r\n  /**\r\n   * Get sign language preferences\r\n   */\r\n  getSignLanguagePreferences() {\r\n    return this.get('sign_language_preferences', null);\r\n  }\r\n}\r\n\r\n", "/**\n * HTML5 Media Renderer\n */\n\nexport class HTML5Renderer {\n  constructor(player) {\n    this.player = player;\n    this.media = player.element;\n    this._didDeferredLoad = false;\n  }\n\n  async init() {\n    // Hide native controls\n    this.media.controls = false;\n    this.media.removeAttribute('controls');\n    \n    this.attachEvents();\n    \n    // Set preload + optionally defer network loading until user play\n    if (this.player.options.deferLoad) {\n      // Allow metadata preload while still avoiding an explicit load() call.\n      // Note: browsers may still fetch metadata automatically when preload=\"metadata\".\n      this.media.preload = this.player.options.preload || 'none';\n    } else {\n      this.media.preload = this.player.options.preload;\n      // Load media (eager)\n      this.media.load();\n    }\n    \n    // Show VidPly controls (remove external controls class if present)\n    if (this.player.container) {\n      this.player.container.classList.remove('vidply-external-controls');\n    }\n  }\n\n  attachEvents() {\n    // Playback events\n    this.media.addEventListener('loadedmetadata', () => {\n      this.player.state.duration = this.media.duration;\n      this.player.emit('loadedmetadata');\n      \n      // Auto-generate poster if none exists (for HTML5 video only)\n      if (this.media.tagName === 'VIDEO') {\n        this.player.autoGeneratePoster().catch(error => {\n          this.player.log('Failed to auto-generate poster:', error, 'warn');\n        });\n      }\n    });\n\n    this.media.addEventListener('play', () => {\n      this.player.state.playing = true;\n      this.player.state.paused = false;\n      this.player.state.ended = false;\n      this.player.emit('play');\n      \n      if (this.player.options.onPlay) {\n        this.player.options.onPlay.call(this.player);\n      }\n      \n      // Pause other players if enabled\n      if (this.player.options.pauseOthersOnPlay) {\n        this.pauseOtherPlayers();\n      }\n    });\n\n    this.media.addEventListener('pause', () => {\n      this.player.state.playing = false;\n      this.player.state.paused = true;\n      this.player.emit('pause');\n      \n      if (this.player.options.onPause) {\n        this.player.options.onPause.call(this.player);\n      }\n    });\n\n    this.media.addEventListener('ended', () => {\n      this.player.state.playing = false;\n      this.player.state.paused = true;\n      this.player.state.ended = true;\n      this.player.emit('ended');\n      \n      if (this.player.options.onEnded) {\n        this.player.options.onEnded.call(this.player);\n      }\n      \n      // Handle loop\n      if (this.player.options.loop) {\n        this.player.seek(0);\n        this.player.play();\n      }\n    });\n\n    this.media.addEventListener('timeupdate', () => {\n      this.player.state.currentTime = this.media.currentTime;\n      this.player.emit('timeupdate', this.media.currentTime);\n      \n      if (this.player.options.onTimeUpdate) {\n        this.player.options.onTimeUpdate.call(this.player, this.media.currentTime);\n      }\n    });\n\n    this.media.addEventListener('volumechange', () => {\n      this.player.state.volume = this.media.volume;\n      this.player.state.muted = this.media.muted;\n      this.player.emit('volumechange', this.media.volume);\n      \n      if (this.player.options.onVolumeChange) {\n        this.player.options.onVolumeChange.call(this.player, this.media.volume);\n      }\n    });\n\n    this.media.addEventListener('seeking', () => {\n      this.player.state.seeking = true;\n      this.player.emit('seeking');\n    });\n\n    this.media.addEventListener('seeked', () => {\n      this.player.state.seeking = false;\n      this.player.emit('seeked');\n    });\n\n    this.media.addEventListener('waiting', () => {\n      this.player.state.buffering = true;\n      this.player.emit('waiting');\n    });\n\n    this.media.addEventListener('canplay', () => {\n      this.player.state.buffering = false;\n      this.player.emit('canplay');\n    });\n\n    this.media.addEventListener('progress', () => {\n      if (this.media.buffered.length > 0) {\n        const buffered = this.media.buffered.end(this.media.buffered.length - 1);\n        this.player.emit('progress', buffered);\n      }\n    });\n\n    this.media.addEventListener('error', (e) => {\n      this.player.handleError(this.media.error);\n    });\n\n    this.media.addEventListener('ratechange', () => {\n      this.player.state.playbackSpeed = this.media.playbackRate;\n      this.player.emit('ratechange', this.media.playbackRate);\n    });\n  }\n\n  pauseOtherPlayers() {\n    // Pause other VidPly instances\n    const allPlayers = document.querySelectorAll('.vidply-player');\n    allPlayers.forEach(playerEl => {\n      if (playerEl !== this.player.container) {\n        const video = playerEl.querySelector('video, audio');\n        if (video && !video.paused) {\n          video.pause();\n        }\n      }\n    });\n  }\n\n  play() {\n    // Save scroll position to prevent browser from scrolling to video\n    const scrollX = window.scrollX;\n    const scrollY = window.scrollY;\n\n    // If deferLoad is enabled, trigger load only on the first user play request.\n    if (this.player.options.deferLoad && !this._didDeferredLoad) {\n      try {\n        // Only call load() if browser hasn't loaded anything yet.\n        if (this.media.readyState === 0) {\n          this.media.load();\n        }\n      } catch (e) {\n        // ignore\n      }\n      this._didDeferredLoad = true;\n    }\n    \n    const promise = this.media.play();\n    \n    // Restore scroll position immediately to prevent auto-scroll\n    window.scrollTo(scrollX, scrollY);\n    \n    if (promise !== undefined) {\n      promise.catch(error => {\n        this.player.log('Play failed:', error, 'warn');\n        \n        // If autoplay failed, try muted autoplay\n        if (this.player.options.autoplay && !this.player.state.muted) {\n          this.player.log('Retrying play with muted audio', 'info');\n          this.media.muted = true;\n          \n          // Save scroll position again for retry\n          const retryScrollX = window.scrollX;\n          const retryScrollY = window.scrollY;\n          this.media.play().then(() => {\n            window.scrollTo(retryScrollX, retryScrollY);\n          }).catch(err => {\n            this.player.handleError(err);\n          });\n        }\n      });\n      return promise;\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * Ensure the media element has been loaded at least once (metadata/initial state)\n   * without starting playback. Useful for playlists to behave like single videos.\n   */\n  ensureLoaded() {\n    if (!this.player.options.deferLoad || this._didDeferredLoad) {\n      return;\n    }\n\n    try {\n      if (this.media.readyState === 0) {\n        this.media.load();\n      }\n    } catch (e) {\n      // ignore\n    }\n    this._didDeferredLoad = true;\n  }\n\n  pause() {\n    this.media.pause();\n  }\n\n  seek(time) {\n    this.media.currentTime = time;\n  }\n\n  setVolume(volume) {\n    this.media.volume = volume;\n  }\n\n  setMuted(muted) {\n    this.media.muted = muted;\n  }\n\n  setPlaybackSpeed(speed) {\n    this.media.playbackRate = speed;\n  }\n\n  /**\n   * Get available quality levels from source elements\n   * @returns {Array} Array of quality objects with index, height, width, and src\n   */\n  getQualities() {\n    const sources = Array.from(this.media.querySelectorAll('source'));\n    \n    if (sources.length <= 1) {\n      return [];\n    }\n\n    return sources.map((source, index) => {\n      // Try to extract quality from data attributes or label\n      const label = source.getAttribute('data-quality') || source.getAttribute('label') || '';\n      const height = source.getAttribute('data-height') || this.extractHeightFromLabel(label);\n      const width = source.getAttribute('data-width') || '';\n      \n      return {\n        index,\n        height: height ? parseInt(height) : 0,\n        width: width ? parseInt(width) : 0,\n        src: source.src,\n        type: source.type,\n        name: label || (height ? `${height}p` : `Quality ${index + 1}`)\n      };\n    }).filter(q => q.height > 0); // Only return qualities with valid height\n  }\n\n  /**\n   * Extract height from quality label (e.g., \"1080p\" -> 1080)\n   * @param {string} label \n   * @returns {number}\n   */\n  extractHeightFromLabel(label) {\n    const match = label.match(/(\\d+)p/i);\n    return match ? parseInt(match[1]) : 0;\n  }\n\n  /**\n   * Switch to a specific quality level\n   * @param {number} qualityIndex - Index of the quality level (-1 for auto, not applicable for HTML5)\n   */\n  switchQuality(qualityIndex) {\n    const qualities = this.getQualities();\n    \n    if (qualityIndex < 0 || qualityIndex >= qualities.length) {\n      this.player.log('Invalid quality index', 'warn');\n      return;\n    }\n\n    const quality = qualities[qualityIndex];\n    const currentTime = this.media.currentTime;\n    const wasPlaying = !this.media.paused;\n\n    // Store the current source for comparison\n    const currentSrc = this.media.currentSrc;\n    \n    // Don't switch if already at this quality\n    if (currentSrc === quality.src) {\n      this.player.log('Already at this quality level', 'info');\n      return;\n    }\n\n    this.player.log(`Switching to quality: ${quality.name}`, 'info');\n\n    // Update the src\n    this.media.src = quality.src;\n    \n    // Wait for the new source to load, then restore playback state\n    const onLoadedMetadata = () => {\n      this.media.removeEventListener('loadedmetadata', onLoadedMetadata);\n      \n      // Restore playback position\n      this.media.currentTime = currentTime;\n      \n      // Resume playback if it was playing\n      if (wasPlaying) {\n        this.media.play().catch(err => {\n          this.player.log('Failed to resume playback after quality switch', 'warn');\n        });\n      }\n      \n      // Emit quality change event\n      this.player.emit('qualitychange', { quality: quality.name, index: qualityIndex });\n    };\n\n    this.media.addEventListener('loadedmetadata', onLoadedMetadata);\n    this.media.load();\n  }\n\n  /**\n   * Get current quality index\n   * @returns {number}\n   */\n  getCurrentQuality() {\n    const qualities = this.getQualities();\n    const currentSrc = this.media.currentSrc;\n    \n    for (let i = 0; i < qualities.length; i++) {\n      if (qualities[i].src === currentSrc) {\n        return i;\n      }\n    }\n    \n    return 0; // Default to first quality if not found\n  }\n\n  destroy() {\n    // Remove event listeners\n    this.media.removeEventListener('loadedmetadata', () => {});\n    this.media.removeEventListener('play', () => {});\n    this.media.removeEventListener('pause', () => {});\n    // ... (other listeners would be removed in a real implementation)\n  }\n}\n\n", "/**\r\n * DraggableResizable Utility\r\n * Provides shared drag and resize functionality for floating windows/elements\r\n */\r\n\r\nexport class DraggableResizable {\r\n  constructor(element, options = {}) {\r\n    this.element = element;\r\n    this.options = {\r\n      dragHandle: null, // Element to use as drag handle (defaults to element itself)\r\n      resizeHandles: [], // Array of resize handle elements\r\n      onDragStart: null,\r\n      onDrag: null,\r\n      onDragEnd: null,\r\n      onResizeStart: null,\r\n      onResize: null,\r\n      onResizeEnd: null,\r\n      constrainToViewport: true, // Allow movement outside viewport?\r\n      minWidth: 150,\r\n      minHeight: 100,\r\n      maintainAspectRatio: false,\r\n      keyboardDragKey: 'd',\r\n      keyboardResizeKey: 'r',\r\n      keyboardStep: 5,\r\n      keyboardStepLarge: 10,\r\n      maxWidth: null,\r\n      maxHeight: null,\r\n      pointerResizeIndicatorText: null,\r\n      onPointerResizeToggle: null,\r\n      classPrefix: 'draggable',\r\n      storage: null, // StorageManager instance for saving position/size\r\n      storageKey: null, // Key for localStorage (if storage is provided)\r\n      ...options\r\n    };\r\n\r\n    // State\r\n    this.isDragging = false;\r\n    this.isResizing = false;\r\n    this.resizeDirection = null;\r\n    this.dragOffsetX = 0;\r\n    this.dragOffsetY = 0;\r\n    this.positionOffsetX = 0;\r\n    this.positionOffsetY = 0;\r\n    this.initialMouseX = 0;\r\n    this.initialMouseY = 0;\r\n    this.needsPositionConversion = false;\r\n    this.resizeStartX = 0;\r\n    this.resizeStartY = 0;\r\n    this.resizeStartWidth = 0;\r\n    this.resizeStartHeight = 0;\r\n    this.resizeStartLeft = 0;\r\n    this.resizeStartTop = 0;\r\n    this.keyboardDragMode = false;\r\n    this.keyboardResizeMode = false;\r\n    this.pointerResizeMode = false;\r\n    this.manuallyPositioned = false; // Flag to track if user has manually moved/resized\r\n    this.resizeHandlesManaged = new Map();\r\n    this.resizeIndicatorElement = null;\r\n\r\n    // Event handlers\r\n    this.handlers = {\r\n      mousedown: this.onMouseDown.bind(this),\r\n      mousemove: this.onMouseMove.bind(this),\r\n      mouseup: this.onMouseUp.bind(this),\r\n      touchstart: this.onTouchStart.bind(this),\r\n      touchmove: this.onTouchMove.bind(this),\r\n      touchend: this.onTouchEnd.bind(this),\r\n      pointerdown: this.onPointerDown.bind(this),\r\n      pointermove: this.onPointerMove.bind(this),\r\n      pointerup: this.onPointerUp.bind(this),\r\n      pointercancel: this.onPointerUp.bind(this),\r\n      keydown: this.onKeyDown.bind(this),\r\n      resizeHandleMousedown: this.onResizeHandleMouseDown.bind(this),\r\n      resizeHandlePointerDown: this.onResizeHandlePointerDown.bind(this)\r\n    };\r\n\r\n    // Pointer tracking (Pointer Events unify mouse + touch)\r\n    this.activePointerId = null;\r\n    this.activePointerType = null;\r\n\r\n    this.init();\r\n  }\r\n\r\n  hasManagedResizeHandles() {\r\n    return Array.from(this.resizeHandlesManaged.values()).some(Boolean);\r\n  }\r\n\r\n  storeOriginalHandleDisplay(handle) {\r\n    if (!handle.dataset.originalDisplay) {\r\n      handle.dataset.originalDisplay = handle.style.display || '';\r\n    }\r\n  }\r\n\r\n  hideResizeHandle(handle) {\r\n    handle.style.display = 'none';\r\n    handle.setAttribute('aria-hidden', 'true');\r\n  }\r\n\r\n  showResizeHandle(handle) {\r\n    const original = handle.dataset.originalDisplay !== undefined ? handle.dataset.originalDisplay : '';\r\n    handle.style.display = original;\r\n    handle.removeAttribute('aria-hidden');\r\n  }\r\n\r\n  setManagedHandlesVisible(visible) {\r\n    if (!this.options.resizeHandles || this.options.resizeHandles.length === 0) {\r\n      return;\r\n    }\r\n\r\n    this.options.resizeHandles.forEach(handle => {\r\n      if (!this.resizeHandlesManaged.get(handle)) {\r\n        return;\r\n      }\r\n\r\n      if (visible) {\r\n        this.showResizeHandle(handle);\r\n      } else {\r\n        this.hideResizeHandle(handle);\r\n      }\r\n    });\r\n  }\r\n\r\n  init() {\r\n    const dragHandle = this.options.dragHandle || this.element;\r\n    \r\n    // Prefer Pointer Events when available (covers mouse + touch in one codepath)\r\n    if (typeof window !== 'undefined' && 'PointerEvent' in window) {\r\n      dragHandle.addEventListener('pointerdown', this.handlers.pointerdown);\r\n\r\n      // Document-level move/up events\r\n      document.addEventListener('pointermove', this.handlers.pointermove, { passive: false });\r\n      document.addEventListener('pointerup', this.handlers.pointerup);\r\n      document.addEventListener('pointercancel', this.handlers.pointercancel);\r\n    } else {\r\n      // Fallback for very old browsers\r\n      dragHandle.addEventListener('mousedown', this.handlers.mousedown);\r\n      dragHandle.addEventListener('touchstart', this.handlers.touchstart, { passive: false });\r\n\r\n      // Document-level move/up events\r\n      document.addEventListener('mousemove', this.handlers.mousemove);\r\n      document.addEventListener('mouseup', this.handlers.mouseup);\r\n      document.addEventListener('touchmove', this.handlers.touchmove, { passive: false });\r\n      document.addEventListener('touchend', this.handlers.touchend);\r\n    }\r\n    \r\n    // Keyboard events\r\n    this.element.addEventListener('keydown', this.handlers.keydown);\r\n    \r\n    // Resize handles\r\n    if (this.options.resizeHandles && this.options.resizeHandles.length > 0) {\r\n      this.options.resizeHandles.forEach(handle => {\r\n        if (typeof window !== 'undefined' && 'PointerEvent' in window) {\r\n          handle.addEventListener('pointerdown', this.handlers.resizeHandlePointerDown);\r\n        } else {\r\n          handle.addEventListener('mousedown', this.handlers.resizeHandleMousedown);\r\n          handle.addEventListener('touchstart', this.handlers.resizeHandleMousedown, { passive: false });\r\n        }\r\n\r\n        const managed = handle.dataset.vidplyManagedResize === 'true';\r\n        this.resizeHandlesManaged.set(handle, managed);\r\n        if (managed) {\r\n          this.storeOriginalHandleDisplay(handle);\r\n          this.hideResizeHandle(handle);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  onPointerDown(e) {\r\n    // Only handle primary pointer (avoid multi-touch weirdness)\r\n    if (e.isPrimary === false) return;\r\n\r\n    // Only left click for mouse\r\n    if (e.pointerType === 'mouse' && e.button !== 0) return;\r\n\r\n    // Don't drag if clicking on resize handle\r\n    if (e.target.classList.contains(`${this.options.classPrefix}-resize-handle`)) {\r\n      return;\r\n    }\r\n\r\n    // Call custom handler if provided\r\n    if (this.options.onDragStart && !this.options.onDragStart(e)) {\r\n      return;\r\n    }\r\n\r\n    this.activePointerId = e.pointerId;\r\n    this.activePointerType = e.pointerType;\r\n\r\n    // Capture pointer so drag continues even if leaving handle\r\n    try {\r\n      e.currentTarget?.setPointerCapture?.(e.pointerId);\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.startDragging(e.clientX, e.clientY);\r\n    e.preventDefault();\r\n  }\r\n\r\n  onPointerMove(e) {\r\n    if (this.activePointerId !== null && e.pointerId !== this.activePointerId) return;\r\n\r\n    if (this.isDragging) {\r\n      this.drag(e.clientX, e.clientY);\r\n      e.preventDefault();\r\n    } else if (this.isResizing) {\r\n      this.resize(e.clientX, e.clientY);\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  onPointerUp(e) {\r\n    if (this.activePointerId !== null && e.pointerId !== this.activePointerId) return;\r\n\r\n    if (this.isDragging) {\r\n      this.stopDragging();\r\n    } else if (this.isResizing) {\r\n      this.stopResizing();\r\n    }\r\n\r\n    this.activePointerId = null;\r\n    this.activePointerType = null;\r\n  }\r\n\r\n  onMouseDown(e) {\r\n    // Don't drag if clicking on resize handle\r\n    if (e.target.classList.contains(`${this.options.classPrefix}-resize-handle`)) {\r\n      return;\r\n    }\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDragStart && !this.options.onDragStart(e)) {\r\n      return;\r\n    }\r\n\r\n    this.startDragging(e.clientX, e.clientY);\r\n    e.preventDefault();\r\n  }\r\n\r\n  onTouchStart(e) {\r\n    // Don't drag if touching resize handle\r\n    if (e.target.classList.contains(`${this.options.classPrefix}-resize-handle`)) {\r\n      return;\r\n    }\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDragStart && !this.options.onDragStart(e)) {\r\n      return;\r\n    }\r\n\r\n    const touch = e.touches[0];\r\n    this.startDragging(touch.clientX, touch.clientY);\r\n    // Prevent page scroll while dragging (requires passive:false listener)\r\n    e.preventDefault();\r\n  }\r\n\r\n  onResizeHandlePointerDown(e) {\r\n    // Only handle primary pointer\r\n    if (e.isPrimary === false) return;\r\n\r\n    // Only left click for mouse\r\n    if (e.pointerType === 'mouse' && e.button !== 0) return;\r\n\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n\r\n    const handle = e.target;\r\n    this.resizeDirection = handle.getAttribute('data-direction');\r\n\r\n    this.activePointerId = e.pointerId;\r\n    this.activePointerType = e.pointerType;\r\n\r\n    try {\r\n      e.currentTarget?.setPointerCapture?.(e.pointerId);\r\n    } catch {\r\n      // ignore\r\n    }\r\n\r\n    this.startResizing(e.clientX, e.clientY);\r\n  }\r\n\r\n  onResizeHandleMouseDown(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    \r\n    const handle = e.target;\r\n    this.resizeDirection = handle.getAttribute('data-direction');\r\n    \r\n    const clientX = e.clientX || e.touches?.[0]?.clientX;\r\n    const clientY = e.clientY || e.touches?.[0]?.clientY;\r\n    \r\n    this.startResizing(clientX, clientY);\r\n  }\r\n\r\n  onMouseMove(e) {\r\n    if (this.isDragging) {\r\n      this.drag(e.clientX, e.clientY);\r\n      e.preventDefault();\r\n    } else if (this.isResizing) {\r\n      this.resize(e.clientX, e.clientY);\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  onTouchMove(e) {\r\n    if (this.isDragging || this.isResizing) {\r\n      const touch = e.touches[0];\r\n      if (this.isDragging) {\r\n        this.drag(touch.clientX, touch.clientY);\r\n      } else {\r\n        this.resize(touch.clientX, touch.clientY);\r\n      }\r\n      e.preventDefault();\r\n    }\r\n  }\r\n\r\n  onMouseUp() {\r\n    if (this.isDragging) {\r\n      this.stopDragging();\r\n    } else if (this.isResizing) {\r\n      this.stopResizing();\r\n    }\r\n  }\r\n\r\n  onTouchEnd() {\r\n    if (this.isDragging) {\r\n      this.stopDragging();\r\n    } else if (this.isResizing) {\r\n      this.stopResizing();\r\n    }\r\n  }\r\n\r\n  onKeyDown(e) {\r\n    // Toggle drag mode\r\n    if (e.key.toLowerCase() === this.options.keyboardDragKey.toLowerCase()) {\r\n      e.preventDefault();\r\n      this.toggleKeyboardDragMode();\r\n      return;\r\n    }\r\n\r\n    // Toggle resize mode\r\n    if (e.key.toLowerCase() === this.options.keyboardResizeKey.toLowerCase()) {\r\n      e.preventDefault();\r\n      if (this.hasManagedResizeHandles()) {\r\n        this.togglePointerResizeMode();\r\n      } else {\r\n        this.toggleKeyboardResizeMode();\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Exit modes with Escape\r\n    if (e.key === 'Escape') {\r\n      if (this.pointerResizeMode) {\r\n        e.preventDefault();\r\n        this.disablePointerResizeMode();\r\n        return;\r\n      }\r\n      if (this.keyboardDragMode || this.keyboardResizeMode) {\r\n        e.preventDefault();\r\n        this.disableKeyboardDragMode();\r\n        this.disableKeyboardResizeMode();\r\n        return;\r\n      }\r\n    }\r\n\r\n    // Arrow keys for drag/resize\r\n    if (['ArrowLeft', 'ArrowRight', 'ArrowUp', 'ArrowDown'].includes(e.key)) {\r\n      if (this.keyboardDragMode) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.keyboardDrag(e.key, e.shiftKey);\r\n      } else if (this.keyboardResizeMode) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        this.keyboardResize(e.key, e.shiftKey);\r\n      }\r\n    }\r\n\r\n    // Home key to reset position\r\n    if (e.key === 'Home' && (this.keyboardDragMode || this.keyboardResizeMode)) {\r\n      e.preventDefault();\r\n      this.resetPosition();\r\n    }\r\n  }\r\n\r\n  startDragging(clientX, clientY) {\r\n    // Get current rendered position BEFORE any changes\r\n    const rect = this.element.getBoundingClientRect();\r\n    \r\n    // Convert position to left/top IMMEDIATELY (before setting any state)\r\n    // Check if element is using right/bottom/transform positioning\r\n    const computedStyle = window.getComputedStyle(this.element);\r\n    const needsConversion = computedStyle.right !== 'auto' || \r\n                           computedStyle.bottom !== 'auto' || \r\n                           computedStyle.transform !== 'none';\r\n    \r\n    this.positionOffsetX = 0;\r\n    this.positionOffsetY = 0;\r\n\r\n    if (needsConversion) {\r\n      // Determine the correct left/top values based on position type\r\n      let targetLeft, targetTop;\r\n      \r\n      if (computedStyle.position === 'absolute') {\r\n        // position: absolute uses container-relative coordinates\r\n        const offsetParent = this.element.offsetParent || document.body;\r\n        const parentRect = offsetParent.getBoundingClientRect();\r\n        targetLeft = rect.left - parentRect.left;\r\n        targetTop = rect.top - parentRect.top;\r\n        this.positionOffsetX = parentRect.left;\r\n        this.positionOffsetY = parentRect.top;\r\n      } else if (computedStyle.position === 'fixed') {\r\n        const parsedLeft = parseFloat(computedStyle.left);\r\n        const parsedTop = parseFloat(computedStyle.top);\r\n        const hasLeft = Number.isFinite(parsedLeft);\r\n        const hasTop = Number.isFinite(parsedTop);\r\n        targetLeft = hasLeft ? parsedLeft : rect.left;\r\n        targetTop = hasTop ? parsedTop : rect.top;\r\n        this.positionOffsetX = rect.left - targetLeft;\r\n        this.positionOffsetY = rect.top - targetTop;\r\n      } else {\r\n        // fallback: treat as viewport-relative\r\n        targetLeft = rect.left;\r\n        targetTop = rect.top;\r\n        this.positionOffsetX = rect.left - targetLeft;\r\n        this.positionOffsetY = rect.top - targetTop;\r\n      }\r\n      \r\n      // Build complete style update atomically\r\n      const currentCssText = this.element.style.cssText;\r\n      let newCssText = currentCssText\r\n        .split(';')\r\n        .filter(rule => {\r\n          const trimmed = rule.trim();\r\n          // Filter out empty rules\r\n          if (!trimmed) return false;\r\n          \r\n          const colonIndex = trimmed.indexOf(':');\r\n          if (colonIndex === -1) return false;\r\n          \r\n          const property = trimmed.substring(0, colonIndex).trim();\r\n          const value = trimmed.substring(colonIndex + 1).trim();\r\n          \r\n          // Skip if value is empty or just whitespace (this catches empty border properties)\r\n          if (!value || value === '') return false;\r\n          \r\n          // Skip positioning properties\r\n          if (property === 'right' || property === 'bottom' || property === 'transform' ||\r\n              property === 'left' || property === 'top' || property === 'inset') {\r\n            return false;\r\n          }\r\n          \r\n          // Skip border-image properties (these can have empty values that cause parse errors)\r\n          if (property.startsWith('border-image')) {\r\n            return false;\r\n          }\r\n          \r\n          return true;\r\n        })\r\n        .join('; ');\r\n      \r\n      if (newCssText) newCssText += '; ';\r\n      newCssText += `left: ${targetLeft}px; top: ${targetTop}px; right: auto; bottom: auto; transform: none`;\r\n      \r\n      // Apply all at once\r\n      this.element.style.cssText = newCssText;\r\n    }\r\n    \r\n    // Now calculate offsets based on CURRENT position (after conversion)\r\n    // Re-get rect after potential position change\r\n    const finalRect = this.element.getBoundingClientRect();\r\n    this.dragOffsetX = clientX - finalRect.left;\r\n    this.dragOffsetY = clientY - finalRect.top;\r\n    \r\n    this.isDragging = true;\r\n    this.element.classList.add(`${this.options.classPrefix}-dragging`);\r\n    document.body.style.cursor = 'grabbing';\r\n    document.body.style.userSelect = 'none';\r\n  }\r\n\r\n  drag(clientX, clientY) {\r\n    if (!this.isDragging) return;\r\n\r\n    // Calculate new position: current mouse position minus the offset where user clicked\r\n    let newX = clientX - this.dragOffsetX - this.positionOffsetX;\r\n    let newY = clientY - this.dragOffsetY - this.positionOffsetY;\r\n    \r\n    // Constrain to viewport if needed\r\n    if (this.options.constrainToViewport) {\r\n      const rect = this.element.getBoundingClientRect();\r\n      const viewportWidth = document.documentElement.clientWidth;\r\n      const viewportHeight = document.documentElement.clientHeight;\r\n      \r\n      // Keep at least 100px visible\r\n      const minVisible = 100;\r\n      const minX = -(rect.width - minVisible);\r\n      const minY = -(rect.height - minVisible);\r\n      const maxX = viewportWidth - minVisible;\r\n      const maxY = viewportHeight - minVisible;\r\n      \r\n      newX = Math.max(minX, Math.min(newX, maxX));\r\n      newY = Math.max(minY, Math.min(newY, maxY));\r\n    }\r\n    \r\n    this.element.style.left = `${newX}px`;\r\n    this.element.style.top = `${newY}px`;\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDrag) {\r\n      this.options.onDrag({ x: newX, y: newY });\r\n    }\r\n  }\r\n\r\n  stopDragging() {\r\n    this.isDragging = false;\r\n    this.element.classList.remove(`${this.options.classPrefix}-dragging`);\r\n    document.body.style.cursor = '';\r\n    document.body.style.userSelect = '';\r\n    \r\n    // Mark as manually positioned\r\n    this.manuallyPositioned = true;\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDragEnd) {\r\n      this.options.onDragEnd();\r\n    }\r\n  }\r\n\r\n  startResizing(clientX, clientY) {\r\n    this.isResizing = true;\r\n    this.resizeStartX = clientX;\r\n    this.resizeStartY = clientY;\r\n    \r\n    const rect = this.element.getBoundingClientRect();\r\n    this.resizeStartWidth = rect.width;\r\n    this.resizeStartHeight = rect.height;\r\n    this.resizeStartLeft = rect.left;\r\n    this.resizeStartTop = rect.top;\r\n    \r\n    this.element.classList.add(`${this.options.classPrefix}-resizing`);\r\n    document.body.style.userSelect = 'none';\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onResizeStart) {\r\n      this.options.onResizeStart();\r\n    }\r\n  }\r\n\r\n  resize(clientX, clientY) {\r\n    if (!this.isResizing) return;\r\n\r\n    const deltaX = clientX - this.resizeStartX;\r\n    const deltaY = clientY - this.resizeStartY;\r\n    \r\n    let newWidth = this.resizeStartWidth;\r\n    let newHeight = this.resizeStartHeight;\r\n    let newLeft = this.resizeStartLeft;\r\n    let newTop = this.resizeStartTop;\r\n\r\n    // Handle horizontal resizing\r\n    if (this.resizeDirection.includes('e')) {\r\n      newWidth = Math.max(this.options.minWidth, this.resizeStartWidth + deltaX);\r\n    }\r\n    if (this.resizeDirection.includes('w')) {\r\n      const proposedWidth = Math.max(this.options.minWidth, this.resizeStartWidth - deltaX);\r\n      newLeft = this.resizeStartLeft + (this.resizeStartWidth - proposedWidth);\r\n      newWidth = proposedWidth;\r\n    }\r\n\r\n    const maxWidthOption = typeof this.options.maxWidth === 'function'\r\n      ? this.options.maxWidth()\r\n      : this.options.maxWidth;\r\n    if (Number.isFinite(maxWidthOption)) {\r\n      const clampedWidth = Math.min(newWidth, maxWidthOption);\r\n      if (clampedWidth !== newWidth && this.resizeDirection.includes('w')) {\r\n        newLeft += newWidth - clampedWidth;\r\n      }\r\n      newWidth = clampedWidth;\r\n    }\r\n\r\n    // Handle vertical resizing (if not maintaining aspect ratio)\r\n    if (!this.options.maintainAspectRatio) {\r\n      if (this.resizeDirection.includes('s')) {\r\n        newHeight = Math.max(this.options.minHeight, this.resizeStartHeight + deltaY);\r\n      }\r\n      if (this.resizeDirection.includes('n')) {\r\n        const proposedHeight = Math.max(this.options.minHeight, this.resizeStartHeight - deltaY);\r\n        newTop = this.resizeStartTop + (this.resizeStartHeight - proposedHeight);\r\n        newHeight = proposedHeight;\r\n      }\r\n\r\n      const maxHeightOption = typeof this.options.maxHeight === 'function'\r\n        ? this.options.maxHeight()\r\n        : this.options.maxHeight;\r\n      if (Number.isFinite(maxHeightOption)) {\r\n        const clampedHeight = Math.min(newHeight, maxHeightOption);\r\n        if (clampedHeight !== newHeight && this.resizeDirection.includes('n')) {\r\n          newTop += newHeight - clampedHeight;\r\n        }\r\n        newHeight = clampedHeight;\r\n      }\r\n    }\r\n\r\n    // Apply new dimensions\r\n    this.element.style.width = `${newWidth}px`;\r\n    if (!this.options.maintainAspectRatio) {\r\n      this.element.style.height = `${newHeight}px`;\r\n    } else {\r\n      this.element.style.height = 'auto';\r\n    }\r\n    \r\n    // Apply new position if resizing from west or north\r\n    if (this.resizeDirection.includes('w')) {\r\n      this.element.style.left = `${newLeft}px`;\r\n    }\r\n    if (this.resizeDirection.includes('n') && !this.options.maintainAspectRatio) {\r\n      this.element.style.top = `${newTop}px`;\r\n    }\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onResize) {\r\n      this.options.onResize({ width: newWidth, height: newHeight, left: newLeft, top: newTop });\r\n    }\r\n  }\r\n\r\n  stopResizing() {\r\n    this.isResizing = false;\r\n    this.resizeDirection = null;\r\n    this.element.classList.remove(`${this.options.classPrefix}-resizing`);\r\n    document.body.style.userSelect = '';\r\n    \r\n    // Mark as manually positioned\r\n    this.manuallyPositioned = true;\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onResizeEnd) {\r\n      this.options.onResizeEnd();\r\n    }\r\n  }\r\n\r\n  toggleKeyboardDragMode() {\r\n    if (this.keyboardDragMode) {\r\n      this.disableKeyboardDragMode();\r\n    } else {\r\n      this.enableKeyboardDragMode();\r\n    }\r\n  }\r\n\r\n  enableKeyboardDragMode() {\r\n    this.keyboardDragMode = true;\r\n    this.keyboardResizeMode = false;\r\n    this.element.classList.add(`${this.options.classPrefix}-keyboard-drag`);\r\n    this.element.classList.remove(`${this.options.classPrefix}-keyboard-resize`);\r\n    this.focusElement();\r\n  }\r\n\r\n  disableKeyboardDragMode() {\r\n    this.keyboardDragMode = false;\r\n    this.element.classList.remove(`${this.options.classPrefix}-keyboard-drag`);\r\n  }\r\n\r\n  toggleKeyboardResizeMode() {\r\n    if (this.keyboardResizeMode) {\r\n      this.disableKeyboardResizeMode();\r\n    } else {\r\n      this.enableKeyboardResizeMode();\r\n    }\r\n  }\r\n\r\n  enableKeyboardResizeMode() {\r\n    this.keyboardResizeMode = true;\r\n    this.keyboardDragMode = false;\r\n    this.element.classList.add(`${this.options.classPrefix}-keyboard-resize`);\r\n    this.element.classList.remove(`${this.options.classPrefix}-keyboard-drag`);\r\n    this.focusElement();\r\n  }\r\n\r\n  disableKeyboardResizeMode() {\r\n    this.keyboardResizeMode = false;\r\n    this.element.classList.remove(`${this.options.classPrefix}-keyboard-resize`);\r\n  }\r\n\r\n  enablePointerResizeMode({ focus = true } = {}) {\r\n    if (!this.hasManagedResizeHandles()) {\r\n      this.enableKeyboardResizeMode();\r\n      return;\r\n    }\r\n\r\n    if (this.pointerResizeMode) {\r\n      return;\r\n    }\r\n\r\n    this.pointerResizeMode = true;\r\n    this.setManagedHandlesVisible(true);\r\n    this.element.classList.add(`${this.options.classPrefix}-resizable`);\r\n    this.enableKeyboardResizeMode();\r\n\r\n    if (focus) {\r\n      this.focusElement();\r\n    }\r\n\r\n    if (typeof this.options.onPointerResizeToggle === 'function') {\r\n      this.options.onPointerResizeToggle(true);\r\n    }\r\n  }\r\n\r\n  disablePointerResizeMode({ focus = false } = {}) {\r\n    if (!this.pointerResizeMode) {\r\n      return;\r\n    }\r\n\r\n    this.pointerResizeMode = false;\r\n    this.setManagedHandlesVisible(false);\r\n    this.element.classList.remove(`${this.options.classPrefix}-resizable`);\r\n    this.disableKeyboardResizeMode();\r\n\r\n    if (focus) {\r\n      this.focusElement();\r\n    }\r\n\r\n    if (typeof this.options.onPointerResizeToggle === 'function') {\r\n      this.options.onPointerResizeToggle(false);\r\n    }\r\n  }\r\n\r\n  togglePointerResizeMode() {\r\n    if (this.pointerResizeMode) {\r\n      this.disablePointerResizeMode();\r\n    } else {\r\n      this.enablePointerResizeMode();\r\n    }\r\n    return this.pointerResizeMode;\r\n  }\r\n\r\n  focusElement() {\r\n    if (typeof this.element.focus === 'function') {\r\n      try {\r\n        this.element.focus({ preventScroll: true });\r\n      } catch (e) {\r\n        // Some browsers do not support the preventScroll option; fallback without it\r\n        this.element.focus();\r\n      }\r\n    }\r\n  }\r\n\r\n  keyboardDrag(key, shiftKey) {\r\n    const step = shiftKey ? this.options.keyboardStepLarge : this.options.keyboardStep;\r\n    \r\n    // Get current position\r\n    let currentLeft = parseFloat(this.element.style.left) || 0;\r\n    let currentTop = parseFloat(this.element.style.top) || 0;\r\n    \r\n    // If element is still centered with transform, convert to absolute position first\r\n    const computedStyle = window.getComputedStyle(this.element);\r\n    if (computedStyle.transform !== 'none') {\r\n      const rect = this.element.getBoundingClientRect();\r\n      currentLeft = rect.left;\r\n      currentTop = rect.top;\r\n      this.element.style.transform = 'none';\r\n      this.element.style.left = `${currentLeft}px`;\r\n      this.element.style.top = `${currentTop}px`;\r\n    }\r\n    \r\n    // Calculate new position\r\n    let newX = currentLeft;\r\n    let newY = currentTop;\r\n\r\n    switch(key) {\r\n      case 'ArrowLeft':\r\n        newX -= step;\r\n        break;\r\n      case 'ArrowRight':\r\n        newX += step;\r\n        break;\r\n      case 'ArrowUp':\r\n        newY -= step;\r\n        break;\r\n      case 'ArrowDown':\r\n        newY += step;\r\n        break;\r\n    }\r\n\r\n    // Apply position\r\n    this.element.style.left = `${newX}px`;\r\n    this.element.style.top = `${newY}px`;\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDrag) {\r\n      this.options.onDrag({ x: newX, y: newY });\r\n    }\r\n  }\r\n\r\n  keyboardResize(key, shiftKey) {\r\n    const step = shiftKey ? this.options.keyboardStepLarge : this.options.keyboardStep;\r\n    const rect = this.element.getBoundingClientRect();\r\n    \r\n    let width = rect.width;\r\n    let height = rect.height;\r\n\r\n    // Adjust width/height based on arrow key\r\n    switch(key) {\r\n      case 'ArrowLeft':\r\n        width -= step;\r\n        break;\r\n      case 'ArrowRight':\r\n        width += step;\r\n        break;\r\n      case 'ArrowUp':\r\n        if (this.options.maintainAspectRatio) {\r\n          width += step;\r\n        } else {\r\n          height -= step;\r\n        }\r\n        break;\r\n      case 'ArrowDown':\r\n        if (this.options.maintainAspectRatio) {\r\n          width -= step;\r\n        } else {\r\n          height += step;\r\n        }\r\n        break;\r\n    }\r\n\r\n    // Constrain to minimum dimensions\r\n    width = Math.max(this.options.minWidth, width);\r\n    height = Math.max(this.options.minHeight, height);\r\n\r\n    // Apply new dimensions\r\n    this.element.style.width = `${width}px`;\r\n    if (!this.options.maintainAspectRatio) {\r\n      this.element.style.height = `${height}px`;\r\n    } else {\r\n      this.element.style.height = 'auto';\r\n    }\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onResize) {\r\n      this.options.onResize({ width, height });\r\n    }\r\n  }\r\n\r\n  resetPosition() {\r\n    this.element.style.left = '50%';\r\n    this.element.style.top = '50%';\r\n    this.element.style.transform = 'translate(-50%, -50%)';\r\n    this.element.style.right = '';\r\n    this.element.style.bottom = '';\r\n    \r\n    // Clear manual positioning flag\r\n    this.manuallyPositioned = false;\r\n    \r\n    // Call custom handler if provided\r\n    if (this.options.onDrag) {\r\n      this.options.onDrag({ centered: true });\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    const dragHandle = this.options.dragHandle || this.element;\r\n    \r\n    this.disablePointerResizeMode();\r\n    \r\n    // Remove drag events\r\n    dragHandle.removeEventListener('mousedown', this.handlers.mousedown);\r\n    dragHandle.removeEventListener('touchstart', this.handlers.touchstart);\r\n    dragHandle.removeEventListener('pointerdown', this.handlers.pointerdown);\r\n    \r\n    // Remove document-level events\r\n    document.removeEventListener('mousemove', this.handlers.mousemove);\r\n    document.removeEventListener('mouseup', this.handlers.mouseup);\r\n    document.removeEventListener('touchmove', this.handlers.touchmove);\r\n    document.removeEventListener('touchend', this.handlers.touchend);\r\n    document.removeEventListener('pointermove', this.handlers.pointermove);\r\n    document.removeEventListener('pointerup', this.handlers.pointerup);\r\n    document.removeEventListener('pointercancel', this.handlers.pointercancel);\r\n    \r\n    // Remove keyboard events\r\n    this.element.removeEventListener('keydown', this.handlers.keydown);\r\n    \r\n    // Remove resize handle events\r\n    if (this.options.resizeHandles && this.options.resizeHandles.length > 0) {\r\n      this.options.resizeHandles.forEach(handle => {\r\n        handle.removeEventListener('mousedown', this.handlers.resizeHandleMousedown);\r\n        handle.removeEventListener('touchstart', this.handlers.resizeHandleMousedown);\r\n        handle.removeEventListener('pointerdown', this.handlers.resizeHandlePointerDown);\r\n      });\r\n    }\r\n    \r\n    // Clean up classes\r\n    this.element.classList.remove(\r\n      `${this.options.classPrefix}-dragging`,\r\n      `${this.options.classPrefix}-resizing`,\r\n      `${this.options.classPrefix}-keyboard-drag`,\r\n      `${this.options.classPrefix}-keyboard-resize`\r\n    );\r\n  }\r\n}\r\n\r\n", "/**\r\n * Menu creation and management utilities\r\n */\r\n\r\nimport { DOMUtils } from './DOMUtils.js';\r\nimport { createIconElement } from '../icons/Icons.js';\r\nimport { i18n } from '../i18n/i18n.js';\r\nimport { focusElement } from './FocusUtils.js';\r\n\r\n/**\r\n * Create a menu item button with icon and text\r\n * @param {Object} options - Menu item options\r\n * @param {string} options.classPrefix - Class prefix\r\n * @param {string} options.itemClass - Menu item class name\r\n * @param {string} options.icon - Icon name\r\n * @param {string} options.label - Button label (i18n key or text)\r\n * @param {string} options.ariaLabel - ARIA label (optional, uses label if not provided)\r\n * @param {Function} options.onClick - Click handler\r\n * @param {boolean} options.hasTextClass - Whether to add text class to span\r\n * @returns {HTMLElement} Menu item button\r\n */\r\nexport function createMenuItem({ classPrefix, itemClass, icon, label, ariaLabel, onClick, hasTextClass = false }) {\r\n    // Check if label is an i18n key for aria-label\r\n    const isI18nKeyForAria = typeof label === 'string' && (label.startsWith('transcript.') || label.startsWith('player.') || label.startsWith('settings.'));\r\n    const ariaLabelText = ariaLabel || (isI18nKeyForAria ? (i18n.t(label) || label) : label);\r\n    \r\n    const button = DOMUtils.createElement('button', {\r\n        className: itemClass,\r\n        attributes: {\r\n            'type': 'button',\r\n            'aria-label': ariaLabelText,\r\n            'tabindex': '-1'\r\n        }\r\n    });\r\n    \r\n    if (icon) {\r\n        button.appendChild(createIconElement(icon));\r\n    }\r\n    \r\n    // Check if label is an i18n key (starts with common prefixes)\r\n    const isI18nKey = typeof label === 'string' && (label.startsWith('transcript.') || label.startsWith('player.') || label.startsWith('settings.'));\r\n    const textContent = isI18nKey ? (i18n.t(label) || label) : label;\r\n    \r\n    const text = DOMUtils.createElement('span', {\r\n        textContent: textContent,\r\n        className: hasTextClass ? `${classPrefix}-settings-text` : undefined,\r\n        attributes: {\r\n            'aria-hidden': 'true'\r\n        }\r\n    });\r\n    button.appendChild(text);\r\n    \r\n    if (onClick) {\r\n        button.addEventListener('click', onClick);\r\n    }\r\n    \r\n    return button;\r\n}\r\n\r\n/**\r\n * Setup keyboard navigation for menu items\r\n * @param {HTMLElement} menu - Menu container\r\n * @param {HTMLElement} button - Trigger button\r\n * @param {string} itemSelector - Selector for menu items\r\n * @param {Function} onClose - Function to close menu\r\n */\r\nexport function attachMenuKeyboardNavigation(menu, button, itemSelector, onClose) {\r\n    if (!menu) return;\r\n    \r\n    const menuItems = Array.from(menu.querySelectorAll(itemSelector));\r\n    if (menuItems.length === 0) return;\r\n\r\n    const handleKeyDown = (e) => {\r\n        const currentIndex = menuItems.indexOf(document.activeElement);\r\n        \r\n        switch (e.key) {\r\n            case 'ArrowDown':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                const nextIndex = (currentIndex + 1) % menuItems.length;\r\n                menuItems.forEach((item, idx) => {\r\n                    item.setAttribute('tabindex', idx === nextIndex ? '0' : '-1');\r\n                });\r\n                menuItems[nextIndex].focus({ preventScroll: false });\r\n                menuItems[nextIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                break;\r\n            \r\n            case 'ArrowUp':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                const prevIndex = (currentIndex - 1 + menuItems.length) % menuItems.length;\r\n                menuItems.forEach((item, idx) => {\r\n                    item.setAttribute('tabindex', idx === prevIndex ? '0' : '-1');\r\n                });\r\n                menuItems[prevIndex].focus({ preventScroll: false });\r\n                menuItems[prevIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                break;\r\n            \r\n            case 'Home':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                menuItems.forEach((item, idx) => {\r\n                    item.setAttribute('tabindex', idx === 0 ? '0' : '-1');\r\n                });\r\n                menuItems[0].focus({ preventScroll: false });\r\n                menuItems[0].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                break;\r\n            \r\n            case 'End':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                const lastIndex = menuItems.length - 1;\r\n                menuItems.forEach((item, idx) => {\r\n                    item.setAttribute('tabindex', idx === lastIndex ? '0' : '-1');\r\n                });\r\n                menuItems[lastIndex].focus({ preventScroll: false });\r\n                menuItems[lastIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                break;\r\n            \r\n            case 'Enter':\r\n            case ' ':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (document.activeElement && menuItems.includes(document.activeElement)) {\r\n                    document.activeElement.click();\r\n                    if (onClose) {\r\n                        setTimeout(() => {\r\n                            if (button && document.contains(button)) {\r\n                                button.focus();\r\n                            }\r\n                        }, 0);\r\n                    }\r\n                }\r\n                break;\r\n            \r\n            case 'Escape':\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (onClose) {\r\n                    onClose();\r\n                }\r\n                break;\r\n        }\r\n    };\r\n\r\n    menu.addEventListener('keydown', handleKeyDown, true); // Use capture phase\r\n    return handleKeyDown; // Return handler for cleanup\r\n}\r\n\r\n/**\r\n * Focus first menu item and set tabindex\r\n * @param {HTMLElement} menu - Menu container\r\n * @param {string} itemSelector - Selector for menu items\r\n * @param {number} delay - Delay in milliseconds\r\n */\r\nexport function focusFirstMenuItem(menu, itemSelector, delay = 0) {\r\n    if (!menu) return;\r\n    \r\n    setTimeout(() => {\r\n        const menuItems = Array.from(menu.querySelectorAll(itemSelector));\r\n        if (menuItems.length > 0) {\r\n            menuItems.forEach((item, index) => {\r\n                item.setAttribute('tabindex', index === 0 ? '0' : '-1');\r\n            });\r\n            focusElement(menuItems[0], { delay: 0 });\r\n            // Scroll into view for keyboard users\r\n            menuItems[0].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n        }\r\n    }, delay);\r\n}\r\n\r\n", "/**\r\n * Form element creation utilities\r\n */\r\n\r\nimport { DOMUtils } from './DOMUtils.js';\r\nimport { i18n } from '../i18n/i18n.js';\r\n\r\n/**\r\n * Create a labeled select element with proper accessibility\r\n * @param {Object} options - Options for creating the labeled select\r\n * @param {string} options.classPrefix - Class prefix for styling\r\n * @param {string} options.labelClass - CSS class for the label\r\n * @param {string} options.selectClass - CSS class for the select\r\n * @param {string} options.labelText - Label text (i18n key or plain text)\r\n * @param {string} options.selectId - ID for the select element\r\n * @param {boolean} options.hidden - Whether to hide the label and select initially\r\n * @param {Function} options.onChange - Change event handler\r\n * @param {Array} options.options - Array of option objects {value, text, selected}\r\n * @returns {Object} Object with label and select elements\r\n */\r\nexport function createLabeledSelect({\r\n  classPrefix,\r\n  labelClass,\r\n  selectClass,\r\n  labelText,\r\n  selectId,\r\n  hidden = false,\r\n  onChange = null,\r\n  options = []\r\n}) {\r\n  // Check if labelText is an i18n key\r\n  const isI18nKey = typeof labelText === 'string' && \r\n    (labelText.startsWith('transcript.') || \r\n     labelText.startsWith('player.') || \r\n     labelText.startsWith('settings.') ||\r\n     labelText.startsWith('captions.'));\r\n  const labelTextContent = isI18nKey ? (i18n.t(labelText) || labelText) : labelText;\r\n\r\n  const label = DOMUtils.createElement('label', {\r\n    className: labelClass,\r\n    textContent: labelTextContent,\r\n    attributes: {\r\n      'for': selectId,\r\n      'style': hidden ? 'display: none;' : undefined\r\n    }\r\n  });\r\n\r\n  const select = DOMUtils.createElement('select', {\r\n    className: selectClass,\r\n    attributes: {\r\n      'id': selectId,\r\n      'style': hidden ? 'display: none;' : undefined\r\n    }\r\n  });\r\n\r\n  // Add options\r\n  options.forEach(opt => {\r\n    const option = DOMUtils.createElement('option', {\r\n      textContent: opt.text,\r\n      attributes: {\r\n        'value': opt.value,\r\n        'selected': opt.selected ? 'selected' : undefined\r\n      }\r\n    });\r\n    select.appendChild(option);\r\n  });\r\n\r\n  // Add change handler if provided\r\n  if (onChange) {\r\n    select.addEventListener('change', onChange);\r\n  }\r\n\r\n  return { label, select };\r\n}\r\n\r\n/**\r\n * Show or hide a labeled select element\r\n * @param {HTMLElement} label - Label element\r\n * @param {HTMLElement} select - Select element\r\n * @param {boolean} show - Whether to show (true) or hide (false)\r\n */\r\nexport function toggleLabeledSelect(label, select, show) {\r\n  if (label) {\r\n    label.style.display = show ? 'block' : 'none';\r\n  }\r\n  if (select) {\r\n    select.style.display = show ? 'block' : 'none';\r\n  }\r\n}\r\n\r\n/**\r\n * Prevent drag on element and its children\r\n * @param {HTMLElement} element - Element to prevent drag on\r\n */\r\nexport function preventDragOnElement(element) {\r\n  if (!element) return;\r\n  \r\n  ['mousedown', 'click'].forEach(eventType => {\r\n    element.addEventListener(eventType, (e) => {\r\n      e.stopPropagation();\r\n    });\r\n  });\r\n}\r\n\r\n", "/**\n * Transcript Manager Component\n * Manages transcript display and interaction\n */\n\nimport { DOMUtils } from '../utils/DOMUtils.js';\nimport { TimeUtils } from '../utils/TimeUtils.js';\nimport { createIconElement } from '../icons/Icons.js';\nimport { i18n } from '../i18n/i18n.js';\nimport { StorageManager } from '../utils/StorageManager.js';\nimport { focusElement, focusFirstElement } from '../utils/FocusUtils.js';\nimport { createMenuItem, attachMenuKeyboardNavigation, focusFirstMenuItem } from '../utils/MenuUtils.js';\nimport { DraggableResizable } from '../utils/DraggableResizable.js';\nimport { createLabeledSelect, toggleLabeledSelect, preventDragOnElement } from '../utils/FormUtils.js';\n\nexport class TranscriptManager {\n  constructor(player) {\n    this.player = player;\n    this.transcriptWindow = null;\n    this.transcriptEntries = [];\n    this.metadataCues = [];\n    this.currentActiveEntry = null;\n    this.isVisible = false;\n    \n    // Storage manager\n    this.storage = new StorageManager('vidply');\n    \n    // Draggable/Resizable utility\n    this.draggableResizable = null;\n    \n    // Settings menu state\n    this.settingsMenuVisible = false;\n    this.settingsMenu = null;\n    this.settingsButton = null;\n    this.settingsMenuJustOpened = false;\n    \n    // Resize mode state\n    this.resizeOptionButton = null;\n    this.resizeOptionText = null;\n    this.dragOptionButton = null;\n    this.dragOptionText = null;\n    this.resizeModeIndicator = null;\n    this.resizeModeIndicatorTimeout = null;\n    this.transcriptResizeHandles = [];\n    this.liveRegion = null;\n    \n    // Style dialog state\n    this.styleDialog = null;\n    this.styleDialogVisible = false;\n    this.styleDialogJustOpened = false;\n    \n    // Language selector state\n    this.languageSelector = null;\n    this.languageLabel = null;\n    this.currentTranscriptLanguage = null;\n    this.availableTranscriptLanguages = [];\n    this.languageSelectorHandler = null;\n    \n    // Load saved preferences from localStorage\n    const savedPreferences = this.storage.getTranscriptPreferences();\n    \n    // Autoscroll state (default: true)\n    this.autoscrollEnabled = savedPreferences?.autoscroll !== undefined ? savedPreferences.autoscroll : true;\n    \n    // Show timestamps state (default: false)\n    this.showTimestamps = savedPreferences?.showTimestamps !== undefined ? savedPreferences.showTimestamps : false;\n    \n    // Transcript styling options (with defaults, then player options, then saved preferences)\n    this.transcriptStyle = {\n      fontSize: savedPreferences?.fontSize || this.player.options.transcriptFontSize || '100%',\n      fontFamily: savedPreferences?.fontFamily || this.player.options.transcriptFontFamily || 'sans-serif',\n      color: savedPreferences?.color || this.player.options.transcriptColor || '#ffffff',\n      backgroundColor: savedPreferences?.backgroundColor || this.player.options.transcriptBackgroundColor || '#1e1e1e',\n      opacity: savedPreferences?.opacity ?? this.player.options.transcriptOpacity ?? 0.98\n    };\n    \n    // Store event handlers for cleanup\n    this.handlers = {\n      timeupdate: () => this.updateActiveEntry(),\n      audiodescriptionenabled: () => {\n        if (this.isVisible) {\n          this.loadTranscriptData();\n        }\n      },\n      audiodescriptiondisabled: () => {\n        if (this.isVisible) {\n          this.loadTranscriptData();\n        }\n      },\n      resize: null,\n      settingsClick: null,\n      settingsKeydown: null,\n      documentClick: null,\n      styleDialogKeydown: null\n    };\n    \n    // Timeout management (for cleanup)\n    this.timeouts = new Set();\n    \n    this.init();\n  }\n\n  init() {\n    // Set up metadata handling immediately (independent of transcript display)\n    this.setupMetadataHandlingOnLoad();\n    \n    // Listen for time updates to highlight active transcript entry\n    this.player.on('timeupdate', this.handlers.timeupdate);\n    \n    // Listen for audio description changes to reload transcript\n    this.player.on('audiodescriptionenabled', this.handlers.audiodescriptionenabled);\n    this.player.on('audiodescriptiondisabled', this.handlers.audiodescriptiondisabled);\n    \n    // Reposition transcript when entering/exiting fullscreen\n    this.player.on('fullscreenchange', () => {\n      if (this.isVisible) {\n        // Re-setup drag/drop when entering/exiting fullscreen on mobile devices\n        // This enables drag/resize when entering fullscreen on mobile\n        const isMobile = window.innerWidth < 768;\n        if (isMobile) {\n          this.setupDragAndDrop();\n        }\n        \n        // Only auto-position if user hasn't manually positioned it\n        if (!this.draggableResizable || !this.draggableResizable.manuallyPositioned) {\n          // Add a small delay to ensure DOM has updated after fullscreen transition\n          this.setManagedTimeout(() => this.positionTranscript(), 100);\n        }\n      }\n    });\n  }\n\n  /**\n   * Toggle transcript window visibility\n   */\n  toggleTranscript() {\n    if (this.isVisible) {\n      this.hideTranscript();\n    } else {\n      this.showTranscript();\n    }\n  }\n\n  /**\n   * Show transcript window\n   */\n  showTranscript() {\n    if (this.transcriptWindow) {\n      this.transcriptWindow.style.display = 'flex';\n      this.isVisible = true;\n\n      if (this.player.controlBar && typeof this.player.controlBar.updateTranscriptButton === 'function') {\n        this.player.controlBar.updateTranscriptButton();\n      }\n      \n      // Focus the settings button for keyboard accessibility\n      focusElement(this.settingsButton, { delay: 150 });\n      return;\n    }\n\n    // Create transcript window\n    this.createTranscriptWindow();\n    this.loadTranscriptData();\n    \n    // Show the window\n    if (this.transcriptWindow) {\n      this.transcriptWindow.style.display = 'flex';\n      \n      // Only auto-position if user hasn't manually positioned it\n      // This prevents overwriting saved positions from localStorage\n      if (!this.draggableResizable || !this.draggableResizable.manuallyPositioned) {\n        this.setManagedTimeout(() => this.positionTranscript(), 0);\n      }\n      \n      // Focus the settings button for keyboard accessibility\n      focusElement(this.settingsButton, { delay: 150 });\n    }\n    this.isVisible = true;\n  }\n\n  /**\n   * Hide transcript window\n   */\n  hideTranscript({ focusButton = false } = {}) {\n    if (this.transcriptWindow) {\n      this.transcriptWindow.style.display = 'none';\n      this.isVisible = false;\n    }\n    if (this.draggableResizable && this.draggableResizable.pointerResizeMode) {\n      this.draggableResizable.disablePointerResizeMode();\n      this.updateResizeOptionState();\n    }\n    this.hideResizeModeIndicator();\n    this.announceLive('');\n\n    // Update transcript button state in control bar\n    if (this.player.controlBar && typeof this.player.controlBar.updateTranscriptButton === 'function') {\n      this.player.controlBar.updateTranscriptButton();\n    }\n\n    if (focusButton) {\n      const transcriptButton = this.player.controlBar?.controls?.transcript;\n      if (transcriptButton && typeof transcriptButton.focus === 'function') {\n        transcriptButton.focus({ preventScroll: true });\n      }\n    }\n  }\n\n  /**\n   * Create the transcript window UI\n   */\n  createTranscriptWindow() {\n    this.transcriptWindow = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-window`,\n      attributes: {\n        'role': 'dialog',\n        'aria-label': i18n.t('transcript.ariaLabel'),\n        'tabindex': '-1'\n      }\n    });\n\n    // Header (draggable)\n    this.transcriptHeader = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-header`,\n      attributes: {\n        'tabindex': '0'\n      }\n    });\n\n    // Header left side (settings button + title)\n    this.headerLeft = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-header-left`\n    });\n\n    // Settings button\n    const settingsAriaLabel = i18n.t('transcript.settingsMenu');\n    this.settingsButton = DOMUtils.createElement('button', {\n      className: `${this.player.options.classPrefix}-transcript-settings`,\n      attributes: {\n        'type': 'button',\n        'aria-label': settingsAriaLabel,\n        'aria-expanded': 'false'\n      }\n    });\n    this.settingsButton.appendChild(createIconElement('settings'));\n    DOMUtils.attachTooltip(this.settingsButton, settingsAriaLabel, this.player.options.classPrefix);\n    this.handlers.settingsClick = (e) => {\n      e.preventDefault();\n      e.stopPropagation();\n      if (this.settingsMenuVisible) {\n        this.hideSettingsMenu();\n      } else {\n        this.showSettingsMenu();\n      }\n    };\n    this.settingsButton.addEventListener('click', this.handlers.settingsClick);\n    \n    // Keyboard handler for settings button\n    this.handlers.settingsKeydown = (e) => {\n      // D key to toggle keyboard drag mode\n      if (e.key === 'd' || e.key === 'D') {\n        e.preventDefault();\n        e.stopPropagation();\n        this.toggleKeyboardDragMode();\n      }\n      // R key to toggle resize mode\n      else if (e.key === 'r' || e.key === 'R') {\n        e.preventDefault();\n        e.stopPropagation();\n        this.toggleResizeMode();\n      }\n      // Escape to close menu if open\n      else if (e.key === 'Escape' && this.settingsMenuVisible) {\n        e.preventDefault();\n        e.stopPropagation();\n        this.hideSettingsMenu();\n      }\n    };\n    this.settingsButton.addEventListener('keydown', this.handlers.settingsKeydown);\n\n    const title = DOMUtils.createElement('h3', {\n      textContent: `${i18n.t('transcript.title')}. ${i18n.t('transcript.dragResizePrompt')}`\n    });\n\n    // Autoscroll checkbox\n    const autoscrollId = `${this.player.options.classPrefix}-transcript-autoscroll-${Date.now()}`;\n    \n    const autoscrollLabel = DOMUtils.createElement('label', {\n      className: `${this.player.options.classPrefix}-transcript-autoscroll-label`,\n      attributes: {\n        'for': autoscrollId\n      }\n    });\n    \n    this.autoscrollCheckbox = DOMUtils.createElement('input', {\n      attributes: {\n        'id': autoscrollId,\n        'type': 'checkbox'\n      }\n    });\n    // Set checked property directly (boolean attribute, not \"true\" string)\n    if (this.autoscrollEnabled) {\n      this.autoscrollCheckbox.checked = true;\n    }\n    \n    const autoscrollText = DOMUtils.createElement('span', {\n      textContent: i18n.t('transcript.autoscroll'),\n      className: `${this.player.options.classPrefix}-transcript-autoscroll-text`\n    });\n    \n    autoscrollLabel.appendChild(this.autoscrollCheckbox);\n    autoscrollLabel.appendChild(autoscrollText);\n    \n    // Handle autoscroll checkbox change\n    this.autoscrollCheckbox.addEventListener('change', (e) => {\n      this.autoscrollEnabled = e.target.checked;\n      this.saveAutoscrollPreference();\n    });\n\n    this.transcriptHeader.appendChild(title);\n    this.headerLeft.appendChild(this.settingsButton);\n    this.headerLeft.appendChild(autoscrollLabel);\n    \n    // Language selector (will be populated after tracks are loaded)\n    const selectId = `${this.player.options.classPrefix}-transcript-language-select-${Date.now()}`;\n    const { label: languageLabel, select: languageSelector } = createLabeledSelect({\n      classPrefix: this.player.options.classPrefix,\n      labelClass: `${this.player.options.classPrefix}-transcript-language-label`,\n      selectClass: `${this.player.options.classPrefix}-transcript-language-select`,\n      labelText: 'settings.language',\n      selectId: selectId,\n      hidden: false // Don't hide individual elements, we'll hide the wrapper instead\n    });\n    \n    this.languageLabel = languageLabel;\n    this.languageSelector = languageSelector;\n    \n    // Wrap label and select in a container for vertical stacking\n    const languageSelectorWrapper = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-language-wrapper`,\n      attributes: {\n        'style': 'display: none;' // Hidden until we detect multiple languages\n      }\n    });\n    languageSelectorWrapper.appendChild(this.languageLabel);\n    languageSelectorWrapper.appendChild(this.languageSelector);\n    this.languageSelectorWrapper = languageSelectorWrapper;\n    \n    // Prevent drag when interacting with wrapper\n    preventDragOnElement(languageSelectorWrapper);\n    \n    this.headerLeft.appendChild(languageSelectorWrapper);\n\n    const closeAriaLabel = i18n.t('transcript.close');\n    const closeButton = DOMUtils.createElement('button', {\n      className: `${this.player.options.classPrefix}-transcript-close`,\n      attributes: {\n        'type': 'button',\n        'aria-label': closeAriaLabel\n      }\n    });\n    closeButton.appendChild(createIconElement('close'));\n    DOMUtils.attachTooltip(closeButton, closeAriaLabel, this.player.options.classPrefix);\n    closeButton.addEventListener('click', () => this.hideTranscript({ focusButton: true }));\n\n    this.transcriptHeader.appendChild(this.headerLeft);\n    this.transcriptHeader.appendChild(closeButton);\n\n    // Content container\n    this.transcriptContent = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-content`\n    });\n\n    this.transcriptWindow.appendChild(this.transcriptHeader);\n    this.transcriptWindow.appendChild(this.transcriptContent);\n\n    this.createResizeHandles();\n\n    // Live region for announcements (screen reader feedback)\n    this.liveRegion = DOMUtils.createElement('div', {\n      className: 'vidply-sr-only',\n      attributes: {\n        'aria-live': 'polite',\n        'aria-atomic': 'true'\n      }\n    });\n    this.transcriptWindow.appendChild(this.liveRegion);\n\n    // Append to player container\n    this.player.container.appendChild(this.transcriptWindow);\n    \n    // Setup drag functionality FIRST (this will restore saved position if it exists)\n    this.setupDragAndDrop();\n    \n    // Then position it next to the video wrapper ONLY if user hasn't manually positioned it\n    // This ensures we don't overwrite saved positions from localStorage\n    if (!this.draggableResizable || !this.draggableResizable.manuallyPositioned) {\n      this.positionTranscript();\n    }\n    \n    // Setup document click handler to close settings menu and style dialog\n    // DON'T add it yet - it will be added when the menu is first opened\n    this.handlers.documentClick = (e) => {\n      // Ignore if menu was just opened (prevents immediate closing)\n      if (this.settingsMenuJustOpened) {\n        return;\n      }\n      \n      // Ignore if style dialog was just opened (prevents immediate closing)\n      if (this.styleDialogJustOpened) {\n        return;\n      }\n      \n      // Ignore clicks on the settings button itself\n      if (this.settingsButton && this.settingsButton.contains(e.target)) {\n        return;\n      }\n      \n      // Ignore clicks on the settings menu items\n      if (this.settingsMenu && this.settingsMenu.contains(e.target)) {\n        return;\n      }\n      \n      // Close settings menu if clicking outside\n      if (this.settingsMenuVisible) {\n        this.hideSettingsMenu();\n      }\n      \n      // Close style dialog if clicking outside (but not on settings button)\n      if (this.styleDialogVisible && this.styleDialog && \n          !this.styleDialog.contains(e.target)) {\n        this.hideStyleDialog();\n      }\n    };\n    // Store flag to track if handler has been added\n    this.documentClickHandlerAdded = false;\n    \n    // Re-position on window resize (debounced) - but only if not manually positioned\n    let resizeTimeout;\n    this.handlers.resize = () => {\n      if (resizeTimeout) {\n        this.clearManagedTimeout(resizeTimeout);\n      }\n      resizeTimeout = this.setManagedTimeout(() => {\n        // Only auto-position if user hasn't manually moved it\n        if (!this.draggableResizable || !this.draggableResizable.manuallyPositioned) {\n          this.positionTranscript();\n        }\n      }, 100);\n    };\n    window.addEventListener('resize', this.handlers.resize);\n  }\n  \n  createResizeHandles() {\n    if (!this.transcriptWindow) return;\n\n    const directions = ['n', 's', 'e', 'w', 'ne', 'nw', 'se', 'sw'];\n    this.transcriptResizeHandles = directions.map(direction => {\n      const handle = DOMUtils.createElement('div', {\n        className: `${this.player.options.classPrefix}-transcript-resize-handle ${this.player.options.classPrefix}-transcript-resize-${direction}`,\n        attributes: {\n          'data-direction': direction,\n          'data-vidply-managed-resize': 'true',\n          'aria-hidden': 'true'\n        }\n      });\n\n      handle.style.display = 'none';\n      this.transcriptWindow.appendChild(handle);\n      return handle;\n    });\n  }\n\n  /**\n   * Position transcript window next to video\n   */\n  positionTranscript() {\n    if (!this.transcriptWindow || !this.player.videoWrapper || !this.isVisible) return;\n    \n    // Don't auto-position if user has manually positioned it\n    if (this.draggableResizable && this.draggableResizable.manuallyPositioned) {\n      return;\n    }\n    \n    const isMobile = window.innerWidth < 768;\n    const videoRect = this.player.videoWrapper.getBoundingClientRect();\n    \n    // Check if player is in fullscreen mode\n    const isFullscreen = this.player.state.fullscreen;\n    \n    if (isMobile && !isFullscreen) {\n      // Mobile: Position underneath the video and controls as part of the layout\n      this.transcriptWindow.style.position = 'relative';\n      this.transcriptWindow.style.left = '0';\n      this.transcriptWindow.style.right = '0';\n      this.transcriptWindow.style.bottom = 'auto';\n      this.transcriptWindow.style.top = 'auto';\n      this.transcriptWindow.style.width = '100%';\n      this.transcriptWindow.style.maxWidth = '100%';\n      this.transcriptWindow.style.maxHeight = '400px';\n      this.transcriptWindow.style.height = 'auto';\n      this.transcriptWindow.style.borderRadius = '0';\n      this.transcriptWindow.style.transform = 'none';\n      this.transcriptWindow.style.border = 'none';\n      this.transcriptWindow.style.borderTop = '1px solid var(--vidply-border-light)';\n      // Remove any empty border properties that might have been set\n      this.transcriptWindow.style.removeProperty('border-right');\n      this.transcriptWindow.style.removeProperty('border-bottom');\n      this.transcriptWindow.style.removeProperty('border-left');\n      // Remove border-image properties that can cause parse errors\n      this.transcriptWindow.style.removeProperty('border-image');\n      this.transcriptWindow.style.removeProperty('border-image-source');\n      this.transcriptWindow.style.removeProperty('border-image-slice');\n      this.transcriptWindow.style.removeProperty('border-image-width');\n      this.transcriptWindow.style.removeProperty('border-image-outset');\n      this.transcriptWindow.style.removeProperty('border-image-repeat');\n      this.transcriptWindow.style.boxShadow = 'none';\n      // Disable dragging on mobile\n      if (this.transcriptHeader) {\n        this.transcriptHeader.style.cursor = 'default';\n      }\n      \n      // Ensure transcript is at the container level for proper stacking\n      if (this.transcriptWindow.parentNode !== this.player.container) {\n        this.player.container.appendChild(this.transcriptWindow);\n      }\n    } else if (isFullscreen) {\n      // In fullscreen: position in bottom right corner inside the video\n      this.transcriptWindow.style.position = 'fixed';\n      this.transcriptWindow.style.left = 'auto';\n      this.transcriptWindow.style.right = '20px';\n      this.transcriptWindow.style.bottom = '80px'; // Above controls\n      this.transcriptWindow.style.top = 'auto';\n      this.transcriptWindow.style.maxHeight = 'calc(100vh - 180px)'; // Leave space for controls\n      this.transcriptWindow.style.height = 'auto';\n      const fullscreenMinWidth = 260;\n      const fullscreenAvailable = Math.max(fullscreenMinWidth, window.innerWidth - 40);\n      const fullscreenDesired = parseFloat(this.transcriptWindow.style.width) || 400;\n      const fullscreenWidth = Math.max(fullscreenMinWidth, Math.min(fullscreenDesired, fullscreenAvailable));\n      this.transcriptWindow.style.width = `${fullscreenWidth}px`;\n      this.transcriptWindow.style.maxWidth = 'none';\n      this.transcriptWindow.style.borderRadius = '8px';\n      this.transcriptWindow.style.border = '1px solid var(--vidply-border)';\n      // Remove borderTop and any other individual border properties to avoid empty values\n      this.transcriptWindow.style.removeProperty('border-top');\n      this.transcriptWindow.style.removeProperty('border-right');\n      this.transcriptWindow.style.removeProperty('border-bottom');\n      this.transcriptWindow.style.removeProperty('border-left');\n      // Remove border-image properties that can cause parse errors\n      this.transcriptWindow.style.removeProperty('border-image');\n      this.transcriptWindow.style.removeProperty('border-image-source');\n      this.transcriptWindow.style.removeProperty('border-image-slice');\n      this.transcriptWindow.style.removeProperty('border-image-width');\n      this.transcriptWindow.style.removeProperty('border-image-outset');\n      this.transcriptWindow.style.removeProperty('border-image-repeat');\n      // Enable dragging in fullscreen (including touch devices)\n      if (this.transcriptHeader) {\n        this.transcriptHeader.style.cursor = 'move';\n      }\n      \n      // Move back to container for fullscreen\n      if (this.transcriptWindow.parentNode !== this.player.container) {\n        this.player.container.appendChild(this.transcriptWindow);\n      }\n    } else {\n      // Desktop mode: position in right side of viewport\n      const transcriptWidth = parseFloat(this.transcriptWindow.style.width) || 400;\n      const padding = 20;\n      const minWidth = 260;\n      const containerRect = this.player.container.getBoundingClientRect();\n\n      const ensureContainerPositioned = () => {\n        const computed = window.getComputedStyle(this.player.container);\n        if (computed.position === 'static') {\n          this.player.container.style.position = 'relative';\n        }\n      };\n\n      ensureContainerPositioned();\n\n      const left = (videoRect.right - containerRect.left) + padding;\n      const availableWidth = window.innerWidth - videoRect.right - padding;\n      const appliedWidth = Math.max(minWidth, Math.min(transcriptWidth, availableWidth));\n      const appliedHeight = videoRect.height;\n\n      this.transcriptWindow.style.position = 'absolute';\n      this.transcriptWindow.style.left = `${left}px`;\n      this.transcriptWindow.style.right = 'auto';\n      this.transcriptWindow.style.bottom = 'auto';\n      this.transcriptWindow.style.top = '0';\n      this.transcriptWindow.style.height = `${appliedHeight}px`;\n      this.transcriptWindow.style.maxHeight = 'none';\n      this.transcriptWindow.style.width = `${appliedWidth}px`;\n      this.transcriptWindow.style.maxWidth = 'none';\n      this.transcriptWindow.style.borderRadius = '8px';\n      this.transcriptWindow.style.border = '1px solid var(--vidply-border)';\n      // Remove borderTop and any other individual border properties to avoid empty values\n      this.transcriptWindow.style.removeProperty('border-top');\n      this.transcriptWindow.style.removeProperty('border-right');\n      this.transcriptWindow.style.removeProperty('border-bottom');\n      this.transcriptWindow.style.removeProperty('border-left');\n      // Remove border-image properties that can cause parse errors\n      this.transcriptWindow.style.removeProperty('border-image');\n      this.transcriptWindow.style.removeProperty('border-image-source');\n      this.transcriptWindow.style.removeProperty('border-image-slice');\n      this.transcriptWindow.style.removeProperty('border-image-width');\n      this.transcriptWindow.style.removeProperty('border-image-outset');\n      this.transcriptWindow.style.removeProperty('border-image-repeat');\n      // Enable dragging on desktop\n      if (this.transcriptHeader) {\n        this.transcriptHeader.style.cursor = 'move';\n      }\n      \n      // Move back to container for desktop\n      if (this.transcriptWindow.parentNode !== this.player.container) {\n        this.player.container.appendChild(this.transcriptWindow);\n      }\n    }\n  }\n\n  /**\n   * Get available transcript languages from tracks\n   */\n  getAvailableTranscriptLanguages() {\n    const textTracks = this.player.textTracks;\n    const languages = new Map();\n    \n    // Collect all caption/subtitle tracks with their languages\n    textTracks.forEach(track => {\n      if ((track.kind === 'captions' || track.kind === 'subtitles') && track.language) {\n        if (!languages.has(track.language)) {\n          languages.set(track.language, {\n            language: track.language,\n            label: track.label || track.language,\n            track: track\n          });\n        }\n      }\n    });\n    \n    return Array.from(languages.values());\n  }\n\n  /**\n   * Update language selector dropdown\n   */\n  updateLanguageSelector() {\n    if (!this.languageSelector) return;\n    \n    this.availableTranscriptLanguages = this.getAvailableTranscriptLanguages();\n    \n    // Clear existing options\n    this.languageSelector.innerHTML = '';\n    \n    // Only show selector if there are 2+ languages\n    if (this.availableTranscriptLanguages.length < 2) {\n      if (this.languageSelectorWrapper) {\n        this.languageSelectorWrapper.style.display = 'none';\n      }\n      return;\n    }\n    \n    // Show selector wrapper\n    if (this.languageSelectorWrapper) {\n      this.languageSelectorWrapper.style.display = 'flex';\n    }\n    \n    this.availableTranscriptLanguages.forEach((langInfo, index) => {\n      const option = DOMUtils.createElement('option', {\n        textContent: langInfo.label,\n        attributes: {\n          'value': langInfo.language,\n          'lang': langInfo.language\n        }\n      });\n      this.languageSelector.appendChild(option);\n    });\n    \n    // Set current selection\n    if (this.currentTranscriptLanguage) {\n      this.languageSelector.value = this.currentTranscriptLanguage;\n    } else if (this.availableTranscriptLanguages.length > 0) {\n      // Default to first language or active track\n      const activeTrack = this.player.textTracks.find(\n        track => (track.kind === 'captions' || track.kind === 'subtitles') && track.mode === 'showing'\n      );\n      this.currentTranscriptLanguage = activeTrack ? activeTrack.language : this.availableTranscriptLanguages[0].language;\n      this.languageSelector.value = this.currentTranscriptLanguage;\n    }\n    \n    // Remove existing change listener if any\n    if (this.languageSelectorHandler) {\n      this.languageSelector.removeEventListener('change', this.languageSelectorHandler);\n    }\n    \n    // Handle language change\n    this.languageSelectorHandler = (e) => {\n      this.currentTranscriptLanguage = e.target.value;\n      this.loadTranscriptData();\n      \n      // Set lang attribute for screen readers to pronounce text correctly\n      if (this.transcriptContent && this.currentTranscriptLanguage) {\n        this.transcriptContent.setAttribute('lang', this.currentTranscriptLanguage);\n      }\n    };\n    this.languageSelector.addEventListener('change', this.languageSelectorHandler);\n  }\n\n  /**\n   * Load transcript data from caption/subtitle tracks\n   */\n  loadTranscriptData() {\n    this.transcriptEntries = [];\n    this.transcriptContent.innerHTML = '';\n\n    // Get all text tracks\n    const textTracks = this.player.textTracks;\n    \n    // Find track for selected language, or default to first available\n    let captionTrack = null;\n    if (this.currentTranscriptLanguage) {\n      captionTrack = textTracks.find(\n        track => (track.kind === 'captions' || track.kind === 'subtitles') && \n                 track.language === this.currentTranscriptLanguage\n      );\n    }\n    \n    // Fallback to first available caption/subtitle track\n    if (!captionTrack) {\n      captionTrack = textTracks.find(\n        track => track.kind === 'captions' || track.kind === 'subtitles'\n      );\n      if (captionTrack) {\n        this.currentTranscriptLanguage = captionTrack.language;\n      }\n    }\n    \n    // Find description track matching the selected language\n    let descriptionTrack = null;\n    if (this.currentTranscriptLanguage) {\n      descriptionTrack = textTracks.find(\n        track => track.kind === 'descriptions' && track.language === this.currentTranscriptLanguage\n      );\n    }\n    // Fallback to first available description track if no match found\n    if (!descriptionTrack) {\n      descriptionTrack = textTracks.find(track => track.kind === 'descriptions');\n    }\n    \n    const metadataTrack = textTracks.find(track => track.kind === 'metadata');\n\n    // We need at least one track type available for display\n    // (captions, descriptions, or metadata - though metadata is not displayed)\n    if (!captionTrack && !descriptionTrack && !metadataTrack) {\n      this.showNoTranscriptMessage();\n      return;\n    }\n\n    // Enable all tracks to load cues so they're available for the transcript\n    const tracksToLoad = [captionTrack, descriptionTrack, metadataTrack].filter(Boolean);\n    tracksToLoad.forEach(track => {\n      if (track.mode === 'disabled') {\n        track.mode = 'hidden';\n      }\n    });\n\n    // Check if any tracks are still loading\n    const needsLoading = tracksToLoad.some(track => !track.cues || track.cues.length === 0);\n    \n    if (needsLoading) {\n      // Wait for cues to load\n      const loadingMessage = DOMUtils.createElement('div', {\n        className: `${this.player.options.classPrefix}-transcript-loading`,\n        textContent: i18n.t('transcript.loading')\n      });\n      this.transcriptContent.appendChild(loadingMessage);\n\n      let loaded = 0;\n      const onLoad = () => {\n        loaded++;\n        if (loaded >= tracksToLoad.length) {\n          this.loadTranscriptData();\n        }\n      };\n\n      tracksToLoad.forEach(track => {\n        track.addEventListener('load', onLoad, { once: true });\n      });\n\n      // Fallback timeout\n      this.setManagedTimeout(() => {\n        this.loadTranscriptData();\n      }, 500);\n      \n      return;\n    }\n\n    // Collect all cues from all tracks with their type\n    const allCues = [];\n    \n    if (captionTrack && captionTrack.cues) {\n      Array.from(captionTrack.cues).forEach(cue => {\n        allCues.push({ cue, type: 'caption' });\n      });\n    }\n    \n    // Always include description cues in transcript for completeness\n    // (Audio description toggle only controls whether they're read aloud,\n    // but the transcript should always show all content for accessibility)\n    if (descriptionTrack && descriptionTrack.cues) {\n      Array.from(descriptionTrack.cues).forEach(cue => {\n        allCues.push({ cue, type: 'description' });\n      });\n    }\n    \n    // Store metadata separately for programmatic use (don't display in transcript)\n    if (metadataTrack && metadataTrack.cues) {\n      this.metadataCues = Array.from(metadataTrack.cues);\n      this.setupMetadataHandling();\n    }\n\n    // Sort all cues by start time\n    allCues.sort((a, b) => a.cue.startTime - b.cue.startTime);\n\n    // Build transcript from captions and descriptions only\n    allCues.forEach((item, index) => {\n      const entry = this.createTranscriptEntry(item.cue, index, item.type);\n      this.transcriptEntries.push({\n        element: entry,\n        cue: item.cue,\n        type: item.type,\n        startTime: item.cue.startTime,\n        endTime: item.cue.endTime\n      });\n      this.transcriptContent.appendChild(entry);\n    });\n    \n    // Apply current styles to newly loaded entries\n    this.applyTranscriptStyles();\n    \n    // Apply timestamp visibility preference\n    this.updateTimestampVisibility();\n    \n    // Set lang attribute for screen readers to pronounce text correctly\n    if (this.transcriptContent && this.currentTranscriptLanguage) {\n      this.transcriptContent.setAttribute('lang', this.currentTranscriptLanguage);\n    }\n    \n    // Update language selector after loading\n    this.updateLanguageSelector();\n  }\n\n  /**\n   * Setup metadata handling on player load\n   * This runs independently of transcript loading\n   */\n  setupMetadataHandlingOnLoad() {\n    // Wait for metadata to be loaded\n    const setupMetadata = () => {\n      const textTracks = this.player.textTracks;\n      const metadataTrack = textTracks.find(track => track.kind === 'metadata');\n      \n      if (metadataTrack) {\n        // Enable the metadata track so cuechange events fire\n        // Use 'hidden' mode so it doesn't display anything, but events still work\n        if (metadataTrack.mode === 'disabled') {\n          metadataTrack.mode = 'hidden';\n        }\n        \n        // Check if we already added the listener\n        if (this.metadataCueChangeHandler) {\n          metadataTrack.removeEventListener('cuechange', this.metadataCueChangeHandler);\n        }\n        \n        // Add event listener for cue changes\n        this.metadataCueChangeHandler = () => {\n          const activeCues = Array.from(metadataTrack.activeCues || []);\n          if (activeCues.length > 0) {\n            // Debug logging (can be removed in production)\n            if (this.player.options.debug) {\n              console.log('[VidPly Metadata] Active cues:', activeCues.map(c => ({\n                start: c.startTime,\n                end: c.endTime,\n                text: c.text\n              })));\n            }\n          }\n          activeCues.forEach(cue => {\n            this.handleMetadataCue(cue);\n          });\n        };\n        \n        metadataTrack.addEventListener('cuechange', this.metadataCueChangeHandler);\n        \n        // Debug: Log metadata track setup\n        if (this.player.options.debug) {\n          const cueCount = metadataTrack.cues ? metadataTrack.cues.length : 0;\n          console.log('[VidPly Metadata] Track enabled,', cueCount, 'cues available');\n        }\n      } else if (this.player.options.debug) {\n        console.warn('[VidPly Metadata] No metadata track found');\n      }\n    };\n    \n    // Try immediately\n    setupMetadata();\n    \n    // Also try after loadedmetadata event\n    this.player.on('loadedmetadata', setupMetadata);\n  }\n\n  /**\n   * Setup metadata handling\n   * Metadata cues are not displayed but can be used programmatically\n   * This is called when transcript data is loaded (for storing cues)\n   */\n  setupMetadataHandling() {\n    if (!this.metadataCues || this.metadataCues.length === 0) {\n      return;\n    }\n\n    // The actual event handling is set up in setupMetadataHandlingOnLoad()\n    // This method just stores the cues for reference\n    if (this.player.options.debug) {\n      console.log('[VidPly Metadata]', this.metadataCues.length, 'cues stored from transcript load');\n    }\n  }\n\n  /**\n   * Handle individual metadata cues\n   * Parses metadata text and emits events or triggers actions\n   */\n  handleMetadataCue(cue) {\n    const text = cue.text.trim();\n    \n    // Debug logging\n    if (this.player.options.debug) {\n      console.log('[VidPly Metadata] Processing cue:', {\n        time: cue.startTime,\n        text: text\n      });\n    }\n    \n    // Emit a generic metadata event that developers can listen to\n    this.player.emit('metadata', {\n      time: cue.startTime,\n      endTime: cue.endTime,\n      text: text,\n      cue: cue\n    });\n\n    // Parse for specific commands (examples based on wwa_meta.vtt format)\n    if (text.includes('PAUSE')) {\n      // Automatically pause the video\n      if (!this.player.state.paused) {\n        if (this.player.options.debug) {\n          console.log('[VidPly Metadata] Pausing video at', cue.startTime);\n        }\n        this.player.pause();\n      }\n      // Also emit event for developers who want to listen\n      this.player.emit('metadata:pause', { time: cue.startTime, text: text });\n    }\n\n    // Parse for focus directives\n    const focusMatch = text.match(/FOCUS:([\\w#-]+)/);\n    if (focusMatch) {\n      const targetSelector = focusMatch[1];\n      // Automatically focus the target element\n      const targetElement = document.querySelector(targetSelector);\n      if (targetElement) {\n        if (this.player.options.debug) {\n          console.log('[VidPly Metadata] Focusing element:', targetSelector);\n        }\n        // Use setTimeout to ensure DOM is ready\n        this.setManagedTimeout(() => {\n          targetElement.focus({ preventScroll: true });\n        }, 10);\n      } else if (this.player.options.debug) {\n        console.warn('[VidPly Metadata] Element not found:', targetSelector);\n      }\n      // Also emit event for developers who want to listen\n      this.player.emit('metadata:focus', { \n        time: cue.startTime, \n        target: targetSelector,\n        element: targetElement,\n        text: text \n      });\n    }\n\n    // Parse for hashtag references\n    const hashtags = text.match(/#[\\w-]+/g);\n    if (hashtags) {\n      if (this.player.options.debug) {\n        console.log('[VidPly Metadata] Hashtags found:', hashtags);\n      }\n      this.player.emit('metadata:hashtags', {\n        time: cue.startTime,\n        hashtags: hashtags,\n        text: text\n      });\n    }\n  }\n\n  /**\n   * Create a single transcript entry element\n   */\n  createTranscriptEntry(cue, index, type = 'caption') {\n    const entryText = this.stripVTTFormatting(cue.text);\n    \n    const entry = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-entry ${this.player.options.classPrefix}-transcript-${type}`,\n      attributes: {\n        'tabindex': '0',\n        'data-start': String(cue.startTime),\n        'data-end': String(cue.endTime),\n        'data-type': type\n      }\n    });\n\n    const timestamp = DOMUtils.createElement('span', {\n      className: `${this.player.options.classPrefix}-transcript-time`,\n      textContent: TimeUtils.formatTime(cue.startTime),\n      attributes: {\n        'aria-hidden': 'true'  // Hide from screen readers - decorative timestamp\n      }\n    });\n\n    const text = DOMUtils.createElement('span', {\n      className: `${this.player.options.classPrefix}-transcript-text`,\n      textContent: entryText\n    });\n\n    entry.appendChild(timestamp);\n    entry.appendChild(text);\n\n    // Click to seek\n    const seekToTime = () => {\n      this.player.seek(cue.startTime);\n      if (this.player.state.paused) {\n        this.player.play();\n      }\n    };\n\n    entry.addEventListener('click', seekToTime);\n    entry.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        seekToTime();\n      }\n    });\n\n    return entry;\n  }\n\n  /**\n   * Strip VTT formatting tags from text\n   */\n  stripVTTFormatting(text) {\n    // Remove VTT tags like <v Speaker>, <c>, etc.\n    return text\n      .replace(/<[^>]+>/g, '')\n      .replace(/\\n/g, ' ')\n      .trim();\n  }\n\n  /**\n   * Show message when no transcript is available\n   */\n  showNoTranscriptMessage() {\n    const message = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-empty`,\n      textContent: i18n.t('transcript.noTranscript')\n    });\n    this.transcriptContent.appendChild(message);\n  }\n\n  /**\n   * Update active transcript entry based on current time\n   */\n  updateActiveEntry() {\n    if (!this.isVisible || this.transcriptEntries.length === 0) return;\n\n    const currentTime = this.player.state.currentTime;\n    \n    // Find the entry that matches current time\n    const activeEntry = this.transcriptEntries.find(\n      entry => currentTime >= entry.startTime && currentTime < entry.endTime\n    );\n\n    if (activeEntry && activeEntry !== this.currentActiveEntry) {\n      // Remove previous active class\n      if (this.currentActiveEntry) {\n        this.currentActiveEntry.element.classList.remove(\n          `${this.player.options.classPrefix}-transcript-entry-active`\n        );\n      }\n\n      // Add active class to current entry\n      activeEntry.element.classList.add(\n        `${this.player.options.classPrefix}-transcript-entry-active`\n      );\n      \n      // Scroll to active entry\n      this.scrollToEntry(activeEntry.element);\n      \n      this.currentActiveEntry = activeEntry;\n    } else if (!activeEntry && this.currentActiveEntry) {\n      // No active entry, remove active class\n      this.currentActiveEntry.element.classList.remove(\n        `${this.player.options.classPrefix}-transcript-entry-active`\n      );\n      this.currentActiveEntry = null;\n    }\n  }\n\n  /**\n   * Scroll transcript window to show active entry\n   */\n  scrollToEntry(entryElement) {\n    if (!this.transcriptContent || !this.autoscrollEnabled) return;\n\n    const contentRect = this.transcriptContent.getBoundingClientRect();\n    const entryRect = entryElement.getBoundingClientRect();\n\n    // Check if entry is out of view\n    if (entryRect.top < contentRect.top || entryRect.bottom > contentRect.bottom) {\n      // Scroll to center the entry\n      const scrollTop = entryElement.offsetTop - (this.transcriptContent.clientHeight / 2) + (entryElement.clientHeight / 2);\n      this.transcriptContent.scrollTo({\n        top: scrollTop,\n        behavior: 'smooth'\n      });\n    }\n  }\n  \n  /**\n   * Save autoscroll preference to localStorage\n   */\n  saveAutoscrollPreference() {\n    const savedPreferences = this.storage.getTranscriptPreferences() || {};\n    savedPreferences.autoscroll = this.autoscrollEnabled;\n    this.storage.saveTranscriptPreferences(savedPreferences);\n  }\n\n  /**\n   * Setup drag and drop functionality\n   */\n  setupDragAndDrop() {\n    if (!this.transcriptHeader || !this.transcriptWindow) return;\n\n    // Check if we're on mobile and not in fullscreen\n    const isMobile = window.innerWidth < 768;\n    const isFullscreen = this.player.state.fullscreen;\n    \n    // On mobile devices (< 768px), only enable drag/resize in fullscreen\n    // On desktop/tablets (>= 768px), always enable drag/resize\n    if (isMobile && !isFullscreen) {\n      // Destroy existing instance if exiting fullscreen on mobile\n      if (this.draggableResizable) {\n        this.draggableResizable.destroy();\n        this.draggableResizable = null;\n      }\n      return; // No drag/resize on mobile when not in fullscreen\n    }\n\n    // If already initialized, don't re-initialize\n    if (this.draggableResizable) {\n      return;\n    }\n\n    // Create DraggableResizable utility with touch support\n    this.draggableResizable = new DraggableResizable(this.transcriptWindow, {\n      dragHandle: this.transcriptHeader,\n      resizeHandles: this.transcriptResizeHandles,\n      constrainToViewport: true,\n      classPrefix: `${this.player.options.classPrefix}-transcript`,\n      keyboardDragKey: 'd',\n      keyboardResizeKey: 'r',\n      keyboardStep: 10,\n      keyboardStepLarge: 50,\n      minWidth: 300,\n      minHeight: 200,\n      maxWidth: () => Math.max(320, window.innerWidth - 40),\n      maxHeight: () => Math.max(200, window.innerHeight - 120),\n      pointerResizeIndicatorText: i18n.t('transcript.resizeModeHint'),\n      onPointerResizeToggle: (enabled) => {\n        // Update resize handles visibility\n        this.transcriptResizeHandles.forEach(handle => {\n          handle.style.display = enabled ? 'block' : 'none';\n        });\n        // Call the state change handler\n        this.onPointerResizeModeChange(enabled);\n      },\n      onDragStart: (e) => {\n        // Don't drag if clicking on certain elements\n        const ignoreSelectors = [\n          `.${this.player.options.classPrefix}-transcript-close`,\n          `.${this.player.options.classPrefix}-transcript-settings`,\n          `.${this.player.options.classPrefix}-transcript-language-select`,\n          `.${this.player.options.classPrefix}-transcript-language-label`,\n          `.${this.player.options.classPrefix}-transcript-settings-menu`,\n          `.${this.player.options.classPrefix}-transcript-style-dialog`\n        ];\n        \n        for (const selector of ignoreSelectors) {\n          if (e.target.closest(selector)) {\n            return false; // Prevent drag\n          }\n        }\n        \n        return true; // Allow drag\n      }\n    });\n\n    // Add custom keyboard handler for special keys (Escape, Home)\n    this.customKeyHandler = (e) => {\n      const key = e.key.toLowerCase();\n      const alreadyPrevented = e.defaultPrevented;\n\n      // Don't handle keys if settings menu or style dialog is open (let them handle keys)\n      if (this.settingsMenuVisible || this.styleDialogVisible) {\n        return;\n      }\n\n      if (key === 'home') {\n        e.preventDefault();\n        e.stopPropagation();\n        if (this.draggableResizable) {\n          if (this.draggableResizable.pointerResizeMode) {\n            this.draggableResizable.disablePointerResizeMode();\n          }\n          this.draggableResizable.manuallyPositioned = false;\n          this.positionTranscript();\n          this.updateResizeOptionState();\n          this.announceLive(i18n.t('transcript.positionReset'));\n        }\n        return;\n      }\n      \n      if (key === 'r') {\n        if (alreadyPrevented) {\n          return;\n        }\n        e.preventDefault();\n        e.stopPropagation();\n        const enabled = this.toggleResizeMode();\n        if (enabled) {\n          this.transcriptWindow.focus({ preventScroll: true });\n        }\n        return;\n      }\n      \n      if (key === 'escape') {\n        // Check priority: resize mode > drag mode > close transcript\n        // (settings menu and style dialog already handled by early return above)\n        if (this.draggableResizable && this.draggableResizable.pointerResizeMode) {\n          e.preventDefault();\n          e.stopPropagation();\n          this.draggableResizable.disablePointerResizeMode();\n          return;\n        }\n        if (this.draggableResizable && this.draggableResizable.keyboardDragMode) {\n          e.preventDefault();\n          e.stopPropagation();\n          this.draggableResizable.disableKeyboardDragMode();\n          this.announceLive(i18n.t('transcript.dragModeDisabled'));\n          return;\n        }\n        // Only close transcript if nothing else is open\n        e.preventDefault();\n        e.stopPropagation();\n        this.hideTranscript({ focusButton: true });\n        return;\n      }\n    };\n    \n    this.transcriptWindow.addEventListener('keydown', this.customKeyHandler);\n  }\n\n\n  /**\n   * Toggle keyboard drag mode\n   */\n  toggleKeyboardDragMode() {\n    if (this.draggableResizable) {\n      const wasEnabled = this.draggableResizable.keyboardDragMode;\n      this.draggableResizable.toggleKeyboardDragMode();\n      const isEnabled = this.draggableResizable.keyboardDragMode;\n      if (!wasEnabled && isEnabled) {\n        this.enableMoveMode();\n      }\n      \n      // Update drag option state\n      this.updateDragOptionState();\n      \n      // Hide settings menu if open\n      if (this.settingsMenuVisible) {\n        this.hideSettingsMenu();\n      }\n      \n      // Focus the window for keyboard navigation\n      this.transcriptWindow.focus({ preventScroll: true });\n    }\n  }\n\n  /**\n   * Toggle settings menu visibility\n   */\n  toggleSettingsMenu() {\n    if (this.settingsMenuVisible) {\n      this.hideSettingsMenu();\n    } else {\n      this.showSettingsMenu();\n    }\n  }\n\n  /**\n   * Show settings menu\n   */\n  showSettingsMenu() {\n    // Set flag to prevent immediate closing\n    this.settingsMenuJustOpened = true;\n    setTimeout(() => {\n      this.settingsMenuJustOpened = false;\n    }, 350);\n    \n    // Add document click handler on FIRST menu open (not at window creation)\n    if (!this.documentClickHandlerAdded) {\n      setTimeout(() => {\n        document.addEventListener('click', this.handlers.documentClick);\n        this.documentClickHandlerAdded = true;\n      }, 300);\n    }\n    \n    if (this.settingsMenu) {\n      this.settingsMenu.style.display = 'block';\n      this.settingsMenuVisible = true;\n      if (this.settingsButton) {\n        this.settingsButton.setAttribute('aria-expanded', 'true');\n      }\n      // Re-attach keyboard navigation handler\n      this.attachSettingsMenuKeyboardNavigation();\n      // Position menu immediately\n      this.positionSettingsMenuImmediate();\n      this.updateResizeOptionState();\n      // Focus first menu item after positioning\n      setTimeout(() => {\n        const menuItems = this.settingsMenu.querySelectorAll(`.${this.player.options.classPrefix}-transcript-settings-item`);\n        if (menuItems.length > 0) {\n          menuItems[0].setAttribute('tabindex', '0');\n          for (let i = 1; i < menuItems.length; i++) {\n            menuItems[i].setAttribute('tabindex', '-1');\n          }\n          menuItems[0].focus({ preventScroll: true });\n        }\n      }, 50);\n      return;\n    }\n    // Create settings menu\n    this.settingsMenu = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-settings-menu`,\n      attributes: {\n        'role': 'menu'\n      }\n    });\n\n    // Keyboard drag option\n    const keyboardDragOption = createMenuItem({\n      classPrefix: this.player.options.classPrefix,\n      itemClass: `${this.player.options.classPrefix}-transcript-settings-item`,\n      icon: 'move',\n      label: 'transcript.enableDragMode',\n      hasTextClass: true,\n      onClick: () => {\n        this.toggleKeyboardDragMode();\n        this.hideSettingsMenu();\n      }\n    });\n    keyboardDragOption.setAttribute('role', 'switch');\n    keyboardDragOption.setAttribute('aria-checked', 'false');\n    // Remove any tooltips from menu items (they have visible text)\n    const dragTooltip = keyboardDragOption.querySelector(`.${this.player.options.classPrefix}-tooltip`);\n    if (dragTooltip) dragTooltip.remove();\n    const dragButtonText = keyboardDragOption.querySelector(`.${this.player.options.classPrefix}-button-text`);\n    if (dragButtonText) dragButtonText.remove();\n    this.dragOptionButton = keyboardDragOption;\n    this.dragOptionText = keyboardDragOption.querySelector(`.${this.player.options.classPrefix}-settings-text`);\n    this.updateDragOptionState();\n    \n    // Style option\n    const styleOption = createMenuItem({\n      classPrefix: this.player.options.classPrefix,\n      itemClass: `${this.player.options.classPrefix}-transcript-settings-item`,\n      icon: 'settings',\n      label: 'transcript.styleTranscript',\n      onClick: (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        this.hideSettingsMenu();\n        // Delay to ensure menu is fully closed before opening dialog\n        setTimeout(() => {\n          this.showStyleDialog();\n        }, 50);\n      }\n    });\n    // Remove any tooltips from menu items (they have visible text)\n    const styleTooltip = styleOption.querySelector(`.${this.player.options.classPrefix}-tooltip`);\n    if (styleTooltip) styleTooltip.remove();\n    const styleButtonText = styleOption.querySelector(`.${this.player.options.classPrefix}-button-text`);\n    if (styleButtonText) styleButtonText.remove();\n\n    // Resize option\n    const resizeOption = createMenuItem({\n      classPrefix: this.player.options.classPrefix,\n      itemClass: `${this.player.options.classPrefix}-transcript-settings-item`,\n      icon: 'resize',\n      label: 'transcript.enableResizeMode',\n      hasTextClass: true,\n      onClick: (event) => {\n        event.preventDefault();\n        event.stopPropagation();\n        \n        const enabled = this.toggleResizeMode({ focus: false });\n        \n        if (enabled) {\n          this.hideSettingsMenu({ focusButton: false });\n          // Focus transcript window after handles appear\n          setTimeout(() => {\n            if (this.transcriptWindow) {\n              this.transcriptWindow.focus({ preventScroll: true });\n            }\n          }, 20);\n        } else {\n          this.hideSettingsMenu({ focusButton: true });\n        }\n      }\n    });\n    resizeOption.setAttribute('role', 'switch');\n    resizeOption.setAttribute('aria-checked', 'false');\n    // Remove any tooltips from menu items (they have visible text)\n    const resizeTooltip = resizeOption.querySelector(`.${this.player.options.classPrefix}-tooltip`);\n    if (resizeTooltip) resizeTooltip.remove();\n    const resizeButtonText = resizeOption.querySelector(`.${this.player.options.classPrefix}-button-text`);\n    if (resizeButtonText) resizeButtonText.remove();\n    this.resizeOptionButton = resizeOption;\n    this.resizeOptionText = resizeOption.querySelector(`.${this.player.options.classPrefix}-settings-text`);\n    this.updateResizeOptionState();\n\n    // Show timestamps option\n    const showTimestampsOption = createMenuItem({\n      classPrefix: this.player.options.classPrefix,\n      itemClass: `${this.player.options.classPrefix}-transcript-settings-item`,\n      icon: 'clock',\n      label: 'transcript.showTimestamps',\n      hasTextClass: true,\n      onClick: () => {\n        this.toggleShowTimestamps();\n      }\n    });\n    showTimestampsOption.setAttribute('role', 'switch');\n    showTimestampsOption.setAttribute('aria-checked', this.showTimestamps ? 'true' : 'false');\n    // Remove any tooltips from menu items (they have visible text)\n    const timestampsTooltip = showTimestampsOption.querySelector(`.${this.player.options.classPrefix}-tooltip`);\n    if (timestampsTooltip) timestampsTooltip.remove();\n    const timestampsButtonText = showTimestampsOption.querySelector(`.${this.player.options.classPrefix}-button-text`);\n    if (timestampsButtonText) timestampsButtonText.remove();\n    this.showTimestampsButton = showTimestampsOption;\n    this.showTimestampsText = showTimestampsOption.querySelector(`.${this.player.options.classPrefix}-settings-text`);\n    this.updateShowTimestampsState();\n\n    // Close option\n    const closeOption = createMenuItem({\n      classPrefix: this.player.options.classPrefix,\n      itemClass: `${this.player.options.classPrefix}-transcript-settings-item`,\n      icon: 'close',\n      label: 'transcript.closeMenu',\n      onClick: () => {\n        this.hideSettingsMenu();\n      }\n    });\n    // Remove any tooltips from menu items (they have visible text)\n    const closeTooltip = closeOption.querySelector(`.${this.player.options.classPrefix}-tooltip`);\n    if (closeTooltip) closeTooltip.remove();\n    const closeButtonText = closeOption.querySelector(`.${this.player.options.classPrefix}-button-text`);\n    if (closeButtonText) closeButtonText.remove();\n\n    this.settingsMenu.appendChild(keyboardDragOption);\n    this.settingsMenu.appendChild(resizeOption);\n    this.settingsMenu.appendChild(styleOption);\n    this.settingsMenu.appendChild(showTimestampsOption);\n    this.settingsMenu.appendChild(closeOption);\n\n    // Position menu first (before it's visible) to prevent jumping\n    // Set menu to invisible temporarily\n    this.settingsMenu.style.visibility = 'hidden';\n    this.settingsMenu.style.display = 'block';\n    \n    // Insert menu right after settings button for proper positioning\n    if (this.settingsButton && this.settingsButton.parentNode) {\n      this.settingsButton.insertAdjacentElement('afterend', this.settingsMenu);\n    } else if (this.headerLeft) {\n      this.headerLeft.appendChild(this.settingsMenu);\n    } else if (this.transcriptHeader) {\n      this.transcriptHeader.appendChild(this.settingsMenu);\n    } else {\n      this.transcriptWindow.appendChild(this.settingsMenu);\n    }\n    \n    // Position the menu relative to the settings button (immediately while hidden)\n    this.positionSettingsMenuImmediate();\n    \n    // Make menu visible after positioning\n    requestAnimationFrame(() => {\n      if (this.settingsMenu) {\n        this.settingsMenu.style.visibility = 'visible';\n      }\n    });\n    \n    // Add keyboard navigation\n    this.settingsMenuKeyHandler = attachMenuKeyboardNavigation(\n      this.settingsMenu,\n      this.settingsButton,\n      `.${this.player.options.classPrefix}-transcript-settings-item`,\n      () => this.hideSettingsMenu({ focusButton: true })\n    );\n    \n    // Set the menu as visible and display it\n    this.settingsMenuVisible = true;\n    this.settingsMenu.style.display = 'block';\n    \n    // Update aria-expanded\n    if (this.settingsButton) {\n      this.settingsButton.setAttribute('aria-expanded', 'true');\n    }\n    this.updateResizeOptionState();\n    \n    // Focus first menu item after visibility is set\n    setTimeout(() => {\n      const menuItems = this.settingsMenu.querySelectorAll(`.${this.player.options.classPrefix}-transcript-settings-item`);\n      if (menuItems.length > 0) {\n        menuItems[0].setAttribute('tabindex', '0');\n        for (let i = 1; i < menuItems.length; i++) {\n          menuItems[i].setAttribute('tabindex', '-1');\n        }\n        menuItems[0].focus({ preventScroll: true });\n      }\n    }, 50);\n  }\n\n  /**\n   * Position settings menu relative to settings button (immediate/synchronous)\n   */\n  positionSettingsMenuImmediate() {\n    if (!this.settingsMenu || !this.settingsButton) return;\n    \n    // Get the parent container (header-left) which has position: relative\n    const container = this.settingsButton.parentElement;\n    if (!container) return;\n    \n    // Position immediately (synchronously) - used when menu is first shown\n    const buttonRect = this.settingsButton.getBoundingClientRect();\n    const containerRect = container.getBoundingClientRect();\n    const menuRect = this.settingsMenu.getBoundingClientRect();\n    const viewportHeight = window.innerHeight;\n    \n    // Calculate position relative to the container\n    const buttonLeft = buttonRect.left - containerRect.left;\n    const buttonBottom = buttonRect.bottom - containerRect.top;\n    const buttonTop = buttonRect.top - containerRect.top;\n    \n    const spaceBelow = viewportHeight - buttonRect.bottom;\n    const spaceAbove = buttonRect.top;\n    \n    // Position menu below button by default (left-aligned with button)\n    let menuTop = buttonBottom + 4;\n    \n    // Check if we should position above instead\n    if (spaceBelow < menuRect.height + 20 && spaceAbove > spaceBelow) {\n      // Position above the button\n      menuTop = buttonTop - menuRect.height - 4;\n      this.settingsMenu.classList.add('vidply-menu-above');\n    } else {\n      this.settingsMenu.classList.remove('vidply-menu-above');\n    }\n    \n    // Apply positions (left-aligned with button)\n    this.settingsMenu.style.top = `${menuTop}px`;\n    this.settingsMenu.style.left = `${buttonLeft}px`;\n    this.settingsMenu.style.right = 'auto';\n    this.settingsMenu.style.bottom = 'auto';\n  }\n  \n  /**\n   * Position settings menu relative to settings button (async for repositioning)\n   */\n  positionSettingsMenu() {\n    if (!this.settingsMenu || !this.settingsButton) return;\n    \n    // Use requestAnimationFrame to ensure layout is stable before positioning (for repositioning)\n    requestAnimationFrame(() => {\n      setTimeout(() => {\n        this.positionSettingsMenuImmediate();\n      }, 10); // Small delay to ensure layout is stable\n    });\n  }\n\n  /**\n   * Attach keyboard navigation to settings menu\n   */\n  attachSettingsMenuKeyboardNavigation() {\n    if (!this.settingsMenu) return;\n    \n    // Remove existing handler if any\n    if (this.settingsMenuKeyHandler) {\n      this.settingsMenu.removeEventListener('keydown', this.settingsMenuKeyHandler, true);\n    }\n    \n    const handler = attachMenuKeyboardNavigation(\n      this.settingsMenu,\n      this.settingsButton,\n      `.${this.player.options.classPrefix}-transcript-settings-item`,\n      () => this.hideSettingsMenu({ focusButton: true })\n    );\n    \n    // Store the handler reference\n    this.settingsMenuKeyHandler = handler;\n    \n  }\n\n  /**\n   * Hide settings menu\n   */\n  hideSettingsMenu({ focusButton = true } = {}) {\n    if (this.settingsMenu) {\n      this.settingsMenu.style.display = 'none';\n      this.settingsMenuVisible = false;\n      this.settingsMenuJustOpened = false;\n      \n      // Remove keyboard handler to prevent duplicate listeners\n      if (this.settingsMenuKeyHandler) {\n        this.settingsMenu.removeEventListener('keydown', this.settingsMenuKeyHandler, true);\n        this.settingsMenuKeyHandler = null;\n      }\n      \n      // Update aria-expanded\n      if (this.settingsButton) {\n        this.settingsButton.setAttribute('aria-expanded', 'false');\n        if (focusButton) {\n          // Return focus to settings button\n          this.settingsButton.focus({ preventScroll: true });\n        }\n      }\n    }\n  }\n\n  /**\n   * Enable move mode (gives visual feedback)\n   */\n  enableMoveMode() {\n    this.hideResizeModeIndicator();\n\n    // Add visual feedback for move mode\n    this.transcriptWindow.classList.add(`${this.player.options.classPrefix}-transcript-move-mode`);\n    \n    // Show tooltip about keyboard drag option\n    const tooltip = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-move-tooltip`,\n      textContent: 'Drag with mouse or press D for keyboard drag mode'\n    });\n    this.transcriptHeader.appendChild(tooltip);\n    \n    // Remove after 2 seconds\n    setTimeout(() => {\n      this.transcriptWindow.classList.remove(`${this.player.options.classPrefix}-transcript-move-mode`);\n      if (tooltip.parentNode) {\n        tooltip.remove();\n      }\n    }, 2000);\n  }\n\n  /**\n   * Toggle resize mode\n   */\n  toggleResizeMode({ focus = true } = {}) {\n    if (!this.draggableResizable) {\n      return false;\n    }\n\n    if (this.draggableResizable.pointerResizeMode) {\n      this.draggableResizable.disablePointerResizeMode({ focus });\n      return false;\n    }\n\n    this.draggableResizable.enablePointerResizeMode({ focus });\n    return true;\n  }\n\n  updateDragOptionState() {\n    if (!this.dragOptionButton) {\n      return;\n    }\n    \n    const isEnabled = !!(this.draggableResizable && this.draggableResizable.keyboardDragMode);\n    const text = isEnabled\n      ? i18n.t('transcript.disableDragMode')\n      : i18n.t('transcript.enableDragMode');\n    const ariaLabel = isEnabled\n      ? i18n.t('transcript.disableDragModeAria')\n      : i18n.t('transcript.enableDragModeAria');\n\n    this.dragOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\n    this.dragOptionButton.setAttribute('aria-label', ariaLabel);\n\n    if (this.dragOptionText) {\n      this.dragOptionText.textContent = text;\n    }\n  }\n\n  updateResizeOptionState() {\n    if (!this.resizeOptionButton) {\n      return;\n    }\n    \n    const isEnabled = !!(this.draggableResizable && this.draggableResizable.pointerResizeMode);\n    const text = isEnabled\n      ? i18n.t('transcript.disableResizeMode')\n      : i18n.t('transcript.enableResizeMode');\n    const ariaLabel = isEnabled\n      ? i18n.t('transcript.disableResizeModeAria')\n      : i18n.t('transcript.enableResizeModeAria');\n\n    this.resizeOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\n    this.resizeOptionButton.setAttribute('aria-label', ariaLabel);\n\n    if (this.resizeOptionText) {\n      this.resizeOptionText.textContent = text;\n    }\n  }\n\n  toggleShowTimestamps() {\n    this.showTimestamps = !this.showTimestamps;\n    this.updateShowTimestampsState();\n    this.updateTimestampVisibility();\n    this.saveTimestampsPreference();\n  }\n\n  updateShowTimestampsState() {\n    if (!this.showTimestampsButton) {\n      return;\n    }\n    \n    const text = this.showTimestamps\n      ? i18n.t('transcript.hideTimestamps')\n      : i18n.t('transcript.showTimestamps');\n    const ariaLabel = this.showTimestamps\n      ? i18n.t('transcript.hideTimestampsAria')\n      : i18n.t('transcript.showTimestampsAria');\n\n    this.showTimestampsButton.setAttribute('aria-checked', this.showTimestamps ? 'true' : 'false');\n    this.showTimestampsButton.setAttribute('aria-label', ariaLabel);\n\n    if (this.showTimestampsText) {\n      this.showTimestampsText.textContent = text;\n    }\n  }\n\n  updateTimestampVisibility() {\n    if (!this.transcriptContent) return;\n    \n    const timestamps = this.transcriptContent.querySelectorAll(`.${this.player.options.classPrefix}-transcript-time`);\n    timestamps.forEach(timestamp => {\n      timestamp.style.display = this.showTimestamps ? '' : 'none';\n    });\n  }\n\n  saveTimestampsPreference() {\n    const savedPreferences = this.storage.getTranscriptPreferences() || {};\n    savedPreferences.showTimestamps = this.showTimestamps;\n    this.storage.saveTranscriptPreferences(savedPreferences);\n  }\n\n  showResizeModeIndicator() {\n    if (!this.transcriptHeader) {\n      return;\n    }\n\n    this.hideResizeModeIndicator();\n\n    const indicator = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-resize-tooltip`,\n      textContent: i18n.t('transcript.resizeModeHint') || 'Resize handles enabled. Drag edges or corners to adjust. Press Esc or R to exit.'\n    });\n\n    this.transcriptHeader.appendChild(indicator);\n    this.resizeModeIndicator = indicator;\n\n    this.resizeModeIndicatorTimeout = this.setManagedTimeout(() => {\n      this.hideResizeModeIndicator();\n    }, 3000);\n  }\n\n  hideResizeModeIndicator() {\n    if (this.resizeModeIndicatorTimeout) {\n      this.clearManagedTimeout(this.resizeModeIndicatorTimeout);\n      this.resizeModeIndicatorTimeout = null;\n    }\n\n    if (this.resizeModeIndicator && this.resizeModeIndicator.parentNode) {\n      this.resizeModeIndicator.remove();\n    }\n\n    this.resizeModeIndicator = null;\n  }\n\n  onPointerResizeModeChange(enabled) {\n    this.updateResizeOptionState();\n\n    if (enabled) {\n      this.showResizeModeIndicator();\n      this.announceLive(i18n.t('transcript.resizeModeEnabled'));\n    } else {\n      this.hideResizeModeIndicator();\n      this.announceLive(i18n.t('transcript.resizeModeDisabled'));\n    }\n  }\n\n  /**\n   * Show style dialog\n   */\n  showStyleDialog() {\n    // If dialog already exists, just show it\n    if (this.styleDialog) {\n      this.styleDialog.style.display = 'block';\n      this.styleDialogVisible = true;\n      \n      // Re-add keyboard handler\n      if (this.handlers.styleDialogKeydown) {\n        document.addEventListener('keydown', this.handlers.styleDialogKeydown);\n      }\n      \n      // Set flag to prevent immediate closing from document click\n      this.styleDialogJustOpened = true;\n      setTimeout(() => {\n        this.styleDialogJustOpened = false;\n      }, 350);\n      \n      // Focus first control\n      setTimeout(() => {\n        const firstSelect = this.styleDialog.querySelector('select, input');\n        if (firstSelect) {\n          firstSelect.focus({ preventScroll: true });\n        }\n      }, 0);\n      return;\n    }\n\n    // Create style dialog\n    this.styleDialog = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-style-dialog`\n    });\n\n    // Dialog title\n    const title = DOMUtils.createElement('h4', {\n      textContent: i18n.t('transcript.styleTitle'),\n      className: `${this.player.options.classPrefix}-transcript-style-title`\n    });\n    this.styleDialog.appendChild(title);\n\n    // Font Size\n    const fontSizeControl = this.createStyleSelectControl(\n      i18n.t('captions.fontSize'),\n      'fontSize',\n      [\n        { label: i18n.t('fontSizes.small'), value: '90%' },\n        { label: i18n.t('fontSizes.normal'), value: '100%' },\n        { label: i18n.t('fontSizes.large'), value: '110%' },\n        { label: i18n.t('fontSizes.xlarge'), value: '120%' }\n      ]\n    );\n    this.styleDialog.appendChild(fontSizeControl);\n\n    // Font Family\n    const fontFamilyControl = this.createStyleSelectControl(\n      i18n.t('captions.fontFamily'),\n      'fontFamily',\n      [\n        { label: i18n.t('fontFamilies.sansSerif'), value: 'sans-serif' },\n        { label: i18n.t('fontFamilies.serif'), value: 'serif' },\n        { label: i18n.t('fontFamilies.monospace'), value: 'monospace' }\n      ]\n    );\n    this.styleDialog.appendChild(fontFamilyControl);\n\n    // Text Color\n    const colorControl = this.createStyleColorControl(i18n.t('captions.color'), 'color');\n    this.styleDialog.appendChild(colorControl);\n\n    // Background Color\n    const bgColorControl = this.createStyleColorControl(i18n.t('captions.backgroundColor'), 'backgroundColor');\n    this.styleDialog.appendChild(bgColorControl);\n\n    // Opacity\n    const opacityControl = this.createStyleOpacityControl(i18n.t('captions.opacity'), 'opacity');\n    this.styleDialog.appendChild(opacityControl);\n\n    // Close button\n    const closeBtn = DOMUtils.createElement('button', {\n      className: `${this.player.options.classPrefix}-transcript-style-close`,\n      textContent: i18n.t('settings.close'),\n      attributes: {\n        'type': 'button'\n      }\n    });\n    closeBtn.addEventListener('click', () => this.hideStyleDialog());\n    this.styleDialog.appendChild(closeBtn);\n\n    // Keyboard navigation for style dialog\n    this.handlers.styleDialogKeydown = (e) => {\n      // Only handle keys when dialog is visible\n      if (!this.styleDialogVisible) return;\n      \n      // ESC to close\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        e.stopPropagation();\n        this.hideStyleDialog();\n        return;\n      }\n      \n      // Tab navigation (allow default behavior but trap focus)\n      if (e.key === 'Tab') {\n        // Get all focusable elements\n        const focusableElements = this.styleDialog.querySelectorAll(\n          'select, input, button'\n        );\n        const firstElement = focusableElements[0];\n        const lastElement = focusableElements[focusableElements.length - 1];\n        \n        // Trap focus within dialog\n        if (e.shiftKey && document.activeElement === firstElement) {\n          e.preventDefault();\n          lastElement.focus({ preventScroll: true });\n        } else if (!e.shiftKey && document.activeElement === lastElement) {\n          e.preventDefault();\n          firstElement.focus({ preventScroll: true });\n        }\n      }\n    };\n    document.addEventListener('keydown', this.handlers.styleDialogKeydown);\n\n    // Append to header left container (same as settings menu) for correct positioning\n    if (this.headerLeft) {\n      this.headerLeft.appendChild(this.styleDialog);\n    } else {\n      this.transcriptHeader.appendChild(this.styleDialog);\n    }\n    \n    // Apply current styles\n    this.applyTranscriptStyles();\n    \n    // Important: Set visible state and display before focusing\n    this.styleDialogVisible = true;\n    this.styleDialog.style.display = 'block';\n    \n    // Set flag to prevent immediate closing from document click\n    this.styleDialogJustOpened = true;\n    setTimeout(() => {\n      this.styleDialogJustOpened = false;\n    }, 350);\n    \n    // Focus first control for keyboard accessibility\n    setTimeout(() => {\n      const firstSelect = this.styleDialog.querySelector('select, input');\n      if (firstSelect) {\n        firstSelect.focus({ preventScroll: true });\n      }\n    }, 0);\n  }\n\n  /**\n   * Hide style dialog\n   */\n  hideStyleDialog() {\n    if (this.styleDialog) {\n      this.styleDialog.style.display = 'none';\n      this.styleDialogVisible = false;\n      \n      // Remove keyboard handler\n      if (this.handlers.styleDialogKeydown) {\n        document.removeEventListener('keydown', this.handlers.styleDialogKeydown);\n      }\n      \n      // Return focus to settings button\n      if (this.settingsButton) {\n        this.settingsButton.focus({ preventScroll: true });\n      }\n    }\n  }\n\n  /**\n   * Create style select control\n   */\n  createStyleSelectControl(label, property, options) {\n    const group = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-style-group`\n    });\n\n    // Generate unique ID for the control\n    const controlId = `${this.player.options.classPrefix}-transcript-${property}-${Date.now()}`;\n\n    const labelEl = DOMUtils.createElement('label', {\n      textContent: label,\n      attributes: {\n        'for': controlId\n      }\n    });\n    group.appendChild(labelEl);\n\n    const select = DOMUtils.createElement('select', {\n      className: `${this.player.options.classPrefix}-transcript-style-select`,\n      attributes: {\n        'id': controlId\n      }\n    });\n\n    options.forEach(opt => {\n      const option = DOMUtils.createElement('option', {\n        textContent: opt.label,\n        attributes: {\n          'value': opt.value\n        }\n      });\n      if (this.transcriptStyle[property] === opt.value) {\n        option.selected = true;\n      }\n      select.appendChild(option);\n    });\n\n    select.addEventListener('change', (e) => {\n      this.transcriptStyle[property] = e.target.value;\n      this.applyTranscriptStyles();\n      this.savePreferences();\n    });\n\n    group.appendChild(select);\n    return group;\n  }\n\n  /**\n   * Create style color control\n   */\n  createStyleColorControl(label, property) {\n    const group = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-style-group`\n    });\n\n    // Generate unique ID for the control\n    const controlId = `${this.player.options.classPrefix}-transcript-${property}-${Date.now()}`;\n\n    const labelEl = DOMUtils.createElement('label', {\n      textContent: label,\n      attributes: {\n        'for': controlId\n      }\n    });\n    group.appendChild(labelEl);\n\n    const input = DOMUtils.createElement('input', {\n      attributes: {\n        'id': controlId,\n        'type': 'color',\n        'value': this.transcriptStyle[property]\n      },\n      className: `${this.player.options.classPrefix}-transcript-style-color`\n    });\n\n    input.addEventListener('input', (e) => {\n      this.transcriptStyle[property] = e.target.value;\n      this.applyTranscriptStyles();\n      this.savePreferences();\n    });\n\n    group.appendChild(input);\n    return group;\n  }\n\n  /**\n   * Create style opacity control\n   */\n  createStyleOpacityControl(label, property) {\n    const group = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-style-group`\n    });\n\n    // Generate unique ID for the control\n    const controlId = `${this.player.options.classPrefix}-transcript-${property}-${Date.now()}`;\n\n    const labelEl = DOMUtils.createElement('label', {\n      textContent: label,\n      attributes: {\n        'for': controlId\n      }\n    });\n    group.appendChild(labelEl);\n\n    const valueDisplay = DOMUtils.createElement('span', {\n      textContent: Math.round(this.transcriptStyle[property] * 100) + '%',\n      className: `${this.player.options.classPrefix}-transcript-style-value`\n    });\n\n    const input = DOMUtils.createElement('input', {\n      attributes: {\n        'id': controlId,\n        'type': 'range',\n        'min': '0',\n        'max': '1',\n        'step': '0.1',\n        'value': String(this.transcriptStyle[property])\n      },\n      className: `${this.player.options.classPrefix}-transcript-style-range`\n    });\n\n    input.addEventListener('input', (e) => {\n      const value = parseFloat(e.target.value);\n      this.transcriptStyle[property] = value;\n      valueDisplay.textContent = Math.round(value * 100) + '%';\n      this.applyTranscriptStyles();\n      this.savePreferences();\n    });\n\n    const inputContainer = DOMUtils.createElement('div', {\n      className: `${this.player.options.classPrefix}-transcript-style-range-container`\n    });\n    inputContainer.appendChild(input);\n    inputContainer.appendChild(valueDisplay);\n\n    group.appendChild(labelEl);\n    group.appendChild(inputContainer);\n    return group;\n  }\n\n  /**\n   * Save transcript preferences to localStorage\n   */\n  savePreferences() {\n    this.storage.saveTranscriptPreferences(this.transcriptStyle);\n  }\n\n  /**\n   * Apply transcript styles\n   */\n  applyTranscriptStyles() {\n    if (!this.transcriptWindow) return;\n\n    // Apply to transcript window background\n    this.transcriptWindow.style.backgroundColor = this.transcriptStyle.backgroundColor;\n    this.transcriptWindow.style.opacity = String(this.transcriptStyle.opacity);\n\n    // Apply to content area\n    if (this.transcriptContent) {\n      this.transcriptContent.style.fontSize = this.transcriptStyle.fontSize;\n      this.transcriptContent.style.fontFamily = this.transcriptStyle.fontFamily;\n      this.transcriptContent.style.color = this.transcriptStyle.color;\n    }\n\n    // Apply to all text entries (important: override CSS defaults)\n    const textEntries = this.transcriptWindow.querySelectorAll(`.${this.player.options.classPrefix}-transcript-text`);\n    textEntries.forEach(entry => {\n      entry.style.fontSize = this.transcriptStyle.fontSize;\n      entry.style.fontFamily = this.transcriptStyle.fontFamily;\n      entry.style.color = this.transcriptStyle.color;\n    });\n    \n    // Apply to timestamp entries as well\n    const timeEntries = this.transcriptWindow.querySelectorAll(`.${this.player.options.classPrefix}-transcript-time`);\n    timeEntries.forEach(entry => {\n      entry.style.fontFamily = this.transcriptStyle.fontFamily;\n    });\n  }\n\n  /**\n   * Set a managed timeout that will be cleaned up on destroy\n   * @param {Function} callback - Callback function\n   * @param {number} delay - Delay in milliseconds\n   * @returns {number} Timeout ID\n   */\n  setManagedTimeout(callback, delay) {\n    const timeoutId = setTimeout(() => {\n      this.timeouts.delete(timeoutId);\n      callback();\n    }, delay);\n    this.timeouts.add(timeoutId);\n    return timeoutId;\n  }\n\n  /**\n   * Clear a managed timeout\n   * @param {number} timeoutId - Timeout ID to clear\n   */\n  clearManagedTimeout(timeoutId) {\n    if (timeoutId) {\n      clearTimeout(timeoutId);\n      this.timeouts.delete(timeoutId);\n    }\n  }\n\n  /**\n   * Cleanup\n   */\n  destroy() {\n    this.hideResizeModeIndicator();\n    \n    // Destroy draggableResizable utility\n    if (this.draggableResizable) {\n      if (this.draggableResizable.pointerResizeMode) {\n        this.draggableResizable.disablePointerResizeMode();\n        this.updateResizeOptionState();\n      }\n      this.draggableResizable.destroy();\n      this.draggableResizable = null;\n    }\n    \n    // Remove custom key handler\n    if (this.transcriptWindow && this.customKeyHandler) {\n      this.transcriptWindow.removeEventListener('keydown', this.customKeyHandler);\n      this.customKeyHandler = null;\n    }\n\n    // Remove timeupdate listener from player\n    if (this.handlers.timeupdate) {\n      this.player.off('timeupdate', this.handlers.timeupdate);\n    }\n    \n    // Remove audio description listeners from player\n    if (this.handlers.audiodescriptionenabled) {\n      this.player.off('audiodescriptionenabled', this.handlers.audiodescriptionenabled);\n    }\n    if (this.handlers.audiodescriptiondisabled) {\n      this.player.off('audiodescriptiondisabled', this.handlers.audiodescriptiondisabled);\n    }\n    \n    // Remove settings button event listeners\n    if (this.settingsButton) {\n      if (this.handlers.settingsClick) {\n        this.settingsButton.removeEventListener('click', this.handlers.settingsClick);\n      }\n      if (this.handlers.settingsKeydown) {\n        this.settingsButton.removeEventListener('keydown', this.handlers.settingsKeydown);\n      }\n    }\n    \n    // Remove style dialog event listeners\n    if (this.handlers.styleDialogKeydown) {\n      document.removeEventListener('keydown', this.handlers.styleDialogKeydown);\n    }\n\n    // Remove document click listener\n    if (this.handlers.documentClick) {\n      document.removeEventListener('click', this.handlers.documentClick);\n    }\n    \n    // Remove window-level listeners\n    if (this.handlers.resize) {\n      window.removeEventListener('resize', this.handlers.resize);\n    }\n\n    // Cleanup all managed timeouts\n    this.timeouts.forEach(timeoutId => clearTimeout(timeoutId));\n    this.timeouts.clear();\n\n    // Clear handlers\n    this.handlers = null;\n\n    // Remove DOM element\n    if (this.transcriptWindow && this.transcriptWindow.parentNode) {\n      this.transcriptWindow.parentNode.removeChild(this.transcriptWindow);\n    }\n    \n    this.transcriptWindow = null;\n    this.transcriptHeader = null;\n    this.transcriptContent = null;\n    this.transcriptEntries = [];\n    this.settingsMenu = null;\n    this.styleDialog = null;\n    this.transcriptResizeHandles = [];\n    this.resizeOptionButton = null;\n    this.resizeOptionText = null;\n    this.liveRegion = null;\n  }\n\n  announceLive(message) {\n    if (!this.liveRegion) return;\n    this.liveRegion.textContent = message || '';\n  }\n}\n", "/**\r\n * YouTube Renderer\r\n */\r\n\r\nexport class YouTubeRenderer {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.youtube = null;\r\n    this.videoId = null;\r\n    this.isReady = false;\r\n    this.iframe = null;\r\n  }\r\n\r\n  async init() {\r\n    // Extract video ID from URL - use currentSource which works for external renderers\r\n    const src = this.player.currentSource || this.player.element.src;\r\n    this.videoId = this.extractVideoId(src);\r\n    \r\n    if (!this.videoId) {\r\n      throw new Error('Invalid YouTube URL');\r\n    }\r\n\r\n    // Load YouTube IFrame API\r\n    await this.loadYouTubeAPI();\r\n\r\n    // Create iframe\r\n    this.createIframe();\r\n\r\n    // Initialize player\r\n    await this.initializePlayer();\r\n  }\r\n\r\n  extractVideoId(url) {\r\n    const patterns = [\r\n      /(?:youtube\\.com\\/watch\\?v=|youtu\\.be\\/)([^&\\s]+)/,\r\n      /youtube\\.com\\/embed\\/([^&\\s]+)/\r\n    ];\r\n\r\n    for (const pattern of patterns) {\r\n      const match = url.match(pattern);\r\n      if (match && match[1]) {\r\n        return match[1];\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  async loadYouTubeAPI() {\r\n    // Check if API is already loaded\r\n    if (window.YT && window.YT.Player) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      // Check if script is already being loaded\r\n      if (window.onYouTubeIframeAPIReady) {\r\n        const originalCallback = window.onYouTubeIframeAPIReady;\r\n        window.onYouTubeIframeAPIReady = () => {\r\n          originalCallback();\r\n          resolve();\r\n        };\r\n        return;\r\n      }\r\n\r\n      // Load the API script\r\n      const tag = document.createElement('script');\r\n      tag.src = 'https://www.youtube.com/iframe_api';\r\n      \r\n      window.onYouTubeIframeAPIReady = () => {\r\n        resolve();\r\n      };\r\n\r\n      tag.onerror = () => reject(new Error('Failed to load YouTube API'));\r\n      \r\n      const firstScriptTag = document.getElementsByTagName('script')[0];\r\n      firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);\r\n    });\r\n  }\r\n\r\n  createIframe() {\r\n    // Hide original element\r\n    this.player.element.style.display = 'none';\r\n\r\n    // Create container for iframe\r\n    this.iframe = document.createElement('div');\r\n    this.iframe.id = `youtube-player-${Math.random().toString(36).substr(2, 9)}`;\r\n    this.iframe.style.width = '100%';\r\n    this.iframe.style.maxHeight = '100%';\r\n    \r\n    this.player.element.parentNode.insertBefore(this.iframe, this.player.element);\r\n  }\r\n\r\n  async initializePlayer() {\r\n    return new Promise((resolve) => {\r\n      this.youtube = new window.YT.Player(this.iframe.id, {\r\n        videoId: this.videoId,\r\n        width: '100%',\r\n        height: '100%',\r\n        playerVars: {\r\n          controls: 1, // Use YouTube native controls\r\n          disablekb: 0, // Allow keyboard controls\r\n          fs: 1, // Allow fullscreen\r\n          modestbranding: 1,\r\n          rel: 0,\r\n          showinfo: 0,\r\n          iv_load_policy: 3,\r\n          autoplay: this.player.options.autoplay ? 1 : 0,\r\n          mute: this.player.options.muted ? 1 : 0,\r\n          start: this.player.options.startTime || 0\r\n        },\r\n        events: {\r\n          onReady: (event) => {\r\n            this.isReady = true;\r\n            this.attachEvents();\r\n            // Hide VidPly controls - YouTube has its own\r\n            if (this.player.container) {\r\n              this.player.container.classList.add('vidply-external-controls');\r\n            }\r\n            resolve();\r\n          },\r\n          onStateChange: (event) => this.handleStateChange(event),\r\n          onError: (event) => this.handleError(event)\r\n        }\r\n      });\r\n    });\r\n  }\r\n\r\n  attachEvents() {\r\n    // Set up polling for time updates (YouTube doesn't provide timeupdate events)\r\n    this.timeUpdateInterval = setInterval(() => {\r\n      if (this.isReady && this.youtube) {\r\n        const currentTime = this.youtube.getCurrentTime();\r\n        const duration = this.youtube.getDuration();\r\n        \r\n        this.player.state.currentTime = currentTime;\r\n        this.player.state.duration = duration;\r\n        \r\n        this.player.emit('timeupdate', currentTime);\r\n      }\r\n    }, 250);\r\n\r\n    // Initial metadata\r\n    if (this.youtube.getDuration) {\r\n      this.player.state.duration = this.youtube.getDuration();\r\n      this.player.emit('loadedmetadata');\r\n    }\r\n  }\r\n\r\n  handleStateChange(event) {\r\n    const states = window.YT.PlayerState;\r\n\r\n    switch (event.data) {\r\n      case states.PLAYING:\r\n        this.player.state.playing = true;\r\n        this.player.state.paused = false;\r\n        this.player.state.ended = false;\r\n        this.player.state.buffering = false;\r\n        this.player.emit('play');\r\n        this.player.emit('playing');\r\n        \r\n        if (this.player.options.onPlay) {\r\n          this.player.options.onPlay.call(this.player);\r\n        }\r\n        break;\r\n\r\n      case states.PAUSED:\r\n        this.player.state.playing = false;\r\n        this.player.state.paused = true;\r\n        this.player.emit('pause');\r\n        \r\n        if (this.player.options.onPause) {\r\n          this.player.options.onPause.call(this.player);\r\n        }\r\n        break;\r\n\r\n      case states.ENDED:\r\n        this.player.state.playing = false;\r\n        this.player.state.paused = true;\r\n        this.player.state.ended = true;\r\n        this.player.emit('ended');\r\n        \r\n        if (this.player.options.onEnded) {\r\n          this.player.options.onEnded.call(this.player);\r\n        }\r\n        \r\n        if (this.player.options.loop) {\r\n          this.youtube.seekTo(0);\r\n          this.youtube.playVideo();\r\n        }\r\n        break;\r\n\r\n      case states.BUFFERING:\r\n        this.player.state.buffering = true;\r\n        this.player.emit('waiting');\r\n        break;\r\n\r\n      case states.CUED:\r\n        this.player.emit('loadedmetadata');\r\n        break;\r\n    }\r\n  }\r\n\r\n  handleError(event) {\r\n    const errors = {\r\n      2: 'Invalid video ID',\r\n      5: 'HTML5 player error',\r\n      100: 'Video not found',\r\n      101: 'Video not allowed to be played in embedded players',\r\n      150: 'Video not allowed to be played in embedded players'\r\n    };\r\n\r\n    const error = new Error(errors[event.data] || 'YouTube player error');\r\n    this.player.handleError(error);\r\n  }\r\n\r\n  play() {\r\n    if (this.isReady && this.youtube) {\r\n      // Save scroll position to prevent browser from scrolling to video\r\n      const scrollX = window.scrollX;\r\n      const scrollY = window.scrollY;\r\n      \r\n      this.youtube.playVideo();\r\n      \r\n      // Restore scroll position immediately to prevent auto-scroll\r\n      window.scrollTo(scrollX, scrollY);\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if (this.isReady && this.youtube) {\r\n      this.youtube.pauseVideo();\r\n    }\r\n  }\r\n\r\n  seek(time) {\r\n    if (this.isReady && this.youtube) {\r\n      this.youtube.seekTo(time, true);\r\n    }\r\n  }\r\n\r\n  setVolume(volume) {\r\n    if (this.isReady && this.youtube) {\r\n      this.youtube.setVolume(volume * 100);\r\n      this.player.state.volume = volume;\r\n    }\r\n  }\r\n\r\n  setMuted(muted) {\r\n    if (this.isReady && this.youtube) {\r\n      if (muted) {\r\n        this.youtube.mute();\r\n      } else {\r\n        this.youtube.unMute();\r\n      }\r\n      this.player.state.muted = muted;\r\n    }\r\n  }\r\n\r\n  setPlaybackSpeed(speed) {\r\n    if (this.isReady && this.youtube) {\r\n      this.youtube.setPlaybackRate(speed);\r\n      this.player.state.playbackSpeed = speed;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    if (this.timeUpdateInterval) {\r\n      clearInterval(this.timeUpdateInterval);\r\n    }\r\n\r\n    if (this.youtube && this.youtube.destroy) {\r\n      this.youtube.destroy();\r\n    }\r\n\r\n    if (this.iframe && this.iframe.parentNode) {\r\n      this.iframe.parentNode.removeChild(this.iframe);\r\n    }\r\n\r\n    // Show original element\r\n    if (this.player.element) {\r\n      this.player.element.style.display = '';\r\n    }\r\n  }\r\n}\r\n\r\n", "/**\r\n * Vimeo Renderer\r\n */\r\n\r\nexport class VimeoRenderer {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.vimeo = null;\r\n    this.videoId = null;\r\n    this.isReady = false;\r\n    this.iframe = null;\r\n  }\r\n\r\n  async init() {\r\n    // Extract video ID from URL - use currentSource which works for external renderers\r\n    const src = this.player.currentSource || this.player.element.src;\r\n    this.videoId = this.extractVideoId(src);\r\n    \r\n    if (!this.videoId) {\r\n      throw new Error('Invalid Vimeo URL');\r\n    }\r\n\r\n    // Load Vimeo Player API\r\n    await this.loadVimeoAPI();\r\n\r\n    // Create iframe\r\n    this.createIframe();\r\n\r\n    // Initialize player\r\n    await this.initializePlayer();\r\n  }\r\n\r\n  extractVideoId(url) {\r\n    const patterns = [\r\n      /vimeo\\.com\\/(\\d+)/,\r\n      /vimeo\\.com\\/video\\/(\\d+)/,\r\n      /player\\.vimeo\\.com\\/video\\/(\\d+)/\r\n    ];\r\n\r\n    for (const pattern of patterns) {\r\n      const match = url.match(pattern);\r\n      if (match && match[1]) {\r\n        return match[1];\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  async loadVimeoAPI() {\r\n    // Check if API is already loaded\r\n    if (window.Vimeo && window.Vimeo.Player) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const script = document.createElement('script');\r\n      script.src = 'https://player.vimeo.com/api/player.js';\r\n      script.onload = () => resolve();\r\n      script.onerror = () => reject(new Error('Failed to load Vimeo API'));\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  createIframe() {\r\n    // Hide original element\r\n    this.player.element.style.display = 'none';\r\n\r\n    // Create container for iframe\r\n    this.iframe = document.createElement('div');\r\n    this.iframe.id = `vimeo-player-${Math.random().toString(36).substr(2, 9)}`;\r\n    this.iframe.style.width = '100%';\r\n    this.iframe.style.maxHeight = '100%';\r\n    \r\n    this.player.element.parentNode.insertBefore(this.iframe, this.player.element);\r\n  }\r\n\r\n  async initializePlayer() {\r\n    const options = {\r\n      id: this.videoId,\r\n      width: '100%',\r\n      height: '100%',\r\n      controls: true, // Use Vimeo native controls\r\n      autoplay: this.player.options.autoplay,\r\n      muted: this.player.options.muted,\r\n      loop: this.player.options.loop,\r\n      keyboard: false\r\n    };\r\n\r\n    if (this.player.options.startTime > 0) {\r\n      options.startTime = this.player.options.startTime;\r\n    }\r\n\r\n    this.vimeo = new window.Vimeo.Player(this.iframe.id, options);\r\n\r\n    // Wait for player to be ready\r\n    await this.vimeo.ready();\r\n    this.isReady = true;\r\n    \r\n    // Ensure the iframe has 100% width and height\r\n    const vimeoIframe = this.iframe.querySelector('iframe');\r\n    if (vimeoIframe) {\r\n      vimeoIframe.style.width = '100%';\r\n      vimeoIframe.style.height = '100%';\r\n      vimeoIframe.setAttribute('width', '100%');\r\n      vimeoIframe.setAttribute('height', '100%');\r\n    }\r\n    \r\n    // Hide VidPly controls - Vimeo has its own\r\n    if (this.player.container) {\r\n      this.player.container.classList.add('vidply-external-controls');\r\n    }\r\n\r\n    this.attachEvents();\r\n\r\n    // Get initial duration\r\n    try {\r\n      const duration = await this.vimeo.getDuration();\r\n      this.player.state.duration = duration;\r\n      this.player.emit('loadedmetadata');\r\n    } catch (error) {\r\n      this.player.log('Error getting duration:', error, 'warn');\r\n    }\r\n  }\r\n\r\n  attachEvents() {\r\n    this.vimeo.on('play', () => {\r\n      this.player.state.playing = true;\r\n      this.player.state.paused = false;\r\n      this.player.state.ended = false;\r\n      this.player.emit('play');\r\n      \r\n      if (this.player.options.onPlay) {\r\n        this.player.options.onPlay.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('pause', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.emit('pause');\r\n      \r\n      if (this.player.options.onPause) {\r\n        this.player.options.onPause.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('ended', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.state.ended = true;\r\n      this.player.emit('ended');\r\n      \r\n      if (this.player.options.onEnded) {\r\n        this.player.options.onEnded.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('timeupdate', (data) => {\r\n      this.player.state.currentTime = data.seconds;\r\n      this.player.state.duration = data.duration;\r\n      this.player.emit('timeupdate', data.seconds);\r\n      \r\n      if (this.player.options.onTimeUpdate) {\r\n        this.player.options.onTimeUpdate.call(this.player, data.seconds);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('volumechange', (data) => {\r\n      this.player.state.volume = data.volume;\r\n      this.player.emit('volumechange', data.volume);\r\n    });\r\n\r\n    this.vimeo.on('bufferstart', () => {\r\n      this.player.state.buffering = true;\r\n      this.player.emit('waiting');\r\n    });\r\n\r\n    this.vimeo.on('bufferend', () => {\r\n      this.player.state.buffering = false;\r\n      this.player.emit('canplay');\r\n    });\r\n\r\n    this.vimeo.on('seeking', () => {\r\n      this.player.state.seeking = true;\r\n      this.player.emit('seeking');\r\n    });\r\n\r\n    this.vimeo.on('seeked', () => {\r\n      this.player.state.seeking = false;\r\n      this.player.emit('seeked');\r\n    });\r\n\r\n    this.vimeo.on('playbackratechange', (data) => {\r\n      this.player.state.playbackSpeed = data.playbackRate;\r\n      this.player.emit('ratechange', data.playbackRate);\r\n    });\r\n\r\n    this.vimeo.on('error', (error) => {\r\n      this.player.handleError(new Error(`Vimeo error: ${error.message}`));\r\n    });\r\n  }\r\n\r\n  play() {\r\n    if (this.isReady && this.vimeo) {\r\n      // Save scroll position to prevent browser from scrolling to video\r\n      const scrollX = window.scrollX;\r\n      const scrollY = window.scrollY;\r\n      \r\n      this.vimeo.play().catch(error => {\r\n        this.player.log('Play error:', error, 'warn');\r\n      });\r\n      \r\n      // Restore scroll position immediately to prevent auto-scroll\r\n      window.scrollTo(scrollX, scrollY);\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.pause().catch(error => {\r\n        this.player.log('Pause error:', error, 'warn');\r\n      });\r\n    }\r\n  }\r\n\r\n  seek(time) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setCurrentTime(time).catch(error => {\r\n        this.player.log('Seek error:', error, 'warn');\r\n      });\r\n    }\r\n  }\r\n\r\n  setVolume(volume) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setVolume(volume).catch(error => {\r\n        this.player.log('Volume error:', error, 'warn');\r\n      });\r\n      this.player.state.volume = volume;\r\n    }\r\n  }\r\n\r\n  setMuted(muted) {\r\n    if (this.isReady && this.vimeo) {\r\n      if (muted) {\r\n        this.vimeo.setVolume(0);\r\n      } else {\r\n        this.vimeo.setVolume(this.player.state.volume);\r\n      }\r\n      this.player.state.muted = muted;\r\n    }\r\n  }\r\n\r\n  setPlaybackSpeed(speed) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setPlaybackRate(speed).catch(error => {\r\n        this.player.log('Playback rate error:', error, 'warn');\r\n      });\r\n      this.player.state.playbackSpeed = speed;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    if (this.vimeo && this.vimeo.destroy) {\r\n      this.vimeo.destroy();\r\n    }\r\n\r\n    if (this.iframe && this.iframe.parentNode) {\r\n      this.iframe.parentNode.removeChild(this.iframe);\r\n    }\r\n\r\n    // Show original element\r\n    if (this.player.element) {\r\n      this.player.element.style.display = '';\r\n    }\r\n  }\r\n}\r\n\r\n", "/**\r\n * HLS Streaming Renderer\r\n * Uses hls.js for browsers that don't natively support HLS\r\n */\r\n\r\nexport class HLSRenderer {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.media = player.element;\r\n    this.hls = null;\r\n    this._hlsSourceLoaded = false;\r\n    this._pendingSrc = null;\r\n  }\r\n\r\n  async init() {\r\n    // Check if browser natively supports HLS (Safari)\r\n    if (this.canPlayNatively()) {\r\n      this.player.log('Using native HLS support');\r\n      await this.initNative();\r\n    } else {\r\n      this.player.log('Using hls.js for HLS support');\r\n      await this.initHlsJs();\r\n    }\r\n  }\r\n\r\n  canPlayNatively() {\r\n    // Only use native HLS on Safari/iOS where it actually works properly\r\n    // Chrome reports it can play HLS but doesn't have proper quality switching\r\n    const isSafari = /^((?!chrome|android).)*safari/i.test(navigator.userAgent);\r\n    const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\r\n    \r\n    if (!isSafari && !isIOS) {\r\n      // Force hls.js on non-Safari browsers for proper quality switching\r\n      return false;\r\n    }\r\n    \r\n    const video = document.createElement('video');\r\n    return video.canPlayType('application/vnd.apple.mpegurl') !== '';\r\n  }\r\n\r\n  async initNative() {\r\n    // Use HTML5 renderer for native HLS support\r\n    const HTML5Renderer = (await import('./HTML5Renderer.js')).HTML5Renderer;\r\n    const renderer = new HTML5Renderer(this.player);\r\n    await renderer.init();\r\n    \r\n    // Copy methods\r\n    Object.getOwnPropertyNames(Object.getPrototypeOf(renderer)).forEach(method => {\r\n      if (method !== 'constructor' && typeof renderer[method] === 'function') {\r\n        this[method] = renderer[method].bind(renderer);\r\n      }\r\n    });\r\n  }\r\n\r\n  async initHlsJs() {\r\n    // Hide native controls\r\n    this.media.controls = false;\r\n    this.media.removeAttribute('controls');\r\n    \r\n    // Load hls.js if not already loaded\r\n    if (!window.Hls) {\r\n      await this.loadHlsJs();\r\n    }\r\n\r\n    if (!window.Hls.isSupported()) {\r\n      throw new Error('HLS is not supported in this browser');\r\n    }\r\n\r\n    // Create hls.js instance with better error recovery\r\n    this.hls = new window.Hls({\r\n      debug: this.player.options.debug,\r\n      // When deferLoad is enabled, do not start loading until the first play().\r\n      autoStartLoad: !this.player.options.deferLoad,\r\n      enableWorker: true,\r\n      lowLatencyMode: false,\r\n      backBufferLength: 90,\r\n      maxBufferLength: 30,\r\n      maxMaxBufferLength: 600,\r\n      maxBufferSize: 60 * 1000 * 1000,\r\n      maxBufferHole: 0.5,\r\n      // Network retry settings\r\n      manifestLoadingTimeOut: 10000,\r\n      manifestLoadingMaxRetry: 4,\r\n      manifestLoadingRetryDelay: 1000,\r\n      manifestLoadingMaxRetryTimeout: 64000,\r\n      levelLoadingTimeOut: 10000,\r\n      levelLoadingMaxRetry: 4,\r\n      levelLoadingRetryDelay: 1000,\r\n      levelLoadingMaxRetryTimeout: 64000,\r\n      fragLoadingTimeOut: 20000,\r\n      fragLoadingMaxRetry: 6,\r\n      fragLoadingRetryDelay: 1000,\r\n      fragLoadingMaxRetryTimeout: 64000\r\n    });\r\n\r\n    // Attach media element\r\n    this.hls.attachMedia(this.media);\r\n\r\n    // Load source - use currentSource for external renderers, or get from attribute\r\n    let src = this.player.currentSource;\r\n    \r\n    if (!src) {\r\n      const sourceElement = this.player.element.querySelector('source');\r\n      if (sourceElement) {\r\n        // Use getAttribute to get the original URL, not the blob-converted one\r\n        src = sourceElement.getAttribute('src');\r\n      } else {\r\n        // Fallback to element's src attribute\r\n        src = this.player.element.getAttribute('src') || this.player.element.src;\r\n      }\r\n    }\r\n    \r\n    this.player.log(`Loading HLS source: ${src}`, 'log');\r\n    \r\n    if (!src) {\r\n      throw new Error('No HLS source found');\r\n    }\r\n    \r\n    if (this.player.options.deferLoad) {\r\n      // Defer manifest/segment loading until first play()\r\n      this._pendingSrc = src;\r\n    } else {\r\n      this.hls.loadSource(src);\r\n      this._hlsSourceLoaded = true;\r\n    }\r\n\r\n    // Attach events\r\n    this.attachHlsEvents();\r\n    this.attachMediaEvents();\r\n  }\r\n\r\n  async loadHlsJs() {\r\n    return new Promise((resolve, reject) => {\r\n      const script = document.createElement('script');\r\n      script.src = 'https://cdn.jsdelivr.net/npm/hls.js@latest';\r\n      script.onload = () => resolve();\r\n      script.onerror = () => reject(new Error('Failed to load hls.js'));\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  attachHlsEvents() {\r\n    this.hls.on(window.Hls.Events.MANIFEST_PARSED, (event, data) => {\r\n      this.player.log('HLS manifest loaded, found ' + data.levels.length + ' quality levels');\r\n      this.player.emit('hlsmanifestparsed', data);\r\n      \r\n      // Show VidPly controls (remove external controls class if present)\r\n      if (this.player.container) {\r\n        this.player.container.classList.remove('vidply-external-controls');\r\n      }\r\n    });\r\n\r\n    this.hls.on(window.Hls.Events.LEVEL_SWITCHED, (event, data) => {\r\n      this.player.log('HLS level switched to ' + data.level);\r\n      this.player.emit('hlslevelswitched', data);\r\n    });\r\n\r\n    this.hls.on(window.Hls.Events.ERROR, (event, data) => {\r\n      this.handleHlsError(data);\r\n    });\r\n\r\n    this.hls.on(window.Hls.Events.FRAG_BUFFERED, () => {\r\n      this.player.state.buffering = false;\r\n    });\r\n  }\r\n\r\n  attachMediaEvents() {\r\n    // Use same events as HTML5 renderer\r\n    this.media.addEventListener('loadedmetadata', () => {\r\n      this.player.state.duration = this.media.duration;\r\n      this.player.emit('loadedmetadata');\r\n    });\r\n\r\n    this.media.addEventListener('play', () => {\r\n      this.player.state.playing = true;\r\n      this.player.state.paused = false;\r\n      this.player.state.ended = false;\r\n      this.player.emit('play');\r\n      \r\n      if (this.player.options.onPlay) {\r\n        this.player.options.onPlay.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.media.addEventListener('pause', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.emit('pause');\r\n      \r\n      if (this.player.options.onPause) {\r\n        this.player.options.onPause.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.media.addEventListener('ended', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.state.ended = true;\r\n      this.player.emit('ended');\r\n      \r\n      if (this.player.options.onEnded) {\r\n        this.player.options.onEnded.call(this.player);\r\n      }\r\n      \r\n      if (this.player.options.loop) {\r\n        this.player.seek(0);\r\n        this.player.play();\r\n      }\r\n    });\r\n\r\n    this.media.addEventListener('timeupdate', () => {\r\n      this.player.state.currentTime = this.media.currentTime;\r\n      this.player.emit('timeupdate', this.media.currentTime);\r\n      \r\n      if (this.player.options.onTimeUpdate) {\r\n        this.player.options.onTimeUpdate.call(this.player, this.media.currentTime);\r\n      }\r\n    });\r\n\r\n    this.media.addEventListener('volumechange', () => {\r\n      this.player.state.volume = this.media.volume;\r\n      this.player.state.muted = this.media.muted;\r\n      this.player.emit('volumechange', this.media.volume);\r\n    });\r\n\r\n    this.media.addEventListener('waiting', () => {\r\n      this.player.state.buffering = true;\r\n      this.player.emit('waiting');\r\n    });\r\n\r\n    this.media.addEventListener('canplay', () => {\r\n      this.player.state.buffering = false;\r\n      this.player.emit('canplay');\r\n    });\r\n\r\n    this.media.addEventListener('error', () => {\r\n      this.player.handleError(this.media.error);\r\n    });\r\n  }\r\n\r\n  handleHlsError(data) {\r\n    // Log detailed error info\r\n    this.player.log(`HLS Error - Type: ${data.type}, Details: ${data.details}, Fatal: ${data.fatal}`, 'warn');\r\n    if (data.response) {\r\n      this.player.log(`Response code: ${data.response.code}, URL: ${data.response.url}`, 'warn');\r\n    }\r\n    \r\n    if (data.fatal) {\r\n      switch (data.type) {\r\n        case window.Hls.ErrorTypes.NETWORK_ERROR:\r\n          this.player.log('Fatal network error, trying to recover...', 'error');\r\n          this.player.log(`Network error details: ${data.details}`, 'error');\r\n          setTimeout(() => {\r\n            this.hls.startLoad();\r\n          }, 1000);\r\n          break;\r\n          \r\n        case window.Hls.ErrorTypes.MEDIA_ERROR:\r\n          this.player.log('Fatal media error, trying to recover...', 'error');\r\n          this.hls.recoverMediaError();\r\n          break;\r\n          \r\n        default:\r\n          this.player.log('Fatal error, cannot recover', 'error');\r\n          this.player.handleError(new Error(`HLS Error: ${data.type} - ${data.details}`));\r\n          this.hls.destroy();\r\n          break;\r\n      }\r\n    } else {\r\n      this.player.log('Non-fatal HLS error: ' + data.details, 'warn');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ensure the HLS manifest/initial loading is started without starting playback.\r\n   * This makes playlist selection behave more like single-video initialization.\r\n   */\r\n  ensureLoaded() {\r\n    if (!this.player.options.deferLoad) {\r\n      return;\r\n    }\r\n\r\n    // Native HLS path delegates to HTML5Renderer; if we got here and have no hls.js instance,\r\n    // there's nothing to do.\r\n    if (!this.hls) {\r\n      return;\r\n    }\r\n\r\n    if (this._hlsSourceLoaded) {\r\n      return;\r\n    }\r\n\r\n    const src = this._pendingSrc || this.player._pendingSource || this.player.currentSource;\r\n    if (!src) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      this.hls.loadSource(src);\r\n      this._hlsSourceLoaded = true;\r\n      // Start loading so manifest is parsed and levels/tracks become available.\r\n      // Note: this may fetch initial fragments depending on stream/config.\r\n      this.hls.startLoad();\r\n    } catch (e) {\r\n      // ignore\r\n    }\r\n  }\r\n\r\n  play() {\r\n    // Save scroll position to prevent browser from scrolling to video\r\n    const scrollX = window.scrollX;\r\n    const scrollY = window.scrollY;\r\n\r\n    // If deferLoad is enabled, start HLS loading only on the first user play request.\r\n    if (this.player.options.deferLoad && this.hls && !this._hlsSourceLoaded) {\r\n      const src = this._pendingSrc || this.player.currentSource;\r\n      if (src) {\r\n        try {\r\n          this.hls.loadSource(src);\r\n          this.hls.startLoad();\r\n          this._hlsSourceLoaded = true;\r\n        } catch (e) {\r\n          // ignore and let media.play() surface errors if any\r\n        }\r\n      }\r\n    }\r\n    \r\n    const promise = this.media.play();\r\n    \r\n    // Restore scroll position immediately to prevent auto-scroll\r\n    window.scrollTo(scrollX, scrollY);\r\n    \r\n    if (promise !== undefined) {\r\n      promise.catch(error => {\r\n        this.player.log('Play failed:', error, 'warn');\r\n      });\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    this.media.pause();\r\n  }\r\n\r\n  seek(time) {\r\n    this.media.currentTime = time;\r\n  }\r\n\r\n  setVolume(volume) {\r\n    this.media.volume = volume;\r\n  }\r\n\r\n  setMuted(muted) {\r\n    this.media.muted = muted;\r\n  }\r\n\r\n  setPlaybackSpeed(speed) {\r\n    this.media.playbackRate = speed;\r\n  }\r\n\r\n  switchQuality(levelIndex) {\r\n    if (this.hls) {\r\n      this.hls.currentLevel = levelIndex;\r\n    }\r\n  }\r\n\r\n  getQualities() {\r\n    if (this.hls && this.hls.levels) {\r\n      return this.hls.levels.map((level, index) => {\r\n        const height = Number(level.height) || 0;\r\n        const bitrate = Number(level.bitrate) || 0;\r\n        const kb = bitrate > 0 ? Math.round(bitrate / 1000) : 0;\r\n\r\n        // Video HLS typically has height -> show \"720p\".\r\n        // Audio-only HLS often has height=0 -> show bitrate label instead.\r\n        const name = height > 0 ? `${height}p` : (kb > 0 ? `${kb} kb` : 'Auto');\r\n\r\n        return {\r\n          index,\r\n          height: level.height,\r\n          width: level.width,\r\n          bitrate: level.bitrate,\r\n          name\r\n        };\r\n      });\r\n    }\r\n    return [];\r\n  }\r\n\r\n  getCurrentQuality() {\r\n    if (this.hls) {\r\n      return this.hls.currentLevel;\r\n    }\r\n    return -1;\r\n  }\r\n\r\n  destroy() {\r\n    if (this.hls) {\r\n      this.hls.destroy();\r\n      this.hls = null;\r\n    }\r\n  }\r\n}\r\n\r\n", "/**\r\n * SoundCloud Renderer\r\n * Uses SoundCloud Widget API for embedded track playback\r\n */\r\n\r\nexport class SoundCloudRenderer {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.widget = null;\r\n    this.trackUrl = null;\r\n    this.isReady = false;\r\n    this.iframe = null;\r\n    this.iframeId = null;\r\n  }\r\n\r\n  async init() {\r\n    // Extract track URL - use currentSource which works for external renderers\r\n    this.trackUrl = this.player.currentSource || this.player.element.src || this.player.element.querySelector('source')?.src;\r\n    \r\n    if (!this.trackUrl || !this.isValidSoundCloudUrl(this.trackUrl)) {\r\n      throw new Error('Invalid SoundCloud URL');\r\n    }\r\n\r\n    // Load SoundCloud Widget API\r\n    await this.loadSoundCloudAPI();\r\n\r\n    // Create iframe\r\n    this.createIframe();\r\n\r\n    // Initialize widget\r\n    await this.initializeWidget();\r\n  }\r\n\r\n  /**\r\n   * Validate SoundCloud URL\r\n   * @param {string} url \r\n   * @returns {boolean}\r\n   */\r\n  isValidSoundCloudUrl(url) {\r\n    return url.includes('soundcloud.com') || url.includes('api.soundcloud.com');\r\n  }\r\n\r\n  /**\r\n   * Check if URL is a playlist/set\r\n   */\r\n  isPlaylist() {\r\n    return this.trackUrl && this.trackUrl.includes('/sets/');\r\n  }\r\n\r\n  /**\r\n   * Extract track/playlist info from URL for embed\r\n   * SoundCloud URLs can be:\r\n   * - https://soundcloud.com/artist/track\r\n   * - https://soundcloud.com/artist/sets/playlist\r\n   * - https://api.soundcloud.com/tracks/123456\r\n   */\r\n  getEmbedUrl() {\r\n    // SoundCloud widget needs the track URL encoded\r\n    const encodedUrl = encodeURIComponent(this.trackUrl);\r\n    \r\n    // Build widget URL with parameters\r\n    const params = new URLSearchParams({\r\n      url: this.trackUrl,\r\n      auto_play: this.player.options.autoplay ? 'true' : 'false',\r\n      hide_related: 'true',\r\n      show_comments: 'false',\r\n      show_user: 'true',\r\n      show_reposts: 'false',\r\n      show_teaser: 'false',\r\n      visual: 'false', // Use classic player for better control\r\n      color: '%23007bff'\r\n    });\r\n    \r\n    return `https://w.soundcloud.com/player/?${params.toString()}`;\r\n  }\r\n\r\n  async loadSoundCloudAPI() {\r\n    // Check if API is already loaded\r\n    if (window.SC && window.SC.Widget) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const script = document.createElement('script');\r\n      script.src = 'https://w.soundcloud.com/player/api.js';\r\n      script.onload = () => {\r\n        // Wait a bit for SC.Widget to be fully available\r\n        setTimeout(() => {\r\n          if (window.SC && window.SC.Widget) {\r\n            resolve();\r\n          } else {\r\n            reject(new Error('SoundCloud Widget API not available'));\r\n          }\r\n        }, 100);\r\n      };\r\n      script.onerror = () => reject(new Error('Failed to load SoundCloud Widget API'));\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  createIframe() {\r\n    // Hide original element and remove poster (SoundCloud has its own visual widget)\r\n    this.player.element.style.display = 'none';\r\n    this.player.element.removeAttribute('poster');\r\n    \r\n    // Remove poster overlay from video wrapper if present\r\n    if (this.player.videoWrapper) {\r\n      this.player.videoWrapper.classList.remove('vidply-forced-poster');\r\n      this.player.videoWrapper.style.removeProperty('--vidply-poster-image');\r\n    }\r\n\r\n    // Generate unique ID for iframe\r\n    this.iframeId = `soundcloud-player-${Math.random().toString(36).substr(2, 9)}`;\r\n\r\n    // Create iframe for SoundCloud widget\r\n    this.iframe = document.createElement('iframe');\r\n    this.iframe.id = this.iframeId;\r\n    this.iframe.scrolling = 'no';\r\n    this.iframe.frameBorder = 'no';\r\n    this.iframe.allow = 'autoplay';\r\n    this.iframe.src = this.getEmbedUrl();\r\n    this.iframe.style.width = '100%';\r\n    this.iframe.style.display = 'block';\r\n    \r\n    // Use different aspect ratio for playlists vs single tracks\r\n    // Playlists need more height to show the track list\r\n    if (this.isPlaylist()) {\r\n      this.iframe.classList.add('vidply-soundcloud-iframe', 'vidply-soundcloud-playlist');\r\n    } else {\r\n      this.iframe.classList.add('vidply-soundcloud-iframe');\r\n    }\r\n    this.iframe.style.maxHeight = '100%';\r\n    \r\n    this.player.element.parentNode.insertBefore(this.iframe, this.player.element);\r\n  }\r\n\r\n  async initializeWidget() {\r\n    return new Promise((resolve, reject) => {\r\n      // Wait for iframe to load\r\n      this.iframe.addEventListener('load', () => {\r\n        try {\r\n          this.widget = window.SC.Widget(this.iframe);\r\n          \r\n          this.widget.bind(window.SC.Widget.Events.READY, () => {\r\n            this.isReady = true;\r\n            this.attachEvents();\r\n            \r\n            // Hide VidPly controls - SoundCloud has its own\r\n            if (this.player.container) {\r\n              this.player.container.classList.add('vidply-external-controls');\r\n            }\r\n            \r\n            // Get initial sound info\r\n            this.widget.getCurrentSound((sound) => {\r\n              if (sound) {\r\n                this.player.state.duration = sound.duration / 1000; // Convert ms to seconds\r\n                this.player.emit('loadedmetadata');\r\n              }\r\n            });\r\n            \r\n            resolve();\r\n          });\r\n          \r\n          this.widget.bind(window.SC.Widget.Events.ERROR, (error) => {\r\n            this.player.handleError(new Error(`SoundCloud error: ${error.message || 'Unknown error'}`));\r\n          });\r\n        } catch (error) {\r\n          reject(error);\r\n        }\r\n      });\r\n      \r\n      // Timeout after 10 seconds\r\n      setTimeout(() => {\r\n        if (!this.isReady) {\r\n          reject(new Error('SoundCloud widget initialization timeout'));\r\n        }\r\n      }, 10000);\r\n    });\r\n  }\r\n\r\n  attachEvents() {\r\n    if (!this.widget) return;\r\n    \r\n    const Events = window.SC.Widget.Events;\r\n\r\n    this.widget.bind(Events.PLAY, () => {\r\n      this.player.state.playing = true;\r\n      this.player.state.paused = false;\r\n      this.player.state.ended = false;\r\n      this.player.emit('play');\r\n      \r\n      if (this.player.options.onPlay) {\r\n        this.player.options.onPlay.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.widget.bind(Events.PAUSE, () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.emit('pause');\r\n      \r\n      if (this.player.options.onPause) {\r\n        this.player.options.onPause.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.widget.bind(Events.FINISH, () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.state.ended = true;\r\n      this.player.emit('ended');\r\n      \r\n      if (this.player.options.onEnded) {\r\n        this.player.options.onEnded.call(this.player);\r\n      }\r\n      \r\n      if (this.player.options.loop) {\r\n        this.seek(0);\r\n        this.play();\r\n      }\r\n    });\r\n\r\n    this.widget.bind(Events.PLAY_PROGRESS, (data) => {\r\n      // data.currentPosition is in milliseconds\r\n      const currentTime = data.currentPosition / 1000;\r\n      this.player.state.currentTime = currentTime;\r\n      this.player.emit('timeupdate', currentTime);\r\n      \r\n      if (this.player.options.onTimeUpdate) {\r\n        this.player.options.onTimeUpdate.call(this.player, currentTime);\r\n      }\r\n    });\r\n\r\n    this.widget.bind(Events.SEEK, (data) => {\r\n      this.player.state.currentTime = data.currentPosition / 1000;\r\n      this.player.emit('seeked');\r\n    });\r\n\r\n    this.widget.bind(Events.LOAD_PROGRESS, (data) => {\r\n      // data.loadedProgress is 0-1\r\n      if (this.player.state.duration) {\r\n        const buffered = data.loadedProgress * this.player.state.duration;\r\n        this.player.emit('progress', buffered);\r\n      }\r\n    });\r\n  }\r\n\r\n  play() {\r\n    if (this.isReady && this.widget) {\r\n      // Save scroll position to prevent browser from scrolling\r\n      const scrollX = window.scrollX;\r\n      const scrollY = window.scrollY;\r\n      \r\n      this.widget.play();\r\n      \r\n      // Restore scroll position\r\n      window.scrollTo(scrollX, scrollY);\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if (this.isReady && this.widget) {\r\n      this.widget.pause();\r\n    }\r\n  }\r\n\r\n  seek(time) {\r\n    if (this.isReady && this.widget) {\r\n      // SoundCloud seekTo uses milliseconds\r\n      this.widget.seekTo(time * 1000);\r\n      this.player.state.currentTime = time;\r\n    }\r\n  }\r\n\r\n  setVolume(volume) {\r\n    if (this.isReady && this.widget) {\r\n      // SoundCloud setVolume expects 0-100\r\n      this.widget.setVolume(volume * 100);\r\n      this.player.state.volume = volume;\r\n    }\r\n  }\r\n\r\n  setMuted(muted) {\r\n    if (this.isReady && this.widget) {\r\n      // SoundCloud doesn't have a native mute, use volume instead\r\n      if (muted) {\r\n        // Store current volume before muting\r\n        this.widget.getVolume((vol) => {\r\n          this._previousVolume = vol;\r\n          this.widget.setVolume(0);\r\n        });\r\n      } else {\r\n        this.widget.setVolume(this._previousVolume || 100);\r\n      }\r\n      this.player.state.muted = muted;\r\n    }\r\n  }\r\n\r\n  setPlaybackSpeed(speed) {\r\n    // SoundCloud Widget API doesn't support playback speed\r\n    this.player.log('SoundCloud does not support playback speed control', 'warn');\r\n  }\r\n\r\n  /**\r\n   * Get current track info\r\n   * @returns {Promise<Object>}\r\n   */\r\n  getCurrentSound() {\r\n    return new Promise((resolve) => {\r\n      if (this.isReady && this.widget) {\r\n        this.widget.getCurrentSound((sound) => {\r\n          resolve(sound);\r\n        });\r\n      } else {\r\n        resolve(null);\r\n      }\r\n    });\r\n  }\r\n\r\n  destroy() {\r\n    // Unbind all events\r\n    if (this.widget) {\r\n      const Events = window.SC.Widget.Events;\r\n      try {\r\n        this.widget.unbind(Events.READY);\r\n        this.widget.unbind(Events.PLAY);\r\n        this.widget.unbind(Events.PAUSE);\r\n        this.widget.unbind(Events.FINISH);\r\n        this.widget.unbind(Events.PLAY_PROGRESS);\r\n        this.widget.unbind(Events.SEEK);\r\n        this.widget.unbind(Events.LOAD_PROGRESS);\r\n        this.widget.unbind(Events.ERROR);\r\n      } catch (e) {\r\n        // Ignore unbind errors\r\n      }\r\n    }\r\n\r\n    if (this.iframe && this.iframe.parentNode) {\r\n      this.iframe.parentNode.removeChild(this.iframe);\r\n    }\r\n\r\n    // Show original element\r\n    if (this.player.element) {\r\n      this.player.element.style.display = '';\r\n    }\r\n\r\n    this.widget = null;\r\n    this.isReady = false;\r\n  }\r\n}\r\n\r\nexport default SoundCloudRenderer;\r\n\r\n", "/**\r\n * Simple EventEmitter implementation\r\n */\r\n\r\nexport class EventEmitter {\r\n  constructor() {\r\n    this.events = {};\r\n  }\r\n\r\n  on(event, listener) {\r\n    if (!this.events[event]) {\r\n      this.events[event] = [];\r\n    }\r\n    this.events[event].push(listener);\r\n    return this;\r\n  }\r\n\r\n  once(event, listener) {\r\n    const onceListener = (...args) => {\r\n      listener(...args);\r\n      this.off(event, onceListener);\r\n    };\r\n    return this.on(event, onceListener);\r\n  }\r\n\r\n  off(event, listener) {\r\n    if (!this.events[event]) return this;\r\n    \r\n    if (!listener) {\r\n      delete this.events[event];\r\n    } else {\r\n      this.events[event] = this.events[event].filter(l => l !== listener);\r\n    }\r\n    \r\n    return this;\r\n  }\r\n\r\n  emit(event, ...args) {\r\n    if (!this.events[event]) return this;\r\n    \r\n    this.events[event].forEach(listener => {\r\n      listener(...args);\r\n    });\r\n    \r\n    return this;\r\n  }\r\n\r\n  removeAllListeners() {\r\n    this.events = {};\r\n    return this;\r\n  }\r\n}\r\n\r\n", "/**\r\n * VidPly - Universal Video Player\r\n * Main Player Class\r\n */\r\n\r\nimport {EventEmitter} from '../utils/EventEmitter.js';\r\nimport {DOMUtils} from '../utils/DOMUtils.js';\r\nimport {ControlBar} from '../controls/ControlBar.js';\r\nimport {CaptionManager} from '../controls/CaptionManager.js';\r\nimport {KeyboardManager} from '../controls/KeyboardManager.js';\r\nimport {HTML5Renderer} from '../renderers/HTML5Renderer.js';\r\nimport {createPlayOverlay, createIconElement} from '../icons/Icons.js';\r\nimport {i18n} from '../i18n/i18n.js';\r\nimport {StorageManager} from '../utils/StorageManager.js';\r\nimport {DraggableResizable} from '../utils/DraggableResizable.js';\r\nimport {createMenuItem, attachMenuKeyboardNavigation, focusFirstMenuItem} from '../utils/MenuUtils.js';\r\nimport {createLabeledSelect, preventDragOnElement} from '../utils/FormUtils.js';\r\nimport {debounce, isMobile, rafWithTimeout} from '../utils/PerformanceUtils.js';\r\nimport {AudioDescriptionManager} from './AudioDescriptionManager.js';\r\nimport {SignLanguageManager} from './SignLanguageManager.js';\r\nimport {captureVideoFrame} from '../utils/VideoFrameCapture.js';\r\n\r\n// Static counter for unique player instances\r\nlet playerInstanceCounter = 0;\r\n\r\nexport class Player extends EventEmitter {\r\n    constructor(element, options = {}) {\r\n        super();\r\n\r\n        this.element = typeof element === 'string' ? document.querySelector(element) : element;\r\n        if (!this.element) {\r\n            throw new Error('VidPly: Element not found');\r\n        }\r\n\r\n        // Assign unique instance ID\r\n        playerInstanceCounter++;\r\n        this.instanceId = playerInstanceCounter;\r\n\r\n        // Auto-create media element if a non-media element is provided\r\n        if (this.element.tagName !== 'VIDEO' && this.element.tagName !== 'AUDIO') {\r\n            const mediaType = options.mediaType || 'video';\r\n            const mediaElement = document.createElement(mediaType);\r\n\r\n            // Copy attributes from the div to the media element\r\n            Array.from(this.element.attributes).forEach(attr => {\r\n                if (attr.name !== 'id' && attr.name !== 'class' && !attr.name.startsWith('data-')) {\r\n                    mediaElement.setAttribute(attr.name, attr.value);\r\n                }\r\n            });\r\n\r\n            // Copy any track elements from the div\r\n            const tracks = this.element.querySelectorAll('track');\r\n            tracks.forEach(track => {\r\n                mediaElement.appendChild(track.cloneNode(true));\r\n            });\r\n\r\n            // Clear the div and insert the media element\r\n            this.element.innerHTML = '';\r\n            this.element.appendChild(mediaElement);\r\n\r\n            // Update element reference to the actual media element\r\n            this.element = mediaElement;\r\n        }\r\n        \r\n        // Store original element reference for mixed media swapping\r\n        // This allows us to swap between video and audio elements in mixed playlists\r\n        this._originalElement = this.element;\r\n\r\n        // Default options\r\n        this.options = {\r\n            // Display\r\n            width: null,\r\n            height: null,\r\n            poster: null,\r\n            responsive: true,\r\n            fillContainer: false,\r\n\r\n            // Playback\r\n            autoplay: false,\r\n            loop: false,\r\n            muted: false,\r\n            volume: 0.8,\r\n            playbackSpeed: 1.0,\r\n            preload: 'metadata',\r\n            // Optional initial duration (seconds) so UI can show duration\r\n            // before media metadata is loaded (useful with deferLoad/preload=none).\r\n            initialDuration: 0,\r\n            // When enabled, VidPly will not start network loading during init().\r\n            // - HTML5: does not call element.load() until the first user-initiated play()\r\n            // - HLS (hls.js): does not load manifest/segments until the first play()\r\n            // This is useful for pages with many players to avoid high initial bandwidth.\r\n            deferLoad: false,\r\n            // When enabled, clicking Audio Description / Sign Language before playback will show\r\n            // a notice instead of implicitly starting playback/loading.\r\n            requirePlaybackForAccessibilityToggles: false,\r\n            startTime: 0,\r\n            playsInline: true, // Enable inline playback on iOS (prevents native fullscreen)\r\n\r\n            // Controls\r\n            controls: true,\r\n            hideControlsDelay: 3000,\r\n            playPauseButton: true,\r\n            progressBar: true,\r\n            currentTime: true,\r\n            duration: true,\r\n            volumeControl: true,\r\n            muteButton: true,\r\n            chaptersButton: true,\r\n            qualityButton: true,\r\n            captionStyleButton: true,\r\n            speedButton: true,\r\n            // When enabled, the playback speed UI is suppressed for ALL HLS streams (audio + video).\r\n            hideSpeedForHls: false,\r\n            // When enabled, the playback speed UI is suppressed for HLS *video* streams only.\r\n            // This is useful for live streams where speed controls don't make sense.\r\n            hideSpeedForHlsVideo: false,\r\n            captionsButton: true,\r\n            transcriptButton: true,\r\n            fullscreenButton: true,\r\n            pipButton: false,\r\n\r\n            // Seeking\r\n            seekInterval: 10,\r\n            seekIntervalLarge: 30,\r\n\r\n            // Captions\r\n            captions: true,\r\n            captionsDefault: false,\r\n            captionsFontSize: '100%',\r\n            captionsFontFamily: 'sans-serif',\r\n            captionsColor: '#FFFFFF',\r\n            captionsBackgroundColor: '#000000',\r\n            captionsOpacity: 0.8,\r\n\r\n            // Audio Description\r\n            audioDescription: true,\r\n            audioDescriptionSrc: null, // URL to audio-described version\r\n            audioDescriptionButton: true,\r\n\r\n            // Sign Language\r\n            signLanguage: true,\r\n            signLanguageSrc: null, // URL to sign language video\r\n            signLanguageButton: true,\r\n            signLanguagePosition: 'bottom-right', // Position: 'bottom-right', 'bottom-left', 'top-right', 'top-left'\r\n            signLanguageDisplayMode: 'both', // Display mode: 'pip' (overlay), 'main' (source swap), 'both'\r\n\r\n            // Transcripts\r\n            transcript: false,\r\n            transcriptPosition: 'external',\r\n            transcriptContainer: null,\r\n\r\n            // Keyboard\r\n            keyboard: true,\r\n            keyboardShortcuts: {\r\n                'play-pause': [' ', 'p', 'k'],\r\n                'volume-up': ['ArrowUp'],\r\n                'volume-down': ['ArrowDown'],\r\n                'seek-forward': ['ArrowRight'],\r\n                'seek-backward': ['ArrowLeft'],\r\n                'mute': ['m'],\r\n                'fullscreen': ['f'],\r\n                'captions': ['c'],\r\n                'caption-style-menu': ['a'],\r\n                'speed-up': ['>'],\r\n                'speed-down': ['<'],\r\n                'speed-menu': ['s'],\r\n                'quality-menu': ['q'],\r\n                'chapters-menu': ['j'],\r\n                'transcript-toggle': ['t']\r\n            },\r\n\r\n            // Accessibility\r\n            ariaLabels: {},\r\n            screenReaderAnnouncements: true,\r\n            highContrast: false,\r\n            focusHighlight: true,\r\n            metadataAlerts: {},\r\n            metadataHashtags: {},\r\n\r\n            // Languages\r\n            language: 'en',\r\n            languages: ['en'],\r\n\r\n            // Advanced\r\n            debug: false,\r\n            classPrefix: 'vidply',\r\n            iconType: 'svg',\r\n            pauseOthersOnPlay: true,\r\n\r\n            // Callbacks\r\n            onReady: null,\r\n            onPlay: null,\r\n            onPause: null,\r\n            onEnded: null,\r\n            onTimeUpdate: null,\r\n            onVolumeChange: null,\r\n            onError: null,\r\n\r\n            ...options\r\n        };\r\n\r\n        this.options.metadataAlerts = this.options.metadataAlerts || {};\r\n        this.options.metadataHashtags = this.options.metadataHashtags || {};\r\n\r\n        // Notice UI\r\n        this.noticeElement = null;\r\n        this.noticeTimeout = null;\r\n\r\n        // Storage manager\r\n        this.storage = new StorageManager('vidply');\r\n        \r\n        // Load saved player preferences\r\n        const savedPrefs = this.storage.getPlayerPreferences();\r\n        if (savedPrefs) {\r\n            if (savedPrefs.volume !== undefined) this.options.volume = savedPrefs.volume;\r\n            if (savedPrefs.playbackSpeed !== undefined) this.options.playbackSpeed = savedPrefs.playbackSpeed;\r\n            if (savedPrefs.muted !== undefined) this.options.muted = savedPrefs.muted;\r\n        }\r\n        \r\n        // State\r\n        this.state = {\r\n            ready: false,\r\n            playing: false,\r\n            paused: true,\r\n            ended: false,\r\n            buffering: false,\r\n            seeking: false,\r\n            hasStartedPlayback: false,\r\n            muted: this.options.muted,\r\n            volume: this.options.volume,\r\n            currentTime: 0,\r\n            duration: Number(this.options.initialDuration) > 0 ? Number(this.options.initialDuration) : 0,\r\n            playbackSpeed: this.options.playbackSpeed,\r\n            fullscreen: false,\r\n            pip: false,\r\n            captionsEnabled: this.options.captionsDefault,\r\n            currentCaption: null,\r\n            controlsVisible: true,\r\n            audioDescriptionEnabled: false,\r\n            signLanguageEnabled: false,\r\n            signLanguageInMainView: false\r\n        };\r\n\r\n        // Store original source for toggling\r\n        this.originalSrc = null;\r\n        this.audioDescriptionSrc = this.options.audioDescriptionSrc;\r\n        this.signLanguageSrc = this.options.signLanguageSrc;\r\n        this.signLanguageSources = this.options.signLanguageSources || {}; // Map of lang codes to video URLs\r\n        this.currentSignLanguage = null; // Current selected sign language code\r\n        this.signLanguageVideo = null;\r\n        // Store references to source elements with audio description attributes\r\n        this.audioDescriptionSourceElement = null;\r\n        this.originalAudioDescriptionSource = null;\r\n        // Store caption tracks that should be swapped for audio description\r\n        this.audioDescriptionCaptionTracks = [];\r\n        this._audioDescriptionDesiredState = false;\r\n\r\n        // DOM query cache (for performance optimization)\r\n        this._textTracksCache = null;\r\n        this._textTracksDirty = true;\r\n        this._sourceElementsCache = null;\r\n        this._sourceElementsDirty = true;\r\n        this._trackElementsCache = null;\r\n        this._trackElementsDirty = true;\r\n\r\n        // Timeout management (for cleanup)\r\n        this.timeouts = new Set();\r\n\r\n        // Components\r\n        this.container = null;\r\n        this.renderer = null;\r\n        this.controlBar = null;\r\n        this.captionManager = null;\r\n        this.keyboardManager = null;\r\n        this.settingsDialog = null;\r\n        \r\n        // Metadata handling\r\n        this.metadataCueChangeHandler = null;\r\n        this.metadataAlertHandlers = new Map();\r\n\r\n        // Feature managers (modular refactoring)\r\n        this.audioDescriptionManager = new AudioDescriptionManager(this);\r\n        this.signLanguageManager = new SignLanguageManager(this);\r\n\r\n        // Backward-compatible property aliases for SignLanguageManager\r\n        // These allow existing code to reference this.signLanguageWrapper, etc.\r\n        Object.defineProperties(this, {\r\n            signLanguageWrapper: {\r\n                get: () => this.signLanguageManager.wrapper,\r\n                set: (v) => { this.signLanguageManager.wrapper = v; }\r\n            },\r\n            signLanguageVideo: {\r\n                get: () => this.signLanguageManager.video,\r\n                set: (v) => { this.signLanguageManager.video = v; }\r\n            },\r\n            signLanguageHeader: {\r\n                get: () => this.signLanguageManager.header,\r\n                set: (v) => { this.signLanguageManager.header = v; }\r\n            },\r\n            signLanguageSettingsButton: {\r\n                get: () => this.signLanguageManager.settingsButton,\r\n                set: (v) => { this.signLanguageManager.settingsButton = v; }\r\n            },\r\n            signLanguageSettingsMenu: {\r\n                get: () => this.signLanguageManager.settingsMenu,\r\n                set: (v) => { this.signLanguageManager.settingsMenu = v; }\r\n            },\r\n            signLanguageSettingsMenuVisible: {\r\n                get: () => this.signLanguageManager.settingsMenuVisible,\r\n                set: (v) => { this.signLanguageManager.settingsMenuVisible = v; }\r\n            },\r\n            signLanguageDraggable: {\r\n                get: () => this.signLanguageManager.draggable,\r\n                set: (v) => { this.signLanguageManager.draggable = v; }\r\n            },\r\n            currentSignLanguage: {\r\n                get: () => this.signLanguageManager.currentLanguage,\r\n                set: (v) => { this.signLanguageManager.currentLanguage = v; }\r\n            }\r\n        });\r\n\r\n        // Initialize\r\n        this.init();\r\n    }\r\n\r\n    /**\r\n     * Show a small in-player notice (non-blocking), also announced to screen readers.\r\n     */\r\n    showNotice(message, { timeout = 2500, priority = 'polite' } = {}) {\r\n        try {\r\n            if (!message) return;\r\n            if (!this.container) return;\r\n\r\n            // Screen reader announcement (reuse KeyboardManager announcer if available)\r\n            if (this.keyboardManager?.announce) {\r\n                this.keyboardManager.announce(message, priority);\r\n            }\r\n\r\n            if (!this.noticeElement) {\r\n                const el = document.createElement('div');\r\n                el.className = `${this.options.classPrefix}-notice`;\r\n                el.setAttribute('role', 'status');\r\n                el.setAttribute('aria-live', priority);\r\n                el.setAttribute('aria-atomic', 'true');\r\n                // Inline styling to avoid requiring CSS rebuilds\r\n                el.style.position = 'absolute';\r\n                el.style.left = '0.75rem';\r\n                el.style.right = '0.75rem';\r\n                el.style.top = '0.75rem';\r\n                el.style.zIndex = '9999';\r\n                el.style.padding = '0.5rem 0.75rem';\r\n                el.style.borderRadius = '0.5rem';\r\n                el.style.background = 'rgba(0, 0, 0, 0.75)';\r\n                el.style.color = '#fff';\r\n                el.style.fontSize = '0.875rem';\r\n                el.style.lineHeight = '1.3';\r\n                el.style.pointerEvents = 'none';\r\n                this.noticeElement = el;\r\n                this.container.appendChild(el);\r\n            }\r\n\r\n            this.noticeElement.textContent = message;\r\n            this.noticeElement.style.display = 'block';\r\n\r\n            if (this.noticeTimeout) {\r\n                clearTimeout(this.noticeTimeout);\r\n                this.noticeTimeout = null;\r\n            }\r\n            this.noticeTimeout = setTimeout(() => {\r\n                if (this.noticeElement) {\r\n                    this.noticeElement.style.display = 'none';\r\n                }\r\n            }, timeout);\r\n        } catch (e) {\r\n            // ignore\r\n        }\r\n    }\r\n\r\n    async init() {\r\n        try {\r\n            this.log('Initializing VidPly player');\r\n\r\n            // Load custom language files if specified\r\n            if (this.options.languageFiles) {\r\n                try {\r\n                    await i18n.loadLanguagesFromUrls(this.options.languageFiles);\r\n                } catch (error) {\r\n                    console.warn('Failed to load some language files:', error);\r\n                }\r\n            }\r\n\r\n            // Load single language file if specified (for backwards compatibility)\r\n            if (this.options.languageFile && this.options.languageFileUrl) {\r\n                try {\r\n                    await i18n.loadLanguageFromUrl(this.options.languageFile, this.options.languageFileUrl);\r\n                    this.log(`Custom language file loaded for ${this.options.languageFile}`);\r\n                } catch (error) {\r\n                    console.warn(`Failed to load language file for ${this.options.languageFile}:`, error);\r\n                }\r\n            }\r\n\r\n            // Auto-detect language from HTML lang attribute if not explicitly set\r\n            if (!this.options.language || this.options.language === 'en') {\r\n                const htmlLang = this.detectHtmlLanguage();\r\n                if (htmlLang) {\r\n                    this.options.language = htmlLang;\r\n                    this.log(`Auto-detected language from HTML: ${htmlLang}`);\r\n                }\r\n            }\r\n\r\n            // Ensure we have a language set (default to 'en' if not set)\r\n            if (!this.options.language) {\r\n                this.options.language = 'en';\r\n            }\r\n\r\n            // Ensure requested language is available (loads built-ins on demand)\r\n            await i18n.ensureLanguage(this.options.language);\r\n\r\n            // Set language\r\n            i18n.setLanguage(this.options.language);\r\n\r\n            // Create container\r\n            this.createContainer();\r\n\r\n            // Detect and initialize renderer (only if source exists)\r\n            const src = this.element.src || this.element.querySelector('source')?.src;\r\n            if (src) {\r\n                await this.initializeRenderer();\r\n            } else {\r\n                this.log('No initial source - waiting for playlist or manual load');\r\n            }\r\n\r\n            // Create controls\r\n            if (this.options.controls) {\r\n                this.controlBar = new ControlBar(this);\r\n                this.videoWrapper.appendChild(this.controlBar.element);\r\n            }\r\n\r\n            // Initialize captions\r\n            if (this.options.captions) {\r\n                this.captionManager = new CaptionManager(this);\r\n            }\r\n\r\n            // Initialize transcript lazily unless explicitly requested\r\n            if (this.options.transcript) {\r\n                await this.ensureTranscriptManager();\r\n            }\r\n            \r\n            // Always set up metadata track handling (independent of transcript)\r\n            this.setupMetadataHandling();\r\n\r\n            // Initialize keyboard controls\r\n            if (this.options.keyboard) {\r\n                this.keyboardManager = new KeyboardManager(this);\r\n            }\r\n\r\n            // Setup responsive handlers\r\n            this.setupResponsiveHandlers();\r\n\r\n            // Set initial state\r\n            if (this.options.startTime > 0) {\r\n                this.seek(this.options.startTime);\r\n            }\r\n\r\n            // Apply volume and mute settings after renderer is initialized\r\n            // Use requestAnimationFrame to ensure renderer is fully ready\r\n            requestAnimationFrame(() => {\r\n                if (this.options.muted) {\r\n                    this.mute();\r\n                } else if (this.renderer && this.renderer.media) {\r\n                    // Ensure media element is not muted if options say it shouldn't be\r\n                    this.renderer.setMuted(false);\r\n                }\r\n\r\n                if (this.options.volume !== 0.8) {\r\n                    this.setVolume(this.options.volume);\r\n                } else if (this.renderer && this.renderer.media) {\r\n                    // Ensure volume is set even if it's the default\r\n                    this.renderer.setVolume(this.options.volume);\r\n                }\r\n            });\r\n\r\n            // Mark as ready\r\n            this.state.ready = true;\r\n            this.emit('ready');\r\n\r\n            if (this.options.onReady) {\r\n                this.options.onReady.call(this);\r\n            }\r\n\r\n            // Autoplay if enabled\r\n            if (this.options.autoplay) {\r\n                this.play();\r\n            }\r\n\r\n            this.log('Player initialized successfully');\r\n        } catch (error) {\r\n            this.handleError(error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Ensure the transcript manager is available, creating it on demand.\r\n     * This keeps initial load fast when transcripts are not needed.\r\n     */\r\n    async ensureTranscriptManager() {\r\n        if (this.transcriptManager) {\r\n            return this.transcriptManager;\r\n        }\r\n\r\n        if (!this.options.transcript && !this.options.transcriptButton) {\r\n            return null;\r\n        }\r\n\r\n        const module = await import('../controls/TranscriptManager.js');\r\n        const Manager = module.TranscriptManager || module.default;\r\n\r\n        if (!Manager) {\r\n            return null;\r\n        }\r\n\r\n        this.transcriptManager = new Manager(this);\r\n        return this.transcriptManager;\r\n    }\r\n\r\n    /**\r\n     * Toggle transcript visibility, lazily creating the manager if necessary.\r\n     */\r\n    async toggleTranscript() {\r\n        const manager = await this.ensureTranscriptManager();\r\n        if (!manager) return;\r\n\r\n        manager.toggleTranscript();\r\n        if (this.controlBar) {\r\n            this.controlBar.updateTranscriptButton();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Detect language from HTML lang attribute\r\n     * @returns {string|null} Language code if available in translations or as built-in, null otherwise\r\n     */\r\n    detectHtmlLanguage() {\r\n        // Try to get lang from html element\r\n        const htmlLang = document.documentElement.lang || document.documentElement.getAttribute('lang');\r\n\r\n        if (!htmlLang) {\r\n            return null;\r\n        }\r\n\r\n        // Normalize the language code (e.g., \"en-US\" -> \"en\", \"de-DE\" -> \"de\")\r\n        const normalizedLang = htmlLang.toLowerCase().split('-')[0];\r\n\r\n        // Check if this language is available in our translations (already loaded)\r\n        if (i18n.translations[normalizedLang]) {\r\n            return normalizedLang;\r\n        }\r\n\r\n        // Check if this language is available as a built-in that can be loaded on demand\r\n        if (i18n.builtInLanguageLoaders && i18n.builtInLanguageLoaders[normalizedLang]) {\r\n            return normalizedLang;\r\n        }\r\n\r\n        // Language not available, will fallback to English\r\n        this.log(`Language \"${htmlLang}\" not available, using English as fallback`);\r\n        return null; // Return null instead of 'en' to let the default language handling work\r\n    }\r\n\r\n    createContainer() {\r\n        // Create main container with unique label for multiple players on same page\r\n        const playerLabel = this.instanceId > 1 \r\n            ? `${i18n.t('player.label')} ${this.instanceId}`\r\n            : i18n.t('player.label');\r\n        \r\n        this.container = DOMUtils.createElement('div', {\r\n            className: `${this.options.classPrefix}-player`,\r\n            attributes: {\r\n                'role': 'application',\r\n                'aria-label': playerLabel,\r\n                'tabindex': '0'\r\n            }\r\n        });\r\n\r\n        // Add media type class\r\n        const mediaType = this.element.tagName.toLowerCase();\r\n        this.container.classList.add(`${this.options.classPrefix}-${mediaType}`);\r\n\r\n        // Add responsive class\r\n        if (this.options.responsive) {\r\n            this.container.classList.add(`${this.options.classPrefix}-responsive`);\r\n        }\r\n\r\n\r\n        // Create video wrapper (for proper positioning of controls)\r\n        this.videoWrapper = DOMUtils.createElement('div', {\r\n            className: `${this.options.classPrefix}-video-wrapper`\r\n        });\r\n\r\n        // Wrap original element\r\n        this.element.parentNode.insertBefore(this.container, this.element);\r\n        \r\n        // Create track artwork element for single audio files (before video wrapper)\r\n        // This shows the poster/artwork above the audio player (similar to playlists)\r\n        if (this.element.tagName === 'AUDIO' && this.options.poster) {\r\n            this.trackArtworkElement = DOMUtils.createElement('div', {\r\n                className: `${this.options.classPrefix}-track-artwork`,\r\n                attributes: {\r\n                    'aria-hidden': 'true'\r\n                }\r\n            });\r\n            this.trackArtworkElement.style.backgroundImage = `url(${this.options.poster})`;\r\n            this.container.appendChild(this.trackArtworkElement);\r\n        }\r\n        \r\n        this.container.appendChild(this.videoWrapper);\r\n        this.videoWrapper.appendChild(this.element);\r\n\r\n        // Hide native controls and set dimensions\r\n        this.element.controls = false;\r\n        this.element.removeAttribute('controls');\r\n        this.element.setAttribute('tabindex', '-1'); // Remove from tab order\r\n        this.element.style.width = '100%';\r\n        this.element.style.height = '100%';\r\n\r\n        // Enable inline playback on iOS (prevents native fullscreen)\r\n        // This allows custom controls to work on iOS devices\r\n        if (this.element.tagName === 'VIDEO' && this.options.playsInline) {\r\n            this.element.setAttribute('playsinline', '');\r\n            this.element.playsInline = true; // Property version\r\n        }\r\n\r\n        // Set dimensions\r\n        if (this.options.width) {\r\n            this.container.style.width = typeof this.options.width === 'number'\r\n                ? `${this.options.width}px`\r\n                : this.options.width;\r\n        }\r\n\r\n        if (this.options.height) {\r\n            this.container.style.height = typeof this.options.height === 'number'\r\n                ? `${this.options.height}px`\r\n                : this.options.height;\r\n        }\r\n\r\n        // Set poster (convert relative paths to absolute URLs)\r\n        if (this.options.poster && this.element.tagName === 'VIDEO') {\r\n            const resolvedPoster = this.resolvePosterPath(this.options.poster);\r\n            this.element.poster = resolvedPoster;\r\n        }\r\n\r\n        // Create centered play button overlay (only for video)\r\n        if (this.element.tagName === 'VIDEO') {\r\n            this.createPlayButtonOverlay();\r\n        }\r\n        \r\n        // Store reference to player on element for easy access\r\n        this.element.vidply = this;\r\n        \r\n        // Add to static instances array\r\n        Player.instances.push(this);\r\n\r\n        // Make video/audio element clickable to toggle play/pause\r\n        this.element.style.cursor = 'pointer';\r\n        this.element.addEventListener('click', (e) => {\r\n            // Prevent if clicking on native controls (shouldn't happen but just in case)\r\n            if (e.target === this.element) {\r\n                this.toggle();\r\n            }\r\n        });\r\n\r\n        this.on('play', () => {\r\n            this.state.hasStartedPlayback = true;\r\n            // Hide poster immediately when playing\r\n            this.hidePosterOverlay();\r\n        });\r\n\r\n        this.on('timeupdate', () => {\r\n            // Hide poster when video has started playing (currentTime > 0)\r\n            if (this.state.currentTime > 0) {\r\n                this.hidePosterOverlay();\r\n            }\r\n        });\r\n\r\n        // Also hide poster on loadeddata event (when first frame is loaded)\r\n        this.element.addEventListener('loadeddata', () => {\r\n            if (this.state.playing || this.state.currentTime > 0) {\r\n                this.hidePosterOverlay();\r\n            }\r\n        }, { once: true });\r\n    }\r\n\r\n    createPlayButtonOverlay() {\r\n        // Create complete SVG play button from Icons.js\r\n        this.playButtonOverlay = createPlayOverlay();\r\n\r\n        // Add click handler\r\n        this.playButtonOverlay.addEventListener('click', () => {\r\n            this.toggle();\r\n        });\r\n\r\n        // Add to video wrapper\r\n        this.videoWrapper.appendChild(this.playButtonOverlay);\r\n\r\n        // Show/hide based on play state\r\n        this.on('play', () => {\r\n            this.playButtonOverlay.style.opacity = '0';\r\n            this.playButtonOverlay.style.pointerEvents = 'none';\r\n        });\r\n\r\n        this.on('pause', () => {\r\n            this.playButtonOverlay.style.opacity = '1';\r\n            this.playButtonOverlay.style.pointerEvents = 'auto';\r\n            this.positionPlayOverlayOnMobile();\r\n        });\r\n\r\n        this.on('ended', () => {\r\n            this.playButtonOverlay.style.opacity = '1';\r\n            this.playButtonOverlay.style.pointerEvents = 'auto';\r\n            this.positionPlayOverlayOnMobile();\r\n        });\r\n        \r\n        // Debounced resize handler\r\n        this.debouncedPositionPlayOverlay = debounce(() => {\r\n            this.positionPlayOverlayOnMobile();\r\n        }, 150);\r\n        \r\n        window.addEventListener('resize', this.debouncedPositionPlayOverlay);\r\n        \r\n        this.on('loadedmetadata', () => {\r\n            this.positionPlayOverlayOnMobile();\r\n        });\r\n        \r\n        // Recalculate on fullscreen change with RAF\r\n        this.on('enterfullscreen', () => {\r\n            rafWithTimeout(() => this.positionPlayOverlayOnMobile(), 100);\r\n        });\r\n        \r\n        this.on('exitfullscreen', () => {\r\n            rafWithTimeout(() => this.positionPlayOverlayOnMobile(), 100);\r\n        });\r\n    }\r\n    \r\n    positionPlayOverlayOnMobile() {\r\n        if (!this.playButtonOverlay || this.element.tagName !== 'VIDEO') {\r\n            return;\r\n        }\r\n        \r\n        const mobile = isMobile();\r\n        \r\n        if (!mobile) {\r\n            // Reset to CSS defaults on desktop\r\n            this.playButtonOverlay.style.top = '';\r\n            return;\r\n        }\r\n        \r\n        const videoRect = this.element.getBoundingClientRect();\r\n        const wrapperRect = this.videoWrapper.getBoundingClientRect();\r\n        const videoCenter = (videoRect.top - wrapperRect.top) + (videoRect.height / 2);\r\n        \r\n        this.playButtonOverlay.style.top = `${videoCenter}px`;\r\n    }\r\n\r\n    async initializeRenderer() {\r\n        // Use pending source for external renderers, or get from element for HTML5\r\n        let src = this._pendingSource || this.element.src || this.element.querySelector('source')?.src;\r\n\r\n        if (!src) {\r\n            throw new Error('No media source found');\r\n        }\r\n        \r\n        // Store the current source for renderers to access\r\n        this.currentSource = src;\r\n        \r\n        // Clear pending source after using it\r\n        this._pendingSource = null;\r\n\r\n        // Initialize audio description sources from elements\r\n        this.audioDescriptionManager.initFromSourceElements(this.sourceElements, this.trackElements);\r\n        \r\n        // Store original source for audio description toggling (fallback if not set by manager)\r\n        if (!this.originalSrc) {\r\n            this.originalSrc = src;\r\n        }\r\n\r\n        // Detect media type and lazily load heavy renderers\r\n        let rendererClass = HTML5Renderer;\r\n\r\n        if (src.includes('youtube.com') || src.includes('youtu.be')) {\r\n            const module = await import('../renderers/YouTubeRenderer.js');\r\n            rendererClass = module.YouTubeRenderer || module.default;\r\n        } else if (src.includes('vimeo.com')) {\r\n            const module = await import('../renderers/VimeoRenderer.js');\r\n            rendererClass = module.VimeoRenderer || module.default;\r\n        } else if (src.includes('.m3u8')) {\r\n            const module = await import('../renderers/HLSRenderer.js');\r\n            rendererClass = module.HLSRenderer || module.default;\r\n        } else if (src.includes('soundcloud.com') || src.includes('api.soundcloud.com')) {\r\n            const module = await import('../renderers/SoundCloudRenderer.js');\r\n            rendererClass = module.SoundCloudRenderer || module.default;\r\n        }\r\n\r\n        this.log(`Using ${rendererClass?.name || 'HTML5Renderer'} renderer`);\r\n        this.renderer = new rendererClass(this);\r\n        await this.renderer.init();\r\n        \r\n        // Invalidate cache after renderer initialization (tracks may have changed)\r\n        this.invalidateTrackCache();\r\n    }\r\n\r\n    /**\r\n     * Get cached text tracks array\r\n     * @returns {Array} Array of text tracks\r\n     */\r\n    get textTracks() {\r\n        if (!this._textTracksCache || this._textTracksDirty) {\r\n            this._textTracksCache = Array.from(this.element.textTracks || []);\r\n            this._textTracksDirty = false;\r\n        }\r\n        return this._textTracksCache;\r\n    }\r\n\r\n    /**\r\n     * Get cached source elements array\r\n     * @returns {Array} Array of source elements\r\n     */\r\n    get sourceElements() {\r\n        if (!this._sourceElementsCache || this._sourceElementsDirty) {\r\n            this._sourceElementsCache = Array.from(this.element.querySelectorAll('source'));\r\n            this._sourceElementsDirty = false;\r\n        }\r\n        return this._sourceElementsCache;\r\n    }\r\n\r\n    /**\r\n     * Get cached track elements array\r\n     * @returns {Array} Array of track elements\r\n     */\r\n    get trackElements() {\r\n        if (!this._trackElementsCache || this._trackElementsDirty) {\r\n            this._trackElementsCache = Array.from(this.element.querySelectorAll('track'));\r\n            this._trackElementsDirty = false;\r\n        }\r\n        return this._trackElementsCache;\r\n    }\r\n\r\n    /**\r\n     * Invalidate DOM query cache (call when tracks/sources change)\r\n     */\r\n    invalidateTrackCache() {\r\n        this._textTracksDirty = true;\r\n        this._trackElementsDirty = true;\r\n        this._sourceElementsDirty = true;\r\n    }\r\n\r\n    /**\r\n     * Find a text track by kind and optionally language\r\n     * @param {string} kind - Track kind (captions, subtitles, descriptions, chapters, metadata)\r\n     * @param {string} [language] - Optional language code\r\n     * @returns {TextTrack|null} Found track or null\r\n     */\r\n    findTextTrack(kind, language = null) {\r\n        const tracks = this.textTracks;\r\n        if (language) {\r\n            return tracks.find(t => t.kind === kind && t.language === language);\r\n        }\r\n        return tracks.find(t => t.kind === kind);\r\n    }\r\n\r\n    /**\r\n     * Find a source element by attribute\r\n     * @param {string} attribute - Attribute name (e.g., 'data-desc-src')\r\n     * @param {string} [value] - Optional attribute value\r\n     * @returns {Element|null} Found source element or null\r\n     */\r\n    findSourceElement(attribute, value = null) {\r\n        const sources = this.sourceElements;\r\n        if (value) {\r\n            return sources.find(el => el.getAttribute(attribute) === value);\r\n        }\r\n        return sources.find(el => el.hasAttribute(attribute));\r\n    }\r\n\r\n    /**\r\n     * Find a track element by its associated TextTrack\r\n     * @param {TextTrack} track - The TextTrack object\r\n     * @returns {Element|null} Found track element or null\r\n     */\r\n    findTrackElement(track) {\r\n        return this.trackElements.find(el => el.track === track);\r\n    }\r\n\r\n    /**\r\n     * Convert relative poster path to absolute URL\r\n     * @param {string} posterPath - Poster path (relative or absolute)\r\n     * @returns {string} Absolute URL\r\n     */\r\n    resolvePosterPath(posterPath) {\r\n        if (!posterPath) {\r\n            return posterPath;\r\n        }\r\n        \r\n        // If already absolute (starts with http://, https://, or /), return as-is\r\n        if (posterPath.match(/^(https?:|\\/)/)) {\r\n            return posterPath;\r\n        }\r\n        \r\n        // Convert relative path to absolute URL\r\n        try {\r\n            const posterUrl = new URL(posterPath, window.location.href);\r\n            return posterUrl.href;\r\n        } catch (e) {\r\n            // If URL constructor fails, return as-is\r\n            return posterPath;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Generate a poster image from video frame at specified time\r\n     * @param {number} time - Time in seconds (default: 10)\r\n     * @returns {Promise<string|null>} Data URL of the poster image or null if failed\r\n     */\r\n    async generatePosterFromVideo(time = 10) {\r\n        // Only for HTML5 video\r\n        if (this.element.tagName !== 'VIDEO') {\r\n            return null;\r\n        }\r\n\r\n        // Check if renderer supports this (HTML5Renderer only)\r\n        const renderer = this.renderer;\r\n        if (!renderer || !renderer.media || renderer.media.tagName !== 'VIDEO') {\r\n            return null;\r\n        }\r\n\r\n        const video = renderer.media;\r\n        \r\n        // Check if video has enough duration\r\n        if (!video.duration || video.duration < time) {\r\n            // Use a smaller time if video is shorter\r\n            time = Math.min(time, Math.max(1, video.duration * 0.1));\r\n        }\r\n\r\n        // Try to use preview video from ControlBar if available (avoids interfering with playback)\r\n        let videoToUse = video;\r\n        if (this.controlBar && this.controlBar.previewVideo && this.controlBar.previewSupported) {\r\n            videoToUse = this.controlBar.previewVideo;\r\n        }\r\n\r\n        // Use shared frame capture utility\r\n        // For main video, restore state; for preview video, no need\r\n        const restoreState = videoToUse === video;\r\n        return await captureVideoFrame(videoToUse, time, {\r\n            restoreState,\r\n            quality: 0.9\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Auto-generate poster from video if none is provided\r\n     */\r\n    async autoGeneratePoster() {\r\n        // Check if poster already exists\r\n        const hasPoster = \r\n            this.element.getAttribute('poster') ||\r\n            this.element.poster ||\r\n            this.options.poster;\r\n\r\n        if (hasPoster) {\r\n            return;\r\n        }\r\n\r\n        // Only for HTML5 video\r\n        if (this.element.tagName !== 'VIDEO') {\r\n            return;\r\n        }\r\n\r\n        // Wait for metadata to be loaded\r\n        if (!this.state.duration || this.state.duration === 0) {\r\n            // Wait for loadedmetadata event\r\n            await new Promise((resolve) => {\r\n                const onLoadedMetadata = () => {\r\n                    this.element.removeEventListener('loadedmetadata', onLoadedMetadata);\r\n                    resolve();\r\n                };\r\n                \r\n                if (this.element.readyState >= 1) {\r\n                    resolve();\r\n                } else {\r\n                    this.element.addEventListener('loadedmetadata', onLoadedMetadata);\r\n                }\r\n            });\r\n        }\r\n\r\n        // Generate poster from second 10\r\n        const posterDataURL = await this.generatePosterFromVideo(10);\r\n        \r\n        if (posterDataURL) {\r\n            // Set as poster\r\n            this.element.poster = posterDataURL;\r\n            this.log('Auto-generated poster from video frame at 10 seconds', 'info');\r\n            \r\n            // Show the poster overlay\r\n            this.showPosterOverlay();\r\n        }\r\n    }\r\n\r\n    showPosterOverlay() {\r\n        if (!this.videoWrapper || this.element.tagName !== 'VIDEO') {\r\n            return;\r\n        }\r\n\r\n        const poster =\r\n            this.element.getAttribute('poster') ||\r\n            this.element.poster ||\r\n            this.options.poster;\r\n\r\n        if (!poster) {\r\n            return;\r\n        }\r\n\r\n        // Resolve relative paths to absolute URLs (skip for data URLs)\r\n        const resolvedPoster = poster.startsWith('data:') \r\n            ? poster \r\n            : this.resolvePosterPath(poster);\r\n        this.videoWrapper.style.setProperty('--vidply-poster-image', `url(\"${resolvedPoster}\")`);\r\n        this.videoWrapper.classList.add('vidply-forced-poster');\r\n        \r\n        // Apply audio content class (16:3 aspect ratio) for audio in video player\r\n        if (this._isAudioContent && this.container) {\r\n            this.container.classList.add('vidply-audio-content');\r\n        } else if (this.container) {\r\n            this.container.classList.remove('vidply-audio-content');\r\n        }\r\n    }\r\n\r\n    hidePosterOverlay() {\r\n        if (!this.videoWrapper) {\r\n            return;\r\n        }\r\n\r\n        this.videoWrapper.classList.remove('vidply-forced-poster');\r\n        this.videoWrapper.style.removeProperty('--vidply-poster-image');\r\n        \r\n        // Note: vidply-audio-content is not removed here because it should persist\r\n        // for the duration of audio content playback, not just poster display\r\n    }\r\n\r\n    /**\r\n     * Set a managed timeout that will be cleaned up on destroy\r\n     * @param {Function} callback - Callback function\r\n     * @param {number} delay - Delay in milliseconds\r\n     * @returns {number} Timeout ID\r\n     */\r\n    setManagedTimeout(callback, delay) {\r\n        const timeoutId = setTimeout(() => {\r\n            this.timeouts.delete(timeoutId);\r\n            callback();\r\n        }, delay);\r\n        this.timeouts.add(timeoutId);\r\n        return timeoutId;\r\n    }\r\n\r\n    /**\r\n     * Clear a managed timeout\r\n     * @param {number} timeoutId - Timeout ID to clear\r\n     */\r\n    clearManagedTimeout(timeoutId) {\r\n        if (timeoutId) {\r\n            clearTimeout(timeoutId);\r\n            this.timeouts.delete(timeoutId);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Load new media source (for playlists)\r\n     * @param {Object} config - Media configuration\r\n     * @param {string} config.src - Media source URL\r\n     * @param {string} config.type - Media MIME type\r\n     * @param {string} [config.poster] - Poster image URL\r\n     * @param {Array} [config.tracks] - Text tracks (captions, chapters, etc.)\r\n     * @param {string} [config.audioDescriptionSrc] - Audio description video URL\r\n     * @param {string} [config.signLanguageSrc] - Sign language video URL\r\n     */\r\n    /**\r\n     * Check if a source URL requires an external renderer (YouTube, Vimeo, SoundCloud, HLS)\r\n     * @param {string} src - Source URL\r\n     * @returns {boolean}\r\n     */\r\n    isExternalRendererUrl(src) {\r\n        if (!src) return false;\r\n        return src.includes('youtube.com') || \r\n               src.includes('youtu.be') || \r\n               src.includes('vimeo.com') || \r\n               src.includes('soundcloud.com') || \r\n               src.includes('api.soundcloud.com') ||\r\n               src.includes('.m3u8');\r\n    }\r\n\r\n    async load(config) {\r\n        try {\r\n            this.log('Loading new media:', config.src);\r\n\r\n            // Pause current playback\r\n            if (this.renderer) {\r\n                this.pause();\r\n            }\r\n\r\n            // Save scroll position to prevent browser from auto-scrolling when loading new media\r\n            const scrollX = window.scrollX || window.pageXOffset;\r\n            const scrollY = window.scrollY || window.pageYOffset;\r\n\r\n            // Clear existing text tracks\r\n            const existingTracks = this.trackElements;\r\n            existingTracks.forEach(track => track.remove());\r\n            this.invalidateTrackCache();\r\n\r\n            // Check if this is an external renderer URL\r\n            const isExternalRenderer = this.isExternalRendererUrl(config.src);\r\n            \r\n            // Set flag early to suppress any errors that might fire during the transition\r\n            // This prevents HTML5 element errors from triggering playlist auto-advance\r\n            if (isExternalRenderer) {\r\n                this._switchingRenderer = true;\r\n            }\r\n\r\n            // Only set src on HTML5 element for non-external sources\r\n            // External renderers (YouTube, Vimeo, SoundCloud, HLS) handle their own media loading\r\n            if (!isExternalRenderer) {\r\n                this.element.src = config.src;\r\n\r\n                if (config.type) {\r\n                    this.element.type = config.type;\r\n                }\r\n            } else {\r\n                // For external renderers, clear the src to prevent HTML5 element errors\r\n                // but store the URL for the renderer to use\r\n                // DO NOT call load() here - it will trigger an error event on an element without a valid source\r\n                this.element.removeAttribute('src');\r\n                // Also clear any source elements to prevent errors\r\n                const sources = this.element.querySelectorAll('source');\r\n                sources.forEach(s => s.removeAttribute('src'));\r\n            }\r\n            \r\n            // Store the source URL for external renderers to access\r\n            this._pendingSource = config.src;\r\n            \r\n            // Track if current content is audio (for poster aspect ratio)\r\n            this._isAudioContent = config.type && config.type.startsWith('audio/');\r\n            \r\n            // Apply or remove audio content class (16:3 aspect ratio for audio in video player)\r\n            if (this.container) {\r\n                if (this._isAudioContent) {\r\n                    this.container.classList.add('vidply-audio-content');\r\n                } else {\r\n                    this.container.classList.remove('vidply-audio-content');\r\n                }\r\n            }\r\n            \r\n            // Handle poster display based on content type\r\n            if (config.poster && this.element.tagName === 'VIDEO') {\r\n                if (this._isAudioContent) {\r\n                    // For audio in video player: use CSS poster overlay with 16:3 aspect ratio\r\n                    this.element.removeAttribute('poster');\r\n                    if (this.videoWrapper) {\r\n                        const resolvedPoster = this.resolvePosterPath(config.poster);\r\n                        this.videoWrapper.style.setProperty('--vidply-poster-image', `url(\"${resolvedPoster}\")`);\r\n                        this.videoWrapper.classList.add('vidply-forced-poster');\r\n                    }\r\n                } else {\r\n                    // For video: use normal poster and remove overlay\r\n                    this.element.poster = this.resolvePosterPath(config.poster);\r\n                    if (this.videoWrapper) {\r\n                        this.videoWrapper.classList.remove('vidply-forced-poster');\r\n                        this.videoWrapper.style.removeProperty('--vidply-poster-image');\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Add new text tracks\r\n            if (config.tracks && config.tracks.length > 0) {\r\n                config.tracks.forEach(trackConfig => {\r\n                    const track = document.createElement('track');\r\n                    track.src = trackConfig.src;\r\n                    track.kind = trackConfig.kind || 'captions';\r\n                    track.srclang = trackConfig.srclang || 'en';\r\n                    track.label = trackConfig.label || trackConfig.srclang;\r\n\r\n                    if (trackConfig.default) {\r\n                        track.default = true;\r\n                    }\r\n                    \r\n                    // Support described track sources for audio description track swapping\r\n                    if (trackConfig.describedSrc) {\r\n                        track.setAttribute('data-desc-src', trackConfig.describedSrc);\r\n                    }\r\n\r\n                    // Insert tracks at the beginning (before any flow content) for HTML5 validity\r\n                    const firstChild = this.element.firstChild;\r\n                    if (firstChild && firstChild.nodeType === Node.ELEMENT_NODE && firstChild.tagName !== 'TRACK') {\r\n                        this.element.insertBefore(track, firstChild);\r\n                    } else {\r\n                        this.element.appendChild(track);\r\n                    }\r\n                });\r\n                this.invalidateTrackCache();\r\n            }\r\n            \r\n            // Remember accessibility feature states before switching tracks\r\n            const wasSignLanguageEnabled = this.state.signLanguageEnabled;\r\n            const wasAudioDescriptionEnabled = this.state.audioDescriptionEnabled;\r\n            \r\n            // Update sources from config FIRST (before hiding features)\r\n            this.audioDescriptionSrc = config.audioDescriptionSrc || null;\r\n            this.signLanguageSrc = config.signLanguageSrc || null;\r\n            \r\n            // Update original source for toggling\r\n            this.originalSrc = config.src;\r\n            \r\n            // Update manager sources for playlist changes\r\n            if (this.audioDescriptionManager) {\r\n                this.audioDescriptionManager.updateSources(config.audioDescriptionSrc);\r\n                // Reinitialize to pick up new track elements with data-desc-src attributes\r\n                this.audioDescriptionManager.reinitialize();\r\n            }\r\n            if (this.signLanguageManager) {\r\n                this.signLanguageManager.updateSources(config.signLanguageSrc, config.signLanguageSources);\r\n            }\r\n            \r\n            // Hide accessibility features that were enabled (must happen AFTER updating sources)\r\n            if (wasAudioDescriptionEnabled) {\r\n                this.disableAudioDescription();\r\n            }\r\n            if (wasSignLanguageEnabled) {\r\n                this.disableSignLanguage();\r\n            }\r\n\r\n            // Check if we need to change renderer type\r\n            const shouldChangeRenderer = this.shouldChangeRenderer(config.src);\r\n\r\n            // Destroy old renderer if changing types\r\n            if (shouldChangeRenderer && this.renderer) {\r\n                this.renderer.destroy();\r\n                this.renderer = null;\r\n            }\r\n\r\n            // Initialize or reinitialize renderer\r\n            if (!this.renderer || shouldChangeRenderer) {\r\n                await this.initializeRenderer();\r\n            } else {\r\n                // Just reload the current renderer with the updated element\r\n                this.renderer.media = this.element; // Update media reference\r\n                if (this.options.deferLoad) {\r\n                    try {\r\n                        // Keep configured preload behavior; actual network load is controlled\r\n                        // by ensureLoaded()/play() when deferLoad is enabled.\r\n                        this.element.preload = this.options.preload || 'metadata';\r\n                    } catch (e) {\r\n                        // ignore\r\n                    }\r\n                    // Reset renderer-level deferred flags if present (HTML5/HLS renderers)\r\n                    if (this.renderer) {\r\n                        if (typeof this.renderer._didDeferredLoad === 'boolean') {\r\n                            this.renderer._didDeferredLoad = false;\r\n                        }\r\n                        if (typeof this.renderer._hlsSourceLoaded === 'boolean') {\r\n                            this.renderer._hlsSourceLoaded = false;\r\n                        }\r\n                        if ('_pendingSrc' in this.renderer) {\r\n                            // For HLS, store pending src for the first play() call\r\n                            this.renderer._pendingSrc = this._pendingSource || this.currentSource || null;\r\n                        }\r\n                    }\r\n                } else {\r\n                    this.element.load();\r\n                }\r\n            }\r\n            \r\n            // Clear the renderer switching flag after a delay to catch async errors\r\n            // This prevents errors from the old renderer's event queue from causing issues\r\n            if (isExternalRenderer) {\r\n                setTimeout(() => {\r\n                    this._switchingRenderer = false;\r\n                }, 500);\r\n            } else {\r\n                this._switchingRenderer = false;\r\n            }\r\n            \r\n            // Restore scroll position immediately after loading to prevent auto-scroll\r\n            window.scrollTo(scrollX, scrollY);\r\n\r\n            // Reinitialize caption manager to pick up new tracks\r\n            if (this.captionManager) {\r\n                this.captionManager.destroy();\r\n                this.captionManager = new CaptionManager(this);\r\n            }\r\n            \r\n            // Reinitialize transcript manager to pick up new tracks\r\n            if (this.transcriptManager) {\r\n                const wasTranscriptVisible = this.transcriptManager.isVisible;\r\n                this.transcriptManager.destroy();\r\n                this.transcriptManager = null;\r\n\r\n                await this.ensureTranscriptManager();\r\n                \r\n                // Only restore transcript visibility if new track has captions\r\n                if (wasTranscriptVisible && this.controlBar && this.controlBar.hasCaptionTracks()) {\r\n                    this.transcriptManager?.showTranscript();\r\n                }\r\n            }\r\n            \r\n            // Update control bar to show/hide feature buttons based on new tracks\r\n            if (this.controlBar) {\r\n                this.updateControlBar();\r\n            }\r\n            \r\n            // Restore scroll position after control bar update (may have caused micro-scrolls)\r\n            window.scrollTo(scrollX, scrollY);\r\n            \r\n            // Restore accessibility features if they were enabled and available in new track\r\n            if (wasSignLanguageEnabled && this.signLanguageSrc) {\r\n                // Small delay to ensure player and control bar are ready\r\n                setTimeout(() => {\r\n                    this.enableSignLanguage();\r\n                    // Restore scroll after sign language is shown\r\n                    window.scrollTo(scrollX, scrollY);\r\n                }, 150);\r\n            }\r\n            \r\n            if (wasAudioDescriptionEnabled && this.audioDescriptionSrc) {\r\n                // Small delay to ensure player is ready\r\n                setTimeout(() => {\r\n                    this.enableAudioDescription();\r\n                    // Restore scroll after audio description is enabled\r\n                    window.scrollTo(scrollX, scrollY);\r\n                }, 150);\r\n            }\r\n\r\n            this.emit('sourcechange', config);\r\n            this.log('Media loaded successfully');\r\n\r\n        } catch (error) {\r\n            this.handleError(error);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Ensure the current renderer has started its initial load (metadata/manifest)\r\n     * without starting playback. This is useful for playlists to behave like\r\n     * single videos on selection, while still keeping autoplay off.\r\n     */\r\n    ensureLoaded() {\r\n        try {\r\n            if (!this.renderer) return;\r\n            if (typeof this.renderer.ensureLoaded === 'function') {\r\n                this.renderer.ensureLoaded();\r\n            }\r\n        } catch (e) {\r\n            // ignore\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if we need to change renderer type\r\n     * @param {string} src - New source URL\r\n     * @returns {boolean}\r\n     */\r\n    /**\r\n     * Update control bar to refresh button visibility based on available features\r\n     */\r\n    updateControlBar() {\r\n        if (!this.controlBar) return;\r\n        \r\n        const controlBar = this.controlBar;\r\n        \r\n        // Clear existing controls content\r\n        controlBar.element.innerHTML = '';\r\n        \r\n        // Recreate controls with updated feature detection\r\n        controlBar.createControls();\r\n        \r\n        // Reattach events for the new controls\r\n        controlBar.attachEvents();\r\n        controlBar.setupAutoHide();\r\n        controlBar.setupOverflowDetection();\r\n    }\r\n    \r\n    shouldChangeRenderer(src) {\r\n        if (!this.renderer) return true;\r\n\r\n        const isYouTube = src.includes('youtube.com') || src.includes('youtu.be');\r\n        const isVimeo = src.includes('vimeo.com');\r\n        const isHLS = src.includes('.m3u8');\r\n        const isSoundCloud = src.includes('soundcloud.com') || src.includes('api.soundcloud.com');\r\n\r\n        const currentRendererName = this.renderer.constructor.name;\r\n\r\n        if (isYouTube && currentRendererName !== 'YouTubeRenderer') return true;\r\n        if (isVimeo && currentRendererName !== 'VimeoRenderer') return true;\r\n        if (isHLS && currentRendererName !== 'HLSRenderer') return true;\r\n        if (isSoundCloud && currentRendererName !== 'SoundCloudRenderer') return true;\r\n        if (!isYouTube && !isVimeo && !isHLS && !isSoundCloud && currentRendererName !== 'HTML5Renderer') return true;\r\n\r\n        return false;\r\n    }\r\n\r\n    // Playback controls\r\n    play() {\r\n        if (this.renderer) {\r\n            this.renderer.play();\r\n            return;\r\n        }\r\n\r\n        // Playlist support: if no renderer exists yet (no initial src),\r\n        // start playback via playlist selection.\r\n        if (this.playlistManager && Array.isArray(this.playlistManager.tracks) && this.playlistManager.tracks.length > 0) {\r\n            const index = this.playlistManager.currentIndex >= 0 ? this.playlistManager.currentIndex : 0;\r\n            this.playlistManager.play(index, true);\r\n        }\r\n    }\r\n\r\n    pause() {\r\n        if (this.renderer) {\r\n            this.renderer.pause();\r\n        }\r\n    }\r\n\r\n    stop() {\r\n        this.pause();\r\n        this.seek(0);\r\n    }\r\n\r\n    toggle() {\r\n        if (this.state.playing) {\r\n            this.pause();\r\n        } else {\r\n            this.play();\r\n        }\r\n    }\r\n\r\n    seek(time) {\r\n        if (this.renderer) {\r\n            this.renderer.seek(time);\r\n        }\r\n    }\r\n\r\n    seekForward(interval = this.options.seekInterval) {\r\n        this.seek(Math.min(this.state.currentTime + interval, this.state.duration));\r\n    }\r\n\r\n    seekBackward(interval = this.options.seekInterval) {\r\n        this.seek(Math.max(this.state.currentTime - interval, 0));\r\n    }\r\n\r\n    // Volume controls\r\n    setVolume(volume) {\r\n        const newVolume = Math.max(0, Math.min(1, volume));\r\n        if (this.renderer) {\r\n            this.renderer.setVolume(newVolume);\r\n        }\r\n        this.state.volume = newVolume;\r\n\r\n        // If volume is increased above 0 and currently muted, unmute\r\n        if (newVolume > 0 && this.state.muted) {\r\n            this.state.muted = false;\r\n            if (this.renderer) {\r\n                this.renderer.setMuted(false);\r\n            }\r\n            this.emit('volumechange');\r\n        }\r\n        \r\n        this.savePlayerPreferences();\r\n    }\r\n\r\n    getVolume() {\r\n        return this.state.volume;\r\n    }\r\n\r\n    mute() {\r\n        if (this.renderer) {\r\n            this.renderer.setMuted(true);\r\n        }\r\n        this.state.muted = true;\r\n        this.savePlayerPreferences();\r\n        this.emit('volumechange');\r\n    }\r\n\r\n    unmute() {\r\n        if (this.renderer) {\r\n            this.renderer.setMuted(false);\r\n        }\r\n        this.state.muted = false;\r\n        this.savePlayerPreferences();\r\n        this.emit('volumechange');\r\n    }\r\n\r\n    toggleMute() {\r\n        if (this.state.muted) {\r\n            this.unmute();\r\n        } else {\r\n            this.mute();\r\n        }\r\n    }\r\n\r\n    // Playback speed\r\n    setPlaybackSpeed(speed) {\r\n        const newSpeed = Math.max(0.25, Math.min(2, speed));\r\n        if (this.renderer) {\r\n            this.renderer.setPlaybackSpeed(newSpeed);\r\n        }\r\n        this.state.playbackSpeed = newSpeed;\r\n        this.savePlayerPreferences();\r\n        this.emit('playbackspeedchange', newSpeed);\r\n    }\r\n\r\n    getPlaybackSpeed() {\r\n        return this.state.playbackSpeed;\r\n    }\r\n    \r\n    // Save player preferences to localStorage\r\n    savePlayerPreferences() {\r\n        this.storage.savePlayerPreferences({\r\n            volume: this.state.volume,\r\n            muted: this.state.muted,\r\n            playbackSpeed: this.state.playbackSpeed\r\n        });\r\n    }\r\n\r\n    // Fullscreen\r\n    enterFullscreen() {\r\n        const elem = this.container;\r\n        let fullscreenPromise = null;\r\n\r\n        // Detect iOS/iPadOS to avoid native fullscreen conflicts\r\n        const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || \r\n                     (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);\r\n        \r\n        // On iOS/iPadOS, always use pseudo-fullscreen to avoid video element native fullscreen\r\n        if (isIOS) {\r\n            this._enablePseudoFullscreen();\r\n            return;\r\n        }\r\n\r\n        // Try to use native Fullscreen API on other platforms\r\n        if (elem.requestFullscreen) {\r\n            fullscreenPromise = elem.requestFullscreen();\r\n        } else if (elem.webkitRequestFullscreen) {\r\n            fullscreenPromise = elem.webkitRequestFullscreen();\r\n        } else if (elem.mozRequestFullScreen) {\r\n            fullscreenPromise = elem.mozRequestFullScreen();\r\n        } else if (elem.msRequestFullscreen) {\r\n            fullscreenPromise = elem.msRequestFullscreen();\r\n        }\r\n\r\n        // Handle promise-based API (modern browsers)\r\n        if (fullscreenPromise && fullscreenPromise.catch) {\r\n            fullscreenPromise.catch((err) => {\r\n                // Fullscreen API failed, use pseudo-fullscreen fallback\r\n                this.log('Fullscreen API failed, using pseudo-fullscreen:', err.message);\r\n                this._enablePseudoFullscreen();\r\n            });\r\n        }\r\n\r\n        // For browsers without Fullscreen API support, use pseudo-fullscreen\r\n        if (!elem.requestFullscreen && !elem.webkitRequestFullscreen && \r\n            !elem.mozRequestFullScreen && !elem.msRequestFullscreen) {\r\n            this._enablePseudoFullscreen();\r\n        } else {\r\n            // Optimistically set state (will be corrected by fullscreenChangeHandler if it fails)\r\n            this.state.fullscreen = true;\r\n            this.container.classList.add(`${this.options.classPrefix}-fullscreen`);\r\n            this.emit('fullscreenchange', true);\r\n        }\r\n    }\r\n\r\n    exitFullscreen() {\r\n        // Check if we're in native fullscreen\r\n        const isInNativeFullscreen = !!(\r\n            document.fullscreenElement ||\r\n            document.webkitFullscreenElement ||\r\n            document.mozFullScreenElement ||\r\n            document.msFullscreenElement\r\n        );\r\n\r\n        if (isInNativeFullscreen) {\r\n            // Exit native fullscreen\r\n            if (document.exitFullscreen) {\r\n                document.exitFullscreen();\r\n            } else if (document.webkitExitFullscreen) {\r\n                document.webkitExitFullscreen();\r\n            } else if (document.mozCancelFullScreen) {\r\n                document.mozCancelFullScreen();\r\n            } else if (document.msExitFullscreen) {\r\n                document.msExitFullscreen();\r\n            }\r\n        } else {\r\n            // We're in pseudo-fullscreen, exit it manually\r\n            this._disablePseudoFullscreen();\r\n        }\r\n\r\n        this.state.fullscreen = false;\r\n        this.container.classList.remove(`${this.options.classPrefix}-fullscreen`);\r\n        this.emit('fullscreenchange', false);\r\n    }\r\n\r\n    toggleFullscreen() {\r\n        if (this.state.fullscreen) {\r\n            this.exitFullscreen();\r\n        } else {\r\n            this.enterFullscreen();\r\n        }\r\n    }\r\n\r\n    // Pseudo-fullscreen fallback for iOS and browsers without Fullscreen API\r\n    _enablePseudoFullscreen() {\r\n        this.state.fullscreen = true;\r\n        this.container.classList.add(`${this.options.classPrefix}-fullscreen`);\r\n        \r\n        // Add body class for CSS targeting (fallback for browsers without :has() support)\r\n        document.body.classList.add('vidply-fullscreen-active');\r\n        \r\n        // Store current scroll position for restoration later\r\n        this._originalScrollX = window.scrollX || window.pageXOffset;\r\n        this._originalScrollY = window.scrollY || window.pageYOffset;\r\n        \r\n        // Prevent body scrolling while in pseudo-fullscreen\r\n        this._originalBodyOverflow = document.body.style.overflow;\r\n        this._originalBodyPosition = document.body.style.position;\r\n        this._originalBodyWidth = document.body.style.width;\r\n        this._originalBodyHeight = document.body.style.height;\r\n        this._originalHtmlOverflow = document.documentElement.style.overflow;\r\n        this._originalBodyBackground = document.body.style.background;\r\n        this._originalHtmlBackground = document.documentElement.style.background;\r\n        \r\n        document.body.style.overflow = 'hidden';\r\n        document.body.style.width = '100%';\r\n        document.body.style.height = '100%';\r\n        document.body.style.background = '#000';\r\n        document.documentElement.style.overflow = 'hidden';\r\n        document.documentElement.style.background = '#000';\r\n        \r\n        // On iOS, also lock the viewport and scroll to top\r\n        this._originalViewport = document.querySelector('meta[name=\"viewport\"]')?.getAttribute('content');\r\n        const viewport = document.querySelector('meta[name=\"viewport\"]');\r\n        if (viewport) {\r\n            viewport.setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no');\r\n        }\r\n        \r\n        // Scroll to top on iOS to prevent positioning issues\r\n        window.scrollTo(0, 0);\r\n        \r\n        // Make all other page content inert to prevent keyboard focus escaping to background\r\n        this._makeBackgroundInert();\r\n        \r\n        this.emit('fullscreenchange', true);\r\n        this.emit('enterfullscreen');\r\n    }\r\n    \r\n    /**\r\n     * Makes all page content except the fullscreen player inert (non-focusable)\r\n     * This prevents keyboard navigation from focusing on hidden background elements\r\n     */\r\n    _makeBackgroundInert() {\r\n        this._inertElements = [];\r\n        \r\n        // Find all siblings and ancestors' siblings that should be made inert\r\n        let current = this.container;\r\n        while (current && current !== document.body && current !== document.documentElement) {\r\n            const parent = current.parentElement;\r\n            if (parent) {\r\n                // Make all siblings inert\r\n                Array.from(parent.children).forEach(sibling => {\r\n                    if (sibling !== current && \r\n                        sibling.nodeType === Node.ELEMENT_NODE &&\r\n                        !sibling.hasAttribute('inert') &&\r\n                        sibling.tagName !== 'SCRIPT' &&\r\n                        sibling.tagName !== 'STYLE' &&\r\n                        sibling.tagName !== 'LINK' &&\r\n                        sibling.tagName !== 'META') {\r\n                        sibling.setAttribute('inert', '');\r\n                        this._inertElements.push(sibling);\r\n                    }\r\n                });\r\n            }\r\n            current = parent;\r\n        }\r\n    }\r\n    \r\n    /**\r\n     * Restores interactivity to elements that were made inert during fullscreen\r\n     */\r\n    _restoreBackgroundInteractivity() {\r\n        if (this._inertElements) {\r\n            this._inertElements.forEach(el => {\r\n                el.removeAttribute('inert');\r\n            });\r\n            this._inertElements = [];\r\n        }\r\n    }\r\n\r\n    _disablePseudoFullscreen() {\r\n        // Remove body class for CSS targeting\r\n        document.body.classList.remove('vidply-fullscreen-active');\r\n        \r\n        // Restore interactivity to background elements\r\n        this._restoreBackgroundInteractivity();\r\n        \r\n        // Restore body scrolling\r\n        if (this._originalBodyOverflow !== undefined) {\r\n            document.body.style.overflow = this._originalBodyOverflow;\r\n            delete this._originalBodyOverflow;\r\n        }\r\n        if (this._originalBodyPosition !== undefined) {\r\n            document.body.style.position = this._originalBodyPosition;\r\n            delete this._originalBodyPosition;\r\n        }\r\n        if (this._originalBodyWidth !== undefined) {\r\n            document.body.style.width = this._originalBodyWidth;\r\n            delete this._originalBodyWidth;\r\n        }\r\n        if (this._originalBodyHeight !== undefined) {\r\n            document.body.style.height = this._originalBodyHeight;\r\n            delete this._originalBodyHeight;\r\n        }\r\n        if (this._originalHtmlOverflow !== undefined) {\r\n            document.documentElement.style.overflow = this._originalHtmlOverflow;\r\n            delete this._originalHtmlOverflow;\r\n        }\r\n        if (this._originalBodyBackground !== undefined) {\r\n            document.body.style.background = this._originalBodyBackground;\r\n            delete this._originalBodyBackground;\r\n        }\r\n        if (this._originalHtmlBackground !== undefined) {\r\n            document.documentElement.style.background = this._originalHtmlBackground;\r\n            delete this._originalHtmlBackground;\r\n        }\r\n        \r\n        // Restore viewport settings\r\n        if (this._originalViewport !== undefined) {\r\n            const viewport = document.querySelector('meta[name=\"viewport\"]');\r\n            if (viewport) {\r\n                viewport.setAttribute('content', this._originalViewport);\r\n            }\r\n            delete this._originalViewport;\r\n        }\r\n        \r\n        // Restore scroll position\r\n        if (this._originalScrollX !== undefined && this._originalScrollY !== undefined) {\r\n            window.scrollTo(this._originalScrollX, this._originalScrollY);\r\n            delete this._originalScrollX;\r\n            delete this._originalScrollY;\r\n        }\r\n        \r\n        this.emit('exitfullscreen');\r\n    }\r\n\r\n    // Picture-in-Picture\r\n    enterPiP() {\r\n        if (this.element.requestPictureInPicture) {\r\n            this.element.requestPictureInPicture();\r\n            this.state.pip = true;\r\n            this.emit('pipchange', true);\r\n        }\r\n    }\r\n\r\n    exitPiP() {\r\n        if (document.pictureInPictureElement) {\r\n            document.exitPictureInPicture();\r\n            this.state.pip = false;\r\n            this.emit('pipchange', false);\r\n        }\r\n    }\r\n\r\n    togglePiP() {\r\n        if (this.state.pip) {\r\n            this.exitPiP();\r\n        } else {\r\n            this.enterPiP();\r\n        }\r\n    }\r\n\r\n    // Captions\r\n    enableCaptions() {\r\n        if (this.captionManager) {\r\n            this.captionManager.enable();\r\n            this.state.captionsEnabled = true;\r\n        }\r\n    }\r\n\r\n    disableCaptions() {\r\n        if (this.captionManager) {\r\n            this.captionManager.disable();\r\n            this.state.captionsEnabled = false;\r\n        }\r\n    }\r\n\r\n    toggleCaptions() {\r\n        if (this.state.captionsEnabled) {\r\n            this.disableCaptions();\r\n        } else {\r\n            this.enableCaptions();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check if a track file exists\r\n     * @param {string} url - Track file URL\r\n     * @returns {Promise<boolean>} - True if file exists\r\n     */\r\n    async validateTrackExists(url) {\r\n        try {\r\n            const response = await fetch(url, { method: 'HEAD', cache: 'no-cache' });\r\n            return response.ok;\r\n        } catch (error) {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Strip VTT formatting tags from caption text\r\n     * @param {string} text - Caption text with VTT formatting\r\n     * @returns {string} Plain text without formatting\r\n     */\r\n    stripVTTFormatting(text) {\r\n        if (!text) return '';\r\n        return text\r\n            .replace(/<[^>]+>/g, '') // Remove all HTML/VTT tags\r\n            .replace(/\\n/g, ' ')      // Replace newlines with spaces\r\n            .trim()\r\n            .toLowerCase();           // Normalize to lowercase for comparison\r\n    }\r\n\r\n    /**\r\n     * Find matching caption time based on text content\r\n     * Useful for syncing between videos of different lengths (e.g., with/without audio description)\r\n     * @param {string} targetText - Caption text to search for\r\n     * @param {Array} tracks - Array of caption tracks to search in\r\n     * @returns {number|null} Start time of matching caption, or null if not found\r\n     */\r\n    findMatchingCaptionTime(targetText, tracks) {\r\n        if (!targetText || !tracks || tracks.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        const normalizedTarget = this.stripVTTFormatting(targetText);\r\n        \r\n        // Search through all caption/subtitle tracks\r\n        for (const trackInfo of tracks) {\r\n            if (trackInfo.kind !== 'captions' && trackInfo.kind !== 'subtitles') {\r\n                continue;\r\n            }\r\n\r\n            const track = trackInfo.track;\r\n            if (!track || !track.cues) {\r\n                continue;\r\n            }\r\n\r\n            // Search through all cues in this track\r\n            for (let i = 0; i < track.cues.length; i++) {\r\n                const cue = track.cues[i];\r\n                const cueText = this.stripVTTFormatting(cue.text);\r\n                \r\n                // Check for exact match or very similar match (at least 80% of words match)\r\n                if (cueText === normalizedTarget) {\r\n                    return cue.startTime;\r\n                }\r\n                \r\n                // Fuzzy matching: check if most words match\r\n                const targetWords = normalizedTarget.split(/\\s+/).filter(w => w.length > 2);\r\n                const cueWords = cueText.split(/\\s+/).filter(w => w.length > 2);\r\n                \r\n                if (targetWords.length > 0 && cueWords.length > 0) {\r\n                    const matchingWords = targetWords.filter(word => cueWords.includes(word));\r\n                    const matchRatio = matchingWords.length / targetWords.length;\r\n                    \r\n                    // If 80% or more words match, consider it a match\r\n                    if (matchRatio >= 0.8) {\r\n                        return cue.startTime;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    // Audio Description (delegated to AudioDescriptionManager)\r\n    async enableAudioDescription() {\r\n        return this.audioDescriptionManager.enable();\r\n    }\r\n\r\n    // Legacy method body preserved for reference - can be removed after testing\r\n    async _legacyEnableAudioDescription() {\r\n        // Check if we have source elements with data-desc-src (even if audioDescriptionSrc is not set)\r\n        const hasSourceElementsWithDesc = this.sourceElements.some(el => el.getAttribute('data-desc-src'));\r\n        const hasTracksWithDesc = this.audioDescriptionCaptionTracks.length > 0;\r\n        \r\n        if (!this.audioDescriptionSrc && !hasSourceElementsWithDesc && !hasTracksWithDesc) {\r\n            console.warn('VidPly: No audio description source, source elements, or tracks provided');\r\n            return;\r\n        }\r\n\r\n        // Store current playback state\r\n        // Use element.currentTime directly, not state, as state may not be up-to-date\r\n        const currentTime = this.element.currentTime;\r\n        const wasPlaying = this.state.playing;\r\n        const shouldKeepPoster = !wasPlaying && currentTime === 0;\r\n        \r\n        // Try to find the current caption text for synchronization\r\n        // This helps when switching between videos of different lengths\r\n        let currentCaptionText = null;\r\n        if (this.captionManager && this.captionManager.currentTrack) {\r\n            const track = this.captionManager.currentTrack.track;\r\n            if (track && track.activeCues && track.activeCues.length > 0) {\r\n                const activeCue = track.activeCues[0];\r\n                currentCaptionText = this.stripVTTFormatting(activeCue.text);\r\n            }\r\n        }\r\n        \r\n        // Store poster to preserve it during source swap\r\n        // Convert relative paths to absolute URLs to prevent resolution issues\r\n        const posterValue = this.resolvePosterPath(\r\n            this.element.getAttribute('poster') || \r\n            this.element.poster || \r\n            this.options.poster\r\n        );\r\n\r\n        if (shouldKeepPoster) {\r\n            this.showPosterOverlay();\r\n        }\r\n\r\n        // Store swapped tracks for transcript reload (declare at function scope)\r\n        let swappedTracksForTranscript = [];\r\n\r\n        // Switch to audio-described version\r\n        // If we have a source element with audio description attributes, update that instead\r\n        if (this.audioDescriptionSourceElement) {\r\n            const currentSrc = this.element.currentSrc || this.element.src;\r\n            \r\n            // Find the source element that matches the currently active source\r\n            const sourceElements = this.sourceElements;\r\n            let sourceElementToUpdate = null;\r\n            let descSrc = this.audioDescriptionSrc;\r\n            \r\n            for (const sourceEl of sourceElements) {\r\n                const sourceSrc = sourceEl.getAttribute('src');\r\n                const descSrcAttr = sourceEl.getAttribute('data-desc-src');\r\n                \r\n                // Check if this source matches the current source (by filename)\r\n                // Match by full path or just filename\r\n                const sourceFilename = sourceSrc ? sourceSrc.split('/').pop() : '';\r\n                const currentFilename = currentSrc ? currentSrc.split('/').pop() : '';\r\n                \r\n                if (currentSrc && (currentSrc === sourceSrc || \r\n                    currentSrc.includes(sourceSrc) || \r\n                    currentSrc.includes(sourceFilename) ||\r\n                    (sourceFilename && currentFilename === sourceFilename))) {\r\n                    sourceElementToUpdate = sourceEl;\r\n                    if (descSrcAttr) {\r\n                        descSrc = descSrcAttr;\r\n                    } else if (sourceSrc) {\r\n                        // If no data-desc-src, try to construct it from the source\r\n                        // But prefer the stored audioDescriptionSrc if available\r\n                        descSrc = this.audioDescriptionSrc || descSrc;\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            \r\n            // If we didn't find a match, use the stored source element\r\n            if (!sourceElementToUpdate) {\r\n                sourceElementToUpdate = this.audioDescriptionSourceElement;\r\n                // Ensure we have the correct descSrc from the stored element\r\n                const storedDescSrc = sourceElementToUpdate.getAttribute('data-desc-src');\r\n                if (storedDescSrc) {\r\n                    descSrc = storedDescSrc;\r\n                }\r\n            }\r\n            \r\n            // Swap caption tracks to described versions BEFORE loading\r\n            if (this.audioDescriptionCaptionTracks.length > 0) {\r\n                // Swap tracks: validate explicit tracks, but try auto-detected tracks without validation\r\n                // This avoids 404 errors while still allowing auto-detection to work\r\n                const validationPromises = this.audioDescriptionCaptionTracks.map(async (trackInfo) => {\r\n                    if (trackInfo.trackElement && trackInfo.describedSrc) {\r\n                        // Only validate explicitly defined tracks (to confirm they exist)\r\n                        // Auto-detected tracks are used without validation (browser will handle missing files gracefully)\r\n                        if (trackInfo.explicit === true) {\r\n                            try {\r\n                                const exists = await this.validateTrackExists(trackInfo.describedSrc);\r\n                                return { trackInfo, exists };\r\n                            } catch (error) {\r\n                                // Silently handle validation errors\r\n                                return { trackInfo, exists: false };\r\n                            }\r\n                        } else {\r\n                            // This shouldn't happen since auto-detection is disabled\r\n                            // But if it does, don't validate to avoid 404s\r\n                            return { trackInfo, exists: false };\r\n                        }\r\n                    }\r\n                    return { trackInfo, exists: false };\r\n                });\r\n                \r\n                const validationResults = await Promise.all(validationPromises);\r\n                const tracksToSwap = validationResults.filter(result => result.exists);\r\n                \r\n                if (tracksToSwap.length > 0) {\r\n                    // Store original track modes before removing tracks\r\n                    const trackModes = new Map();\r\n                    tracksToSwap.forEach(({ trackInfo }) => {\r\n                        const textTrack = trackInfo.trackElement.track;\r\n                        if (textTrack) {\r\n                            trackModes.set(trackInfo, {\r\n                                wasShowing: textTrack.mode === 'showing',\r\n                                wasHidden: textTrack.mode === 'hidden'\r\n                            });\r\n                        } else {\r\n                            trackModes.set(trackInfo, {\r\n                                wasShowing: false,\r\n                                wasHidden: false\r\n                            });\r\n                        }\r\n                    });\r\n                    \r\n                    // Store all track information before removing\r\n                    const tracksToReadd = tracksToSwap.map(({ trackInfo }) => {\r\n                        const oldSrc = trackInfo.trackElement.getAttribute('src');\r\n                        const parent = trackInfo.trackElement.parentNode;\r\n                        const nextSibling = trackInfo.trackElement.nextSibling;\r\n                        \r\n                        // Store all attributes from the old track\r\n                        const attributes = {};\r\n                        Array.from(trackInfo.trackElement.attributes).forEach(attr => {\r\n                            attributes[attr.name] = attr.value;\r\n                        });\r\n                        \r\n                        return {\r\n                            trackInfo,\r\n                            oldSrc,\r\n                            parent,\r\n                            nextSibling,\r\n                            attributes\r\n                        };\r\n                    });\r\n                    \r\n                    // Remove ALL old tracks first to force browser to clear TextTrack objects\r\n                    tracksToReadd.forEach(({ trackInfo }) => {\r\n                        trackInfo.trackElement.remove();\r\n                    });\r\n                    \r\n                    // Force browser to process the removal by calling load()\r\n                    this.element.load();\r\n                    \r\n                    // Wait for browser to process the removal, then add new tracks\r\n                    // Use await to ensure this completes before continuing\r\n                    await new Promise(resolve => {\r\n                        setTimeout(() => {\r\n                            tracksToReadd.forEach(({ trackInfo, oldSrc, parent, nextSibling, attributes }) => {\r\n                                swappedTracksForTranscript.push(trackInfo);\r\n                                \r\n                                // Create a completely new track element (not a clone) to force browser to create new TextTrack\r\n                                const newTrackElement = document.createElement('track');\r\n                                newTrackElement.setAttribute('src', trackInfo.describedSrc);\r\n                                \r\n                                // Copy all attributes except src and data-desc-src\r\n                                Object.keys(attributes).forEach(attrName => {\r\n                                    if (attrName !== 'src' && attrName !== 'data-desc-src') {\r\n                                        newTrackElement.setAttribute(attrName, attributes[attrName]);\r\n                                    }\r\n                                });\r\n                                \r\n                                // Insert new track element\r\n                                if (nextSibling && nextSibling.parentNode) {\r\n                                    parent.insertBefore(newTrackElement, nextSibling);\r\n                                } else {\r\n                                    parent.appendChild(newTrackElement);\r\n                                }\r\n                                \r\n                                // Update reference to the new track element\r\n                                trackInfo.trackElement = newTrackElement;\r\n                            });\r\n                            \r\n                            this.invalidateTrackCache();\r\n                            \r\n                            // Wait for loadedmetadata event before accessing new TextTrack objects\r\n                            const setupNewTracks = () => {\r\n                                // Wait a bit more for browser to fully process the new track elements\r\n                                this.setManagedTimeout(() => {\r\n                                    swappedTracksForTranscript.forEach((trackInfo) => {\r\n                                        const trackElement = trackInfo.trackElement;\r\n                                        const newTextTrack = trackElement.track;\r\n                                        \r\n                                        if (newTextTrack) {\r\n                                            // Get original mode from stored map\r\n                                            const modeInfo = trackModes.get(trackInfo) || { wasShowing: false, wasHidden: false };\r\n                                            \r\n                                            // Set mode to load the new track\r\n                                            newTextTrack.mode = 'hidden'; // Use hidden to load cues without showing\r\n                                            \r\n                                            // Restore original mode after track loads\r\n                                            // Note: CaptionManager will handle enabling captions separately\r\n                                            const restoreMode = () => {\r\n                                                if (modeInfo.wasShowing) {\r\n                                                    // Set to hidden - CaptionManager will set it to showing when it enables\r\n                                                    newTextTrack.mode = 'hidden';\r\n                                                } else if (modeInfo.wasHidden) {\r\n                                                    newTextTrack.mode = 'hidden';\r\n                                                } else {\r\n                                                    newTextTrack.mode = 'disabled';\r\n                                                }\r\n                                            };\r\n                                            \r\n                                            // Wait for track to load\r\n                                            if (newTextTrack.readyState >= 2) { // LOADED\r\n                                                restoreMode();\r\n                                            } else {\r\n                                                newTextTrack.addEventListener('load', restoreMode, { once: true });\r\n                                                newTextTrack.addEventListener('error', restoreMode, { once: true });\r\n                                            }\r\n                                        }\r\n                                    });\r\n                                }, 300); // Additional wait for browser to process track elements\r\n                            };\r\n                            \r\n                            // Wait for loadedmetadata event which fires when browser processes track elements\r\n                            if (this.element.readyState >= 1) { // HAVE_METADATA\r\n                                // Already loaded, wait a bit and setup\r\n                                setTimeout(setupNewTracks, 200);\r\n                            } else {\r\n                                this.element.addEventListener('loadedmetadata', setupNewTracks, { once: true });\r\n                                // Fallback timeout\r\n                                setTimeout(setupNewTracks, 2000);\r\n                            }\r\n                            \r\n                            resolve();\r\n                        }, 100);\r\n                    }); // Wait 100ms after first load() before adding new tracks\r\n                    \r\n                    const skippedCount = validationResults.length - tracksToSwap.length;\r\n                }\r\n            }\r\n            \r\n            // Update all source elements that have data-desc-src to their described versions\r\n            // Force browser to pick up changes by removing and re-adding source elements\r\n            // Get source elements (may have been defined in if block above, but get fresh list here)\r\n            const allSourceElements = this.sourceElements;\r\n            const sourcesToUpdate = [];\r\n            \r\n            allSourceElements.forEach((sourceEl) => {\r\n                const descSrcAttr = sourceEl.getAttribute('data-desc-src');\r\n                const currentSrc = sourceEl.getAttribute('src');\r\n                \r\n                if (descSrcAttr) {\r\n                    const type = sourceEl.getAttribute('type');\r\n                    let origSrc = sourceEl.getAttribute('data-orig-src');\r\n                    \r\n                    // Store current src as data-orig-src if not already set\r\n                    if (!origSrc) {\r\n                        origSrc = currentSrc;\r\n                    }\r\n                    \r\n                    // Store info for re-adding with described src\r\n                    sourcesToUpdate.push({\r\n                        src: descSrcAttr,  // Use described version\r\n                        type: type,\r\n                        origSrc: origSrc,\r\n                        descSrc: descSrcAttr\r\n                    });\r\n                } else {\r\n                    // Source element without data-desc-src - keep as-is\r\n                    const type = sourceEl.getAttribute('type');\r\n                    const src = sourceEl.getAttribute('src');\r\n                    sourcesToUpdate.push({\r\n                        src: src,\r\n                        type: type,\r\n                        origSrc: null,\r\n                        descSrc: null\r\n                    });\r\n                }\r\n            });\r\n            \r\n            // Remove src attribute if present (video with src can't have source elements per HTML spec)\r\n            const hasSrcAttribute = this.element.hasAttribute('src');\r\n            const srcValue = hasSrcAttribute ? this.element.getAttribute('src') : null;\r\n            if (hasSrcAttribute) {\r\n                this.element.removeAttribute('src');\r\n            }\r\n            \r\n            // Remove all source elements\r\n            allSourceElements.forEach(sourceEl => {\r\n                sourceEl.remove();\r\n            });\r\n            \r\n            // Re-add them with updated src attributes (described versions)\r\n            sourcesToUpdate.forEach(sourceInfo => {\r\n                const newSource = document.createElement('source');\r\n                newSource.setAttribute('src', sourceInfo.src);\r\n                if (sourceInfo.type) {\r\n                    newSource.setAttribute('type', sourceInfo.type);\r\n                }\r\n                if (sourceInfo.origSrc) {\r\n                    newSource.setAttribute('data-orig-src', sourceInfo.origSrc);\r\n                }\r\n                if (sourceInfo.descSrc) {\r\n                    newSource.setAttribute('data-desc-src', sourceInfo.descSrc);\r\n                }\r\n                const firstTrack = this.element.querySelector('track');\r\n                if (firstTrack) {\r\n                    this.element.insertBefore(newSource, firstTrack);\r\n                } else {\r\n                    this.element.appendChild(newSource);\r\n                }\r\n            });\r\n\r\n            // Ensure cached source references are refreshed after rebuilding the list\r\n            this._sourceElementsDirty = true;\r\n            this._sourceElementsCache = null;\r\n            \r\n            // Preserve poster before reload\r\n            if (posterValue && this.element.tagName === 'VIDEO') {\r\n                this.element.poster = posterValue;\r\n            }\r\n            \r\n            // Force reload by calling load() on the element\r\n            // This should pick up the new src attributes from the re-added source elements\r\n            // and also reload the track elements\r\n            this.element.load();\r\n            \r\n            // Wait for new source to load metadata\r\n            await new Promise((resolve) => {\r\n                const onLoadedMetadata = () => {\r\n                    this.element.removeEventListener('loadedmetadata', onLoadedMetadata);\r\n                    resolve();\r\n                };\r\n                \r\n                if (this.element.readyState >= 1) {\r\n                    // Metadata already loaded\r\n                    resolve();\r\n                } else {\r\n                    this.element.addEventListener('loadedmetadata', onLoadedMetadata);\r\n                }\r\n            });\r\n            \r\n            // Wait a bit more for tracks to be recognized and loaded after video metadata loads\r\n            await new Promise(resolve => setTimeout(resolve, 300));\r\n\r\n            // If we need to seek and/or play, wait for enough data to be loaded\r\n            if (currentTime > 0 || wasPlaying) {\r\n                await new Promise((resolve) => {\r\n                    const onCanPlay = () => {\r\n                        this.element.removeEventListener('canplay', onCanPlay);\r\n                        this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                        resolve();\r\n                    };\r\n                    \r\n                    // Check if already ready\r\n                    if (this.element.readyState >= 3) { // HAVE_FUTURE_DATA or better\r\n                        resolve();\r\n                    } else {\r\n                        // Wait for canplay or canplaythrough\r\n                        this.element.addEventListener('canplay', onCanPlay, { once: true });\r\n                        this.element.addEventListener('canplaythrough', onCanPlay, { once: true });\r\n                        \r\n                        // Fallback timeout in case events don't fire\r\n                        setTimeout(() => {\r\n                            this.element.removeEventListener('canplay', onCanPlay);\r\n                            this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                            resolve();\r\n                        }, 3000);\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Try to find matching caption in the new track for better synchronization\r\n            let syncTime = currentTime;\r\n            if (currentCaptionText && this.captionManager && this.captionManager.tracks.length > 0) {\r\n                // Wait a bit for tracks to load\r\n                await new Promise(resolve => setTimeout(resolve, 500));\r\n                \r\n                // Find the matching caption in the described video's track\r\n                const matchingTime = this.findMatchingCaptionTime(currentCaptionText, this.captionManager.tracks);\r\n                if (matchingTime !== null) {\r\n                    syncTime = matchingTime;\r\n                    if (this.options.debug) {\r\n                        console.log(`[VidPly] Syncing via caption: ${currentTime}s -> ${syncTime}s`);\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Restore playback position (avoid forcing first frame if still at start)\r\n            if (syncTime > 0) {\r\n                this.seek(syncTime);\r\n                // Wait a bit for seek to complete\r\n                await new Promise(resolve => setTimeout(resolve, 100));\r\n            }\r\n\r\n            if (wasPlaying) {\r\n                await this.play();\r\n                // Hide poster when playing - use setTimeout to ensure play event has fired\r\n                this.setManagedTimeout(() => {\r\n                    this.hidePosterOverlay();\r\n                }, 100);\r\n            } else {\r\n                // Explicitly pause the video if it wasn't playing\r\n                // This ensures it's in a clean paused state after load()\r\n                this.pause();\r\n                if (!shouldKeepPoster) {\r\n                    this.hidePosterOverlay();\r\n                }\r\n            }\r\n\r\n            // Update state and emit event\r\n            if (!this._audioDescriptionDesiredState) {\r\n                return;\r\n            }\r\n            this.state.audioDescriptionEnabled = true;\r\n            this.emit('audiodescriptionenabled');\r\n        } else {\r\n            // Fallback to updating element src directly\r\n            // Swap caption tracks to described versions BEFORE loading\r\n            if (this.audioDescriptionCaptionTracks.length > 0) {\r\n                // Swap tracks: validate explicit tracks, but try auto-detected tracks without validation\r\n                const validationPromises = this.audioDescriptionCaptionTracks.map(async (trackInfo) => {\r\n                    if (trackInfo.trackElement && trackInfo.describedSrc) {\r\n                        // Only validate explicitly defined tracks\r\n                        // Auto-detected tracks are used without validation (no 404s)\r\n                        if (trackInfo.explicit === true) {\r\n                            try {\r\n                                const exists = await this.validateTrackExists(trackInfo.describedSrc);\r\n                                return { trackInfo, exists };\r\n                            } catch (error) {\r\n                                return { trackInfo, exists: false };\r\n                            }\r\n                        } else {\r\n                            // This shouldn't happen since auto-detection is disabled\r\n                            return { trackInfo, exists: false };\r\n                        }\r\n                    }\r\n                    return { trackInfo, exists: false };\r\n                });\r\n                \r\n                const validationResults = await Promise.all(validationPromises);\r\n                const tracksToSwap = validationResults.filter(result => result.exists);\r\n                \r\n                if (tracksToSwap.length > 0) {\r\n                    // Store original track modes before removing tracks\r\n                    const trackModes = new Map();\r\n                    tracksToSwap.forEach(({ trackInfo }) => {\r\n                        const textTrack = trackInfo.trackElement.track;\r\n                        if (textTrack) {\r\n                            trackModes.set(trackInfo, {\r\n                                wasShowing: textTrack.mode === 'showing',\r\n                                wasHidden: textTrack.mode === 'hidden'\r\n                            });\r\n                        } else {\r\n                            trackModes.set(trackInfo, {\r\n                                wasShowing: false,\r\n                                wasHidden: false\r\n                            });\r\n                        }\r\n                    });\r\n                    \r\n                    // Store all track information before removing\r\n                    const tracksToReadd = tracksToSwap.map(({ trackInfo }) => {\r\n                        const oldSrc = trackInfo.trackElement.getAttribute('src');\r\n                        const parent = trackInfo.trackElement.parentNode;\r\n                        const nextSibling = trackInfo.trackElement.nextSibling;\r\n                        \r\n                        // Store all attributes from the old track\r\n                        const attributes = {};\r\n                        Array.from(trackInfo.trackElement.attributes).forEach(attr => {\r\n                            attributes[attr.name] = attr.value;\r\n                        });\r\n                        \r\n                        return {\r\n                            trackInfo,\r\n                            oldSrc,\r\n                            parent,\r\n                            nextSibling,\r\n                            attributes\r\n                        };\r\n                    });\r\n                    \r\n                    // Remove ALL old tracks first to force browser to clear TextTrack objects\r\n                    tracksToReadd.forEach(({ trackInfo }) => {\r\n                        trackInfo.trackElement.remove();\r\n                    });\r\n                    \r\n                    // Force browser to process the removal by calling load()\r\n                    this.element.load();\r\n                    \r\n                    // Wait for browser to process the removal, then add new tracks\r\n                    setTimeout(() => {\r\n                        tracksToReadd.forEach(({ trackInfo, oldSrc, parent, nextSibling, attributes }) => {\r\n                            swappedTracksForTranscript.push(trackInfo);\r\n                            \r\n                            // Create a completely new track element (not a clone) to force browser to create new TextTrack\r\n                            const newTrackElement = document.createElement('track');\r\n                            newTrackElement.setAttribute('src', trackInfo.describedSrc);\r\n                            \r\n                            // Copy all attributes except src and data-desc-src\r\n                            Object.keys(attributes).forEach(attrName => {\r\n                                if (attrName !== 'src' && attrName !== 'data-desc-src') {\r\n                                    newTrackElement.setAttribute(attrName, attributes[attrName]);\r\n                                }\r\n                            });\r\n                            \r\n                            // Insert new track element at the beginning (before any flow content) for HTML5 validity\r\n                            const firstChild = parent.firstChild;\r\n                            if (firstChild && firstChild.nodeType === Node.ELEMENT_NODE && firstChild.tagName !== 'TRACK') {\r\n                                parent.insertBefore(newTrackElement, firstChild);\r\n                            } else if (nextSibling && nextSibling.parentNode) {\r\n                                parent.insertBefore(newTrackElement, nextSibling);\r\n                            } else {\r\n                                parent.appendChild(newTrackElement);\r\n                            }\r\n                            \r\n                            // Update reference to the new track element\r\n                            trackInfo.trackElement = newTrackElement;\r\n                        });\r\n                        \r\n                        // After all new tracks are added, force browser to reload media element again\r\n                        this.element.load();\r\n                        \r\n                        // Wait for loadedmetadata event before accessing new TextTrack objects\r\n                        const setupNewTracks = () => {\r\n                            // Wait a bit more for browser to fully process the new track elements\r\n                            setTimeout(() => {\r\n                                swappedTracksForTranscript.forEach((trackInfo) => {\r\n                                    const trackElement = trackInfo.trackElement;\r\n                                    const newTextTrack = trackElement.track;\r\n                                    \r\n                                    if (newTextTrack) {\r\n                                        // Get original mode from stored map\r\n                                        const modeInfo = trackModes.get(trackInfo) || { wasShowing: false, wasHidden: false };\r\n                                        \r\n                                        // Set mode to load the new track\r\n                                        newTextTrack.mode = 'hidden'; // Use hidden to load cues without showing\r\n                                        \r\n                                        // Restore original mode after track loads\r\n                                        const restoreMode = () => {\r\n                                            if (modeInfo.wasShowing) {\r\n                                                // Set to hidden - CaptionManager will set it to showing when it enables\r\n                                                newTextTrack.mode = 'hidden';\r\n                                            } else if (modeInfo.wasHidden) {\r\n                                                newTextTrack.mode = 'hidden';\r\n                                            } else {\r\n                                                newTextTrack.mode = 'disabled';\r\n                                            }\r\n                                        };\r\n                                        \r\n                                        // Wait for track to load\r\n                                        if (newTextTrack.readyState >= 2) { // LOADED\r\n                                            restoreMode();\r\n                                        } else {\r\n                                            newTextTrack.addEventListener('load', restoreMode, { once: true });\r\n                                            newTextTrack.addEventListener('error', restoreMode, { once: true });\r\n                                        }\r\n                                    }\r\n                                });\r\n                            }, 300); // Additional wait for browser to process track elements\r\n                        };\r\n                        \r\n                        // Wait for loadedmetadata event which fires when browser processes track elements\r\n                        if (this.element.readyState >= 1) { // HAVE_METADATA\r\n                            // Already loaded, wait a bit and setup\r\n                            setTimeout(setupNewTracks, 200);\r\n                        } else {\r\n                            this.element.addEventListener('loadedmetadata', setupNewTracks, { once: true });\r\n                            // Fallback timeout\r\n                            setTimeout(setupNewTracks, 2000);\r\n                        }\r\n                    }, 100); // Wait 100ms after first load() before adding new tracks\r\n                }\r\n            }\r\n            \r\n            // Check if we have source elements with data-desc-src (fallback method)\r\n            const fallbackSourceElements = this.sourceElements;\r\n            const hasSourceElementsWithDesc = fallbackSourceElements.some(el => el.getAttribute('data-desc-src'));\r\n            \r\n            if (hasSourceElementsWithDesc) {\r\n                const fallbackSourcesToUpdate = [];\r\n                \r\n                fallbackSourceElements.forEach((sourceEl) => {\r\n                    const descSrcAttr = sourceEl.getAttribute('data-desc-src');\r\n                    const currentSrc = sourceEl.getAttribute('src');\r\n                    \r\n                    if (descSrcAttr) {\r\n                        const type = sourceEl.getAttribute('type');\r\n                        let origSrc = sourceEl.getAttribute('data-orig-src');\r\n                        \r\n                        if (!origSrc) {\r\n                            origSrc = currentSrc;\r\n                        }\r\n                        \r\n                        fallbackSourcesToUpdate.push({\r\n                            src: descSrcAttr,\r\n                            type: type,\r\n                            origSrc: origSrc,\r\n                            descSrc: descSrcAttr\r\n                        });\r\n                    } else {\r\n                        const type = sourceEl.getAttribute('type');\r\n                        const src = sourceEl.getAttribute('src');\r\n                        fallbackSourcesToUpdate.push({\r\n                            src: src,\r\n                            type: type,\r\n                            origSrc: null,\r\n                            descSrc: null\r\n                        });\r\n                    }\r\n                });\r\n                \r\n                // Remove all source elements\r\n                fallbackSourceElements.forEach(sourceEl => {\r\n                    sourceEl.remove();\r\n                });\r\n                \r\n                // Re-add them with updated src attributes\r\n                fallbackSourcesToUpdate.forEach(sourceInfo => {\r\n                    const newSource = document.createElement('source');\r\n                    newSource.setAttribute('src', sourceInfo.src);\r\n                    if (sourceInfo.type) {\r\n                        newSource.setAttribute('type', sourceInfo.type);\r\n                    }\r\n                    if (sourceInfo.origSrc) {\r\n                        newSource.setAttribute('data-orig-src', sourceInfo.origSrc);\r\n                    }\r\n                    if (sourceInfo.descSrc) {\r\n                        newSource.setAttribute('data-desc-src', sourceInfo.descSrc);\r\n                    }\r\n                    this.element.appendChild(newSource);\r\n                });\r\n                \r\n                // Preserve poster before reload\r\n                if (posterValue && this.element.tagName === 'VIDEO') {\r\n                    this.element.poster = posterValue;\r\n                }\r\n                \r\n                // Force reload\r\n                this.element.load();\r\n                this.invalidateTrackCache();\r\n            } else {\r\n                // Fallback to updating element src directly (for videos without source elements)\r\n                // Preserve poster before changing src\r\n                if (posterValue && this.element.tagName === 'VIDEO') {\r\n                    this.element.poster = posterValue;\r\n                }\r\n                this.element.src = this.audioDescriptionSrc;\r\n            }\r\n        }\r\n\r\n        // Wait for new source to load metadata\r\n        await new Promise((resolve) => {\r\n            const onLoadedMetadata = () => {\r\n                this.element.removeEventListener('loadedmetadata', onLoadedMetadata);\r\n                resolve();\r\n            };\r\n            \r\n            if (this.element.readyState >= 1) {\r\n                // Metadata already loaded\r\n                resolve();\r\n            } else {\r\n                this.element.addEventListener('loadedmetadata', onLoadedMetadata);\r\n            }\r\n        });\r\n\r\n        // If we need to seek and/or play, wait for enough data to be loaded\r\n        if (currentTime > 0 || wasPlaying) {\r\n            await new Promise((resolve) => {\r\n                const onCanPlay = () => {\r\n                    this.element.removeEventListener('canplay', onCanPlay);\r\n                    this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                    resolve();\r\n                };\r\n                \r\n                // Check if already ready\r\n                if (this.element.readyState >= 3) { // HAVE_FUTURE_DATA or better\r\n                    resolve();\r\n                } else {\r\n                    // Wait for canplay or canplaythrough\r\n                    this.element.addEventListener('canplay', onCanPlay, { once: true });\r\n                    this.element.addEventListener('canplaythrough', onCanPlay, { once: true });\r\n                    \r\n                    // Fallback timeout in case events don't fire\r\n                    setTimeout(() => {\r\n                        this.element.removeEventListener('canplay', onCanPlay);\r\n                        this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                        resolve();\r\n                    }, 3000);\r\n                }\r\n            });\r\n        }\r\n\r\n        // Hide poster if video hasn't started yet (poster should hide when we seek or play)\r\n        if (this.element.tagName === 'VIDEO' && currentTime === 0 && !wasPlaying) {\r\n            // Force poster to hide by doing a minimal seek or loading first frame\r\n            // Setting readyState check or seeking to 0.001 seconds will hide the poster\r\n            if (this.element.readyState >= 1) { // HAVE_METADATA\r\n                // Seek to a tiny fraction to trigger poster hiding without actually moving\r\n                this.element.currentTime = 0.001;\r\n                // Then seek back to 0 after a brief moment to ensure poster stays hidden\r\n                this.setManagedTimeout(() => {\r\n                    this.element.currentTime = 0;\r\n                }, 10);\r\n            }\r\n        }\r\n\r\n        // Try to find matching caption in the new track for better synchronization\r\n        let syncTime = currentTime;\r\n        if (currentCaptionText && this.captionManager && this.captionManager.tracks.length > 0) {\r\n            // Wait a bit for tracks to load\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n            \r\n            // Find the matching caption in the described video's track\r\n            const matchingTime = this.findMatchingCaptionTime(currentCaptionText, this.captionManager.tracks);\r\n            if (matchingTime !== null) {\r\n                syncTime = matchingTime;\r\n                if (this.options.debug) {\r\n                    console.log(`[VidPly] Syncing via caption: ${currentTime}s -> ${syncTime}s`);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Restore playback position (avoid forcing first frame if still at start)\r\n        if (syncTime > 0) {\r\n            this.seek(syncTime);\r\n            // Wait a bit for seek to complete\r\n            await new Promise(resolve => setTimeout(resolve, 100));\r\n        }\r\n\r\n        if (wasPlaying) {\r\n            await this.play();\r\n            // Hide poster when playing - use setTimeout to ensure play event has fired\r\n            this.setManagedTimeout(() => {\r\n                this.hidePosterOverlay();\r\n            }, 100);\r\n        } else {\r\n            // Explicitly pause the video if it wasn't playing\r\n            // This ensures it's in a clean paused state after load()\r\n            this.pause();\r\n            if (!shouldKeepPoster) {\r\n                this.hidePosterOverlay();\r\n            }\r\n        }\r\n\r\n        // Reload CaptionManager tracks if tracks were swapped (so it has fresh references)\r\n        if (swappedTracksForTranscript.length > 0 && this.captionManager) {\r\n            // Store if captions were enabled and which track\r\n            const wasCaptionsEnabled = this.state.captionsEnabled;\r\n            let currentTrackInfo = null;\r\n            if (this.captionManager.currentTrack) {\r\n                const currentTrackIndex = this.captionManager.tracks.findIndex(t => t.track === this.captionManager.currentTrack.track);\r\n                if (currentTrackIndex >= 0) {\r\n                    currentTrackInfo = {\r\n                        language: this.captionManager.tracks[currentTrackIndex].language,\r\n                        kind: this.captionManager.tracks[currentTrackIndex].kind\r\n                    };\r\n                }\r\n            }\r\n            \r\n            // Wait for new tracks to be available and loaded, then reload\r\n            // Use a longer timeout and wait for track load events\r\n            const reloadTracks = () => {\r\n                // Reload tracks to get fresh references to new TextTrack objects\r\n                this.captionManager.tracks = [];\r\n                this.captionManager.loadTracks();\r\n                \r\n                // Re-enable captions if they were enabled before\r\n                if (wasCaptionsEnabled && currentTrackInfo && this.captionManager.tracks.length > 0) {\r\n                    // Find the track by language and kind to match the swapped track\r\n                    const matchingTrackIndex = this.captionManager.tracks.findIndex(t => \r\n                        t.language === currentTrackInfo.language && t.kind === currentTrackInfo.kind\r\n                    );\r\n                    \r\n                    if (matchingTrackIndex >= 0) {\r\n                        const trackToEnable = this.captionManager.tracks[matchingTrackIndex];\r\n                        // Wait for track to load its cues before enabling\r\n                        if (trackToEnable.track.readyState >= 2) {\r\n                            // Track is already loaded\r\n                            this.captionManager.enable(matchingTrackIndex);\r\n                        } else {\r\n                            // Wait for track to load\r\n                            const onTrackLoad = () => {\r\n                                trackToEnable.track.removeEventListener('load', onTrackLoad);\r\n                                trackToEnable.track.removeEventListener('error', onTrackLoad);\r\n                                if (this.captionManager && this.captionManager.tracks.includes(trackToEnable)) {\r\n                                    this.captionManager.enable(matchingTrackIndex);\r\n                                }\r\n                            };\r\n                            trackToEnable.track.addEventListener('load', onTrackLoad, { once: true });\r\n                            trackToEnable.track.addEventListener('error', onTrackLoad, { once: true });\r\n                            // Set mode to 'hidden' to trigger loading\r\n                            trackToEnable.track.mode = 'hidden';\r\n                            // Fallback timeout\r\n                            setTimeout(() => {\r\n                                if (this.captionManager && this.captionManager.tracks.includes(trackToEnable)) {\r\n                                    this.captionManager.enable(matchingTrackIndex);\r\n                                }\r\n                            }, 1000);\r\n                        }\r\n                    } else if (this.captionManager.tracks.length > 0) {\r\n                        // Fallback: enable first track\r\n                        const firstTrack = this.captionManager.tracks[0];\r\n                        if (firstTrack.track.readyState >= 2) {\r\n                            this.captionManager.enable(0);\r\n                        } else {\r\n                            const onTrackLoad = () => {\r\n                                firstTrack.track.removeEventListener('load', onTrackLoad);\r\n                                firstTrack.track.removeEventListener('error', onTrackLoad);\r\n                                if (this.captionManager && this.captionManager.tracks.includes(firstTrack)) {\r\n                                    this.captionManager.enable(0);\r\n                                }\r\n                            };\r\n                            firstTrack.track.addEventListener('load', onTrackLoad, { once: true });\r\n                            firstTrack.track.addEventListener('error', onTrackLoad, { once: true });\r\n                            firstTrack.track.mode = 'hidden';\r\n                            setTimeout(() => {\r\n                                if (this.captionManager && this.captionManager.tracks.includes(firstTrack)) {\r\n                                    this.captionManager.enable(0);\r\n                                }\r\n                            }, 1000);\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n            \r\n            // Wait for tracks to be processed by the browser\r\n            setTimeout(reloadTracks, 600);\r\n        }\r\n\r\n        // Reload transcript if visible (after video metadata loaded, tracks should be available)\r\n        // Reload regardless of whether caption tracks were swapped, in case tracks changed\r\n        if (this.transcriptManager && this.transcriptManager.isVisible) {\r\n            // Wait for tracks to load after source swap\r\n            // If tracks were swapped, wait for them to load; otherwise wait a bit for any track changes\r\n            const swappedTracks = typeof swappedTracksForTranscript !== 'undefined' ? swappedTracksForTranscript : [];\r\n            \r\n            if (swappedTracks.length > 0) {\r\n                // Wait for swapped tracks to load their new cues\r\n                // Since we re-added track elements and called load(), wait for loadedmetadata event\r\n                // which is when the browser processes track elements\r\n                const onMetadataLoaded = () => {\r\n                    // Get fresh track references from the video element's textTracks collection\r\n                    // This ensures we get the actual textTrack objects that the browser created\r\n                    // Invalidate cache first to get fresh tracks after swap\r\n                    this.invalidateTrackCache();\r\n                    const allTextTracks = this.textTracks;\r\n                    \r\n                    // Find the tracks that match our swapped tracks by language and kind\r\n                    // Match by checking the track element's src attribute\r\n                    const freshTracks = swappedTracks.map((trackInfo) => {\r\n                        const trackEl = trackInfo.trackElement;\r\n                        const expectedSrc = trackEl.getAttribute('src');\r\n                        const srclang = trackEl.getAttribute('srclang');\r\n                        const kind = trackEl.getAttribute('kind');\r\n                        \r\n                        // Find matching track in textTracks collection\r\n                        // First try to match by the track element reference\r\n                        let foundTrack = allTextTracks.find(track => trackEl.track === track);\r\n                        \r\n                        // If not found, try matching by language and kind, but verify src\r\n                        if (!foundTrack) {\r\n                            foundTrack = allTextTracks.find(track => {\r\n                                if (track.language === srclang && \r\n                                    (track.kind === kind || (kind === 'captions' && track.kind === 'subtitles'))) {\r\n                                    // Verify the src matches\r\n                                    const trackElementForTrack = this.findTrackElement(track);\r\n                                    if (trackElementForTrack) {\r\n                                        const actualSrc = trackElementForTrack.getAttribute('src');\r\n                                        if (actualSrc === expectedSrc) {\r\n                                            return true;\r\n                                        }\r\n                                    }\r\n                                }\r\n                                return false;\r\n                            });\r\n                        }\r\n                        \r\n                        // Verify the track element's src matches what we expect\r\n                        if (foundTrack) {\r\n                            const trackElement = this.findTrackElement(foundTrack);\r\n                            if (trackElement && trackElement.getAttribute('src') !== expectedSrc) {\r\n                                return null;\r\n                            }\r\n                        }\r\n                        \r\n                        return foundTrack;\r\n                    }).filter(Boolean);\r\n                    \r\n                    if (freshTracks.length === 0) {\r\n                        // Fallback: just reload after delay - transcript manager will find tracks itself\r\n                        this.setManagedTimeout(() => {\r\n                            if (this.transcriptManager && this.transcriptManager.loadTranscriptData) {\r\n                                this.transcriptManager.loadTranscriptData();\r\n                            }\r\n                        }, 1000);\r\n                        return;\r\n                    }\r\n                    \r\n                    // Ensure tracks are in hidden mode to load cues for transcript\r\n                    freshTracks.forEach(track => {\r\n                        if (track.mode === 'disabled') {\r\n                            track.mode = 'hidden';\r\n                        }\r\n                    });\r\n                    \r\n                    let loadedCount = 0;\r\n                    const checkLoaded = () => {\r\n                        loadedCount++;\r\n                        if (loadedCount >= freshTracks.length) {\r\n                            // Give a bit more time for cues to be fully parsed\r\n                            // Also ensure we're getting the latest TextTrack references\r\n                            this.setManagedTimeout(() => {\r\n                                if (this.transcriptManager && this.transcriptManager.loadTranscriptData) {\r\n                                    // Force transcript manager to get fresh track references\r\n                                    // Clear any cached track references by forcing a fresh read\r\n                                    // The transcript manager will find tracks from this.element.textTracks\r\n                                    // which should now have the new TextTrack objects with the described captions\r\n                                    \r\n                                    // Verify the tracks have the correct src before reloading transcript\r\n                                    this.invalidateTrackCache();\r\n                                    const allTextTracks = this.textTracks;\r\n                                    const swappedTrackSrcs = swappedTracks.map(t => t.describedSrc);\r\n                                    const hasCorrectTracks = freshTracks.some(track => {\r\n                                        const trackEl = this.findTrackElement(track);\r\n                                        return trackEl && swappedTrackSrcs.includes(trackEl.getAttribute('src'));\r\n                                    });\r\n                                    \r\n                                    if (hasCorrectTracks || freshTracks.length > 0) {\r\n                                        this.transcriptManager.loadTranscriptData();\r\n                                    }\r\n                                }\r\n                            }, 800); // Increased wait time to ensure cues are fully loaded\r\n                        }\r\n                    };\r\n                    \r\n                    freshTracks.forEach(track => {\r\n                        // Ensure track is in hidden mode to load cues (required for transcript)\r\n                        if (track.mode === 'disabled') {\r\n                            track.mode = 'hidden';\r\n                        }\r\n                        \r\n                        // Check if track has cues loaded\r\n                        // Verify the track element's src matches the expected described src\r\n                        const trackElementForTrack = this.findTrackElement(track);\r\n                        const actualSrc = trackElementForTrack ? trackElementForTrack.getAttribute('src') : null;\r\n                        \r\n                        // Find the expected src from swappedTracks\r\n                        const expectedTrackInfo = swappedTracks.find(t => {\r\n                            const tEl = t.trackElement;\r\n                            return tEl && (tEl.track === track || \r\n                                (tEl.getAttribute('srclang') === track.language && \r\n                                 tEl.getAttribute('kind') === track.kind));\r\n                        });\r\n                        const expectedSrc = expectedTrackInfo ? expectedTrackInfo.describedSrc : null;\r\n                        \r\n                        // Only proceed if the src matches (or we can't verify)\r\n                        if (expectedSrc && actualSrc && actualSrc !== expectedSrc) {\r\n                            // Wrong track, skip it\r\n                            checkLoaded(); // Count it as loaded to not block\r\n                            return;\r\n                        }\r\n                        \r\n                        if (track.readyState >= 2 && track.cues && track.cues.length > 0) { // LOADED with cues\r\n                            // Track already loaded with cues\r\n                            checkLoaded();\r\n                        } else {\r\n                            // Force track to load by setting mode\r\n                            if (track.mode === 'disabled') {\r\n                                track.mode = 'hidden';\r\n                            }\r\n                            \r\n                            // Wait for track to load\r\n                            const onTrackLoad = () => {\r\n                                // Wait a bit for cues to be fully parsed\r\n                                this.setManagedTimeout(checkLoaded, 300);\r\n                            };\r\n                            \r\n                            if (track.readyState >= 2) {\r\n                                // Already loaded, but might not have cues yet\r\n                                // Wait a bit and check again\r\n                                this.setManagedTimeout(() => {\r\n                                    if (track.cues && track.cues.length > 0) {\r\n                                        checkLoaded();\r\n                                    } else {\r\n                                        // Still no cues, wait for load event\r\n                                        track.addEventListener('load', onTrackLoad, { once: true });\r\n                                    }\r\n                                }, 100);\r\n                            } else {\r\n                                track.addEventListener('load', onTrackLoad, { once: true });\r\n                                track.addEventListener('error', () => {\r\n                                    // Even on error, try to reload transcript\r\n                                    checkLoaded();\r\n                                }, { once: true });\r\n                            }\r\n                        }\r\n                    });\r\n                };\r\n                \r\n                // Wait for loadedmetadata event which fires when browser processes track elements\r\n                // Also wait for the tracks to be fully processed after the second load()\r\n                const waitForTracks = () => {\r\n                        // Wait a bit more to ensure new TextTrack objects are created\r\n                        this.setManagedTimeout(() => {\r\n                            if (this.element.readyState >= 1) { // HAVE_METADATA\r\n                                onMetadataLoaded();\r\n                            } else {\r\n                                this.element.addEventListener('loadedmetadata', onMetadataLoaded, { once: true });\r\n                                // Fallback timeout\r\n                                this.setManagedTimeout(onMetadataLoaded, 2000);\r\n                            }\r\n                        }, 500); // Wait 500ms after second load() for tracks to be processed\r\n                };\r\n                \r\n                waitForTracks();\r\n                \r\n                // Fallback timeout - longer to ensure tracks are loaded\r\n                setTimeout(() => {\r\n                    if (this.transcriptManager && this.transcriptManager.loadTranscriptData) {\r\n                        this.transcriptManager.loadTranscriptData();\r\n                    }\r\n                }, 5000);\r\n            } else {\r\n                // No tracks swapped, just wait a bit and reload\r\n                setTimeout(() => {\r\n                    if (this.transcriptManager && this.transcriptManager.loadTranscriptData) {\r\n                        this.transcriptManager.loadTranscriptData();\r\n                    }\r\n                }, 800);\r\n            }\r\n        }\r\n\r\n        if (!shouldKeepPoster) {\r\n            this.hidePosterOverlay();\r\n        }\r\n\r\n        if (!this._audioDescriptionDesiredState) {\r\n            return;\r\n        }\r\n\r\n        this.state.audioDescriptionEnabled = true;\r\n        this.emit('audiodescriptionenabled');\r\n    }\r\n\r\n    async disableAudioDescription() {\r\n        return this.audioDescriptionManager.disable();\r\n    }\r\n\r\n    // Legacy method body preserved for reference - can be removed after testing\r\n    async _legacyDisableAudioDescription() {\r\n        if (!this.originalSrc) {\r\n            return;\r\n        }\r\n\r\n        // Store current playback state\r\n        // Use element.currentTime directly, not state, as state may not be up-to-date\r\n        const currentTime = this.element.currentTime;\r\n        const wasPlaying = this.state.playing;\r\n        \r\n        // Try to find the current caption text for synchronization\r\n        // This helps when switching between videos of different lengths\r\n        let currentCaptionText = null;\r\n        if (this.captionManager && this.captionManager.currentTrack) {\r\n            const track = this.captionManager.currentTrack.track;\r\n            if (track && track.activeCues && track.activeCues.length > 0) {\r\n                const activeCue = track.activeCues[0];\r\n                currentCaptionText = this.stripVTTFormatting(activeCue.text);\r\n            }\r\n        }\r\n        \r\n        // Store poster to preserve it during source swap\r\n        // Convert relative paths to absolute URLs to prevent resolution issues\r\n        const posterValue = this.resolvePosterPath(\r\n            this.element.getAttribute('poster') || \r\n            this.element.poster || \r\n            this.options.poster\r\n        );\r\n\r\n        // Swap caption/chapter tracks back to original versions BEFORE loading\r\n        // Store swapped tracks for transcript reload\r\n        let swappedTracksForTranscript = [];\r\n        if (this.audioDescriptionCaptionTracks.length > 0) {\r\n            // Store track information before removing\r\n            const tracksToRestore = this.audioDescriptionCaptionTracks.map((trackInfo) => {\r\n                const trackElement = trackInfo.trackElement;\r\n                if (!trackElement || !trackElement.parentNode) {\r\n                    return null;\r\n                }\r\n                \r\n                const parent = trackElement.parentNode;\r\n                const nextSibling = trackElement.nextSibling;\r\n                \r\n                // Store all attributes from the current track\r\n                const attributes = {};\r\n                Array.from(trackElement.attributes).forEach(attr => {\r\n                    attributes[attr.name] = attr.value;\r\n                });\r\n                \r\n                return {\r\n                    trackInfo,\r\n                    parent,\r\n                    nextSibling,\r\n                    attributes\r\n                };\r\n            }).filter(Boolean);\r\n            \r\n            // Remove all current track elements\r\n            tracksToRestore.forEach(({ trackInfo }) => {\r\n                if (trackInfo.trackElement && trackInfo.trackElement.parentNode) {\r\n                    trackInfo.trackElement.remove();\r\n                }\r\n            });\r\n            \r\n            // Force browser to process the removal\r\n            this.element.load();\r\n            \r\n            // Wait for browser to process the removal, then add original tracks back\r\n            // Use await instead of setTimeout to ensure this completes before continuing\r\n            await new Promise(resolve => {\r\n                setTimeout(() => {\r\n                    tracksToRestore.forEach(({ trackInfo, parent, nextSibling, attributes }) => {\r\n                        swappedTracksForTranscript.push(trackInfo);\r\n                        \r\n                        // Create a new track element with the original src\r\n                        const newTrackElement = document.createElement('track');\r\n                        newTrackElement.setAttribute('src', trackInfo.originalTrackSrc);\r\n                        \r\n                        // Copy all attributes except src and data-desc-src\r\n                        Object.keys(attributes).forEach(attrName => {\r\n                            if (attrName !== 'src' && attrName !== 'data-desc-src') {\r\n                                newTrackElement.setAttribute(attrName, attributes[attrName]);\r\n                            }\r\n                        });\r\n                        \r\n                        // Keep data-desc-src for future swaps\r\n                        if (trackInfo.describedSrc) {\r\n                            newTrackElement.setAttribute('data-desc-src', trackInfo.describedSrc);\r\n                        }\r\n                        \r\n                        // Insert new track element\r\n                        if (nextSibling && nextSibling.parentNode) {\r\n                            parent.insertBefore(newTrackElement, nextSibling);\r\n                        } else {\r\n                            parent.appendChild(newTrackElement);\r\n                        }\r\n                        \r\n                        // Update reference to the new track element\r\n                        trackInfo.trackElement = newTrackElement;\r\n                    });\r\n                    \r\n                    this.invalidateTrackCache();\r\n                    resolve();\r\n                }, 100);\r\n            });\r\n        }\r\n        \r\n        // Swap source elements back to original versions\r\n        // Check if we have source elements with data-orig-src\r\n        const allSourceElements = this.sourceElements;\r\n        const hasSourceElementsToSwap = allSourceElements.some(el => el.getAttribute('data-orig-src'));\r\n        \r\n        if (hasSourceElementsToSwap) {\r\n            const sourcesToRestore = [];\r\n            \r\n            allSourceElements.forEach((sourceEl) => {\r\n                const origSrcAttr = sourceEl.getAttribute('data-orig-src');\r\n                const descSrcAttr = sourceEl.getAttribute('data-desc-src');\r\n                \r\n                if (origSrcAttr) {\r\n                    // Swap back to original src\r\n                    const type = sourceEl.getAttribute('type');\r\n                    sourcesToRestore.push({\r\n                        src: origSrcAttr,  // Use original version\r\n                        type: type,\r\n                        origSrc: origSrcAttr,\r\n                        descSrc: descSrcAttr  // Keep data-desc-src for future swaps\r\n                    });\r\n                } else {\r\n                    // Keep as-is (no data-orig-src means it wasn't swapped)\r\n                    const type = sourceEl.getAttribute('type');\r\n                    const src = sourceEl.getAttribute('src');\r\n                    sourcesToRestore.push({\r\n                        src: src,\r\n                        type: type,\r\n                        origSrc: null,\r\n                        descSrc: descSrcAttr\r\n                    });\r\n                }\r\n            });\r\n            \r\n            // Remove src attribute if present (video with src can't have source elements per HTML spec)\r\n            const hasSrcAttribute = this.element.hasAttribute('src');\r\n            const srcValue = hasSrcAttribute ? this.element.getAttribute('src') : null;\r\n            if (hasSrcAttribute) {\r\n                this.element.removeAttribute('src');\r\n            }\r\n            \r\n            // Remove all source elements\r\n            allSourceElements.forEach(sourceEl => {\r\n                sourceEl.remove();\r\n            });\r\n            \r\n            // Re-add them with original src attributes\r\n            sourcesToRestore.forEach(sourceInfo => {\r\n                const newSource = document.createElement('source');\r\n                newSource.setAttribute('src', sourceInfo.src);\r\n                if (sourceInfo.type) {\r\n                    newSource.setAttribute('type', sourceInfo.type);\r\n                }\r\n                if (sourceInfo.origSrc) {\r\n                    newSource.setAttribute('data-orig-src', sourceInfo.origSrc);\r\n                }\r\n                if (sourceInfo.descSrc) {\r\n                    newSource.setAttribute('data-desc-src', sourceInfo.descSrc);\r\n                }\r\n                const firstTrack = this.element.querySelector('track');\r\n                if (firstTrack) {\r\n                    this.element.insertBefore(newSource, firstTrack);\r\n                } else {\r\n                    this.element.appendChild(newSource);\r\n                }\r\n            });\r\n\r\n            // Ensure cached source references are refreshed after rebuilding the list\r\n            this._sourceElementsDirty = true;\r\n            this._sourceElementsCache = null;\r\n            \r\n            // Preserve poster before reload\r\n            if (posterValue && this.element.tagName === 'VIDEO') {\r\n                this.element.poster = posterValue;\r\n            }\r\n            \r\n            // Force reload\r\n            this.element.load();\r\n        } else {\r\n            // Fallback to updating element src directly (for videos without source elements)\r\n            // Preserve poster before changing src\r\n            if (posterValue && this.element.tagName === 'VIDEO') {\r\n                this.element.poster = posterValue;\r\n            }\r\n            const originalSrcToUse = this.originalAudioDescriptionSource || this.originalSrc;\r\n            this.element.src = originalSrcToUse;\r\n            this.element.load();\r\n        }\r\n\r\n        // Wait for new source to load metadata\r\n        await new Promise((resolve) => {\r\n            const onLoadedMetadata = () => {\r\n                this.element.removeEventListener('loadedmetadata', onLoadedMetadata);\r\n                resolve();\r\n            };\r\n            \r\n            if (this.element.readyState >= 1) {\r\n                // Metadata already loaded\r\n                resolve();\r\n            } else {\r\n                this.element.addEventListener('loadedmetadata', onLoadedMetadata);\r\n            }\r\n        });\r\n\r\n        // If we need to seek and/or play, wait for enough data to be loaded\r\n        if (currentTime > 0 || wasPlaying) {\r\n            await new Promise((resolve) => {\r\n                const onCanPlay = () => {\r\n                    this.element.removeEventListener('canplay', onCanPlay);\r\n                    this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                    resolve();\r\n                };\r\n                \r\n                // Check if already ready\r\n                if (this.element.readyState >= 3) { // HAVE_FUTURE_DATA or better\r\n                    resolve();\r\n                } else {\r\n                    // Wait for canplay or canplaythrough\r\n                    this.element.addEventListener('canplay', onCanPlay, { once: true });\r\n                    this.element.addEventListener('canplaythrough', onCanPlay, { once: true });\r\n                    \r\n                    // Fallback timeout in case events don't fire\r\n                    setTimeout(() => {\r\n                        this.element.removeEventListener('canplay', onCanPlay);\r\n                        this.element.removeEventListener('canplaythrough', onCanPlay);\r\n                        resolve();\r\n                    }, 3000);\r\n                }\r\n            });\r\n        }\r\n\r\n        // Try to find matching caption in the new track for better synchronization\r\n        let syncTime = currentTime;\r\n        if (currentCaptionText && this.captionManager && this.captionManager.tracks.length > 0) {\r\n            // Wait a bit for tracks to load\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n            \r\n            // Find the matching caption in the regular video's track\r\n            const matchingTime = this.findMatchingCaptionTime(currentCaptionText, this.captionManager.tracks);\r\n            if (matchingTime !== null) {\r\n                syncTime = matchingTime;\r\n                if (this.options.debug) {\r\n                    console.log(`[VidPly] Syncing via caption: ${currentTime}s -> ${syncTime}s`);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (syncTime > 0) {\r\n            this.seek(syncTime);\r\n            // Wait a bit for seek to complete\r\n            await new Promise(resolve => setTimeout(resolve, 100));\r\n        }\r\n\r\n        if (wasPlaying) {\r\n            await this.play();\r\n            this.hidePosterOverlay();\r\n        } else {\r\n            // Explicitly pause the video if it wasn't playing\r\n            // This ensures it's in a clean paused state after load()\r\n            this.pause();\r\n            if (!wasPlaying && syncTime === 0) {\r\n                this.showPosterOverlay();\r\n            } else {\r\n                this.hidePosterOverlay();\r\n            }\r\n        }\r\n\r\n            // Reload CaptionManager tracks if tracks were swapped (so it has fresh references)\r\n            if (swappedTracksForTranscript.length > 0 && this.captionManager) {\r\n                // Store if captions were enabled and which track\r\n                const wasCaptionsEnabled = this.state.captionsEnabled;\r\n                let currentTrackInfo = null;\r\n                if (this.captionManager.currentTrack) {\r\n                    const currentTrackIndex = this.captionManager.tracks.findIndex(t => t.track === this.captionManager.currentTrack.track);\r\n                    if (currentTrackIndex >= 0) {\r\n                        currentTrackInfo = {\r\n                            language: this.captionManager.tracks[currentTrackIndex].language,\r\n                            kind: this.captionManager.tracks[currentTrackIndex].kind\r\n                        };\r\n                    }\r\n                }\r\n                \r\n                // Wait for tracks to be processed by the browser\r\n                const reloadTracks = () => {\r\n                    // Reload tracks to get fresh references to new TextTrack objects\r\n                    this.captionManager.tracks = [];\r\n                    this.captionManager.loadTracks();\r\n                    \r\n                    // Re-enable captions if they were enabled before\r\n                    if (wasCaptionsEnabled && currentTrackInfo && this.captionManager.tracks.length > 0) {\r\n                        // Find the track by language and kind to match the swapped track\r\n                        const matchingTrackIndex = this.captionManager.tracks.findIndex(t => \r\n                            t.language === currentTrackInfo.language && t.kind === currentTrackInfo.kind\r\n                        );\r\n                        \r\n                        if (matchingTrackIndex >= 0) {\r\n                            const trackToEnable = this.captionManager.tracks[matchingTrackIndex];\r\n                            // Wait for track to load its cues before enabling\r\n                            if (trackToEnable.track.readyState >= 2) {\r\n                                // Track is already loaded\r\n                                this.captionManager.enable(matchingTrackIndex);\r\n                            } else {\r\n                                // Wait for track to load\r\n                                const onTrackLoad = () => {\r\n                                    trackToEnable.track.removeEventListener('load', onTrackLoad);\r\n                                    trackToEnable.track.removeEventListener('error', onTrackLoad);\r\n                                    if (this.captionManager && this.captionManager.tracks.includes(trackToEnable)) {\r\n                                        this.captionManager.enable(matchingTrackIndex);\r\n                                    }\r\n                                };\r\n                                trackToEnable.track.addEventListener('load', onTrackLoad, { once: true });\r\n                                trackToEnable.track.addEventListener('error', onTrackLoad, { once: true });\r\n                                // Set mode to 'hidden' to trigger loading\r\n                                trackToEnable.track.mode = 'hidden';\r\n                                // Fallback timeout\r\n                                setTimeout(() => {\r\n                                    if (this.captionManager && this.captionManager.tracks.includes(trackToEnable)) {\r\n                                        this.captionManager.enable(matchingTrackIndex);\r\n                                    }\r\n                                }, 1000);\r\n                            }\r\n                        } else if (this.captionManager.tracks.length > 0) {\r\n                            // Fallback: enable first track\r\n                            const firstTrack = this.captionManager.tracks[0];\r\n                            if (firstTrack.track.readyState >= 2) {\r\n                                this.captionManager.enable(0);\r\n                            } else {\r\n                                const onTrackLoad = () => {\r\n                                    firstTrack.track.removeEventListener('load', onTrackLoad);\r\n                                    firstTrack.track.removeEventListener('error', onTrackLoad);\r\n                                    if (this.captionManager && this.captionManager.tracks.includes(firstTrack)) {\r\n                                        this.captionManager.enable(0);\r\n                                    }\r\n                                };\r\n                                firstTrack.track.addEventListener('load', onTrackLoad, { once: true });\r\n                                firstTrack.track.addEventListener('error', onTrackLoad, { once: true });\r\n                                firstTrack.track.mode = 'hidden';\r\n                                setTimeout(() => {\r\n                                    if (this.captionManager && this.captionManager.tracks.includes(firstTrack)) {\r\n                                        this.captionManager.enable(0);\r\n                                    }\r\n                                }, 1000);\r\n                            }\r\n                        }\r\n                    }\r\n                };\r\n                \r\n                // Wait for tracks to be processed by the browser\r\n                setTimeout(reloadTracks, 600);\r\n            }\r\n\r\n            // Reload transcript if visible (after video metadata loaded, tracks should be available)\r\n            // Reload regardless of whether caption tracks were swapped, in case tracks changed\r\n            if (this.transcriptManager && this.transcriptManager.isVisible) {\r\n                // Wait for tracks to load after source swap\r\n                this.setManagedTimeout(() => {\r\n                    if (this.transcriptManager && this.transcriptManager.loadTranscriptData) {\r\n                        this.transcriptManager.loadTranscriptData();\r\n                    }\r\n                }, 500);\r\n            }\r\n\r\n        if (this._audioDescriptionDesiredState) {\r\n            return;\r\n        }\r\n\r\n        this.state.audioDescriptionEnabled = false;\r\n        this.emit('audiodescriptiondisabled');\r\n    }\r\n\r\n    async toggleAudioDescription() {\r\n        if (this.options.requirePlaybackForAccessibilityToggles && !this.renderer && this.playlistManager?.tracks?.length) {\r\n            this.showNotice(i18n.t('player.startPlaybackForAudioDescription'));\r\n            return;\r\n        }\r\n\r\n        // If user toggles audio description before the first track has been loaded,\r\n        // remember desired state and start playback so the described source is loaded.\r\n        if (!this.renderer && this.playlistManager && this.playlistManager.tracks?.length) {\r\n            this.audioDescriptionManager.desiredState = !this.audioDescriptionManager.desiredState;\r\n            this.state.audioDescriptionEnabled = this.audioDescriptionManager.desiredState;\r\n            this.emit(this.audioDescriptionManager.desiredState ? 'audiodescriptionenabled' : 'audiodescriptiondisabled');\r\n            // Start playback (PlaylistManager.play() will honor desiredState and load described src)\r\n            this.play();\r\n            return;\r\n        }\r\n\r\n        return this.audioDescriptionManager.toggle();\r\n    }\r\n\r\n    // Sign Language (delegated to SignLanguageManager)\r\n    enableSignLanguage() {\r\n        return this.signLanguageManager.enable();\r\n    }\r\n\r\n    // Legacy method body preserved for reference - can be removed after testing\r\n    _legacyEnableSignLanguage() {\r\n        // Determine available sign language sources\r\n        const hasMultipleSources = Object.keys(this.signLanguageSources).length > 0;\r\n        const hasSingleSource = !!this.signLanguageSrc;\r\n        \r\n        if (!hasMultipleSources && !hasSingleSource) {\r\n            console.warn('No sign language video source provided');\r\n            return;\r\n        }\r\n\r\n        if (this.signLanguageWrapper) {\r\n            // Already exists, just show it\r\n            this.signLanguageWrapper.style.display = 'block';\r\n            this.state.signLanguageEnabled = true;\r\n            this.emit('signlanguageenabled');\r\n            \r\n            // Focus the settings button after wrapper is shown\r\n            // Use setManagedTimeout to ensure it's properly scheduled\r\n            this.setManagedTimeout(() => {\r\n                if (this.signLanguageSettingsButton && document.contains(this.signLanguageSettingsButton)) {\r\n                    this.signLanguageSettingsButton.focus({ preventScroll: true });\r\n                }\r\n            }, 150);\r\n            return;\r\n        }\r\n        \r\n        // Determine initial sign language\r\n        let initialLang = null;\r\n        let initialSrc = null;\r\n        \r\n        if (hasMultipleSources) {\r\n            // Try to sync with current caption language\r\n            if (this.captionManager && this.captionManager.currentTrack) {\r\n                const captionLang = this.captionManager.currentTrack.language?.toLowerCase().split('-')[0];\r\n                if (captionLang && this.signLanguageSources[captionLang]) {\r\n                    initialLang = captionLang;\r\n                    initialSrc = this.signLanguageSources[captionLang];\r\n                }\r\n            }\r\n            \r\n            // If no match, try player language\r\n            if (!initialLang && this.options.language) {\r\n                const playerLang = this.options.language.toLowerCase().split('-')[0];\r\n                if (this.signLanguageSources[playerLang]) {\r\n                    initialLang = playerLang;\r\n                    initialSrc = this.signLanguageSources[playerLang];\r\n                }\r\n            }\r\n            \r\n            // If still no match, use first available\r\n            if (!initialLang) {\r\n                initialLang = Object.keys(this.signLanguageSources)[0];\r\n                initialSrc = this.signLanguageSources[initialLang];\r\n            }\r\n            \r\n            this.currentSignLanguage = initialLang;\r\n        } else {\r\n            // Single source fallback\r\n            initialSrc = this.signLanguageSrc;\r\n        }\r\n\r\n        // Create wrapper container\r\n        this.signLanguageWrapper = document.createElement('div');\r\n        this.signLanguageWrapper.className = 'vidply-sign-language-wrapper';\r\n        this.signLanguageWrapper.setAttribute('tabindex', '0');\r\n        this.signLanguageWrapper.setAttribute('aria-label', i18n.t('player.signLanguageDragResize'));\r\n\r\n        // Create header (draggable)\r\n        this.signLanguageHeader = DOMUtils.createElement('div', {\r\n            className: `${this.options.classPrefix}-sign-language-header`,\r\n            attributes: {\r\n                'tabindex': '0'\r\n            }\r\n        });\r\n\r\n        // Header left side (title)\r\n        const headerLeft = DOMUtils.createElement('div', {\r\n            className: `${this.options.classPrefix}-sign-language-header-left`\r\n        });\r\n\r\n        const title = DOMUtils.createElement('h3', {\r\n            textContent: i18n.t('player.signLanguageVideo')\r\n        });\r\n\r\n        // Settings button (before language selector)\r\n        const settingsAriaLabel = i18n.t('player.signLanguageSettings');\r\n        this.signLanguageSettingsButton = DOMUtils.createElement('button', {\r\n            className: `${this.options.classPrefix}-sign-language-settings`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': settingsAriaLabel,\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n        this.signLanguageSettingsButton.appendChild(createIconElement('settings'));\r\n        DOMUtils.attachTooltip(this.signLanguageSettingsButton, settingsAriaLabel, this.options.classPrefix);\r\n        this.signLanguageSettingsHandlers = {\r\n            settingsClick: (e) => {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                // Stop the document click handler from interfering\r\n                if (this.signLanguageDocumentClickHandler) {\r\n                    // Temporarily disable document click handler\r\n                    const wasJustOpened = this.signLanguageSettingsMenuJustOpened;\r\n                    this.signLanguageSettingsMenuJustOpened = true;\r\n                    setTimeout(() => {\r\n                        this.signLanguageSettingsMenuJustOpened = wasJustOpened;\r\n                    }, 100);\r\n                }\r\n                if (this.signLanguageSettingsMenuVisible) {\r\n                    this.hideSignLanguageSettingsMenu();\r\n                } else {\r\n                    this.showSignLanguageSettingsMenu();\r\n                }\r\n            },\r\n            settingsKeydown: (e) => {\r\n                // D key to toggle keyboard drag mode\r\n                if (e.key === 'd' || e.key === 'D') {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    this.toggleSignLanguageKeyboardDragMode();\r\n                }\r\n                // R key to toggle resize mode\r\n                else if (e.key === 'r' || e.key === 'R') {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    this.toggleSignLanguageResizeMode();\r\n                }\r\n                // Escape to close menu if open\r\n                else if (e.key === 'Escape' && this.signLanguageSettingsMenuVisible) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    this.hideSignLanguageSettingsMenu();\r\n                }\r\n            }\r\n        };\r\n        this.signLanguageSettingsButton.addEventListener('click', this.signLanguageSettingsHandlers.settingsClick);\r\n        this.signLanguageSettingsButton.addEventListener('keydown', this.signLanguageSettingsHandlers.settingsKeydown);\r\n        headerLeft.appendChild(this.signLanguageSettingsButton);\r\n\r\n        // Language selector (if multiple sources available)\r\n        this.signLanguageSelector = null;\r\n        if (hasMultipleSources) {\r\n            const selectId = `${this.options.classPrefix}-sign-language-select-${Date.now()}`;\r\n            \r\n            // Create options array\r\n            const options = Object.keys(this.signLanguageSources).map(langCode => ({\r\n                value: langCode,\r\n                text: this.getSignLanguageLabel(langCode),\r\n                selected: langCode === initialLang\r\n            }));\r\n            \r\n            const { label: signLanguageLabel, select: signLanguageSelector } = createLabeledSelect({\r\n                classPrefix: this.options.classPrefix,\r\n                labelClass: `${this.options.classPrefix}-sign-language-label`,\r\n                selectClass: `${this.options.classPrefix}-sign-language-select`,\r\n                labelText: 'settings.language',\r\n                selectId: selectId,\r\n                options: options,\r\n                onChange: (e) => {\r\n                    e.stopPropagation(); // Prevent event from bubbling\r\n                    const selectedLang = e.target.value;\r\n                    this.switchSignLanguage(selectedLang);\r\n                }\r\n            });\r\n            \r\n            this.signLanguageSelector = signLanguageSelector;\r\n            \r\n            // Wrap label and select in a container for horizontal layout\r\n            const signLanguageSelectorWrapper = DOMUtils.createElement('div', {\r\n                className: `${this.options.classPrefix}-sign-language-selector-wrapper`\r\n            });\r\n            signLanguageSelectorWrapper.appendChild(signLanguageLabel);\r\n            signLanguageSelectorWrapper.appendChild(this.signLanguageSelector);\r\n            \r\n            // Prevent drag when interacting with wrapper\r\n            preventDragOnElement(signLanguageSelectorWrapper);\r\n            \r\n            headerLeft.appendChild(signLanguageSelectorWrapper);\r\n        }\r\n\r\n        headerLeft.appendChild(title);\r\n        \r\n        // Close button\r\n        const closeAriaLabel = i18n.t('player.closeSignLanguage');\r\n        const closeButton = DOMUtils.createElement('button', {\r\n            className: `${this.options.classPrefix}-sign-language-close`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': closeAriaLabel\r\n            }\r\n        });\r\n        closeButton.appendChild(createIconElement('close'));\r\n        DOMUtils.attachTooltip(closeButton, closeAriaLabel, this.options.classPrefix);\r\n        closeButton.addEventListener('click', () => {\r\n            this.disableSignLanguage();\r\n            // Return focus to sign language button if available\r\n            if (this.controlBar && this.controlBar.controls && this.controlBar.controls.signLanguage) {\r\n                setTimeout(() => {\r\n                    this.controlBar.controls.signLanguage.focus({ preventScroll: true });\r\n                }, 0);\r\n            }\r\n        });\r\n\r\n        this.signLanguageHeader.appendChild(headerLeft);\r\n        this.signLanguageHeader.appendChild(closeButton);\r\n        \r\n        // Initialize settings menu state\r\n        this.signLanguageSettingsMenuVisible = false;\r\n        this.signLanguageSettingsMenu = null;\r\n        this.signLanguageSettingsMenuJustOpened = false;\r\n        this.signLanguageResizeOptionButton = null;\r\n        this.signLanguageResizeOptionText = null;\r\n        this.signLanguageDragOptionButton = null;\r\n        this.signLanguageDragOptionText = null;\r\n        this.signLanguageDocumentClickHandler = null;\r\n        this.signLanguageDocumentClickHandlerAdded = false;\r\n\r\n        // Create sign language video element\r\n        this.signLanguageVideo = document.createElement('video');\r\n        this.signLanguageVideo.className = 'vidply-sign-language-video';\r\n        this.signLanguageVideo.src = initialSrc;\r\n        this.signLanguageVideo.setAttribute('aria-label', i18n.t('player.signLanguage'));\r\n        this.signLanguageVideo.muted = true; // Sign language video should be muted\r\n        \r\n        // Enable inline playback on iOS (prevents native fullscreen)\r\n        this.signLanguageVideo.setAttribute('playsinline', '');\r\n\r\n        // Create resize handles (8 directions like transcript)\r\n        this.signLanguageResizeHandles = ['n', 's', 'e', 'w', 'ne', 'nw', 'se', 'sw'].map(dir => {\r\n            const handle = DOMUtils.createElement('div', {\r\n                className: `${this.options.classPrefix}-sign-resize-handle ${this.options.classPrefix}-sign-resize-${dir}`,\r\n                attributes: {\r\n                    'data-direction': dir,\r\n                    'data-vidply-managed-resize': 'true',\r\n                    'aria-hidden': 'true'\r\n                }\r\n            });\r\n            handle.style.display = 'none';\r\n            return handle;\r\n        });\r\n\r\n        // Append header, video and handles to wrapper\r\n        this.signLanguageWrapper.appendChild(this.signLanguageHeader);\r\n        this.signLanguageWrapper.appendChild(this.signLanguageVideo);\r\n        this.signLanguageResizeHandles.forEach(handle => this.signLanguageWrapper.appendChild(handle));\r\n\r\n        // Set width FIRST to ensure proper dimensions\r\n        const saved = this.storage.getSignLanguagePreferences();\r\n        if (saved && saved.size && saved.size.width) {\r\n            this.signLanguageWrapper.style.width = saved.size.width;\r\n        } else {\r\n            this.signLanguageWrapper.style.width = '280px'; // Default width\r\n        }\r\n        // Height is always auto to maintain aspect ratio\r\n        this.signLanguageWrapper.style.height = 'auto';\r\n        \r\n        // Position is always calculated fresh - use option or default to bottom-right\r\n        this.signLanguageDesiredPosition = this.options.signLanguagePosition || 'bottom-right';\r\n\r\n        // Add to main player container (NOT videoWrapper) to avoid overflow:hidden clipping\r\n        this.container.appendChild(this.signLanguageWrapper);\r\n\r\n        // Set position immediately after appending\r\n        requestAnimationFrame(() => {\r\n            this.constrainSignLanguagePosition();\r\n        });\r\n\r\n        // Sync with main video\r\n        this.signLanguageVideo.currentTime = this.state.currentTime;\r\n        if (!this.state.paused) {\r\n            this.signLanguageVideo.play();\r\n        }\r\n\r\n        // Setup drag and resize\r\n        this.setupSignLanguageInteraction();\r\n\r\n        // Create bound handlers to store references for cleanup\r\n        this.signLanguageHandlers = {\r\n            play: () => {\r\n                if (this.signLanguageVideo) {\r\n                    this.signLanguageVideo.play();\r\n                }\r\n            },\r\n            pause: () => {\r\n                if (this.signLanguageVideo) {\r\n                    this.signLanguageVideo.pause();\r\n                }\r\n            },\r\n            timeupdate: () => {\r\n                if (this.signLanguageVideo && Math.abs(this.signLanguageVideo.currentTime - this.state.currentTime) > 0.5) {\r\n                    this.signLanguageVideo.currentTime = this.state.currentTime;\r\n                }\r\n            },\r\n            ratechange: () => {\r\n                if (this.signLanguageVideo) {\r\n                    this.signLanguageVideo.playbackRate = this.state.playbackSpeed;\r\n                }\r\n            }\r\n        };\r\n\r\n        // Sync playback\r\n        this.on('play', this.signLanguageHandlers.play);\r\n        this.on('pause', this.signLanguageHandlers.pause);\r\n        this.on('timeupdate', this.signLanguageHandlers.timeupdate);\r\n        this.on('ratechange', this.signLanguageHandlers.ratechange);\r\n        \r\n        // Sync sign language when captions change (if multiple sources available)\r\n        if (hasMultipleSources) {\r\n            this.signLanguageHandlers.captionChange = () => {\r\n                if (this.captionManager && this.captionManager.currentTrack && this.signLanguageSelector) {\r\n                    const captionLang = this.captionManager.currentTrack.language?.toLowerCase().split('-')[0];\r\n                    if (captionLang && this.signLanguageSources[captionLang] && this.currentSignLanguage !== captionLang) {\r\n                        this.switchSignLanguage(captionLang);\r\n                        // Update selector\r\n                        this.signLanguageSelector.value = captionLang;\r\n                    }\r\n                }\r\n            };\r\n            // Listen to captionsenabled which fires when a track is enabled (including when switching)\r\n            this.on('captionsenabled', this.signLanguageHandlers.captionChange);\r\n        }\r\n\r\n        this.state.signLanguageEnabled = true;\r\n        this.emit('signlanguageenabled');\r\n        \r\n        // Focus the settings button after wrapper is appended to DOM\r\n        // Use setManagedTimeout to ensure it's properly scheduled\r\n        this.setManagedTimeout(() => {\r\n            if (this.signLanguageSettingsButton && document.contains(this.signLanguageSettingsButton)) {\r\n                this.signLanguageSettingsButton.focus({ preventScroll: true });\r\n            }\r\n        }, 150);\r\n    }\r\n\r\n    disableSignLanguage() {\r\n        return this.signLanguageManager.disable();\r\n    }\r\n\r\n    toggleSignLanguage() {\r\n        if (this.options.requirePlaybackForAccessibilityToggles && !this.renderer && this.playlistManager?.tracks?.length) {\r\n            this.showNotice(i18n.t('player.startPlaybackForSignLanguage'));\r\n            return;\r\n        }\r\n\r\n        // If user toggles sign language before the first track has been loaded,\r\n        // enable the overlay and start playback so sign language video sync begins.\r\n        if (!this.renderer && this.playlistManager && this.playlistManager.tracks?.length) {\r\n            const wasEnabled = this.signLanguageManager.enabled;\r\n            const result = this.signLanguageManager.toggle();\r\n            if (!wasEnabled && this.signLanguageManager.enabled) {\r\n                this.play();\r\n            }\r\n            return result;\r\n        }\r\n\r\n        return this.signLanguageManager.toggle();\r\n    }\r\n\r\n    setupSignLanguageInteraction() {\r\n        return this.signLanguageManager._setupInteraction();\r\n    }\r\n\r\n    // Legacy method preserved for reference\r\n    _legacySetupSignLanguageInteraction() {\r\n        if (!this.signLanguageWrapper) return;\r\n\r\n        // Check if we're on mobile and not in fullscreen\r\n        const isMobile = window.innerWidth < 768;\r\n        const isFullscreen = this.state.fullscreen;\r\n        \r\n        // On mobile devices (< 768px), only enable drag/resize in fullscreen\r\n        // On desktop/tablets (>= 768px), always enable drag/resize\r\n        if (isMobile && !isFullscreen) {\r\n            // Destroy existing instance if exiting fullscreen on mobile\r\n            if (this.signLanguageDraggable) {\r\n                this.signLanguageDraggable.destroy();\r\n                this.signLanguageDraggable = null;\r\n            }\r\n            return; // No drag/resize on mobile when not in fullscreen\r\n        }\r\n\r\n        // If already initialized, don't re-initialize\r\n        if (this.signLanguageDraggable) {\r\n            return;\r\n        }\r\n\r\n        // Create DraggableResizable utility with touch support\r\n        // Use header as drag handle instead of video\r\n        this.signLanguageDraggable = new DraggableResizable(this.signLanguageWrapper, {\r\n            dragHandle: this.signLanguageHeader,\r\n            resizeHandles: this.signLanguageResizeHandles,\r\n            constrainToViewport: true,\r\n            maintainAspectRatio: true,\r\n            minWidth: 150,\r\n            minHeight: 100,\r\n            classPrefix: `${this.options.classPrefix}-sign`,\r\n            keyboardDragKey: 'd',\r\n            keyboardResizeKey: 'r',\r\n            keyboardStep: 10,\r\n            keyboardStepLarge: 50,\r\n            pointerResizeIndicatorText: i18n.t('player.signLanguageResizeActive'),\r\n            onPointerResizeToggle: (enabled) => {\r\n                // Update resize handles visibility\r\n                this.signLanguageResizeHandles.forEach(handle => {\r\n                    handle.style.display = enabled ? 'block' : 'none';\r\n                });\r\n            },\r\n            onDragStart: (e) => {\r\n                // Don't drag if clicking on close button, settings button, language selector, or settings menu\r\n                if (e.target.closest(`.${this.options.classPrefix}-sign-language-close`) ||\r\n                    e.target.closest(`.${this.options.classPrefix}-sign-language-settings`) ||\r\n                    e.target.closest(`.${this.options.classPrefix}-sign-language-select`) ||\r\n                    e.target.closest(`.${this.options.classPrefix}-sign-language-label`) ||\r\n                    e.target.closest(`.${this.options.classPrefix}-sign-language-settings-menu`)) {\r\n                    return false; // Prevent drag\r\n                }\r\n                return true; // Allow drag\r\n            }\r\n        });\r\n\r\n        // Add custom keyboard handler for special keys (Escape, Home)\r\n        this.signLanguageCustomKeyHandler = (e) => {\r\n            const key = e.key.toLowerCase();\r\n            \r\n            // Don't handle keys if settings menu is open (let menu handle them)\r\n            if (this.signLanguageSettingsMenuVisible) {\r\n                return;\r\n            }\r\n            \r\n            if (key === 'home') {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                if (this.signLanguageDraggable) {\r\n                    if (this.signLanguageDraggable.pointerResizeMode) {\r\n                        this.signLanguageDraggable.disablePointerResizeMode();\r\n                    }\r\n                    this.signLanguageDraggable.manuallyPositioned = false;\r\n                    this.constrainSignLanguagePosition();\r\n                }\r\n                return;\r\n            }\r\n            \r\n            if (key === 'r') {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                const enabled = this.toggleSignLanguageResizeMode();\r\n                if (enabled) {\r\n                    this.signLanguageWrapper.focus({ preventScroll: true });\r\n                }\r\n                return;\r\n            }\r\n            \r\n            if (key === 'escape') {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                // Exit resize mode if active\r\n                if (this.signLanguageDraggable && this.signLanguageDraggable.pointerResizeMode) {\r\n                    this.signLanguageDraggable.disablePointerResizeMode();\r\n                    return;\r\n                }\r\n                // Exit keyboard drag mode if active\r\n                if (this.signLanguageDraggable && this.signLanguageDraggable.keyboardDragMode) {\r\n                    this.signLanguageDraggable.disableKeyboardDragMode();\r\n                    return;\r\n                }\r\n                // Close video if no modes are active\r\n                this.disableSignLanguage();\r\n                // Return focus to sign language button if available\r\n                if (this.controlBar && this.controlBar.controls && this.controlBar.controls.signLanguage) {\r\n                    setTimeout(() => {\r\n                        this.controlBar.controls.signLanguage.focus({ preventScroll: true });\r\n                    }, 0);\r\n                }\r\n                return;\r\n            }\r\n        };\r\n        \r\n        this.signLanguageWrapper.addEventListener('keydown', this.signLanguageCustomKeyHandler);\r\n\r\n        // Store for cleanup\r\n        this.signLanguageInteractionHandlers = {\r\n            draggable: this.signLanguageDraggable,\r\n            headerKeyHandler: this.signLanguageHeaderKeyHandler,\r\n            customKeyHandler: this.signLanguageCustomKeyHandler\r\n        };\r\n    }\r\n\r\n    toggleSignLanguageKeyboardDragMode() {\r\n        if (this.signLanguageDraggable) {\r\n            const wasEnabled = this.signLanguageDraggable.keyboardDragMode;\r\n            this.signLanguageDraggable.toggleKeyboardDragMode();\r\n            const isEnabled = this.signLanguageDraggable.keyboardDragMode;\r\n            if (!wasEnabled && isEnabled) {\r\n                this.enableSignLanguageMoveMode();\r\n            }\r\n            // Update drag option state\r\n            this.updateSignLanguageDragOptionState();\r\n        }\r\n    }\r\n\r\n    enableSignLanguageMoveMode() {\r\n        // Add visual feedback for move mode\r\n        this.signLanguageWrapper.classList.add(`${this.options.classPrefix}-sign-move-mode`);\r\n        \r\n        // Update resize option state in case menu is open\r\n        this.updateSignLanguageResizeOptionState();\r\n        \r\n        // Remove after 2 seconds\r\n        setTimeout(() => {\r\n            this.signLanguageWrapper.classList.remove(`${this.options.classPrefix}-sign-move-mode`);\r\n        }, 2000);\r\n    }\r\n\r\n    toggleSignLanguageResizeMode({ focus = true } = {}) {\r\n        if (!this.signLanguageDraggable) {\r\n            return false;\r\n        }\r\n\r\n        if (this.signLanguageDraggable.pointerResizeMode) {\r\n            this.signLanguageDraggable.disablePointerResizeMode({ focus });\r\n            this.updateSignLanguageResizeOptionState();\r\n            return false;\r\n        }\r\n\r\n        this.signLanguageDraggable.enablePointerResizeMode({ focus });\r\n        this.updateSignLanguageResizeOptionState();\r\n        return true;\r\n    }\r\n\r\n    getSignLanguageLabel(langCode) {\r\n        // Get language label from i18n or use language code\r\n        const langNames = {\r\n            'en': 'English',\r\n            'de': 'Deutsch',\r\n            'es': 'Español',\r\n            'fr': 'Français',\r\n            'it': 'Italiano',\r\n            'ja': '日本語',\r\n            'pt': 'Português',\r\n            'ar': 'العربية',\r\n            'hi': 'हिन्दी'\r\n        };\r\n        return langNames[langCode] || langCode.toUpperCase();\r\n    }\r\n\r\n    switchSignLanguage(langCode) {\r\n        return this.signLanguageManager.switchLanguage(langCode);\r\n    }\r\n\r\n    // Legacy method preserved for reference\r\n    _legacySwitchSignLanguage(langCode) {\r\n        if (!this.signLanguageSources[langCode] || !this.signLanguageVideo) {\r\n            return;\r\n        }\r\n        \r\n        const currentTime = this.signLanguageVideo.currentTime;\r\n        const wasPlaying = !this.signLanguageVideo.paused;\r\n        \r\n        this.signLanguageVideo.src = this.signLanguageSources[langCode];\r\n        this.currentSignLanguage = langCode;\r\n        \r\n        // Restore playback state\r\n        this.signLanguageVideo.currentTime = currentTime;\r\n        if (wasPlaying) {\r\n            this.signLanguageVideo.play().catch(() => {\r\n                // Ignore play errors\r\n            });\r\n        }\r\n        \r\n        this.emit('signlanguagelanguagechanged', langCode);\r\n    }\r\n\r\n    showSignLanguageSettingsMenu() {\r\n        return this.signLanguageManager.showSettingsMenu();\r\n    }\r\n\r\n    // Legacy method preserved for reference\r\n    _legacyShowSignLanguageSettingsMenu() {\r\n        // Set flag to prevent immediate closing\r\n        this.signLanguageSettingsMenuJustOpened = true;\r\n        setTimeout(() => {\r\n            this.signLanguageSettingsMenuJustOpened = false;\r\n        }, 350);\r\n        \r\n        // Add document click handler on FIRST menu open (not at window creation)\r\n        if (!this.signLanguageDocumentClickHandlerAdded) {\r\n            this.signLanguageDocumentClickHandler = (e) => {\r\n                // Ignore if menu was just opened (prevents immediate closing)\r\n                if (this.signLanguageSettingsMenuJustOpened) {\r\n                    return;\r\n                }\r\n                \r\n                // Ignore clicks on the settings button itself or its children\r\n                if (this.signLanguageSettingsButton && \r\n                    (this.signLanguageSettingsButton === e.target || this.signLanguageSettingsButton.contains(e.target))) {\r\n                    return;\r\n                }\r\n                \r\n                // Ignore clicks on the settings menu items\r\n                if (this.signLanguageSettingsMenu && this.signLanguageSettingsMenu.contains(e.target)) {\r\n                    return;\r\n                }\r\n                \r\n                // Close menu if clicking outside\r\n                if (this.signLanguageSettingsMenuVisible) {\r\n                    this.hideSignLanguageSettingsMenu();\r\n                }\r\n            };\r\n            setTimeout(() => {\r\n                document.addEventListener('mousedown', this.signLanguageDocumentClickHandler, true); // Use mousedown in capture phase\r\n                this.signLanguageDocumentClickHandlerAdded = true;\r\n            }, 300);\r\n        }\r\n        \r\n        if (this.signLanguageSettingsMenu) {\r\n            this.signLanguageSettingsMenu.style.display = 'block';\r\n            this.signLanguageSettingsMenuVisible = true;\r\n            if (this.signLanguageSettingsButton) {\r\n                this.signLanguageSettingsButton.setAttribute('aria-expanded', 'true');\r\n            }\r\n            // Always re-attach keyboard navigation handler when reopening\r\n            this.signLanguageSettingsMenuKeyHandler = attachMenuKeyboardNavigation(\r\n                this.signLanguageSettingsMenu,\r\n                this.signLanguageSettingsButton,\r\n                `.${this.options.classPrefix}-sign-language-settings-item`,\r\n                () => this.hideSignLanguageSettingsMenu({ focusButton: true })\r\n            );\r\n            // Reposition menu in case window was moved (async for repositioning)\r\n            this.positionSignLanguageSettingsMenu();\r\n            this.updateSignLanguageDragOptionState();\r\n            this.updateSignLanguageResizeOptionState();\r\n            focusFirstMenuItem(this.signLanguageSettingsMenu, `.${this.options.classPrefix}-sign-language-settings-item`);\r\n            return;\r\n        }\r\n        \r\n        // Create settings menu\r\n        this.signLanguageSettingsMenu = DOMUtils.createElement('div', {\r\n            className: `${this.options.classPrefix}-sign-language-settings-menu`,\r\n            attributes: {\r\n                'role': 'menu'\r\n            }\r\n        });\r\n\r\n        // Keyboard drag option\r\n        const keyboardDragOption = createMenuItem({\r\n            classPrefix: this.options.classPrefix,\r\n            itemClass: `${this.options.classPrefix}-sign-language-settings-item`,\r\n            icon: 'move',\r\n            label: 'player.enableSignDragMode',\r\n            hasTextClass: true,\r\n            onClick: () => {\r\n                this.toggleSignLanguageKeyboardDragMode();\r\n                this.hideSignLanguageSettingsMenu();\r\n            }\r\n        });\r\n        keyboardDragOption.setAttribute('role', 'switch');\r\n        keyboardDragOption.setAttribute('aria-checked', 'false');\r\n        // Remove any tooltips from menu items (they have visible text)\r\n        const dragTooltip = keyboardDragOption.querySelector(`.${this.options.classPrefix}-tooltip`);\r\n        if (dragTooltip) dragTooltip.remove();\r\n        const dragButtonText = keyboardDragOption.querySelector(`.${this.options.classPrefix}-button-text`);\r\n        if (dragButtonText) dragButtonText.remove();\r\n        this.signLanguageDragOptionButton = keyboardDragOption;\r\n        this.signLanguageDragOptionText = keyboardDragOption.querySelector(`.${this.options.classPrefix}-settings-text`);\r\n        this.updateSignLanguageDragOptionState();\r\n\r\n        // Resize option\r\n        const resizeOption = createMenuItem({\r\n            classPrefix: this.options.classPrefix,\r\n            itemClass: `${this.options.classPrefix}-sign-language-settings-item`,\r\n            icon: 'resize',\r\n            label: 'player.enableSignResizeMode',\r\n            hasTextClass: true,\r\n            onClick: (event) => {\r\n                event.preventDefault();\r\n                event.stopPropagation();\r\n                \r\n                const enabled = this.toggleSignLanguageResizeMode({ focus: false });\r\n                \r\n                if (enabled) {\r\n                    this.hideSignLanguageSettingsMenu({ focusButton: false });\r\n                    // Focus sign language wrapper after handles appear\r\n                    setTimeout(() => {\r\n                        if (this.signLanguageWrapper) {\r\n                            this.signLanguageWrapper.focus({ preventScroll: true });\r\n                        }\r\n                    }, 20);\r\n                } else {\r\n                    this.hideSignLanguageSettingsMenu({ focusButton: true });\r\n                }\r\n            }\r\n        });\r\n        resizeOption.setAttribute('role', 'switch');\r\n        resizeOption.setAttribute('aria-checked', 'false');\r\n        // Remove any tooltips from menu items (they have visible text)\r\n        const resizeTooltip = resizeOption.querySelector(`.${this.options.classPrefix}-tooltip`);\r\n        if (resizeTooltip) resizeTooltip.remove();\r\n        const resizeButtonText = resizeOption.querySelector(`.${this.options.classPrefix}-button-text`);\r\n        if (resizeButtonText) resizeButtonText.remove();\r\n        this.signLanguageResizeOptionButton = resizeOption;\r\n        this.signLanguageResizeOptionText = resizeOption.querySelector(`.${this.options.classPrefix}-settings-text`);\r\n        this.updateSignLanguageResizeOptionState();\r\n\r\n        // Close option\r\n        const closeOption = createMenuItem({\r\n            classPrefix: this.options.classPrefix,\r\n            itemClass: `${this.options.classPrefix}-sign-language-settings-item`,\r\n            icon: 'close',\r\n            label: 'transcript.closeMenu',\r\n            onClick: () => {\r\n                this.hideSignLanguageSettingsMenu();\r\n            }\r\n        });\r\n        // Remove any tooltips from menu items (they have visible text)\r\n        const closeTooltip = closeOption.querySelector(`.${this.options.classPrefix}-tooltip`);\r\n        if (closeTooltip) closeTooltip.remove();\r\n        const closeButtonText = closeOption.querySelector(`.${this.options.classPrefix}-button-text`);\r\n        if (closeButtonText) closeButtonText.remove();\r\n\r\n        this.signLanguageSettingsMenu.appendChild(keyboardDragOption);\r\n        this.signLanguageSettingsMenu.appendChild(resizeOption);\r\n        this.signLanguageSettingsMenu.appendChild(closeOption);\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        // Set menu to invisible temporarily\r\n        this.signLanguageSettingsMenu.style.visibility = 'hidden';\r\n        this.signLanguageSettingsMenu.style.display = 'block';\r\n        \r\n        // Insert menu right after the button in the DOM (like control bar menus)\r\n        if (this.signLanguageSettingsButton && this.signLanguageSettingsButton.parentNode) {\r\n            this.signLanguageSettingsButton.insertAdjacentElement('afterend', this.signLanguageSettingsMenu);\r\n        } else if (this.signLanguageWrapper) {\r\n            // Fallback: append to wrapper if button parent not available\r\n            this.signLanguageWrapper.appendChild(this.signLanguageSettingsMenu);\r\n        }\r\n        \r\n        // Position the menu relative to the settings button (immediately while hidden)\r\n        this.positionSignLanguageSettingsMenuImmediate();\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            if (this.signLanguageSettingsMenu) {\r\n                this.signLanguageSettingsMenu.style.visibility = 'visible';\r\n            }\r\n        });\r\n        \r\n        // Add keyboard navigation\r\n        this.signLanguageSettingsMenuKeyHandler = attachMenuKeyboardNavigation(\r\n            this.signLanguageSettingsMenu,\r\n            this.signLanguageSettingsButton,\r\n            `.${this.options.classPrefix}-sign-language-settings-item`,\r\n            () => this.hideSignLanguageSettingsMenu({ focusButton: true })\r\n        );\r\n        \r\n        // Set the menu as visible and display it\r\n        this.signLanguageSettingsMenuVisible = true;\r\n        // this.signLanguageSettingsMenu.style.display = 'block'; // Already set above\r\n        \r\n        // Update aria-expanded\r\n        if (this.signLanguageSettingsButton) {\r\n            this.signLanguageSettingsButton.setAttribute('aria-expanded', 'true');\r\n        }\r\n        this.updateSignLanguageDragOptionState();\r\n        this.updateSignLanguageResizeOptionState();\r\n        \r\n        // Focus first menu item\r\n        focusFirstMenuItem(this.signLanguageSettingsMenu, `.${this.options.classPrefix}-sign-language-settings-item`);\r\n    }\r\n\r\n    hideSignLanguageSettingsMenu({ focusButton = true } = {}) {\r\n        return this.signLanguageManager.hideSettingsMenu({ focusButton });\r\n    }\r\n\r\n    positionSignLanguageSettingsMenuImmediate() {\r\n        if (!this.signLanguageSettingsMenu || !this.signLanguageSettingsButton) return;\r\n        \r\n        // Position immediately (synchronously) - used when menu is first shown\r\n        const buttonRect = this.signLanguageSettingsButton.getBoundingClientRect();\r\n        const menuRect = this.signLanguageSettingsMenu.getBoundingClientRect();\r\n        const viewportWidth = window.innerWidth;\r\n        const viewportHeight = window.innerHeight;\r\n        \r\n        // Get the parent container (headerLeft) as the positioning container (like control bar menus)\r\n        const parentContainer = this.signLanguageSettingsButton.parentElement;\r\n        if (!parentContainer) return;\r\n        \r\n        const parentRect = parentContainer.getBoundingClientRect();\r\n        \r\n        // Calculate position relative to parent container\r\n        const buttonCenterX = buttonRect.left + buttonRect.width / 2 - parentRect.left;\r\n        const buttonBottom = buttonRect.bottom - parentRect.top;\r\n        const buttonTop = buttonRect.top - parentRect.top;\r\n        \r\n        const spaceAbove = buttonRect.top;\r\n        const spaceBelow = viewportHeight - buttonRect.bottom;\r\n        \r\n        // Position menu below button by default\r\n        let menuTop = buttonBottom + 8;\r\n        let menuBottom = null;\r\n        \r\n        // Prefer below, but switch to above if not enough space\r\n        if (spaceBelow < menuRect.height + 20 && spaceAbove > spaceBelow) {\r\n            menuTop = null;\r\n            const parentHeight = parentRect.bottom - parentRect.top;\r\n            menuBottom = parentHeight - buttonTop + 8;\r\n            this.signLanguageSettingsMenu.classList.add('vidply-menu-above');\r\n        } else {\r\n            this.signLanguageSettingsMenu.classList.remove('vidply-menu-above');\r\n        }\r\n        \r\n        // Calculate horizontal position (center on button)\r\n        let menuLeft = buttonCenterX - menuRect.width / 2;\r\n        let menuRight = 'auto';\r\n        let transformX = 'translateX(0)';\r\n        \r\n        const menuLeftAbsolute = buttonRect.left + buttonRect.width / 2 - menuRect.width / 2;\r\n        if (menuLeftAbsolute < 10) {\r\n            menuLeft = 0;\r\n            transformX = 'translateX(0)';\r\n        } else if (menuLeftAbsolute + menuRect.width > viewportWidth - 10) {\r\n            menuLeft = 'auto';\r\n            menuRight = 0;\r\n            transformX = 'translateX(0)';\r\n        } else {\r\n            menuLeft = buttonCenterX;\r\n            transformX = 'translateX(-50%)';\r\n        }\r\n        \r\n        // Apply calculated positions\r\n        if (menuTop !== null) {\r\n            this.signLanguageSettingsMenu.style.top = `${menuTop}px`;\r\n            this.signLanguageSettingsMenu.style.bottom = 'auto';\r\n        } else if (menuBottom !== null) {\r\n            this.signLanguageSettingsMenu.style.top = 'auto';\r\n            this.signLanguageSettingsMenu.style.bottom = `${menuBottom}px`;\r\n        }\r\n        \r\n        if (menuLeft !== 'auto') {\r\n            this.signLanguageSettingsMenu.style.left = `${menuLeft}px`;\r\n            this.signLanguageSettingsMenu.style.right = 'auto';\r\n        } else {\r\n            this.signLanguageSettingsMenu.style.left = 'auto';\r\n            this.signLanguageSettingsMenu.style.right = `${menuRight}px`;\r\n        }\r\n        \r\n        this.signLanguageSettingsMenu.style.transform = transformX;\r\n    }\r\n    \r\n    positionSignLanguageSettingsMenu() {\r\n        if (!this.signLanguageSettingsMenu || !this.signLanguageSettingsButton || !this.signLanguageWrapper) return;\r\n        \r\n        // Use requestAnimationFrame to ensure layout is stable before positioning (for repositioning)\r\n        requestAnimationFrame(() => {\r\n            setTimeout(() => {\r\n                this.positionSignLanguageSettingsMenuImmediate();\r\n            }, 10); // Small delay to ensure layout is stable\r\n        });\r\n    }\r\n\r\n    attachSignLanguageSettingsMenuKeyboardNavigation() {\r\n        if (!this.signLanguageSettingsMenu) return;\r\n        \r\n        // Remove existing handler if any\r\n        if (this.signLanguageSettingsMenuKeyHandler) {\r\n            this.signLanguageSettingsMenu.removeEventListener('keydown', this.signLanguageSettingsMenuKeyHandler);\r\n        }\r\n        \r\n        this.signLanguageSettingsMenuKeyHandler = attachMenuKeyboardNavigation(\r\n            this.signLanguageSettingsMenu,\r\n            this.signLanguageSettingsButton,\r\n            `.${this.options.classPrefix}-sign-language-settings-item`,\r\n            () => this.hideSignLanguageSettingsMenu({ focusButton: true })\r\n        );\r\n    }\r\n\r\n    updateSignLanguageDragOptionState() {\r\n        if (!this.signLanguageDragOptionButton) {\r\n            return;\r\n        }\r\n        \r\n        const isEnabled = !!(this.signLanguageDraggable && this.signLanguageDraggable.keyboardDragMode);\r\n        const text = isEnabled\r\n            ? i18n.t('player.disableSignDragMode')\r\n            : i18n.t('player.enableSignDragMode');\r\n        const ariaLabel = isEnabled\r\n            ? i18n.t('player.disableSignDragModeAria')\r\n            : i18n.t('player.enableSignDragModeAria');\r\n\r\n        this.signLanguageDragOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\r\n        this.signLanguageDragOptionButton.setAttribute('aria-label', ariaLabel);\r\n\r\n        if (this.signLanguageDragOptionText) {\r\n            this.signLanguageDragOptionText.textContent = text;\r\n        }\r\n    }\r\n\r\n    updateSignLanguageResizeOptionState() {\r\n        if (!this.signLanguageResizeOptionButton) {\r\n            return;\r\n        }\r\n        \r\n        const isEnabled = !!(this.signLanguageDraggable && this.signLanguageDraggable.pointerResizeMode);\r\n        const text = isEnabled\r\n            ? i18n.t('player.disableSignResizeMode')\r\n            : i18n.t('player.enableSignResizeMode');\r\n        const ariaLabel = isEnabled\r\n            ? i18n.t('player.disableSignResizeModeAria')\r\n            : i18n.t('player.enableSignResizeModeAria');\r\n\r\n        this.signLanguageResizeOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\r\n        this.signLanguageResizeOptionButton.setAttribute('aria-label', ariaLabel);\r\n\r\n        if (this.signLanguageResizeOptionText) {\r\n            this.signLanguageResizeOptionText.textContent = text;\r\n        }\r\n    }\r\n\r\n    constrainSignLanguagePosition() {\r\n        return this.signLanguageManager.constrainPosition();\r\n    }\r\n\r\n    saveSignLanguagePreferences() {\r\n        return this.signLanguageManager.savePreferences();\r\n    }\r\n\r\n    // Legacy methods preserved for reference - can be removed after testing\r\n    _legacyConstrainSignLanguagePosition() {\r\n        if (!this.signLanguageWrapper || !this.videoWrapper) return;\r\n        \r\n        // Don't auto-position if user has manually positioned it\r\n        if (this.signLanguageDraggable && this.signLanguageDraggable.manuallyPositioned) {\r\n            return;\r\n        }\r\n        \r\n        // Ensure width is set\r\n        if (!this.signLanguageWrapper.style.width || this.signLanguageWrapper.style.width === '') {\r\n            this.signLanguageWrapper.style.width = '280px'; // Default width\r\n        }\r\n        \r\n        // Get videoWrapper position relative to the player CONTAINER (where sign language video is attached)\r\n        const videoWrapperRect = this.videoWrapper.getBoundingClientRect();\r\n        const containerRect = this.container.getBoundingClientRect();\r\n        const wrapperRect = this.signLanguageWrapper.getBoundingClientRect();\r\n        \r\n        // Calculate videoWrapper's position and dimensions relative to container\r\n        const videoWrapperLeft = videoWrapperRect.left - containerRect.left;\r\n        const videoWrapperTop = videoWrapperRect.top - containerRect.top;\r\n        const videoWrapperWidth = videoWrapperRect.width;\r\n        const videoWrapperHeight = videoWrapperRect.height;\r\n        \r\n        // Use estimated height if video hasn't loaded yet (16:9 aspect ratio)\r\n        let wrapperWidth = wrapperRect.width || 280;\r\n        let wrapperHeight = wrapperRect.height || ((280 * 9) / 16); // Estimate based on 16:9 aspect ratio\r\n        \r\n        let left, top;\r\n        const margin = 16; // Margin from edges\r\n        const controlsHeight = 95; // Height of controls when visible\r\n        \r\n        // Always calculate fresh position based on desired location (relative to videoWrapper)\r\n        const position = this.signLanguageDesiredPosition || 'bottom-right';\r\n        \r\n        switch (position) {\r\n            case 'bottom-right':\r\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\r\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\r\n                break;\r\n            case 'bottom-left':\r\n                left = videoWrapperLeft + margin;\r\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\r\n                break;\r\n            case 'top-right':\r\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\r\n                top = videoWrapperTop + margin;\r\n                break;\r\n            case 'top-left':\r\n                left = videoWrapperLeft + margin;\r\n                top = videoWrapperTop + margin;\r\n                break;\r\n            default:\r\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\r\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\r\n        }\r\n        \r\n        // Constrain to videoWrapper bounds (ensuring it stays above controls)\r\n        left = Math.max(videoWrapperLeft, Math.min(left, videoWrapperLeft + videoWrapperWidth - wrapperWidth));\r\n        top = Math.max(videoWrapperTop, Math.min(top, videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight));\r\n        \r\n        // Apply constrained position\r\n        this.signLanguageWrapper.style.left = `${left}px`;\r\n        this.signLanguageWrapper.style.top = `${top}px`;\r\n        this.signLanguageWrapper.style.right = 'auto';\r\n        this.signLanguageWrapper.style.bottom = 'auto';\r\n        // Remove position classes if any were applied\r\n        this.signLanguageWrapper.classList.remove(...Array.from(this.signLanguageWrapper.classList).filter(c => c.startsWith('vidply-sign-position-')));\r\n    }\r\n\r\n    _legacySaveSignLanguagePreferences() {\r\n        if (!this.signLanguageWrapper) return;\r\n        \r\n        // Only save width - position is always calculated fresh to bottom-right\r\n        this.storage.saveSignLanguagePreferences({\r\n            size: {\r\n                width: this.signLanguageWrapper.style.width\r\n                // Height is auto - maintained by aspect ratio\r\n            }\r\n        });\r\n    }\r\n\r\n    cleanupSignLanguage() {\r\n        return this.signLanguageManager.cleanup();\r\n    }\r\n\r\n    // Settings\r\n    // Settings dialog removed - using individual control buttons instead\r\n    showSettings() {\r\n        console.warn('[VidPly] Settings dialog has been removed. Use individual control buttons (speed, captions, etc.)');\r\n    }\r\n\r\n    hideSettings() {\r\n        // No-op - settings dialog removed\r\n    }\r\n\r\n    // Utility methods\r\n    getCurrentTime() {\r\n        return this.state.currentTime;\r\n    }\r\n\r\n    getDuration() {\r\n        return this.state.duration;\r\n    }\r\n\r\n    isPlaying() {\r\n        return this.state.playing;\r\n    }\r\n\r\n    isPaused() {\r\n        return this.state.paused;\r\n    }\r\n\r\n    isEnded() {\r\n        return this.state.ended;\r\n    }\r\n\r\n    isMuted() {\r\n        return this.state.muted;\r\n    }\r\n\r\n    isFullscreen() {\r\n        return this.state.fullscreen;\r\n    }\r\n\r\n    // Error handling\r\n    handleError(error) {\r\n        // Suppress errors during renderer switching\r\n        // This prevents cascade of errors when HTML5 element is cleared for external renderers\r\n        if (this._switchingRenderer) {\r\n            this.log('Suppressing error during renderer switch:', error, 'debug');\r\n            return;\r\n        }\r\n        \r\n        this.log('Error:', error, 'error');\r\n        this.emit('error', error);\r\n\r\n        if (this.options.onError) {\r\n            this.options.onError.call(this, error);\r\n        }\r\n    }\r\n\r\n    // Logging\r\n    log(...messages) {\r\n        if (!this.options.debug) {\r\n            return;\r\n        }\r\n\r\n        let type = 'log';\r\n        if (messages.length > 0) {\r\n            const potentialType = messages[messages.length - 1];\r\n            if (typeof potentialType === 'string' && console[potentialType]) {\r\n                type = potentialType;\r\n                messages = messages.slice(0, -1);\r\n            }\r\n        }\r\n\r\n        if (messages.length === 0) {\r\n            messages = [''];\r\n        }\r\n\r\n        if (typeof console[type] === 'function') {\r\n            console[type]('[VidPly]', ...messages);\r\n        } else {\r\n            console.log('[VidPly]', ...messages);\r\n        }\r\n    }\r\n\r\n    // Setup responsive handlers\r\n    setupResponsiveHandlers() {\r\n        // Use ResizeObserver for efficient resize tracking\r\n        if (typeof ResizeObserver !== 'undefined') {\r\n            this.resizeObserver = new ResizeObserver((entries) => {\r\n                for (const entry of entries) {\r\n                    const width = entry.contentRect.width;\r\n\r\n                    // Update control bar for viewport\r\n                    if (this.controlBar && typeof this.controlBar.updateControlsForViewport === 'function') {\r\n                        this.controlBar.updateControlsForViewport(width);\r\n                    }\r\n\r\n                    // Update transcript positioning\r\n                    if (this.transcriptManager && this.transcriptManager.isVisible) {\r\n                        this.transcriptManager.positionTranscript();\r\n                    }\r\n                }\r\n            });\r\n\r\n            this.resizeObserver.observe(this.container);\r\n        } else {\r\n            // Fallback to window resize event\r\n            this.resizeHandler = () => {\r\n                const width = this.container.clientWidth;\r\n\r\n                if (this.controlBar && typeof this.controlBar.updateControlsForViewport === 'function') {\r\n                    this.controlBar.updateControlsForViewport(width);\r\n                }\r\n\r\n                if (this.transcriptManager && this.transcriptManager.isVisible) {\r\n                    // Only auto-position if user hasn't manually moved it\r\n                    if (!this.transcriptManager.draggableResizable || !this.transcriptManager.draggableResizable.manuallyPositioned) {\r\n                        this.transcriptManager.positionTranscript();\r\n                    }\r\n                }\r\n            };\r\n\r\n            window.addEventListener('resize', this.resizeHandler);\r\n        }\r\n\r\n        // Also listen for orientation changes on mobile\r\n        if (window.matchMedia) {\r\n            this.orientationHandler = (e) => {\r\n                // Wait for layout to settle\r\n                setTimeout(() => {\r\n                    if (this.transcriptManager && this.transcriptManager.isVisible) {\r\n                        // Only auto-position if user hasn't manually moved it\r\n                        if (!this.transcriptManager.draggableResizable || !this.transcriptManager.draggableResizable.manuallyPositioned) {\r\n                            this.transcriptManager.positionTranscript();\r\n                        }\r\n                    }\r\n                }, 100);\r\n            };\r\n\r\n            const orientationQuery = window.matchMedia('(orientation: portrait)');\r\n            if (orientationQuery.addEventListener) {\r\n                orientationQuery.addEventListener('change', this.orientationHandler);\r\n            } else if (orientationQuery.addListener) {\r\n                // Fallback for older browsers\r\n                orientationQuery.addListener(this.orientationHandler);\r\n            }\r\n\r\n            this.orientationQuery = orientationQuery;\r\n        }\r\n\r\n        // Listen for native fullscreen change events (e.g., when user presses ESC)\r\n        this.fullscreenChangeHandler = () => {\r\n            const isFullscreen = !!(\r\n                document.fullscreenElement ||\r\n                document.webkitFullscreenElement ||\r\n                document.mozFullScreenElement ||\r\n                document.msFullscreenElement\r\n            );\r\n\r\n            // Only update if state has changed\r\n            if (this.state.fullscreen !== isFullscreen) {\r\n                this.state.fullscreen = isFullscreen;\r\n                \r\n                if (isFullscreen) {\r\n                    this.container.classList.add(`${this.options.classPrefix}-fullscreen`);\r\n                    // Add body class for CSS targeting (fallback for browsers without :has() support)\r\n                    document.body.classList.add('vidply-fullscreen-active');\r\n                    // Make background content inert to prevent keyboard focus escaping\r\n                    this._makeBackgroundInert();\r\n                } else {\r\n                    this.container.classList.remove(`${this.options.classPrefix}-fullscreen`);\r\n                    // Remove body class for CSS targeting\r\n                    document.body.classList.remove('vidply-fullscreen-active');\r\n                    // Restore background interactivity\r\n                    this._restoreBackgroundInteractivity();\r\n                    // Clean up pseudo-fullscreen state when exiting\r\n                    this._disablePseudoFullscreen();\r\n                }\r\n                \r\n                this.emit('fullscreenchange', isFullscreen);\r\n                \r\n                // Update fullscreen button icon\r\n                if (this.controlBar) {\r\n                    this.controlBar.updateFullscreenButton();\r\n                }\r\n                \r\n                // Reposition sign language video after fullscreen transition\r\n                if (this.signLanguageWrapper && this.signLanguageWrapper.style.display !== 'none') {\r\n                    // Re-setup drag/drop when entering/exiting fullscreen on mobile devices\r\n                    // This enables drag/resize when entering fullscreen on mobile\r\n                    const isMobile = window.innerWidth < 768;\r\n                    if (isMobile) {\r\n                        this.setupSignLanguageInteraction();\r\n                    }\r\n                    \r\n                    // Use setTimeout to ensure layout has updated after fullscreen transition\r\n                    // Longer delay to account for CSS transition animations and layout recalculation\r\n                    this.setManagedTimeout(() => {\r\n                        // Use requestAnimationFrame to ensure the browser has fully rendered the layout\r\n                        requestAnimationFrame(() => {\r\n                            // Clear saved size and reset to default for the new container size\r\n                            this.storage.saveSignLanguagePreferences({ size: null });\r\n                            this.signLanguageDesiredPosition = 'bottom-right';\r\n                            // Reset to default width for the new container\r\n                            this.signLanguageWrapper.style.width = isFullscreen ? '400px' : '280px';\r\n                            this.constrainSignLanguagePosition();\r\n                        });\r\n                    }, 500);\r\n                }\r\n            }\r\n        };\r\n\r\n        // Add listeners for all vendor-prefixed fullscreenchange events\r\n        document.addEventListener('fullscreenchange', this.fullscreenChangeHandler);\r\n        document.addEventListener('webkitfullscreenchange', this.fullscreenChangeHandler);\r\n        document.addEventListener('mozfullscreenchange', this.fullscreenChangeHandler);\r\n        document.addEventListener('MSFullscreenChange', this.fullscreenChangeHandler);\r\n    }\r\n\r\n    // Cleanup\r\n    destroy() {\r\n        this.log('Destroying player');\r\n\r\n        if (this.renderer) {\r\n            this.renderer.destroy();\r\n        }\r\n\r\n        if (this.controlBar) {\r\n            this.controlBar.destroy();\r\n        }\r\n\r\n        if (this.captionManager) {\r\n            this.captionManager.destroy();\r\n        }\r\n\r\n        if (this.keyboardManager) {\r\n            this.keyboardManager.destroy();\r\n        }\r\n\r\n        if (this.transcriptManager) {\r\n            this.transcriptManager.destroy();\r\n        }\r\n\r\n        // Cleanup sign language video and listeners\r\n        this.cleanupSignLanguage();\r\n\r\n        // Cleanup play overlay button\r\n        if (this.playButtonOverlay && this.playButtonOverlay.parentNode) {\r\n            this.playButtonOverlay.remove();\r\n            this.playButtonOverlay = null;\r\n        }\r\n\r\n        // Cleanup resize observer\r\n        if (this.resizeObserver) {\r\n            this.resizeObserver.disconnect();\r\n            this.resizeObserver = null;\r\n        }\r\n\r\n        // Cleanup window resize handler\r\n        if (this.resizeHandler) {\r\n            window.removeEventListener('resize', this.resizeHandler);\r\n            this.resizeHandler = null;\r\n        }\r\n\r\n        // Cleanup orientation change handler\r\n        if (this.orientationQuery && this.orientationHandler) {\r\n            if (this.orientationQuery.removeEventListener) {\r\n                this.orientationQuery.removeEventListener('change', this.orientationHandler);\r\n            } else if (this.orientationQuery.removeListener) {\r\n                this.orientationQuery.removeListener(this.orientationHandler);\r\n            }\r\n            this.orientationQuery = null;\r\n            this.orientationHandler = null;\r\n        }\r\n\r\n        // Cleanup fullscreen change handler\r\n        if (this.fullscreenChangeHandler) {\r\n            document.removeEventListener('fullscreenchange', this.fullscreenChangeHandler);\r\n            document.removeEventListener('webkitfullscreenchange', this.fullscreenChangeHandler);\r\n            document.removeEventListener('mozfullscreenchange', this.fullscreenChangeHandler);\r\n            document.removeEventListener('MSFullscreenChange', this.fullscreenChangeHandler);\r\n            this.fullscreenChangeHandler = null;\r\n        }\r\n\r\n        // Cleanup all managed timeouts\r\n        this.timeouts.forEach(timeoutId => clearTimeout(timeoutId));\r\n        this.timeouts.clear();\r\n\r\n        // Cleanup metadata handling\r\n        if (this.metadataCueChangeHandler) {\r\n            const textTracks = this.textTracks;\r\n            const metadataTrack = textTracks.find(track => track.kind === 'metadata');\r\n            if (metadataTrack) {\r\n                metadataTrack.removeEventListener('cuechange', this.metadataCueChangeHandler);\r\n            }\r\n            this.metadataCueChangeHandler = null;\r\n        }\r\n\r\n        if (this.metadataAlertHandlers && this.metadataAlertHandlers.size > 0) {\r\n            this.metadataAlertHandlers.forEach(({ button, handler }) => {\r\n                if (button && handler) {\r\n                    button.removeEventListener('click', handler);\r\n                }\r\n            });\r\n            this.metadataAlertHandlers.clear();\r\n        }\r\n\r\n        // Remove container\r\n        if (this.container && this.container.parentNode) {\r\n            this.container.parentNode.insertBefore(this.element, this.container);\r\n            this.container.parentNode.removeChild(this.container);\r\n        }\r\n\r\n        this.removeAllListeners();\r\n    }\r\n\r\n    /**\r\n     * Setup metadata track handling\r\n     * This enables metadata tracks and listens for cue changes to trigger actions\r\n     */\r\n    setupMetadataHandling() {\r\n        const setupMetadata = () => {\r\n            const textTracks = this.textTracks;\r\n            const metadataTrack = textTracks.find(track => track.kind === 'metadata');\r\n            \r\n            if (metadataTrack) {\r\n                // Enable the metadata track so cuechange events fire\r\n                // Use 'hidden' mode so it doesn't display anything, but events still work\r\n                if (metadataTrack.mode === 'disabled') {\r\n                    metadataTrack.mode = 'hidden';\r\n                }\r\n                \r\n                // Remove existing listener if any\r\n                if (this.metadataCueChangeHandler) {\r\n                    metadataTrack.removeEventListener('cuechange', this.metadataCueChangeHandler);\r\n                }\r\n                \r\n                // Add event listener for cue changes\r\n                this.metadataCueChangeHandler = () => {\r\n                    const activeCues = Array.from(metadataTrack.activeCues || []);\r\n                    if (activeCues.length > 0) {\r\n                        // Debug logging\r\n                        if (this.options.debug) {\r\n                            this.log('[Metadata] Active cues:', activeCues.map(c => ({\r\n                                start: c.startTime,\r\n                                end: c.endTime,\r\n                                text: c.text\r\n                            })));\r\n                        }\r\n                    }\r\n                    activeCues.forEach(cue => {\r\n                        this.handleMetadataCue(cue);\r\n                    });\r\n                };\r\n                \r\n                metadataTrack.addEventListener('cuechange', this.metadataCueChangeHandler);\r\n                \r\n                // Debug: Log metadata track setup\r\n                if (this.options.debug) {\r\n                    const cueCount = metadataTrack.cues ? metadataTrack.cues.length : 0;\r\n                    this.log('[Metadata] Track enabled,', cueCount, 'cues available');\r\n                }\r\n            } else if (this.options.debug) {\r\n                this.log('[Metadata] No metadata track found');\r\n            }\r\n        };\r\n        \r\n        // Try immediately\r\n        setupMetadata();\r\n        \r\n        // Also try after loadedmetadata event (tracks might not be ready yet)\r\n        this.on('loadedmetadata', setupMetadata);\r\n    }\r\n\r\n    normalizeMetadataSelector(selector) {\r\n        if (!selector) {\r\n            return null;\r\n        }\r\n        const trimmed = selector.trim();\r\n        if (!trimmed) {\r\n            return null;\r\n        }\r\n        if (trimmed.startsWith('#') || trimmed.startsWith('.') || trimmed.startsWith('[')) {\r\n            return trimmed;\r\n        }\r\n        return `#${trimmed}`;\r\n    }\r\n\r\n    resolveMetadataConfig(map, key) {\r\n        if (!map || !key) {\r\n            return null;\r\n        }\r\n        if (Object.prototype.hasOwnProperty.call(map, key)) {\r\n            return map[key];\r\n        }\r\n        const withoutHash = key.replace(/^#/, '');\r\n        if (Object.prototype.hasOwnProperty.call(map, withoutHash)) {\r\n            return map[withoutHash];\r\n        }\r\n        return null;\r\n    }\r\n\r\n    cacheMetadataAlertContent(element, config = {}) {\r\n        if (!element) {\r\n            return;\r\n        }\r\n        const titleSelector = config.titleSelector || '[data-vidply-alert-title], h3, header';\r\n        const messageSelector = config.messageSelector || '[data-vidply-alert-message], p';\r\n\r\n        const titleEl = element.querySelector(titleSelector);\r\n        if (titleEl && !titleEl.dataset.vidplyAlertTitleOriginal) {\r\n            titleEl.dataset.vidplyAlertTitleOriginal = titleEl.textContent.trim();\r\n        }\r\n\r\n        const messageEl = element.querySelector(messageSelector);\r\n        if (messageEl && !messageEl.dataset.vidplyAlertMessageOriginal) {\r\n            messageEl.dataset.vidplyAlertMessageOriginal = messageEl.textContent.trim();\r\n        }\r\n    }\r\n\r\n    restoreMetadataAlertContent(element, config = {}) {\r\n        if (!element) {\r\n            return;\r\n        }\r\n        const titleSelector = config.titleSelector || '[data-vidply-alert-title], h3, header';\r\n        const messageSelector = config.messageSelector || '[data-vidply-alert-message], p';\r\n\r\n        const titleEl = element.querySelector(titleSelector);\r\n        if (titleEl && titleEl.dataset.vidplyAlertTitleOriginal) {\r\n            titleEl.textContent = titleEl.dataset.vidplyAlertTitleOriginal;\r\n        }\r\n\r\n        const messageEl = element.querySelector(messageSelector);\r\n        if (messageEl && messageEl.dataset.vidplyAlertMessageOriginal) {\r\n            messageEl.textContent = messageEl.dataset.vidplyAlertMessageOriginal;\r\n        }\r\n    }\r\n\r\n    focusMetadataTarget(target, fallbackElement = null) {\r\n        if (!target || target === 'none') {\r\n            return;\r\n        }\r\n\r\n        if (target === 'alert' && fallbackElement) {\r\n            fallbackElement.focus({ preventScroll: true });\r\n            return;\r\n        }\r\n\r\n        if (target === 'player') {\r\n            if (this.container) {\r\n                this.container.focus({ preventScroll: true });\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (target === 'media') {\r\n            this.element.focus({ preventScroll: true });\r\n            return;\r\n        }\r\n\r\n        if (target === 'playButton') {\r\n            const playButton = this.controlBar?.controls?.playPause;\r\n            if (playButton) {\r\n                playButton.focus({ preventScroll: true });\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (typeof target === 'string') {\r\n            const targetElement = document.querySelector(target);\r\n            if (targetElement) {\r\n                if (targetElement.tabIndex === -1 && !targetElement.hasAttribute('tabindex')) {\r\n                    targetElement.setAttribute('tabindex', '-1');\r\n                }\r\n                targetElement.focus({ preventScroll: true });\r\n            }\r\n        }\r\n    }\r\n\r\n    handleMetadataAlert(selector, options = {}) {\r\n        if (!selector) {\r\n            return;\r\n        }\r\n\r\n        const config = this.resolveMetadataConfig(this.options.metadataAlerts, selector) || {};\r\n        const element = options.element || document.querySelector(selector);\r\n\r\n        if (!element) {\r\n            if (this.options.debug) {\r\n                this.log('[Metadata] Alert element not found:', selector);\r\n            }\r\n            return;\r\n        }\r\n\r\n        if (this.options.debug) {\r\n            this.log('[Metadata] Handling alert', selector, { reason: options.reason, config });\r\n        }\r\n\r\n        this.cacheMetadataAlertContent(element, config);\r\n\r\n        if (!element.dataset.vidplyAlertOriginalDisplay) {\r\n            element.dataset.vidplyAlertOriginalDisplay = element.style.display || '';\r\n        }\r\n\r\n        if (!element.dataset.vidplyAlertDisplay) {\r\n            element.dataset.vidplyAlertDisplay = config.display || 'block';\r\n        }\r\n\r\n        const shouldShow = options.show !== undefined ? options.show : (config.show !== false);\r\n        if (shouldShow) {\r\n            const displayValue = config.display || element.dataset.vidplyAlertDisplay || 'block';\r\n            element.style.display = displayValue;\r\n            element.hidden = false;\r\n            element.removeAttribute('hidden');\r\n            element.setAttribute('aria-hidden', 'false');\r\n            element.setAttribute('data-vidply-alert-active', 'true');\r\n        }\r\n\r\n        const shouldReset = config.resetContent !== false && options.reason === 'focus';\r\n        if (shouldReset) {\r\n            this.restoreMetadataAlertContent(element, config);\r\n        }\r\n\r\n        const shouldFocus = options.focus !== undefined\r\n            ? options.focus\r\n            : (config.focusOnShow ?? (options.reason !== 'focus'));\r\n\r\n        if (shouldShow && shouldFocus) {\r\n            if (element.tabIndex === -1 && !element.hasAttribute('tabindex')) {\r\n                element.setAttribute('tabindex', '-1');\r\n            }\r\n            element.focus({ preventScroll: true });\r\n        }\r\n\r\n        if (shouldShow && config.autoScroll !== false && options.autoScroll !== false) {\r\n            element.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n        }\r\n\r\n        const continueSelector = config.continueButton;\r\n        if (continueSelector) {\r\n            let continueButton = null;\r\n            if (continueSelector === 'self') {\r\n                continueButton = element;\r\n            } else if (element.matches(continueSelector)) {\r\n                continueButton = element;\r\n            } else {\r\n                continueButton = element.querySelector(continueSelector) || document.querySelector(continueSelector);\r\n            }\r\n\r\n            if (continueButton && !this.metadataAlertHandlers.has(selector)) {\r\n                const handler = () => {\r\n                    const hideOnContinue = config.hideOnContinue !== false;\r\n                    if (hideOnContinue) {\r\n                        const originalDisplay = element.dataset.vidplyAlertOriginalDisplay || '';\r\n                        element.style.display = config.hideDisplay || originalDisplay || 'none';\r\n                        element.setAttribute('aria-hidden', 'true');\r\n                        element.removeAttribute('data-vidply-alert-active');\r\n                    }\r\n\r\n                    if (config.resume !== false && this.state.paused) {\r\n                        this.play();\r\n                    }\r\n\r\n                    const focusTarget = config.focusTarget || 'playButton';\r\n                    this.setManagedTimeout(() => {\r\n                        this.focusMetadataTarget(focusTarget, element);\r\n                    }, config.focusDelay ?? 100);\r\n                };\r\n\r\n                continueButton.addEventListener('click', handler);\r\n                this.metadataAlertHandlers.set(selector, { button: continueButton, handler });\r\n            }\r\n        }\r\n\r\n        return element;\r\n    }\r\n\r\n    handleMetadataHashtags(hashtags) {\r\n        if (!Array.isArray(hashtags) || hashtags.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const configMap = this.options.metadataHashtags;\r\n        if (!configMap) {\r\n            return;\r\n        }\r\n\r\n        hashtags.forEach(tag => {\r\n            const config = this.resolveMetadataConfig(configMap, tag);\r\n            if (!config) {\r\n                return;\r\n            }\r\n\r\n            const selector = this.normalizeMetadataSelector(config.alert || config.selector || config.target);\r\n            if (!selector) {\r\n                return;\r\n            }\r\n\r\n            const element = document.querySelector(selector);\r\n            if (!element) {\r\n                if (this.options.debug) {\r\n                    this.log('[Metadata] Hashtag target not found:', selector);\r\n                }\r\n                return;\r\n            }\r\n\r\n        if (this.options.debug) {\r\n            this.log('[Metadata] Handling hashtag', tag, { selector, config });\r\n        }\r\n\r\n            this.cacheMetadataAlertContent(element, config);\r\n\r\n            if (config.title) {\r\n                const titleSelector = config.titleSelector || '[data-vidply-alert-title], h3, header';\r\n                const titleEl = element.querySelector(titleSelector);\r\n                if (titleEl) {\r\n                    titleEl.textContent = config.title;\r\n                }\r\n            }\r\n\r\n            if (config.message) {\r\n                const messageSelector = config.messageSelector || '[data-vidply-alert-message], p';\r\n                const messageEl = element.querySelector(messageSelector);\r\n                if (messageEl) {\r\n                    messageEl.textContent = config.message;\r\n                }\r\n            }\r\n\r\n            const show = config.show !== false;\r\n            const focus = config.focus !== undefined ? config.focus : false;\r\n\r\n            this.handleMetadataAlert(selector, {\r\n                element,\r\n                show,\r\n                focus,\r\n                autoScroll: config.autoScroll,\r\n                reason: 'hashtag'\r\n            });\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Handle individual metadata cues\r\n     * Parses metadata text and emits events or triggers actions\r\n     */\r\n    handleMetadataCue(cue) {\r\n        const text = cue.text.trim();\r\n        \r\n        // Debug logging\r\n        if (this.options.debug) {\r\n            this.log('[Metadata] Processing cue:', {\r\n                time: cue.startTime,\r\n                text: text\r\n            });\r\n        }\r\n        \r\n        // Emit a generic metadata event that developers can listen to\r\n        this.emit('metadata', {\r\n            time: cue.startTime,\r\n            endTime: cue.endTime,\r\n            text: text,\r\n            cue: cue\r\n        });\r\n\r\n        // Parse for specific commands (examples based on wwa_meta.vtt format)\r\n        if (text.includes('PAUSE')) {\r\n            // Automatically pause the video\r\n            if (!this.state.paused) {\r\n                if (this.options.debug) {\r\n                    this.log('[Metadata] Pausing video at', cue.startTime);\r\n                }\r\n                this.pause();\r\n            }\r\n            // Also emit event for developers who want to listen\r\n            this.emit('metadata:pause', { time: cue.startTime, text: text });\r\n        }\r\n\r\n        // Parse for focus directives\r\n        const focusMatch = text.match(/FOCUS:([\\w#-]+)/);\r\n        if (focusMatch) {\r\n            const targetSelector = focusMatch[1];\r\n            const normalizedSelector = this.normalizeMetadataSelector(targetSelector);\r\n            // Automatically focus the target element\r\n            const targetElement = normalizedSelector ? document.querySelector(normalizedSelector) : null;\r\n            if (targetElement) {\r\n                if (this.options.debug) {\r\n                    this.log('[Metadata] Focusing element:', normalizedSelector);\r\n                }\r\n                // Make element focusable if it isn't already\r\n                if (targetElement.tabIndex === -1 && !targetElement.hasAttribute('tabindex')) {\r\n                    targetElement.setAttribute('tabindex', '-1');\r\n                }\r\n                // Use setTimeout to ensure DOM is ready\r\n                this.setManagedTimeout(() => {\r\n                    targetElement.focus({ preventScroll: true });\r\n                }, 10);\r\n            } else if (this.options.debug) {\r\n                this.log('[Metadata] Element not found:', normalizedSelector || targetSelector);\r\n            }\r\n            // Also emit event for developers who want to listen\r\n            this.emit('metadata:focus', { \r\n                time: cue.startTime, \r\n                target: targetSelector,\r\n                selector: normalizedSelector,\r\n                element: targetElement,\r\n                text: text \r\n            });\r\n\r\n            if (normalizedSelector) {\r\n                this.handleMetadataAlert(normalizedSelector, {\r\n                    element: targetElement,\r\n                    reason: 'focus'\r\n                });\r\n            }\r\n        }\r\n\r\n        // Parse for hashtag references\r\n        const hashtags = text.match(/#[\\w-]+/g);\r\n        if (hashtags) {\r\n            if (this.options.debug) {\r\n                this.log('[Metadata] Hashtags found:', hashtags);\r\n            }\r\n            this.emit('metadata:hashtags', {\r\n                time: cue.startTime,\r\n                hashtags: hashtags,\r\n                text: text\r\n            });\r\n\r\n            this.handleMetadataHashtags(hashtags);\r\n        }\r\n    }\r\n}\r\n\r\n// Static instances tracker for pause others functionality\r\nPlayer.instances = [];\r\n\r\n", "/**\r\n * Control Bar Component\r\n */\r\n\r\nimport {DOMUtils} from '../utils/DOMUtils.js';\r\nimport {TimeUtils} from '../utils/TimeUtils.js';\r\nimport {createIconElement} from '../icons/Icons.js';\r\nimport {i18n} from '../i18n/i18n.js';\r\nimport {focusElement, focusFirstElement} from '../utils/FocusUtils.js';\r\nimport {isMobile} from '../utils/PerformanceUtils.js';\r\nimport {captureVideoFrame} from '../utils/VideoFrameCapture.js';\r\n\r\nexport class ControlBar {\r\n    constructor(player) {\r\n        this.player = player;\r\n        this.element = null;\r\n        this.controls = {};\r\n        this.hideTimeout = null;\r\n        this.isDraggingProgress = false;\r\n        this.isDraggingVolume = false;\r\n        this.openMenu = null; // Track currently open menu\r\n        this.openMenuButton = null; // Track button that opened the menu\r\n\r\n        this.init();\r\n    }\r\n\r\n    init() {\r\n        this.createElement();\r\n        this.createControls();\r\n        // Ensure time UI reflects any prefilled state (e.g. initialDuration)\r\n        // even when media metadata is deferred and 'loadedmetadata' won't fire yet.\r\n        this.updateDuration();\r\n        this.updateProgress();\r\n        this.attachEvents();\r\n        this.setupAutoHide();\r\n        this.setupOverflowDetection();\r\n    }\r\n\r\n    // Helper method to detect touch devices\r\n    isTouchDevice() {\r\n        return (\r\n            ('ontouchstart' in window) ||\r\n            (navigator.maxTouchPoints > 0) ||\r\n            (navigator.msMaxTouchPoints > 0)\r\n        );\r\n    }\r\n\r\n    // Smart menu positioning to avoid overflow\r\n    positionMenu(menu, button, immediate = false) {\r\n        const mobile = isMobile();\r\n        const isOverflowMenu = menu.classList.contains(`${this.player.options.classPrefix}-overflow-menu-list`);\r\n        const isFullscreen = this.player.state.fullscreen;\r\n        \r\n        // In fullscreen, menu is appended to player container, so use fixed positioning\r\n        if (isFullscreen && menu.parentElement === this.player.container) {\r\n            const doFullscreenPositioning = () => {\r\n                const buttonRect = button.getBoundingClientRect();\r\n                const menuRect = menu.getBoundingClientRect();\r\n                const containerRect = this.player.container.getBoundingClientRect();\r\n                const viewportHeight = window.innerHeight;\r\n                \r\n                // Position relative to player container\r\n                const buttonCenterX = buttonRect.left + buttonRect.width / 2 - containerRect.left;\r\n                const buttonTop = buttonRect.top - containerRect.top;\r\n                const buttonBottom = buttonRect.bottom - containerRect.top;\r\n                \r\n                const spaceAbove = buttonRect.top - containerRect.top;\r\n                const spaceBelow = containerRect.bottom - buttonRect.bottom;\r\n                \r\n                // Position menu above button by default\r\n                if (spaceAbove >= menuRect.height + 20 || spaceAbove > spaceBelow) {\r\n                    menu.style.bottom = `${containerRect.height - buttonTop + 8}px`;\r\n                    menu.style.top = 'auto';\r\n                    menu.classList.remove('vidply-menu-below');\r\n                } else {\r\n                    // Position below if more space there\r\n                    menu.style.top = `${buttonBottom + 8}px`;\r\n                    menu.style.bottom = 'auto';\r\n                    menu.classList.add('vidply-menu-below');\r\n                }\r\n                \r\n                // Horizontal positioning\r\n                if (isOverflowMenu) {\r\n                    // Overflow menu aligns to right\r\n                    const buttonRight = buttonRect.right - containerRect.left;\r\n                    menu.style.right = `${containerRect.width - buttonRight}px`;\r\n                    menu.style.left = 'auto';\r\n                    menu.style.transform = 'none';\r\n                } else {\r\n                    // Other menus center on button\r\n                    menu.style.left = `${buttonCenterX}px`;\r\n                    menu.style.right = 'auto';\r\n                    menu.style.transform = 'translateX(-50%)';\r\n                }\r\n            };\r\n            \r\n            if (immediate) {\r\n                doFullscreenPositioning();\r\n            } else {\r\n                requestAnimationFrame(doFullscreenPositioning);\r\n            }\r\n            return;\r\n        }\r\n        \r\n        if (mobile) {\r\n            // On mobile, ensure menus stay within viewport\r\n            const isVolumeMenu = menu.classList.contains(`${this.player.options.classPrefix}-volume-menu`);\r\n            \r\n            const doMobilePositioning = () => {\r\n                // Get the button's parent container (controls-left or controls-right)\r\n                const parentContainer = button.parentElement;\r\n                if (!parentContainer) return;\r\n                \r\n                const buttonRect = button.getBoundingClientRect();\r\n                const parentRect = parentContainer.getBoundingClientRect();\r\n                const menuRect = menu.getBoundingClientRect();\r\n                const viewportWidth = window.innerWidth;\r\n                const viewportHeight = window.innerHeight;\r\n                \r\n                // Volume menu should be centered on its button\r\n                if (isVolumeMenu) {\r\n                    // Calculate button position relative to parent\r\n                    const buttonCenterX = buttonRect.left + buttonRect.width / 2 - parentRect.left;\r\n                    \r\n                    // Center menu on button\r\n                    menu.style.left = `${buttonCenterX}px`;\r\n                    menu.style.right = 'auto';\r\n                    menu.style.transform = 'translateX(-50%)';\r\n                    return;\r\n                }\r\n                \r\n                // Check if menu overflows viewport\r\n                if (menuRect.right > viewportWidth) {\r\n                    menu.style.left = 'auto';\r\n                    menu.style.right = '10px';\r\n                    menu.style.transform = 'none';\r\n                }\r\n                \r\n                if (menuRect.left < 0) {\r\n                    menu.style.left = '10px';\r\n                    menu.style.right = 'auto';\r\n                    menu.style.transform = 'none';\r\n                }\r\n                \r\n                // Ensure menu doesn't go off top or bottom\r\n                if (menuRect.top < 10) {\r\n                    menu.style.top = '10px';\r\n                    // Important: clear bottom constraint, otherwise top+bottom will squeeze the menu height\r\n                    // into a tiny strip on some mobile layouts.\r\n                    menu.style.bottom = 'auto';\r\n                }\r\n                \r\n                if (menuRect.bottom > viewportHeight - 10) {\r\n                    menu.style.bottom = '10px';\r\n                    menu.style.top = 'auto';\r\n                }\r\n            };\r\n            \r\n            if (immediate) {\r\n                doMobilePositioning();\r\n            } else {\r\n                requestAnimationFrame(doMobilePositioning);\r\n            }\r\n            return;\r\n        }\r\n\r\n        // Desktop: Smart positioning\r\n        // Menu is now a sibling of the button, within controls-left or controls-right container\r\n        // These containers have position: relative, so menus position relative to them\r\n        \r\n        const doPositioning = () => {\r\n            const buttonRect = button.getBoundingClientRect();\r\n            const menuRect = menu.getBoundingClientRect();\r\n            const viewportWidth = window.innerWidth;\r\n            const viewportHeight = window.innerHeight;\r\n            \r\n            // Get the button's parent container (controls-left or controls-right)\r\n            const parentContainer = button.parentElement;\r\n            if (!parentContainer) return;\r\n            \r\n            const parentRect = parentContainer.getBoundingClientRect();\r\n            \r\n            // Calculate position relative to parent container\r\n            const buttonCenterX = buttonRect.left + buttonRect.width / 2 - parentRect.left;\r\n            const buttonBottom = buttonRect.bottom - parentRect.top;\r\n            const buttonTop = buttonRect.top - parentRect.top;\r\n            \r\n            const spaceAbove = buttonRect.top;\r\n            const spaceBelow = viewportHeight - buttonRect.bottom;\r\n            \r\n            // Position menu above button by default\r\n            let menuTop = buttonTop - menuRect.height - 8;\r\n            let menuBottom = null;\r\n            \r\n            // Prefer above, but switch to below if not enough space\r\n            if (spaceAbove < menuRect.height + 20 && spaceBelow > spaceAbove) {\r\n                menuTop = null;\r\n                // Calculate bottom position relative to parent container\r\n                // bottom: X means X pixels from the bottom of the positioned parent\r\n                // We want the menu to be 8px below the button\r\n                const parentHeight = parentRect.bottom - parentRect.top;\r\n                menuBottom = parentHeight - buttonBottom + 8;\r\n                menu.classList.add('vidply-menu-below');\r\n            } else {\r\n                menu.classList.remove('vidply-menu-below');\r\n            }\r\n            \r\n            // Calculate horizontal position\r\n            let menuLeft = 'auto';\r\n            let menuRight = 'auto';\r\n            let transformX = 'translateX(0)';\r\n            \r\n            // For overflow menu, always align to the right edge\r\n            if (isOverflowMenu) {\r\n                menuLeft = 'auto';\r\n                menuRight = 0;\r\n                transformX = 'translateX(0)';\r\n            } else {\r\n                // For other menus, center on button by default\r\n                menuLeft = buttonCenterX - menuRect.width / 2;\r\n                \r\n                // Check horizontal overflow\r\n                const menuLeftAbsolute = buttonRect.left + buttonRect.width / 2 - menuRect.width / 2;\r\n                if (menuLeftAbsolute < 10) {\r\n                    // Too far left, align to left edge of parent\r\n                    menuLeft = 0;\r\n                    transformX = 'translateX(0)';\r\n                } else if (menuLeftAbsolute + menuRect.width > viewportWidth - 10) {\r\n                    // Too far right, align to right edge of parent\r\n                    menuLeft = 'auto';\r\n                    menuRight = 0;\r\n                    transformX = 'translateX(0)';\r\n                } else {\r\n                    // Center on button\r\n                    menuLeft = buttonCenterX;\r\n                    transformX = 'translateX(-50%)';\r\n                }\r\n            }\r\n            \r\n            // Apply calculated positions\r\n            if (menuTop !== null) {\r\n                menu.style.top = `${menuTop}px`;\r\n                menu.style.bottom = 'auto';\r\n            } else if (menuBottom !== null) {\r\n                menu.style.top = 'auto';\r\n                menu.style.bottom = `${menuBottom}px`;\r\n            }\r\n            \r\n            if (menuLeft !== 'auto') {\r\n                menu.style.left = `${menuLeft}px`;\r\n                menu.style.right = 'auto';\r\n            } else {\r\n                menu.style.left = 'auto';\r\n                menu.style.right = `${menuRight}px`;\r\n            }\r\n            \r\n            menu.style.transform = transformX;\r\n        };\r\n        \r\n        if (immediate) {\r\n            // Position immediately (synchronously) - used when menu is first shown\r\n            doPositioning();\r\n        } else {\r\n            // Use requestAnimationFrame to ensure layout is stable before positioning\r\n            requestAnimationFrame(() => {\r\n                setTimeout(doPositioning, 10); // Small delay to ensure layout is stable\r\n            });\r\n        }\r\n    }\r\n\r\n    // Helper method to insert menu into DOM (handles fullscreen vs normal mode)\r\n    insertMenuIntoDOM(menu, button) {\r\n        // Ensure menu has an ID for aria-controls relationship\r\n        if (!menu.id) {\r\n            menu.id = `vidply-menu-${Math.random().toString(36).substr(2, 9)}`;\r\n        }\r\n        \r\n        // Set ARIA attributes for screen reader users (WCAG 4.1.2)\r\n        button.setAttribute('aria-controls', menu.id);\r\n        button.setAttribute('aria-haspopup', 'true');\r\n        \r\n        // In fullscreen, append menu to player container to escape video-wrapper stacking context\r\n        // This allows menus to appear above the playlist panel\r\n        // Otherwise, keep it after the button for WCAG compliance\r\n        const isFullscreen = this.player.state.fullscreen;\r\n        if (isFullscreen) {\r\n            // Append to player container as sibling to playlist panel\r\n            this.player.container.appendChild(menu);\r\n            // Store reference to button for positioning\r\n            menu.dataset.triggerButton = button.getAttribute('aria-label') || 'button';\r\n        } else {\r\n            // Insert menu right after the button in the DOM for keyboard navigation\r\n            button.insertAdjacentElement('afterend', menu);\r\n        }\r\n    }\r\n\r\n    // Helper method to attach close-on-outside-click behavior to menus\r\n    attachMenuCloseHandler(menu, button, preventCloseOnInteraction = false) {\r\n        // Close any previously open menu and clean up its handlers\r\n        if (this.openMenu && this.openMenu !== menu && this.openMenuButton) {\r\n            // Remove previous button's blur handler if it exists\r\n            if (this.openMenuButton._vidplyBlurHandler) {\r\n                this.openMenuButton.removeEventListener('blur', this.openMenuButton._vidplyBlurHandler);\r\n                delete this.openMenuButton._vidplyBlurHandler;\r\n            }\r\n            if (this.openMenuButton._vidplyMousedownHandler) {\r\n                this.openMenuButton.removeEventListener('mousedown', this.openMenuButton._vidplyMousedownHandler);\r\n                delete this.openMenuButton._vidplyMousedownHandler;\r\n            }\r\n            \r\n            // Close previous menu without returning focus\r\n            if (this.openMenu && document.contains(this.openMenu)) {\r\n                this.openMenu.remove();\r\n            } else if (this.openMenu && this.openMenu.parentNode) {\r\n                this.openMenu.parentNode.removeChild(this.openMenu);\r\n            }\r\n            if (this.openMenuButton) {\r\n                this.openMenuButton.setAttribute('aria-expanded', 'false');\r\n            }\r\n        }\r\n        \r\n        // Track this menu as open\r\n        this.openMenu = menu;\r\n        this.openMenuButton = button;\r\n        \r\n        // Position menu smartly\r\n        this.positionMenu(menu, button);\r\n        \r\n        // Set aria-expanded to true when menu opens\r\n        if (button) {\r\n            button.setAttribute('aria-expanded', 'true');\r\n        }\r\n        \r\n        // Add focus handler to button to close menu when focus leaves to another control bar button\r\n        // But only if it's a keyboard navigation (Tab), not a click\r\n        let isClickingButton = false;\r\n        let blurHandlerActive = true;\r\n        \r\n        const handleButtonMousedown = () => {\r\n            isClickingButton = true;\r\n            // Temporarily disable blur handler when clicking\r\n            blurHandlerActive = false;\r\n            setTimeout(() => {\r\n                isClickingButton = false;\r\n                blurHandlerActive = true;\r\n            }, 200);\r\n        };\r\n        button.addEventListener('mousedown', handleButtonMousedown);\r\n        button._vidplyMousedownHandler = handleButtonMousedown; // Store for cleanup\r\n        \r\n        const handleButtonBlur = (e) => {\r\n            // If blur handler is disabled (during click) or this is a click, don't close the menu\r\n            if (!blurHandlerActive || isClickingButton) {\r\n                return;\r\n            }\r\n            \r\n            // Check if this menu is still the open menu (might have been replaced)\r\n            if (this.openMenu !== menu) {\r\n                return;\r\n            }\r\n            \r\n            // Store the related target (where focus is going) before async operations\r\n            const relatedTarget = e.relatedTarget;\r\n            \r\n            // Use requestAnimationFrame to check where focus went after browser handles focus\r\n            requestAnimationFrame(() => {\r\n                setTimeout(() => {\r\n                    // Check again if blur handler is still active and menu is still open\r\n                    if (!blurHandlerActive || this.openMenu !== menu) {\r\n                        return;\r\n                    }\r\n                    \r\n                    const activeElement = document.activeElement;\r\n                    \r\n                    // Don't close if focus is still within the menu\r\n                    if (menu.contains(activeElement)) {\r\n                        return;\r\n                    }\r\n                    \r\n                    // Don't close if focus moved to sign language or transcript windows\r\n                    const signLanguageWrapper = this.player.signLanguageWrapper;\r\n                    const transcriptWindow = this.player.transcriptManager?.transcriptWindow;\r\n                    if ((signLanguageWrapper && signLanguageWrapper.contains(activeElement)) ||\r\n                        (transcriptWindow && transcriptWindow.contains(activeElement))) {\r\n                        return;\r\n                    }\r\n                    \r\n                    // If focus moved to another button in the control bar, close the menu\r\n                    const controlBarButtons = this.element.querySelectorAll('button');\r\n                    const isFocusOnAnotherButton = Array.from(controlBarButtons).includes(activeElement) && activeElement !== button;\r\n                    \r\n                    // Also check relatedTarget in case activeElement hasn't updated yet\r\n                    const isRelatedTargetAnotherButton = relatedTarget && Array.from(controlBarButtons).includes(relatedTarget) && relatedTarget !== button;\r\n                    \r\n                    // Close menu if focus moved to another control bar button (without returning focus)\r\n                    if (isFocusOnAnotherButton || isRelatedTargetAnotherButton) {\r\n                        // Double-check this menu is still the open menu\r\n                        if (this.openMenu !== menu) {\r\n                            return;\r\n                        }\r\n                        \r\n                        // Just remove the menu, don't touch focus at all\r\n                        if (menu && document.contains(menu)) {\r\n                            menu.remove();\r\n                        } else if (menu && menu.parentNode) {\r\n                            menu.parentNode.removeChild(menu);\r\n                        }\r\n                        if (button) {\r\n                            button.setAttribute('aria-expanded', 'false');\r\n                        }\r\n                        // Clear tracking\r\n                        if (this.openMenu === menu) {\r\n                            this.openMenu = null;\r\n                            this.openMenuButton = null;\r\n                        }\r\n                        button.removeEventListener('blur', handleButtonBlur);\r\n                        button.removeEventListener('mousedown', handleButtonMousedown);\r\n                        delete button._vidplyBlurHandler;\r\n                        delete button._vidplyMousedownHandler;\r\n                    }\r\n                }, 10); // Small delay to ensure focus has fully moved\r\n            });\r\n        };\r\n        button.addEventListener('blur', handleButtonBlur);\r\n        button._vidplyBlurHandler = handleButtonBlur; // Store for cleanup\r\n        \r\n        const closeMenuAndUpdateAria = () => {\r\n            this.closeMenuAndReturnFocus(menu, button);\r\n        };\r\n        \r\n        // Store document handlers for cleanup\r\n        let documentClickHandler = null;\r\n        let documentEscapeHandler = null;\r\n        \r\n        setTimeout(() => {\r\n            documentClickHandler = (e) => {\r\n                // If this menu has form controls, don't close when clicking inside\r\n                if (preventCloseOnInteraction && menu.contains(e.target)) {\r\n                    return;\r\n                }\r\n\r\n                // Check if click is outside menu and button\r\n                // Also check if this menu is still the open menu\r\n                if (this.openMenu === menu && !menu.contains(e.target) && !button.contains(e.target)) {\r\n                    closeMenuAndUpdateAria();\r\n                    if (documentClickHandler) {\r\n                        document.removeEventListener('click', documentClickHandler);\r\n                    }\r\n                    if (documentEscapeHandler) {\r\n                        document.removeEventListener('keydown', documentEscapeHandler);\r\n                    }\r\n                }\r\n            };\r\n\r\n            documentEscapeHandler = (e) => {\r\n                if (e.key === 'Escape' && this.openMenu === menu) {\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    // Close menu and return focus to the button that opened it\r\n                    this.closeMenuAndReturnFocus(menu, button, true);\r\n                    if (documentClickHandler) {\r\n                        document.removeEventListener('click', documentClickHandler);\r\n                    }\r\n                    if (documentEscapeHandler) {\r\n                        document.removeEventListener('keydown', documentEscapeHandler);\r\n                    }\r\n                }\r\n            };\r\n\r\n            document.addEventListener('click', documentClickHandler);\r\n            document.addEventListener('keydown', documentEscapeHandler);\r\n        }, 100);\r\n    }\r\n\r\n    // Helper method to close menu and return focus to button\r\n    closeMenuAndReturnFocus(menu, button, returnFocus = true) {\r\n        if (menu) {\r\n            // Remove menu from DOM - use remove() which works reliably\r\n            if (document.contains(menu)) {\r\n                menu.remove();\r\n            } else if (menu.parentNode) {\r\n                // Fallback if menu is not in document but has parent\r\n                menu.parentNode.removeChild(menu);\r\n            }\r\n        }\r\n        if (button) {\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clean up aria-controls since menu is removed (optional, but cleaner)\r\n            // Note: Keeping it doesn't cause issues, but removing it is semantically correct\r\n            // when the referenced element no longer exists\r\n            if (menu && menu.id) {\r\n                button.removeAttribute('aria-controls');\r\n            }\r\n            // Only return focus if explicitly requested (not when tabbing away)\r\n            if (returnFocus) {\r\n                // Use requestAnimationFrame to ensure DOM updates are complete before focusing\r\n                // This prevents focus from jumping to next/previous button\r\n                requestAnimationFrame(() => {\r\n                    setTimeout(() => {\r\n                        if (button && document.contains(button)) {\r\n                            button.focus({ preventScroll: true });\r\n                        }\r\n                    }, 0);\r\n                });\r\n            }\r\n        }\r\n        // Clear tracking\r\n        if (this.openMenu === menu) {\r\n            this.openMenu = null;\r\n            this.openMenuButton = null;\r\n        }\r\n    }\r\n    \r\n    // Close any open menu when tabbing to another button or clicking another button\r\n    closeOpenMenu() {\r\n        if (this.openMenu && this.openMenuButton) {\r\n            // Close without returning focus (user is tabbing to next element or clicking another button)\r\n            if (this.openMenu && document.contains(this.openMenu)) {\r\n                this.openMenu.remove();\r\n            } else if (this.openMenu && this.openMenu.parentNode) {\r\n                this.openMenu.parentNode.removeChild(this.openMenu);\r\n            }\r\n            if (this.openMenuButton) {\r\n                this.openMenuButton.setAttribute('aria-expanded', 'false');\r\n            }\r\n            // Clear tracking\r\n            this.openMenu = null;\r\n            this.openMenuButton = null;\r\n        }\r\n    }\r\n\r\n    // Helper method to add keyboard navigation to menus (arrow keys)\r\n    attachMenuKeyboardNavigation(menu, button) {\r\n        const menuItems = Array.from(menu.querySelectorAll(`.${this.player.options.classPrefix}-menu-item`));\r\n        \r\n        if (menuItems.length === 0) return;\r\n\r\n        const handleKeyDown = (e) => {\r\n            const currentIndex = menuItems.indexOf(document.activeElement);\r\n            \r\n            switch (e.key) {\r\n                case 'ArrowDown':\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); // Prevent volume/seek actions\r\n                    const nextIndex = (currentIndex + 1) % menuItems.length;\r\n                    menuItems[nextIndex].focus({ preventScroll: false });\r\n                    menuItems[nextIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                    break;\r\n                \r\n                case 'ArrowUp':\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); // Prevent volume/seek actions\r\n                    const prevIndex = (currentIndex - 1 + menuItems.length) % menuItems.length;\r\n                    menuItems[prevIndex].focus({ preventScroll: false });\r\n                    menuItems[prevIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                    break;\r\n                \r\n                case 'ArrowLeft':\r\n                case 'ArrowRight':\r\n                    // Prevent seeking when in menu (but allow menu to handle if needed)\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    break;\r\n                \r\n                case 'Home':\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    menuItems[0].focus({ preventScroll: false });\r\n                    menuItems[0].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                    break;\r\n                \r\n                case 'End':\r\n                    e.preventDefault();\r\n                    e.stopPropagation();\r\n                    menuItems[menuItems.length - 1].focus({ preventScroll: false });\r\n                    menuItems[menuItems.length - 1].scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n                    break;\r\n                \r\n                case 'Enter':\r\n                case ' ':\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); // Prevent event from reaching KeyboardManager\r\n                    if (document.activeElement && menuItems.includes(document.activeElement)) {\r\n                        document.activeElement.click();\r\n                        // Menu will be closed by the click handler, but ensure focus returns\r\n                        focusElement(button, { delay: 0 });\r\n                    }\r\n                    break;\r\n                \r\n                case 'Escape':\r\n                    e.preventDefault();\r\n                    e.stopPropagation(); // Prevent event from reaching KeyboardManager\r\n                    // Close menu and return focus to the button that opened it\r\n                    this.closeMenuAndReturnFocus(menu, button, true);\r\n                    break;\r\n            }\r\n        };\r\n\r\n        menu.addEventListener('keydown', handleKeyDown);\r\n    }\r\n\r\n    createElement() {\r\n        this.element = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-controls`,\r\n            attributes: {\r\n                'role': 'region',\r\n                'aria-label': i18n.t('player.label') + ' controls'\r\n            }\r\n        });\r\n    }\r\n\r\n    createControls() {\r\n        // Progress bar and time display wrapper\r\n        const progressTimeWrapper = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-time-wrapper`\r\n        });\r\n\r\n        // Progress bar container\r\n        if (this.player.options.progressBar) {\r\n            this.createProgressBar();\r\n            progressTimeWrapper.appendChild(this.controls.progress);\r\n        }\r\n\r\n        // Time display (right beside progress bar)\r\n        if (this.player.options.currentTime || this.player.options.duration) {\r\n            progressTimeWrapper.appendChild(this.createTimeDisplay());\r\n        }\r\n\r\n        this.element.appendChild(progressTimeWrapper);\r\n\r\n        // Button container\r\n        const buttonContainer = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-controls-buttons`\r\n        });\r\n\r\n        // Left buttons\r\n        const leftButtons = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-controls-left`\r\n        });\r\n\r\n        // Previous track button (if playlist)\r\n        if (this.player.playlistManager) {\r\n            leftButtons.appendChild(this.createPreviousButton());\r\n        }\r\n\r\n        // Play/Pause button\r\n        if (this.player.options.playPauseButton) {\r\n            leftButtons.appendChild(this.createPlayPauseButton());\r\n        }\r\n\r\n        // Restart button (right beside play button)\r\n        leftButtons.appendChild(this.createRestartButton());\r\n\r\n        // Next track button (if playlist)\r\n        if (this.player.playlistManager) {\r\n            leftButtons.appendChild(this.createNextButton());\r\n        }\r\n\r\n        // Rewind button (not shown in playlist mode)\r\n        if (!this.player.playlistManager) {\r\n            leftButtons.appendChild(this.createRewindButton());\r\n        }\r\n\r\n        // Forward button (not shown in playlist mode)\r\n        if (!this.player.playlistManager) {\r\n            leftButtons.appendChild(this.createForwardButton());\r\n        }\r\n\r\n        // Volume control\r\n        if (this.player.options.volumeControl) {\r\n            // On touch devices: simple mute button (hardware buttons control volume)\r\n            // On desktop: full volume control with slider\r\n            if (this.isTouchDevice()) {\r\n                leftButtons.appendChild(this.createMuteButton());\r\n            } else {\r\n                leftButtons.appendChild(this.createVolumeControl());\r\n            }\r\n        }\r\n\r\n        // Right buttons\r\n        this.rightButtons = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-controls-right`\r\n        });\r\n\r\n        // Check for available features\r\n        const hasChapters = this.hasChapterTracks();\r\n        const hasCaptions = this.hasCaptionTracks();\r\n        const hasQualityLevels = this.hasQualityLevels();\r\n        const hasAudioDescription = this.hasAudioDescription();\r\n\r\n        // Priority order (lower number = higher priority, stays visible longer)\r\n        // Desktop (>768px):\r\n        //   Priority 1: Play, Volume, Captions, Speed, Fullscreen\r\n        //   Priority 2: Audio Description, Quality  \r\n        //   Priority 3: Chapters, Caption Style, Transcript, Sign Language, PiP\r\n        // Smaller screens (<768px):\r\n        //   Priority 1: Play, Volume, Progress (only left controls visible)\r\n        //   Priority 3: ALL right-side buttons go to overflow menu\r\n\r\n        // 1. Chapters button\r\n        if (this.player.options.chaptersButton && hasChapters) {\r\n            const btn = this.createChaptersButton();\r\n            btn.dataset.overflowPriority = '3';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 2. Captions button\r\n        if (this.player.options.captionsButton && hasCaptions) {\r\n            const btn = this.createCaptionsButton();\r\n            btn.dataset.overflowPriority = '1';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 3. Caption styling button\r\n        if (this.player.options.captionStyleButton && hasCaptions) {\r\n            const btn = this.createCaptionStyleButton();\r\n            btn.dataset.overflowPriority = '3';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 4. Playback speed button\r\n        // IMPORTANT: Don't rely on renderer.constructor.name here.\r\n        // In production builds, class names are minified (e.g. \"class s\"), which would break the check.\r\n        // Instead, detect HLS by the current source URL.\r\n        const src = this.player.currentSource\r\n            || this.player.element?.getAttribute?.('src')\r\n            || this.player.element?.currentSrc\r\n            || this.player.element?.src\r\n            || this.player.element?.querySelector?.('source')?.getAttribute?.('src')\r\n            || this.player.element?.querySelector?.('source')?.src\r\n            || '';\r\n        const isHlsSource = typeof src === 'string' && src.includes('.m3u8');\r\n        const isVideoElement = this.player.element?.tagName?.toLowerCase() === 'video';\r\n        const hideSpeedForThisPlayer =\r\n            (!!this.player.options.hideSpeedForHls && isHlsSource)\r\n            || (!!this.player.options.hideSpeedForHlsVideo && isHlsSource && isVideoElement);\r\n        if (this.player.options.speedButton && !hideSpeedForThisPlayer) {\r\n            const btn = this.createSpeedButton();\r\n            btn.dataset.overflowPriority = '1';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 5. Audio Description button\r\n        if (this.player.options.audioDescriptionButton && hasAudioDescription) {\r\n            const btn = this.createAudioDescriptionButton();\r\n            btn.dataset.overflowPriority = '2';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 6. Transcript button\r\n        if (this.player.options.transcriptButton && hasCaptions) {\r\n            const btn = this.createTranscriptButton();\r\n            btn.dataset.overflowPriority = '3';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 6.5 Playlist toggle button (for playlists)\r\n        if (this.player.playlistManager && this.player.options.playlistToggleButton !== false) {\r\n            const btn = this.createPlaylistToggleButton();\r\n            btn.dataset.overflowPriority = '2';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 7. Sign Language buttons (PiP overlay and/or main view src swap)\r\n        const hasSignLanguage = this.hasSignLanguage();\r\n        const showSignLanguageButtons = this.player.options.signLanguageButton !== false && hasSignLanguage;\r\n        const signLanguageDisplayMode = this.player.options.signLanguageDisplayMode || 'both';\r\n        if (showSignLanguageButtons) {\r\n            // PiP overlay button (show if mode is 'pip' or 'both')\r\n            if (['pip', 'both'].includes(signLanguageDisplayMode)) {\r\n                const pipBtn = this.createSignLanguageButton();\r\n                pipBtn.dataset.overflowPriority = '3';\r\n                pipBtn.dataset.overflowPriorityMobile = '3';\r\n                this.rightButtons.appendChild(pipBtn);\r\n            }\r\n            \r\n            // Main view button (show if mode is 'main' or 'both')\r\n            if (['main', 'both'].includes(signLanguageDisplayMode)) {\r\n                const mainViewBtn = this.createSignLanguageInMainViewButton();\r\n                mainViewBtn.dataset.overflowPriority = '3';\r\n                mainViewBtn.dataset.overflowPriorityMobile = '3';\r\n                this.rightButtons.appendChild(mainViewBtn);\r\n            }\r\n        }\r\n\r\n        // Quality button (before fullscreen)\r\n        if (this.player.options.qualityButton && hasQualityLevels) {\r\n            const btn = this.createQualityButton();\r\n            btn.dataset.overflowPriority = '2';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // PiP button (before fullscreen)\r\n        if (this.player.options.pipButton && 'pictureInPictureEnabled' in document) {\r\n            const btn = this.createPipButton();\r\n            btn.dataset.overflowPriority = '3';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // 8. Fullscreen button (last)\r\n        // Don't show fullscreen button for audio players\r\n        const isAudioPlayer = this.player.element.tagName.toLowerCase() === 'audio';\r\n        if (this.player.options.fullscreenButton && !isAudioPlayer) {\r\n            const btn = this.createFullscreenButton();\r\n            btn.dataset.overflowPriority = '1';\r\n            btn.dataset.overflowPriorityMobile = '3';\r\n            this.rightButtons.appendChild(btn);\r\n        }\r\n\r\n        // Create overflow menu button (initially hidden)\r\n        this.overflowMenuButton = this.createOverflowMenuButton();\r\n        this.overflowMenuButton.style.display = 'none';\r\n        this.rightButtons.appendChild(this.overflowMenuButton);\r\n\r\n        buttonContainer.appendChild(leftButtons);\r\n        buttonContainer.appendChild(this.rightButtons);\r\n        this.element.appendChild(buttonContainer);\r\n        \r\n        // Ensure all buttons have title attributes\r\n        this.ensureButtonTooltips(buttonContainer);\r\n    }\r\n    \r\n    /**\r\n     * Ensure all buttons in the controls have title attributes\r\n     * Uses aria-label as title if title is not present\r\n     */\r\n    ensureButtonTooltips(container) {\r\n        const buttons = container.querySelectorAll('button');\r\n        buttons.forEach(button => {\r\n            // Skip if tooltip already exists\r\n            if (button.querySelector(`.${this.player.options.classPrefix}-tooltip`)) {\r\n                return;\r\n            }\r\n            \r\n            // Skip if button text already exists\r\n            if (button.querySelector(`.${this.player.options.classPrefix}-button-text`)) {\r\n                return;\r\n            }\r\n            \r\n            // Skip menu items - they already have visible text\r\n            if (button.getAttribute('role') === 'menuitem' || \r\n                button.classList.contains(`${this.player.options.classPrefix}-settings-item`) ||\r\n                button.classList.contains(`${this.player.options.classPrefix}-menu-item`) ||\r\n                button.classList.contains(`${this.player.options.classPrefix}-transcript-settings-item`) ||\r\n                button.classList.contains(`${this.player.options.classPrefix}-sign-language-settings-item`) ||\r\n                button.classList.contains(`${this.player.options.classPrefix}-popup-settings-item`)) {\r\n                return;\r\n            }\r\n            \r\n            const ariaLabel = button.getAttribute('aria-label');\r\n            if (ariaLabel) {\r\n                // Add tooltip (aria-hidden popover)\r\n                DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n            }\r\n        });\r\n    }\r\n\r\n    // Helper methods to check for available features\r\n    hasChapterTracks() {\r\n        // 1) Prefer already-loaded TextTracks (fast + accurate)\r\n        const textTracks = this.player.element.textTracks;\r\n        for (let i = 0; i < textTracks.length; i++) {\r\n            if (textTracks[i].kind === 'chapters') return true;\r\n            }\r\n\r\n        // 2) Fallback to DOM <track> elements (works before tracks are fully loaded)\r\n        const trackEls = Array.from(this.player.element.querySelectorAll('track[kind=\"chapters\"]'));\r\n        if (trackEls.length > 0) return true;\r\n\r\n        // 3) Playlist metadata fallback (works even when we intentionally defer loading)\r\n        const current = this.player.playlistManager?.getCurrentTrack?.();\r\n        if (current?.tracks && Array.isArray(current.tracks)) {\r\n            return current.tracks.some(t => t?.kind === 'chapters');\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    hasCaptionTracks() {\r\n        // 1) Prefer already-loaded TextTracks\r\n        const textTracks = this.player.element.textTracks;\r\n        for (let i = 0; i < textTracks.length; i++) {\r\n            if (textTracks[i].kind === 'captions' || textTracks[i].kind === 'subtitles') return true;\r\n        }\r\n\r\n        // 2) Fallback to DOM <track> elements\r\n        const trackEls = Array.from(this.player.element.querySelectorAll('track'));\r\n        if (trackEls.some(el => (el.getAttribute('kind') === 'captions' || el.getAttribute('kind') === 'subtitles'))) {\r\n                return true;\r\n            }\r\n\r\n        // 3) Playlist metadata fallback\r\n        const current = this.player.playlistManager?.getCurrentTrack?.();\r\n        if (current?.tracks && Array.isArray(current.tracks)) {\r\n            return current.tracks.some(t => t?.kind === 'captions' || t?.kind === 'subtitles');\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    hasQualityLevels() {\r\n        // Check if renderer supports quality selection\r\n        if (this.player.renderer && this.player.renderer.getQualities) {\r\n            const qualities = this.player.renderer.getQualities();\r\n            return qualities && qualities.length > 1;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    hasAudioDescription() {\r\n        // Check for audio-described video source OR description tracks\r\n        if (this.player.audioDescriptionSrc && this.player.audioDescriptionSrc.length > 0) {\r\n            return true;\r\n        }\r\n        \r\n        // Check for description tracks\r\n        const textTracks = Array.from(this.player.element.textTracks || []);\r\n        return textTracks.some(track => track.kind === 'descriptions');\r\n    }\r\n\r\n    hasSignLanguage() {\r\n        // Check for single source or multiple sources\r\n        const hasSingleSource = this.player.signLanguageSrc && this.player.signLanguageSrc.length > 0;\r\n        const hasMultipleSources = this.player.signLanguageSources && Object.keys(this.player.signLanguageSources).length > 0;\r\n        return hasSingleSource || hasMultipleSources;\r\n    }\r\n\r\n    createProgressBar() {\r\n        const progressContainer = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-container`,\r\n            attributes: {\r\n                'role': 'slider',\r\n                'aria-label': i18n.t('player.progress'),\r\n                'aria-valuemin': '0',\r\n                'aria-valuemax': '100',\r\n                'aria-valuenow': '0',\r\n                'tabindex': '0'\r\n            }\r\n        });\r\n\r\n        // Buffered progress\r\n        this.controls.buffered = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-buffered`\r\n        });\r\n\r\n        // Played progress\r\n        this.controls.played = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-played`\r\n        });\r\n\r\n        // Progress handle\r\n        this.controls.progressHandle = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-handle`\r\n        });\r\n\r\n        // Tooltip\r\n        this.controls.progressTooltip = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-tooltip`\r\n        });\r\n\r\n        // Preview thumbnail (for video only)\r\n        this.controls.progressPreview = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-preview`,\r\n            attributes: {\r\n                'aria-hidden': 'true'\r\n            }\r\n        });\r\n        this.controls.progressTooltip.appendChild(this.controls.progressPreview);\r\n\r\n        // Time text\r\n        this.controls.progressTooltipTime = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-progress-tooltip-time`\r\n        });\r\n        this.controls.progressTooltip.appendChild(this.controls.progressTooltipTime);\r\n\r\n        progressContainer.appendChild(this.controls.buffered);\r\n        progressContainer.appendChild(this.controls.played);\r\n        this.controls.played.appendChild(this.controls.progressHandle);\r\n        progressContainer.appendChild(this.controls.progressTooltip);\r\n\r\n        this.controls.progress = progressContainer;\r\n\r\n        // Initialize preview functionality\r\n        this.initPreviewThumbnail();\r\n\r\n        // Progress bar events\r\n        this.setupProgressBarEvents();\r\n    }\r\n\r\n    /**\r\n     * Initialize preview thumbnail functionality for HTML5 video\r\n     */\r\n    initPreviewThumbnail() {\r\n        this.previewThumbnailCache = new Map();\r\n        this.previewVideo = null;\r\n        this.currentPreviewTime = null;\r\n        this.previewThumbnailTimeout = null;\r\n        this.previewSupported = false;\r\n        this.previewVideoReady = false;\r\n        this.previewVideoInitialized = false;\r\n\r\n        // Check if preview is supported (HTML5 video only)\r\n        // Check if element is a video\r\n        const isVideo = this.player.element && this.player.element.tagName === 'VIDEO';\r\n        \r\n        if (!isVideo) {\r\n            return;\r\n        }\r\n\r\n        // IMPORTANT: do NOT create/load the preview video until the user has started playback at least once.\r\n        // Otherwise we'd trigger heavy MP4 network traffic just by hovering the progress bar.\r\n    }\r\n\r\n    /**\r\n     * Lazily create the hidden preview video (only after playback started once)\r\n     */\r\n    ensurePreviewVideoInitialized() {\r\n        if (this.previewVideoInitialized) return;\r\n        if (!this.player?.state?.hasStartedPlayback) return;\r\n\r\n        const renderer = this.player.renderer;\r\n        const hasVideoMedia = renderer && renderer.media && renderer.media.tagName === 'VIDEO';\r\n        const isHTML5Renderer = hasVideoMedia &&\r\n            renderer.media === this.player.element &&\r\n            !renderer.hls &&\r\n            typeof renderer.seek === 'function';\r\n\r\n        this.previewSupported = isHTML5Renderer && hasVideoMedia;\r\n        if (!this.previewSupported) return;\r\n\r\n        const mainVideo = renderer.media || this.player.element;\r\n        let videoSrc = null;\r\n        if (mainVideo.src) {\r\n            videoSrc = mainVideo.src;\r\n        } else {\r\n            const source = mainVideo.querySelector('source');\r\n            if (source) {\r\n                videoSrc = source.src;\r\n            }\r\n        }\r\n\r\n        if (!videoSrc) {\r\n            this.player.log('No video source found for preview', 'warn');\r\n            this.previewSupported = false;\r\n            return;\r\n        }\r\n\r\n        // Create a hidden video element for capturing frames\r\n        this.previewVideo = document.createElement('video');\r\n        this.previewVideo.muted = true;\r\n        this.previewVideo.preload = 'auto'; // Need more than metadata to capture frames\r\n        this.previewVideo.playsInline = true;\r\n        this.previewVideo.style.position = 'absolute';\r\n        this.previewVideo.style.visibility = 'hidden';\r\n        this.previewVideo.style.width = '1px';\r\n        this.previewVideo.style.height = '1px';\r\n        this.previewVideo.style.top = '-9999px';\r\n\r\n        if (mainVideo.crossOrigin) {\r\n            this.previewVideo.crossOrigin = mainVideo.crossOrigin;\r\n        }\r\n\r\n        this.previewVideo.addEventListener('error', (e) => {\r\n            this.player.log('Preview video failed to load:', e, 'warn');\r\n            this.previewSupported = false;\r\n        });\r\n\r\n        this.previewVideo.addEventListener('loadedmetadata', () => {\r\n            this.previewVideoReady = true;\r\n        }, { once: true });\r\n\r\n        if (this.player.container) {\r\n            this.player.container.appendChild(this.previewVideo);\r\n        }\r\n\r\n        this.previewVideo.src = videoSrc;\r\n        this.previewVideoReady = false;\r\n        this.previewVideoInitialized = true;\r\n    }\r\n\r\n    /**\r\n     * Generate preview thumbnail for a specific time\r\n     * @param {number} time - Time in seconds\r\n     * @returns {Promise<string>} Data URL of the thumbnail\r\n     */\r\n    async generatePreviewThumbnail(time) {\r\n        if (!this.previewSupported || !this.previewVideo) {\r\n            return null;\r\n        }\r\n\r\n        // Wait for preview video to be ready if not yet loaded\r\n        if (!this.previewVideoReady) {\r\n            if (this.previewVideo.readyState < 2) {\r\n                // Wait for at least HAVE_CURRENT_DATA (2) to ensure we can capture frames\r\n                await new Promise((resolve, reject) => {\r\n                    const timeout = setTimeout(() => {\r\n                        reject(new Error('Preview video data load timeout'));\r\n                    }, 10000);\r\n                    \r\n                    const cleanup = () => {\r\n                        clearTimeout(timeout);\r\n                        this.previewVideo.removeEventListener('loadeddata', checkReady);\r\n                        this.previewVideo.removeEventListener('canplay', checkReady);\r\n                        this.previewVideo.removeEventListener('error', onError);\r\n                    };\r\n                    \r\n                    const checkReady = () => {\r\n                        if (this.previewVideo.readyState >= 2) {\r\n                            cleanup();\r\n                            this.previewVideoReady = true;\r\n                            resolve();\r\n                        }\r\n                    };\r\n                    \r\n                    const onError = () => {\r\n                        cleanup();\r\n                        reject(new Error('Preview video failed to load'));\r\n                    };\r\n                    \r\n                    // Try loadeddata first (faster), fallback to canplay\r\n                    if (this.previewVideo.readyState >= 1) {\r\n                        this.previewVideo.addEventListener('loadeddata', checkReady);\r\n                    }\r\n                    this.previewVideo.addEventListener('canplay', checkReady);\r\n                    this.previewVideo.addEventListener('error', onError);\r\n                    \r\n                    // If already ready, resolve immediately\r\n                    if (this.previewVideo.readyState >= 2) {\r\n                        checkReady();\r\n                    }\r\n                }).catch(() => {\r\n                    this.previewSupported = false;\r\n                    return null;\r\n                });\r\n            } else {\r\n                this.previewVideoReady = true;\r\n            }\r\n        }\r\n\r\n        // Check cache first\r\n        const cacheKey = Math.floor(time);\r\n        if (this.previewThumbnailCache.has(cacheKey)) {\r\n            return this.previewThumbnailCache.get(cacheKey);\r\n        }\r\n\r\n        // Use shared frame capture utility\r\n        // Don't restore state since preview video is always muted and hidden\r\n        const dataURL = await captureVideoFrame(this.previewVideo, time, {\r\n            restoreState: false,\r\n            quality: 0.8,\r\n            maxWidth: 160,\r\n            maxHeight: 90\r\n        });\r\n\r\n        if (dataURL) {\r\n            // Cache the thumbnail (limit cache size to 20 entries using LRU-like behavior)\r\n            if (this.previewThumbnailCache.size >= 20) {\r\n                // Delete oldest entry (first key in insertion order)\r\n                const firstKey = this.previewThumbnailCache.keys().next().value;\r\n                this.previewThumbnailCache.delete(firstKey);\r\n            }\r\n            this.previewThumbnailCache.set(cacheKey, dataURL);\r\n        }\r\n\r\n        return dataURL;\r\n    }\r\n\r\n    /**\r\n     * Update preview thumbnail display\r\n     * @param {number} time - Time in seconds\r\n     */\r\n    async updatePreviewThumbnail(time) {\r\n        if (!this.previewSupported || !this.controls.progressPreview) {\r\n            return;\r\n        }\r\n\r\n        // Clear any pending updates\r\n        if (this.previewThumbnailTimeout) {\r\n            clearTimeout(this.previewThumbnailTimeout);\r\n        }\r\n\r\n        // Debounce thumbnail generation to avoid excessive seeking\r\n        this.previewThumbnailTimeout = setTimeout(async () => {\r\n            try {\r\n                const thumbnail = await this.generatePreviewThumbnail(time);\r\n                if (thumbnail && this.controls.progressPreview) {\r\n                    // Set background image and make visible\r\n                    this.controls.progressPreview.style.backgroundImage = `url(\"${thumbnail}\")`;\r\n                    this.controls.progressPreview.style.display = 'block';\r\n                    this.controls.progressPreview.style.backgroundRepeat = 'no-repeat';\r\n                    this.controls.progressPreview.style.backgroundPosition = 'center';\r\n                } else {\r\n                    // Hide if thumbnail generation failed\r\n                    if (this.controls.progressPreview) {\r\n                        this.controls.progressPreview.style.display = 'none';\r\n                    }\r\n                }\r\n                this.currentPreviewTime = time;\r\n            } catch (error) {\r\n                this.player.log('Preview thumbnail update failed:', error, 'warn');\r\n                if (this.controls.progressPreview) {\r\n                    this.controls.progressPreview.style.display = 'none';\r\n                }\r\n            }\r\n        }, 100);\r\n    }\r\n\r\n    setupProgressBarEvents() {\r\n        const progress = this.controls.progress;\r\n\r\n        const updateProgress = (clientX) => {\r\n            const rect = progress.getBoundingClientRect();\r\n            // Guard against division by zero if progress bar has no width\r\n            const percent = rect.width > 0 ? Math.max(0, Math.min(1, (clientX - rect.left) / rect.width)) : 0;\r\n            const duration = this.player.state.duration || 0;\r\n            const time = percent * duration;\r\n            return {percent, time};\r\n        };\r\n\r\n        // Mouse events\r\n        progress.addEventListener('mousedown', (e) => {\r\n            this.isDraggingProgress = true;\r\n            const {time} = updateProgress(e.clientX);\r\n            this.player.seek(time);\r\n        });\r\n\r\n        document.addEventListener('mousemove', (e) => {\r\n            if (this.isDraggingProgress) {\r\n                const {time} = updateProgress(e.clientX);\r\n                this.player.seek(time);\r\n            }\r\n        });\r\n\r\n        document.addEventListener('mouseup', () => {\r\n            this.isDraggingProgress = false;\r\n        });\r\n\r\n        // Hover tooltip\r\n        progress.addEventListener('mousemove', (e) => {\r\n            if (!this.isDraggingProgress) {\r\n                const {time} = updateProgress(e.clientX);\r\n                const rect = progress.getBoundingClientRect();\r\n                const left = e.clientX - rect.left;\r\n                \r\n                // Update tooltip time text\r\n                this.controls.progressTooltipTime.textContent = TimeUtils.formatTime(time);\r\n                \r\n                // Update tooltip position\r\n                this.controls.progressTooltip.style.left = `${left}px`;\r\n                this.controls.progressTooltip.style.display = 'block';\r\n\r\n                // Only show preview thumbnails after the user has started playback at least once.\r\n                // Before that, show just the timestamp (no empty preview box).\r\n                if (!this.player?.state?.hasStartedPlayback) {\r\n                    if (this.controls.progressPreview) {\r\n                        this.controls.progressPreview.style.display = 'none';\r\n                    }\r\n                    return;\r\n                }\r\n\r\n                this.ensurePreviewVideoInitialized();\r\n                if (this.previewSupported) {\r\n                    this.updatePreviewThumbnail(time);\r\n                } else if (this.controls.progressPreview) {\r\n                    this.controls.progressPreview.style.display = 'none';\r\n                }\r\n            }\r\n        });\r\n\r\n        progress.addEventListener('mouseleave', () => {\r\n            this.controls.progressTooltip.style.display = 'none';\r\n            if (this.previewThumbnailTimeout) {\r\n                clearTimeout(this.previewThumbnailTimeout);\r\n            }\r\n        });\r\n\r\n        // Keyboard navigation\r\n        progress.addEventListener('keydown', (e) => {\r\n            if (e.key === 'ArrowLeft') {\r\n                e.preventDefault();\r\n                this.player.seekBackward(5);\r\n            } else if (e.key === 'ArrowRight') {\r\n                e.preventDefault();\r\n                this.player.seekForward(5);\r\n            }\r\n        });\r\n\r\n        // Touch events\r\n        progress.addEventListener('touchstart', (e) => {\r\n            this.isDraggingProgress = true;\r\n            const touch = e.touches[0];\r\n            const {time} = updateProgress(touch.clientX);\r\n            this.player.seek(time);\r\n        });\r\n\r\n        progress.addEventListener('touchmove', (e) => {\r\n            if (this.isDraggingProgress) {\r\n                e.preventDefault();\r\n                const touch = e.touches[0];\r\n                const {time} = updateProgress(touch.clientX);\r\n                this.player.seek(time);\r\n            }\r\n        });\r\n\r\n        progress.addEventListener('touchend', () => {\r\n            this.isDraggingProgress = false;\r\n        });\r\n    }\r\n\r\n    createPlayPauseButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-play-pause`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.play')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('play'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.toggle();\r\n        });\r\n\r\n        this.controls.playPause = button;\r\n        return button;\r\n    }\r\n\r\n    createRestartButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-restart`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.restart')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('restart'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.seek(0);\r\n            this.player.play();\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    createPreviousButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-previous`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.previous')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('skipPrevious'));\r\n\r\n        button.addEventListener('click', () => {\r\n            if (this.player.playlistManager) {\r\n                this.player.playlistManager.previous();\r\n            }\r\n        });\r\n\r\n        // Update button state\r\n        const updateState = () => {\r\n            if (this.player.playlistManager) {\r\n                button.disabled = !this.player.playlistManager.hasPrevious() && !this.player.playlistManager.options.loop;\r\n            }\r\n        };\r\n        this.player.on('playlisttrackchange', updateState);\r\n        updateState();\r\n\r\n        this.controls.previous = button;\r\n        return button;\r\n    }\r\n\r\n    createNextButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-next`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.next')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('skipNext'));\r\n\r\n        button.addEventListener('click', () => {\r\n            if (this.player.playlistManager) {\r\n                this.player.playlistManager.next();\r\n            }\r\n        });\r\n\r\n        // Update button state\r\n        const updateState = () => {\r\n            if (this.player.playlistManager) {\r\n                button.disabled = !this.player.playlistManager.hasNext() && !this.player.playlistManager.options.loop;\r\n            }\r\n        };\r\n        this.player.on('playlisttrackchange', updateState);\r\n        updateState();\r\n\r\n        this.controls.next = button;\r\n        return button;\r\n    }\r\n\r\n    createPlaylistToggleButton() {\r\n        // Get unique panel ID from playlist manager\r\n        const panelId = this.player.playlistManager ? `${this.player.playlistManager.uniqueId}-panel` : 'vidply-playlist-panel';\r\n        \r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-playlist-toggle`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.playlist'),\r\n                'aria-expanded': 'false',\r\n                'aria-pressed': 'false',\r\n                'aria-controls': panelId\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('playlist'));\r\n\r\n        button.addEventListener('click', () => {\r\n            if (this.player.playlistManager) {\r\n                this.player.playlistManager.togglePanel();\r\n            }\r\n        });\r\n\r\n        this.controls.playlistToggle = button;\r\n        return button;\r\n    }\r\n\r\n    createRewindButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-rewind`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.rewindSeconds', { seconds: 15 })\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('rewind'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.seekBackward(15);\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    createForwardButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-forward`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.forwardSeconds', { seconds: 15 })\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('forward'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.seekForward(15);\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    createMuteButton() {\r\n        // Simple mute/unmute button for touch devices\r\n        const muteButton = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-mute`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.mute')\r\n            }\r\n        });\r\n\r\n        muteButton.appendChild(createIconElement('volumeHigh'));\r\n\r\n        // Simply toggle mute on click/touch\r\n        muteButton.addEventListener('click', () => {\r\n            this.player.toggleMute();\r\n        });\r\n\r\n        this.controls.mute = muteButton;\r\n\r\n        return muteButton;\r\n    }\r\n\r\n    createVolumeControl() {\r\n        // Mute/Volume button with slider (desktop)\r\n        const muteButton = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-mute`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.volume'),\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        muteButton.appendChild(createIconElement('volumeHigh'));\r\n\r\n        // Toggle mute on right click, show volume slider on left click\r\n        muteButton.addEventListener('contextmenu', (e) => {\r\n            e.preventDefault();\r\n            this.player.toggleMute();\r\n        });\r\n\r\n        muteButton.addEventListener('click', () => {\r\n            this.showVolumeSlider(muteButton);\r\n        });\r\n\r\n        this.controls.mute = muteButton;\r\n\r\n        return muteButton;\r\n    }\r\n\r\n    showVolumeSlider(button) {\r\n        // Remove existing slider if any\r\n        const existingSlider = document.querySelector(`.${this.player.options.classPrefix}-volume-menu`);\r\n        if (existingSlider) {\r\n            existingSlider.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            return;\r\n        }\r\n\r\n        // Volume menu container\r\n        const volumeMenu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-volume-menu ${this.player.options.classPrefix}-menu`\r\n        });\r\n\r\n        const volumeSlider = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-volume-slider`,\r\n            attributes: {\r\n                'role': 'slider',\r\n                'aria-label': i18n.t('player.volume'),\r\n                'aria-valuemin': '0',\r\n                'aria-valuemax': '100',\r\n                'aria-valuenow': String(Math.round(this.player.state.volume * 100)),\r\n                'tabindex': '0'\r\n            }\r\n        });\r\n\r\n        const volumeTrack = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-volume-track`\r\n        });\r\n\r\n        const volumeFill = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-volume-fill`\r\n        });\r\n        \r\n        // Set initial fill height based on current volume\r\n        const initialVolumePercent = this.player.state.volume * 100;\r\n        volumeFill.style.height = `${initialVolumePercent}%`;\r\n\r\n        const volumeHandle = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-volume-handle`\r\n        });\r\n\r\n        volumeTrack.appendChild(volumeFill);\r\n        volumeFill.appendChild(volumeHandle);\r\n        volumeSlider.appendChild(volumeTrack);\r\n        volumeMenu.appendChild(volumeSlider);\r\n\r\n        // Volume slider events\r\n        const updateVolume = (clientY) => {\r\n            const rect = volumeTrack.getBoundingClientRect();\r\n            const percent = Math.max(0, Math.min(1, 1 - ((clientY - rect.top) / rect.height)));\r\n            this.player.setVolume(percent);\r\n        };\r\n\r\n        // Mouse events\r\n        volumeSlider.addEventListener('mousedown', (e) => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            this.isDraggingVolume = true;\r\n            updateVolume(e.clientY);\r\n        });\r\n\r\n        document.addEventListener('mousemove', (e) => {\r\n            if (this.isDraggingVolume) {\r\n                updateVolume(e.clientY);\r\n            }\r\n        });\r\n\r\n        document.addEventListener('mouseup', () => {\r\n            this.isDraggingVolume = false;\r\n        });\r\n\r\n        // Touch events for iOS and mobile devices\r\n        volumeSlider.addEventListener('touchstart', (e) => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            this.isDraggingVolume = true;\r\n            const touch = e.touches[0];\r\n            updateVolume(touch.clientY);\r\n        }, { passive: false });\r\n\r\n        volumeSlider.addEventListener('touchmove', (e) => {\r\n            if (this.isDraggingVolume) {\r\n                e.preventDefault();\r\n                const touch = e.touches[0];\r\n                updateVolume(touch.clientY);\r\n            }\r\n        }, { passive: false });\r\n\r\n        volumeSlider.addEventListener('touchend', (e) => {\r\n            e.stopPropagation();\r\n            e.preventDefault();\r\n            this.isDraggingVolume = false;\r\n        }, { passive: false });\r\n\r\n        volumeSlider.addEventListener('touchcancel', () => {\r\n            this.isDraggingVolume = false;\r\n        });\r\n\r\n        // Keyboard volume control\r\n        volumeSlider.addEventListener('keydown', (e) => {\r\n            if (e.key === 'ArrowUp') {\r\n                e.preventDefault();\r\n                this.player.setVolume(Math.min(1, this.player.state.volume + 0.1));\r\n            } else if (e.key === 'ArrowDown') {\r\n                e.preventDefault();\r\n                this.player.setVolume(Math.max(0, this.player.state.volume - 0.1));\r\n            } else if (e.key === 'Escape') {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                // Close menu and return focus to button\r\n                this.closeMenuAndReturnFocus(volumeMenu, button, true);\r\n            }\r\n        });\r\n\r\n        // Prevent menu from closing when interacting with slider\r\n        volumeMenu.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n        \r\n        // Prevent menu from closing on touch events\r\n        volumeMenu.addEventListener('touchstart', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n        \r\n        volumeMenu.addEventListener('touchmove', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n        \r\n        volumeMenu.addEventListener('touchend', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        volumeMenu.style.visibility = 'hidden';\r\n        volumeMenu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(volumeMenu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(volumeMenu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            volumeMenu.style.visibility = 'visible';\r\n        });\r\n\r\n        this.controls.volumeSlider = volumeSlider;\r\n        this.controls.volumeFill = volumeFill;\r\n\r\n        // Focus the volume slider for keyboard accessibility\r\n        focusElement(volumeSlider, { delay: 50 });\r\n\r\n        // Close menu on outside click\r\n        this.attachMenuCloseHandler(volumeMenu, button, true);\r\n    }\r\n\r\n    createTimeDisplay() {\r\n        const container = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-time`,\r\n            attributes: {\r\n                'role': 'group',\r\n                'aria-label': i18n.t('time.display')\r\n            }\r\n        });\r\n\r\n        // Current time - visual text hidden, accessible text provided via sr-only span\r\n        this.controls.currentTimeDisplay = DOMUtils.createElement('span', {\r\n            className: `${this.player.options.classPrefix}-current-time`\r\n        });\r\n        \r\n        // Create visual text inside, hidden from screen readers\r\n        const currentTimeVisual = DOMUtils.createElement('span', {\r\n            textContent: '00:00',\r\n            attributes: {\r\n                'aria-hidden': 'true'\r\n            }\r\n        });\r\n        const currentTimeAccessible = DOMUtils.createElement('span', {\r\n            className: 'vidply-sr-only',\r\n            textContent: i18n.t('time.seconds', { count: 0 })\r\n        });\r\n\r\n        this.controls.currentTimeDisplay.appendChild(currentTimeVisual);\r\n        this.controls.currentTimeDisplay.appendChild(currentTimeAccessible);\r\n        this.controls.currentTimeVisual = currentTimeVisual;\r\n        this.controls.currentTimeAccessible = currentTimeAccessible;\r\n\r\n        const separator = DOMUtils.createElement('span', {\r\n            textContent: ' / ',\r\n            attributes: {\r\n                'aria-hidden': 'true'\r\n            }\r\n        });\r\n\r\n        // Duration - visual text hidden, accessible text provided via sr-only span\r\n        this.controls.durationDisplay = DOMUtils.createElement('span', {\r\n            className: `${this.player.options.classPrefix}-duration`\r\n        });\r\n        \r\n        // Create visual text inside, hidden from screen readers\r\n        const durationVisual = DOMUtils.createElement('span', {\r\n            textContent: '00:00',\r\n            attributes: {\r\n                'aria-hidden': 'true'\r\n            }\r\n        });\r\n        const durationAccessible = DOMUtils.createElement('span', {\r\n            className: 'vidply-sr-only',\r\n            textContent: i18n.t('time.durationPrefix') + i18n.t('time.seconds', { count: 0 })\r\n        });\r\n\r\n        this.controls.durationDisplay.appendChild(durationVisual);\r\n        this.controls.durationDisplay.appendChild(durationAccessible);\r\n        this.controls.durationVisual = durationVisual;\r\n        this.controls.durationAccessible = durationAccessible;\r\n\r\n        container.appendChild(this.controls.currentTimeDisplay);\r\n        container.appendChild(separator);\r\n        container.appendChild(this.controls.durationDisplay);\r\n\r\n        return container;\r\n    }\r\n\r\n    createChaptersButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-chapters`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.chapters'),\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('chapters'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showChaptersMenu(button);\r\n        });\r\n\r\n        this.controls.chapters = button;\r\n        return button;\r\n    }\r\n\r\n    showChaptersMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-chapters-menu`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clear tracking if this was the open menu\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-chapters-menu ${this.player.options.classPrefix}-menu`,\r\n            attributes: {\r\n                'role': 'menu',\r\n                'aria-label': i18n.t('player.chapters')\r\n            }\r\n        });\r\n\r\n        // Get chapter tracks\r\n        const chapterTracks = Array.from(this.player.element.textTracks).filter(\r\n            track => track.kind === 'chapters'\r\n        );\r\n\r\n        if (chapterTracks.length === 0) {\r\n            // No chapters available\r\n            const noChaptersItem = DOMUtils.createElement('div', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: i18n.t('player.noChapters'),\r\n                attributes: {\r\n                    'role': 'menuitem'\r\n                },\r\n                style: {opacity: '0.5', cursor: 'default'}\r\n            });\r\n            menu.appendChild(noChaptersItem);\r\n        } else {\r\n            const chapterTrack = chapterTracks[0];\r\n\r\n            // Ensure track is in 'hidden' mode to load cues\r\n            if (chapterTrack.mode === 'disabled') {\r\n                chapterTrack.mode = 'hidden';\r\n            }\r\n\r\n            if (!chapterTrack.cues || chapterTrack.cues.length === 0) {\r\n                // Cues not loaded yet - wait for them to load\r\n                const loadingItem = DOMUtils.createElement('div', {\r\n                    className: `${this.player.options.classPrefix}-menu-item`,\r\n                    textContent: i18n.t('player.loadingChapters'),\r\n                    attributes: {\r\n                        'role': 'menuitem'\r\n                    },\r\n                    style: {opacity: '0.5', cursor: 'default'}\r\n                });\r\n                menu.appendChild(loadingItem);\r\n\r\n                // Listen for track load event\r\n                const onTrackLoad = () => {\r\n                    // Remove loading message and rebuild menu\r\n                    menu.remove();\r\n                    this.showChaptersMenu(button);\r\n                };\r\n\r\n                chapterTrack.addEventListener('load', onTrackLoad, {once: true});\r\n\r\n                // Also try again after a short delay as fallback\r\n                setTimeout(() => {\r\n                    if (chapterTrack.cues && chapterTrack.cues.length > 0 && document.contains(menu)) {\r\n                        menu.remove();\r\n                        this.showChaptersMenu(button);\r\n                    }\r\n                }, 500);\r\n            } else {\r\n                // Display chapters\r\n                const cues = chapterTrack.cues;\r\n                for (let i = 0; i < cues.length; i++) {\r\n                    const cue = cues[i];\r\n                    const item = DOMUtils.createElement('button', {\r\n                        className: `${this.player.options.classPrefix}-menu-item`,\r\n                        attributes: {\r\n                            'type': 'button',\r\n                            'role': 'menuitem',\r\n                            'tabindex': '-1'\r\n                        }\r\n                    });\r\n\r\n                    const timeLabel = DOMUtils.createElement('span', {\r\n                        className: `${this.player.options.classPrefix}-chapter-time`,\r\n                        textContent: TimeUtils.formatTime(cue.startTime),\r\n                        attributes: {\r\n                            'aria-label': TimeUtils.formatDuration(cue.startTime)\r\n                        }\r\n                    });\r\n\r\n                    const titleLabel = DOMUtils.createElement('span', {\r\n                        className: `${this.player.options.classPrefix}-chapter-title`,\r\n                        textContent: cue.text\r\n                    });\r\n\r\n                    item.appendChild(timeLabel);\r\n                    item.appendChild(document.createTextNode(' '));\r\n                    item.appendChild(titleLabel);\r\n\r\n                    item.addEventListener('click', () => {\r\n                        this.player.seek(cue.startTime);\r\n                        this.closeMenuAndReturnFocus(menu, button);\r\n                    });\r\n\r\n                    menu.appendChild(item);\r\n                }\r\n                \r\n                // Add keyboard navigation\r\n                this.attachMenuKeyboardNavigation(menu, button);\r\n                \r\n                // Focus first item\r\n                setTimeout(() => {\r\n                    const firstItem = menu.querySelector(`.${this.player.options.classPrefix}-menu-item`);\r\n                    if (firstItem) {\r\n                        firstItem.focus({ preventScroll: true });\r\n                    }\r\n                }, 0);\r\n            }\r\n        }\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        // Set menu to invisible temporarily\r\n        menu.style.visibility = 'hidden';\r\n        menu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(menu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            menu.style.visibility = 'visible';\r\n        });\r\n\r\n        // Close menu on outside click\r\n        this.attachMenuCloseHandler(menu, button);\r\n    }\r\n\r\n    createQualityButton() {\r\n        const ariaLabel = i18n.t('player.quality');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-quality`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('hd'));\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        // Add quality indicator text\r\n        const qualityText = DOMUtils.createElement('span', {\r\n            className: `${this.player.options.classPrefix}-quality-text`,\r\n            textContent: ''\r\n        });\r\n        button.appendChild(qualityText);\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showQualityMenu(button);\r\n        });\r\n\r\n        this.controls.quality = button;\r\n        this.controls.qualityText = qualityText;\r\n        \r\n        // Update quality indicator after a short delay to ensure renderer is ready\r\n        setTimeout(() => this.updateQualityIndicator(), 500);\r\n        \r\n        return button;\r\n    }\r\n\r\n    showQualityMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-quality-menu`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clear tracking if this was the open menu\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-quality-menu ${this.player.options.classPrefix}-menu`,\r\n            attributes: {\r\n                'role': 'menu',\r\n                'aria-label': i18n.t('player.quality')\r\n            }\r\n        });\r\n\r\n        // Check if renderer supports quality selection\r\n        if (this.player.renderer && this.player.renderer.getQualities) {\r\n            const qualities = this.player.renderer.getQualities();\r\n            const currentQuality = this.player.renderer.getCurrentQuality ? this.player.renderer.getCurrentQuality() : -1;\r\n            const isHLS = this.player.renderer.hls !== undefined;\r\n\r\n            if (qualities.length === 0) {\r\n                // No qualities available\r\n                const noQualityItem = DOMUtils.createElement('div', {\r\n                    className: `${this.player.options.classPrefix}-menu-item`,\r\n                    textContent: i18n.t('player.autoQuality'),\r\n                    attributes: {\r\n                        'role': 'menuitem'\r\n                    },\r\n                    style: {opacity: '0.5', cursor: 'default'}\r\n                });\r\n                menu.appendChild(noQualityItem);\r\n            } else {\r\n                let activeItem = null;\r\n                \r\n                // Auto quality option (only for HLS)\r\n                if (isHLS) {\r\n                    const autoItem = DOMUtils.createElement('button', {\r\n                        className: `${this.player.options.classPrefix}-menu-item`,\r\n                        textContent: i18n.t('player.auto'),\r\n                        attributes: {\r\n                            'type': 'button',\r\n                            'role': 'menuitem',\r\n                            'tabindex': '-1'\r\n                        }\r\n                    });\r\n\r\n                    // Check if auto is currently selected\r\n                    const isAuto = this.player.renderer.hls && this.player.renderer.hls.currentLevel === -1;\r\n                    if (isAuto) {\r\n                        autoItem.classList.add(`${this.player.options.classPrefix}-menu-item-active`);\r\n                        autoItem.appendChild(createIconElement('check'));\r\n                        activeItem = autoItem;\r\n                    }\r\n\r\n                    autoItem.addEventListener('click', () => {\r\n                        if (this.player.renderer.switchQuality) {\r\n                            this.player.renderer.switchQuality(-1); // -1 for auto\r\n                        }\r\n                        this.closeMenuAndReturnFocus(menu, button);\r\n                    });\r\n\r\n                    menu.appendChild(autoItem);\r\n                }\r\n\r\n                // Quality options\r\n                qualities.forEach(quality => {\r\n                    const item = DOMUtils.createElement('button', {\r\n                        className: `${this.player.options.classPrefix}-menu-item`,\r\n                        textContent: quality.name || `${quality.height}p`,\r\n                        attributes: {\r\n                            'type': 'button',\r\n                            'role': 'menuitem',\r\n                            'tabindex': '-1'\r\n                        }\r\n                    });\r\n\r\n                    // Highlight current quality\r\n                    if (quality.index === currentQuality) {\r\n                        item.classList.add(`${this.player.options.classPrefix}-menu-item-active`);\r\n                        item.appendChild(createIconElement('check'));\r\n                        activeItem = item;\r\n                    }\r\n\r\n                    item.addEventListener('click', () => {\r\n                        if (this.player.renderer.switchQuality) {\r\n                            this.player.renderer.switchQuality(quality.index);\r\n                        }\r\n                        this.closeMenuAndReturnFocus(menu, button);\r\n                    });\r\n\r\n                    menu.appendChild(item);\r\n                });\r\n                \r\n                // Add keyboard navigation\r\n                this.attachMenuKeyboardNavigation(menu, button);\r\n                \r\n                // Focus active item or first item\r\n                setTimeout(() => {\r\n                    const focusTarget = activeItem || menu.querySelector(`.${this.player.options.classPrefix}-menu-item`);\r\n                    if (focusTarget) {\r\n                        focusTarget.focus({ preventScroll: true });\r\n                    }\r\n                }, 0);\r\n            }\r\n        } else {\r\n            // No quality support\r\n            const noSupportItem = DOMUtils.createElement('div', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: i18n.t('player.noQuality'),\r\n                style: {opacity: '0.5', cursor: 'default'}\r\n            });\r\n            menu.appendChild(noSupportItem);\r\n        }\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        // Set menu to invisible temporarily\r\n        menu.style.visibility = 'hidden';\r\n        menu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(menu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            menu.style.visibility = 'visible';\r\n        });\r\n\r\n        // Close menu on outside click\r\n        this.attachMenuCloseHandler(menu, button);\r\n    }\r\n\r\n    createCaptionStyleButton() {\r\n        const ariaLabel = i18n.t('player.captionStyling');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-caption-style`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        // Create \"Aa\" text icon for styling\r\n        const textIcon = DOMUtils.createElement('span', {\r\n            textContent: 'Aa',\r\n            style: {\r\n                fontSize: '14px',\r\n                fontWeight: 'bold'\r\n            }\r\n        });\r\n        button.appendChild(textIcon);\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showCaptionStyleMenu(button);\r\n        });\r\n\r\n        this.controls.captionStyle = button;\r\n        return button;\r\n    }\r\n\r\n    showCaptionStyleMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-caption-style-menu`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clear tracking if this was the open menu\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-caption-style-menu ${this.player.options.classPrefix}-menu ${this.player.options.classPrefix}-settings-menu`,\r\n            attributes: {\r\n                'role': 'menu',\r\n                'aria-label': i18n.t('player.captionStyling')\r\n            }\r\n        });\r\n\r\n        // Prevent menu from closing when clicking inside\r\n        menu.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        // Check if there are any caption tracks\r\n        if (!this.player.captionManager || this.player.captionManager.tracks.length === 0) {\r\n            // Show \"No captions available\" message\r\n            const noTracksItem = DOMUtils.createElement('div', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: i18n.t('player.noCaptions'),\r\n                attributes: {\r\n                    'role': 'menuitem'\r\n                },\r\n                style: {opacity: '0.5', cursor: 'default', padding: '12px 16px'}\r\n            });\r\n            menu.appendChild(noTracksItem);\r\n\r\n            // Position menu first (before it's visible) to prevent jumping\r\n            // Set menu to invisible temporarily\r\n            menu.style.visibility = 'hidden';\r\n            menu.style.display = 'block';\r\n            \r\n            // Insert menu into DOM (handles fullscreen positioning)\r\n            this.insertMenuIntoDOM(menu, button);\r\n            \r\n            // Position immediately (synchronously) while hidden\r\n            this.positionMenu(menu, button, true);\r\n            \r\n            // Make menu visible after positioning\r\n            requestAnimationFrame(() => {\r\n                menu.style.visibility = 'visible';\r\n            });\r\n\r\n            // Close menu on outside click\r\n            this.attachMenuCloseHandler(menu, button, true);\r\n            return;\r\n        }\r\n\r\n        // Font Size\r\n        const fontSizeGroup = this.createStyleControl(\r\n            i18n.t('styleLabels.fontSize'),\r\n            'captionsFontSize',\r\n            [\r\n                {label: i18n.t('fontSizes.small'), value: '87.5%'},\r\n                {label: i18n.t('fontSizes.normal'), value: '100%'},\r\n                {label: i18n.t('fontSizes.large'), value: '125%'},\r\n                {label: i18n.t('fontSizes.xlarge'), value: '150%'}\r\n            ]\r\n        );\r\n        menu.appendChild(fontSizeGroup);\r\n\r\n        // Font Family\r\n        const fontFamilyGroup = this.createStyleControl(\r\n            i18n.t('styleLabels.font'),\r\n            'captionsFontFamily',\r\n            [\r\n                {label: i18n.t('fontFamilies.sansSerif'), value: 'sans-serif'},\r\n                {label: i18n.t('fontFamilies.serif'), value: 'serif'},\r\n                {label: i18n.t('fontFamilies.monospace'), value: 'monospace'}\r\n            ]\r\n        );\r\n        menu.appendChild(fontFamilyGroup);\r\n\r\n        // Text Color\r\n        const colorGroup = this.createColorControl(i18n.t('styleLabels.textColor'), 'captionsColor');\r\n        menu.appendChild(colorGroup);\r\n\r\n        // Background Color\r\n        const bgColorGroup = this.createColorControl(i18n.t('styleLabels.background'), 'captionsBackgroundColor');\r\n        menu.appendChild(bgColorGroup);\r\n\r\n        // Opacity\r\n        const opacityGroup = this.createOpacityControl(i18n.t('styleLabels.opacity'), 'captionsOpacity');\r\n        menu.appendChild(opacityGroup);\r\n\r\n        // Set min-width for caption style menu\r\n        menu.style.minWidth = '220px';\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        // Set menu to invisible temporarily\r\n        menu.style.visibility = 'hidden';\r\n        menu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(menu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            menu.style.visibility = 'visible';\r\n        });\r\n\r\n        // Close menu on outside click (but not when interacting with controls)\r\n        this.attachMenuCloseHandler(menu, button, true);\r\n\r\n        // Auto-focus the first style select element\r\n        focusFirstElement(menu, `.${this.player.options.classPrefix}-style-select`);\r\n    }\r\n\r\n    createStyleControl(label, property, options) {\r\n        const group = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-style-group`\r\n        });\r\n\r\n        // Generate unique ID for the control\r\n        const controlId = `${this.player.options.classPrefix}-${property}-${Date.now()}`;\r\n\r\n        const labelEl = DOMUtils.createElement('label', {\r\n            textContent: label,\r\n            attributes: {\r\n                'for': controlId\r\n            },\r\n            style: {\r\n                display: 'block',\r\n                fontSize: '12px',\r\n                marginBottom: '4px',\r\n                color: 'rgba(255,255,255,0.7)'\r\n            }\r\n        });\r\n        group.appendChild(labelEl);\r\n\r\n        const select = DOMUtils.createElement('select', {\r\n            className: `${this.player.options.classPrefix}-style-select`,\r\n            attributes: {\r\n                'id': controlId\r\n            },\r\n            style: {\r\n                width: '100%',\r\n                padding: '6px',\r\n                background: 'var(--vidply-white)',\r\n                border: '1px solid var(--vidply-white-10)',\r\n                borderRadius: '4px',\r\n                color: 'var(--vidply-black)',\r\n                fontSize: '13px'\r\n            }\r\n        });\r\n\r\n        const currentValue = this.player.options[property];\r\n        options.forEach(opt => {\r\n            const option = DOMUtils.createElement('option', {\r\n                textContent: opt.label,\r\n                attributes: {value: opt.value}\r\n            });\r\n            if (opt.value === currentValue) {\r\n                option.selected = true;\r\n            }\r\n            select.appendChild(option);\r\n        });\r\n\r\n        // Prevent clicks from closing the menu\r\n        select.addEventListener('mousedown', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        select.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        select.addEventListener('change', (e) => {\r\n            e.stopPropagation();\r\n            this.player.options[property] = e.target.value;\r\n            if (this.player.captionManager) {\r\n                this.player.captionManager.setCaptionStyle(\r\n                    property.replace('captions', '').charAt(0).toLowerCase() + property.replace('captions', '').slice(1),\r\n                    e.target.value\r\n                );\r\n            }\r\n        });\r\n\r\n        group.appendChild(select);\r\n        return group;\r\n    }\r\n\r\n    createColorControl(label, property) {\r\n        const group = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-style-group`\r\n        });\r\n\r\n        // Generate unique ID for the control\r\n        const controlId = `${this.player.options.classPrefix}-${property}-${Date.now()}`;\r\n\r\n        const labelEl = DOMUtils.createElement('label', {\r\n            textContent: label,\r\n            attributes: {\r\n                'for': controlId\r\n            },\r\n            style: {\r\n                display: 'block',\r\n                fontSize: '12px',\r\n                marginBottom: '4px',\r\n                color: 'rgba(255,255,255,0.7)'\r\n            }\r\n        });\r\n        group.appendChild(labelEl);\r\n\r\n        const input = DOMUtils.createElement('input', {\r\n            attributes: {\r\n                'id': controlId,\r\n                type: 'color',\r\n                value: this.player.options[property]\r\n            },\r\n            style: {\r\n                width: '100%',\r\n                height: '32px',\r\n                padding: '2px',\r\n                background: 'rgba(255,255,255,0.1)',\r\n                border: '1px solid rgba(255,255,255,0.2)',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer'\r\n            }\r\n        });\r\n\r\n        // Prevent clicks from closing the menu\r\n        input.addEventListener('mousedown', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        input.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        input.addEventListener('change', (e) => {\r\n            e.stopPropagation();\r\n            this.player.options[property] = e.target.value;\r\n            if (this.player.captionManager) {\r\n                this.player.captionManager.setCaptionStyle(\r\n                    property.replace('captions', '').charAt(0).toLowerCase() + property.replace('captions', '').slice(1),\r\n                    e.target.value\r\n                );\r\n            }\r\n        });\r\n\r\n        group.appendChild(input);\r\n        return group;\r\n    }\r\n\r\n    createOpacityControl(label, property) {\r\n        const group = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-style-group`\r\n        });\r\n\r\n        // Generate unique ID for the control\r\n        const controlId = `${this.player.options.classPrefix}-${property}-${Date.now()}`;\r\n\r\n        const labelContainer = DOMUtils.createElement('div', {\r\n            style: {\r\n                display: 'flex',\r\n                justifyContent: 'space-between',\r\n                marginBottom: '4px'\r\n            }\r\n        });\r\n\r\n        const labelEl = DOMUtils.createElement('label', {\r\n            textContent: label,\r\n            attributes: {\r\n                'for': controlId\r\n            },\r\n            style: {\r\n                fontSize: '12px',\r\n                color: 'rgba(255,255,255,0.7)'\r\n            }\r\n        });\r\n\r\n        const valueEl = DOMUtils.createElement('span', {\r\n            textContent: Math.round(this.player.options[property] * 100) + '%',\r\n            style: {\r\n                fontSize: '12px',\r\n                color: 'rgba(255,255,255,0.7)'\r\n            }\r\n        });\r\n\r\n        labelContainer.appendChild(labelEl);\r\n        labelContainer.appendChild(valueEl);\r\n        group.appendChild(labelContainer);\r\n\r\n        const input = DOMUtils.createElement('input', {\r\n            attributes: {\r\n                'id': controlId,\r\n                type: 'range',\r\n                min: '0',\r\n                max: '1',\r\n                step: '0.1',\r\n                value: String(this.player.options[property])\r\n            },\r\n            style: {\r\n                width: '100%',\r\n                cursor: 'pointer'\r\n            }\r\n        });\r\n\r\n        // Prevent clicks from closing the menu\r\n        input.addEventListener('mousedown', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        input.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n        });\r\n\r\n        input.addEventListener('input', (e) => {\r\n            e.stopPropagation();\r\n            const value = parseFloat(e.target.value);\r\n            valueEl.textContent = Math.round(value * 100) + '%';\r\n            this.player.options[property] = value;\r\n            if (this.player.captionManager) {\r\n                this.player.captionManager.setCaptionStyle(\r\n                    property.replace('captions', '').charAt(0).toLowerCase() + property.replace('captions', '').slice(1),\r\n                    value\r\n                );\r\n            }\r\n        });\r\n\r\n        group.appendChild(input);\r\n        return group;\r\n    }\r\n\r\n    createSpeedButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-speed`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.speed'),\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('speed'));\r\n\r\n        const speedText = DOMUtils.createElement('span', {\r\n            className: `${this.player.options.classPrefix}-speed-text`,\r\n            textContent: '1x'\r\n        });\r\n        button.appendChild(speedText);\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showSpeedMenu(button);\r\n        });\r\n\r\n        this.controls.speed = button;\r\n        this.controls.speedText = speedText;\r\n        return button;\r\n    }\r\n\r\n    formatSpeedLabel(speed) {\r\n        // Special case: 1x is \"Normal\" (translated)\r\n        if (speed === 1) {\r\n            return i18n.t('speeds.normal');\r\n        }\r\n        \r\n        // For other speeds, format with locale-specific decimal separator\r\n        const speedStr = speed.toLocaleString(i18n.getLanguage(), {\r\n            minimumFractionDigits: 0,\r\n            maximumFractionDigits: 2\r\n        });\r\n        \r\n        return `${speedStr}×`;\r\n    }\r\n\r\n    showSpeedMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-speed-menu`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clear tracking if this was the open menu\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-speed-menu ${this.player.options.classPrefix}-menu`,\r\n            attributes: {\r\n                'role': 'menu'\r\n            }\r\n        });\r\n\r\n        const speeds = [0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2];\r\n        let activeItem = null;\r\n\r\n        speeds.forEach(speed => {\r\n            const item = DOMUtils.createElement('button', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: this.formatSpeedLabel(speed),\r\n                attributes: {\r\n                    'type': 'button',\r\n                    'role': 'menuitem',\r\n                    'tabindex': '-1'\r\n                }\r\n            });\r\n\r\n            if (speed === this.player.state.playbackSpeed) {\r\n                item.classList.add(`${this.player.options.classPrefix}-menu-item-active`);\r\n                item.appendChild(createIconElement('check'));\r\n                activeItem = item;\r\n            }\r\n\r\n            item.addEventListener('click', () => {\r\n                this.player.setPlaybackSpeed(speed);\r\n                this.closeMenuAndReturnFocus(menu, button);\r\n            });\r\n\r\n            menu.appendChild(item);\r\n        });\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        // Set menu to invisible temporarily\r\n        menu.style.visibility = 'hidden';\r\n        menu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(menu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            menu.style.visibility = 'visible';\r\n        });\r\n\r\n        // Add keyboard navigation\r\n        this.attachMenuKeyboardNavigation(menu, button);\r\n\r\n        // Close menu on outside click\r\n        this.attachMenuCloseHandler(menu, button);\r\n\r\n        // Focus the active item or first item\r\n        setTimeout(() => {\r\n            const focusTarget = activeItem || menu.querySelector(`.${this.player.options.classPrefix}-menu-item`);\r\n            if (focusTarget) {\r\n                focusTarget.focus({ preventScroll: true });\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    createCaptionsButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-captions-button`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.captions'),\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('captionsOff'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showCaptionsMenu(button);\r\n        });\r\n\r\n        this.controls.captions = button;\r\n        return button;\r\n    }\r\n\r\n    showCaptionsMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-captions-menu`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            // Clear tracking if this was the open menu\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-captions-menu ${this.player.options.classPrefix}-menu`,\r\n            attributes: {\r\n                'role': 'menu',\r\n                'aria-label': i18n.t('captions.select')\r\n            }\r\n        });\r\n\r\n        // Check if there are any caption tracks\r\n        if (!this.player.captionManager || this.player.captionManager.tracks.length === 0) {\r\n            // Show \"No captions available\" message\r\n            const noTracksItem = DOMUtils.createElement('div', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: i18n.t('player.noCaptions'),\r\n                attributes: {\r\n                    'role': 'menuitem'\r\n                },\r\n                style: {opacity: '0.5', cursor: 'default'}\r\n            });\r\n            menu.appendChild(noTracksItem);\r\n\r\n            // Insert menu into DOM (handles fullscreen positioning)\r\n            this.insertMenuIntoDOM(menu, button);\r\n\r\n            // Close menu on outside click\r\n            this.attachMenuCloseHandler(menu, button);\r\n            return;\r\n        }\r\n\r\n        let activeItem = null;\r\n\r\n        // Off option\r\n        const offItem = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-menu-item`,\r\n            textContent: i18n.t('captions.off'),\r\n            attributes: {\r\n                'type': 'button',\r\n                'role': 'menuitem',\r\n                'tabindex': '-1'\r\n            }\r\n        });\r\n\r\n        if (!this.player.state.captionsEnabled) {\r\n            offItem.classList.add(`${this.player.options.classPrefix}-menu-item-active`);\r\n            offItem.appendChild(createIconElement('check'));\r\n            activeItem = offItem;\r\n        }\r\n\r\n        offItem.addEventListener('click', () => {\r\n            this.player.disableCaptions();\r\n            this.updateCaptionsButton();\r\n            this.closeMenuAndReturnFocus(menu, button);\r\n        });\r\n\r\n        menu.appendChild(offItem);\r\n\r\n        // Available tracks\r\n        const tracks = this.player.captionManager.getAvailableTracks();\r\n        tracks.forEach(track => {\r\n            const item = DOMUtils.createElement('button', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: track.label,\r\n                attributes: {\r\n                    'type': 'button',\r\n                    'role': 'menuitem',\r\n                    'lang': track.language,\r\n                    'tabindex': '-1'\r\n                }\r\n            });\r\n\r\n            // Check if this is the current track\r\n            if (this.player.state.captionsEnabled &&\r\n                this.player.captionManager.currentTrack === this.player.captionManager.tracks[track.index]) {\r\n                item.classList.add(`${this.player.options.classPrefix}-menu-item-active`);\r\n                item.appendChild(createIconElement('check'));\r\n                activeItem = item;\r\n            }\r\n\r\n            item.addEventListener('click', () => {\r\n                this.player.captionManager.switchTrack(track.index);\r\n                this.updateCaptionsButton();\r\n                this.closeMenuAndReturnFocus(menu, button);\r\n            });\r\n\r\n            menu.appendChild(item);\r\n        });\r\n\r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n\r\n        // Add keyboard navigation for the menu\r\n        this.attachMenuKeyboardNavigation(menu, button);\r\n\r\n        // Close menu on outside click and Escape key\r\n        this.attachMenuCloseHandler(menu, button);\r\n\r\n        // Focus the active item or the first item\r\n        setTimeout(() => {\r\n            const focusTarget = activeItem || menu.querySelector(`.${this.player.options.classPrefix}-menu-item`);\r\n            if (focusTarget) {\r\n                focusTarget.focus({ preventScroll: true });\r\n            }\r\n        }, 0);\r\n    }\r\n\r\n    updateCaptionsButton() {\r\n        if (!this.controls.captions) return;\r\n\r\n        const icon = this.controls.captions.querySelector('.vidply-icon');\r\n        const isEnabled = this.player.state.captionsEnabled;\r\n\r\n        icon.innerHTML = isEnabled ?\r\n            createIconElement('captions').innerHTML :\r\n            createIconElement('captionsOff').innerHTML;\r\n\r\n    }\r\n\r\n    createTranscriptButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-transcript`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.transcript'),\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('transcript'));\r\n\r\n        button.addEventListener('click', async () => {\r\n            await this.player.toggleTranscript();\r\n                this.updateTranscriptButton();\r\n        });\r\n\r\n        this.controls.transcript = button;\r\n        return button;\r\n    }\r\n\r\n    updateTranscriptButton() {\r\n        if (!this.controls.transcript) return;\r\n\r\n        const isVisible = this.player.transcriptManager && this.player.transcriptManager.isVisible;\r\n        this.controls.transcript.setAttribute('aria-expanded', isVisible ? 'true' : 'false');\r\n    }\r\n\r\n    createAudioDescriptionButton() {\r\n        const ariaLabel = i18n.t('player.audioDescription');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-audio-description`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'role': 'switch',\r\n                'aria-checked': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('audioDescription'));\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        button.addEventListener('click', async () => {\r\n            await this.player.toggleAudioDescription();\r\n            this.updateAudioDescriptionButton();\r\n        });\r\n\r\n        this.controls.audioDescription = button;\r\n        return button;\r\n    }\r\n\r\n    updateAudioDescriptionButton() {\r\n        if (!this.controls.audioDescription) return;\r\n\r\n        const icon = this.controls.audioDescription.querySelector('.vidply-icon');\r\n        const isEnabled = this.player.state.audioDescriptionEnabled;\r\n\r\n        icon.innerHTML = isEnabled ?\r\n            createIconElement('audioDescriptionOn').innerHTML :\r\n            createIconElement('audioDescription').innerHTML;\r\n\r\n        this.controls.audioDescription.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\r\n        // Keep aria-label static - let aria-checked convey the state for switch role\r\n        // The label describes what the control is, not what action it performs\r\n    }\r\n\r\n    createSignLanguageButton() {\r\n        const ariaLabel = i18n.t('player.signLanguage');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-sign-language`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('signLanguagePip'));\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.toggleSignLanguage();\r\n            this.updateSignLanguageButton();\r\n        });\r\n\r\n        this.controls.signLanguage = button;\r\n        return button;\r\n    }\r\n\r\n    updateSignLanguageButton() {\r\n        if (!this.controls.signLanguage) return;\r\n\r\n        const icon = this.controls.signLanguage.querySelector('.vidply-icon');\r\n        const isEnabled = this.player.state.signLanguageEnabled;\r\n\r\n        icon.innerHTML = isEnabled ?\r\n            createIconElement('signLanguagePipOn').innerHTML :\r\n            createIconElement('signLanguagePip').innerHTML;\r\n\r\n        this.controls.signLanguage.setAttribute('aria-expanded', isEnabled ? 'true' : 'false');\r\n        this.controls.signLanguage.setAttribute('aria-label',\r\n            isEnabled ? i18n.t('signLanguage.hide') : i18n.t('signLanguage.show')\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Create sign language in main view button (src swap, like audio description)\r\n     */\r\n    createSignLanguageInMainViewButton() {\r\n        const ariaLabel = i18n.t('signLanguage.showInMainView');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-sign-language-main-view`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'aria-pressed': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('signLanguage'));\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        button.addEventListener('click', () => {\r\n            if (this.player.signLanguageManager) {\r\n                this.player.signLanguageManager.toggleInMainView();\r\n            }\r\n        });\r\n\r\n        this.controls.signLanguageMainView = button;\r\n        return button;\r\n    }\r\n\r\n    /**\r\n     * Update sign language in main view button state\r\n     */\r\n    updateSignLanguageInMainViewButton() {\r\n        const btn = this.controls.signLanguageMainView;\r\n        if (!btn) return;\r\n\r\n        const isEnabled = this.player.state.signLanguageInMainView;\r\n        const newLabel = isEnabled ? i18n.t('signLanguage.hideInMainView') : i18n.t('signLanguage.showInMainView');\r\n        const iconName = isEnabled ? 'signLanguageOn' : 'signLanguage';\r\n\r\n        btn.querySelector('.vidply-icon').innerHTML = createIconElement(iconName).innerHTML;\r\n        btn.setAttribute('aria-pressed', String(isEnabled));\r\n        btn.setAttribute('aria-label', newLabel);\r\n        \r\n        const tooltip = btn.querySelector(`.${this.player.options.classPrefix}-tooltip`);\r\n        if (tooltip) tooltip.textContent = newLabel;\r\n    }\r\n\r\n    /**\r\n     * Update accessibility buttons visibility based on current track data.\r\n     * Called when loading a new playlist track to show/hide buttons accordingly.\r\n     */\r\n    updateAccessibilityButtons() {\r\n        const hasAudioDescription = this.hasAudioDescription();\r\n        const hasSignLanguage = this.hasSignLanguage();\r\n        \r\n        // Handle Audio Description button\r\n        if (hasAudioDescription) {\r\n            // Create button if it doesn't exist\r\n            if (!this.controls.audioDescription && this.player.options.audioDescriptionButton !== false) {\r\n                const btn = this.createAudioDescriptionButton();\r\n                btn.dataset.overflowPriority = '2';\r\n                btn.dataset.overflowPriorityMobile = '3';\r\n                // Insert before transcript or playlist toggle button\r\n                const transcriptBtn = this.rightButtons.querySelector(`.${this.player.options.classPrefix}-transcript`);\r\n                const playlistBtn = this.rightButtons.querySelector(`.${this.player.options.classPrefix}-playlist-toggle`);\r\n                const insertBefore = transcriptBtn || playlistBtn || null;\r\n                if (insertBefore) {\r\n                    this.rightButtons.insertBefore(btn, insertBefore);\r\n                } else {\r\n                    this.rightButtons.appendChild(btn);\r\n                }\r\n                // Re-setup overflow menu after adding button\r\n                this.setupOverflowMenu();\r\n            }\r\n            // Show button\r\n            if (this.controls.audioDescription) {\r\n                this.controls.audioDescription.style.display = '';\r\n            }\r\n        } else {\r\n            // Hide button if no audio description available\r\n            if (this.controls.audioDescription) {\r\n                this.controls.audioDescription.style.display = 'none';\r\n            }\r\n        }\r\n        \r\n        // Handle Sign Language buttons (PiP overlay and/or main view based on displayMode)\r\n        const showSignLanguage = hasSignLanguage && this.player.options.signLanguageButton !== false;\r\n        const classPrefix = this.player.options.classPrefix;\r\n        const displayMode = this.player.options.signLanguageDisplayMode || 'both';\r\n        const showPip = ['pip', 'both'].includes(displayMode);\r\n        const showMain = ['main', 'both'].includes(displayMode);\r\n        \r\n        if (showSignLanguage) {\r\n            // Find insertion point once for both buttons\r\n            const qualityBtn = this.rightButtons.querySelector(`.${classPrefix}-quality`);\r\n            const fullscreenBtn = this.rightButtons.querySelector(`.${classPrefix}-fullscreen`);\r\n            const insertBeforeRef = qualityBtn || fullscreenBtn || null;\r\n            let needsOverflowSetup = false;\r\n            \r\n            // Create PiP button if needed and doesn't exist\r\n            if (showPip && !this.controls.signLanguage) {\r\n                const btn = this.createSignLanguageButton();\r\n                btn.dataset.overflowPriority = '3';\r\n                btn.dataset.overflowPriorityMobile = '3';\r\n                if (insertBeforeRef) {\r\n                    this.rightButtons.insertBefore(btn, insertBeforeRef);\r\n                } else {\r\n                    this.rightButtons.appendChild(btn);\r\n                }\r\n                needsOverflowSetup = true;\r\n            }\r\n            \r\n            // Create main view button if needed and doesn't exist\r\n            if (showMain && !this.controls.signLanguageMainView) {\r\n                const btn = this.createSignLanguageInMainViewButton();\r\n                btn.dataset.overflowPriority = '3';\r\n                btn.dataset.overflowPriorityMobile = '3';\r\n                // Insert after PiP button or at the reference point\r\n                const afterPip = this.controls.signLanguage?.nextSibling;\r\n                if (afterPip) {\r\n                    this.rightButtons.insertBefore(btn, afterPip);\r\n                } else if (insertBeforeRef) {\r\n                    this.rightButtons.insertBefore(btn, insertBeforeRef);\r\n                } else {\r\n                    this.rightButtons.appendChild(btn);\r\n                }\r\n                needsOverflowSetup = true;\r\n            }\r\n            \r\n            if (needsOverflowSetup) {\r\n                this.setupOverflowMenu();\r\n            }\r\n            \r\n            // Show/hide buttons based on displayMode\r\n            if (this.controls.signLanguage) {\r\n                this.controls.signLanguage.style.display = showPip ? '' : 'none';\r\n            }\r\n            if (this.controls.signLanguageMainView) {\r\n                this.controls.signLanguageMainView.style.display = showMain ? '' : 'none';\r\n            }\r\n        } else {\r\n            // Hide both buttons if no sign language available\r\n            if (this.controls.signLanguage) this.controls.signLanguage.style.display = 'none';\r\n            if (this.controls.signLanguageMainView) this.controls.signLanguageMainView.style.display = 'none';\r\n        }\r\n    }\r\n\r\n    createSettingsButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-settings`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.settings')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('settings'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.showSettings();\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    createPipButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-pip`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.pip')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('pip'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.togglePiP();\r\n        });\r\n\r\n        return button;\r\n    }\r\n\r\n    createFullscreenButton() {\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-fullscreen`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': i18n.t('player.fullscreen')\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('fullscreen'));\r\n\r\n        button.addEventListener('click', () => {\r\n            this.player.toggleFullscreen();\r\n        });\r\n\r\n        this.controls.fullscreen = button;\r\n        return button;\r\n    }\r\n\r\n    attachEvents() {\r\n        // Update controls based on player state\r\n        this.player.on('play', () => this.updatePlayPauseButton());\r\n        this.player.on('pause', () => this.updatePlayPauseButton());\r\n        this.player.on('timeupdate', () => this.updateProgress());\r\n        this.player.on('loadedmetadata', () => {\r\n            this.updateDuration();\r\n            this.ensureQualityButton();\r\n            this.updateQualityIndicator();\r\n            // Update preview video source when metadata loads (for playlists)\r\n            this.updatePreviewVideoSource();\r\n        });\r\n        this.player.on('sourcechange', () => {\r\n            // Update preview video source when source changes (for playlists)\r\n            this.updatePreviewVideoSource();\r\n        });\r\n        this.player.on('volumechange', () => this.updateVolumeDisplay());\r\n        this.player.on('progress', () => this.updateBuffered());\r\n        this.player.on('playbackspeedchange', () => this.updateSpeedDisplay());\r\n        this.player.on('fullscreenchange', () => this.updateFullscreenButton());\r\n        this.player.on('captionsenabled', () => this.updateCaptionsButton());\r\n        this.player.on('captionsdisabled', () => this.updateCaptionsButton());\r\n        this.player.on('audiodescriptionenabled', () => this.updateAudioDescriptionButton());\r\n        this.player.on('audiodescriptiondisabled', () => this.updateAudioDescriptionButton());\r\n        this.player.on('signlanguageenabled', () => this.updateSignLanguageButton());\r\n        this.player.on('signlanguagedisabled', () => this.updateSignLanguageButton());\r\n        this.player.on('signlanguageinmainviewenabled', () => this.updateSignLanguageInMainViewButton());\r\n        this.player.on('signlanguageinmainviewdisabled', () => this.updateSignLanguageInMainViewButton());\r\n        this.player.on('qualitychange', () => this.updateQualityIndicator());\r\n        this.player.on('hlslevelswitched', () => this.updateQualityIndicator());\r\n        this.player.on('hlsmanifestparsed', () => {\r\n            this.ensureQualityButton();\r\n            this.updateQualityIndicator();\r\n        });\r\n    }\r\n\r\n    updatePlayPauseButton() {\r\n        if (!this.controls.playPause) return;\r\n\r\n        const icon = this.controls.playPause.querySelector('.vidply-icon');\r\n        const isPlaying = this.player.state.playing;\r\n\r\n        icon.innerHTML = isPlaying ?\r\n            createIconElement('pause').innerHTML :\r\n            createIconElement('play').innerHTML;\r\n\r\n        const newAriaLabel = isPlaying ? i18n.t('player.pause') : i18n.t('player.play');\r\n        this.controls.playPause.setAttribute('aria-label', newAriaLabel);\r\n        // Update tooltip to match aria-label\r\n        DOMUtils.attachTooltip(this.controls.playPause, newAriaLabel, this.player.options.classPrefix);\r\n    }\r\n\r\n    updateProgress() {\r\n        if (!this.controls.played) return;\r\n\r\n        const currentTime = this.player.state.currentTime || 0;\r\n        const duration = this.player.state.duration || 0;\r\n        \r\n        // Guard against division by zero and ensure valid percentage\r\n        const percent = duration > 0 ? Math.min(100, Math.max(0, (currentTime / duration) * 100)) : 0;\r\n        \r\n        this.controls.played.style.width = `${percent}%`;\r\n        this.controls.progress.setAttribute('aria-valuenow', String(Math.round(percent)));\r\n        \r\n        // Set aria-valuetext to announce both percentage and time for screen readers\r\n        const currentTimeText = TimeUtils.formatDuration(this.player.state.currentTime);\r\n        const durationText = TimeUtils.formatDuration(this.player.state.duration);\r\n        this.controls.progress.setAttribute('aria-valuetext', \r\n            `${Math.round(percent)}%, ${currentTimeText} ${i18n.t('time.of')} ${durationText}`);\r\n\r\n        if (this.controls.currentTimeVisual) {\r\n            const currentTime = this.player.state.currentTime;\r\n            // Update visual text (hidden from screen readers)\r\n            this.controls.currentTimeVisual.textContent = TimeUtils.formatTime(currentTime);\r\n            if (this.controls.currentTimeAccessible) {\r\n                this.controls.currentTimeAccessible.textContent = TimeUtils.formatDuration(currentTime);\r\n            }\r\n        }\r\n    }\r\n\r\n    updateDuration() {\r\n        if (this.controls.durationVisual) {\r\n            const duration = this.player.state.duration;\r\n            // Update visual text (hidden from screen readers)\r\n            this.controls.durationVisual.textContent = TimeUtils.formatTime(duration);\r\n            if (this.controls.durationAccessible) {\r\n                this.controls.durationAccessible.textContent = i18n.t('time.durationPrefix') + TimeUtils.formatDuration(duration);\r\n            }\r\n        }\r\n    }\r\n\r\n    updateVolumeDisplay() {\r\n        const percent = this.player.state.volume * 100;\r\n\r\n        // Update volume fill bar if it exists\r\n        if (this.controls.volumeFill) {\r\n            this.controls.volumeFill.style.height = `${percent}%`;\r\n        }\r\n        \r\n        // Update volume slider aria-valuenow if it exists\r\n        if (this.controls.volumeSlider) {\r\n            this.controls.volumeSlider.setAttribute('aria-valuenow', String(Math.round(percent)));\r\n        }\r\n\r\n        // Update mute button icon (should always work even if slider not shown)\r\n        if (this.controls.mute) {\r\n            const icon = this.controls.mute.querySelector('.vidply-icon');\r\n            if (icon) {\r\n                let iconName;\r\n\r\n                if (this.player.state.muted || this.player.state.volume === 0) {\r\n                    iconName = 'volumeMuted';\r\n                } else if (this.player.state.volume < 0.3) {\r\n                    iconName = 'volumeLow';\r\n                } else if (this.player.state.volume < 0.7) {\r\n                    iconName = 'volumeMedium';\r\n                } else {\r\n                    iconName = 'volumeHigh';\r\n                }\r\n\r\n                icon.innerHTML = createIconElement(iconName).innerHTML;\r\n\r\n                const newMuteAriaLabel =\r\n                    this.player.state.muted ? i18n.t('player.unmute') : i18n.t('player.mute');\r\n                this.controls.mute.setAttribute('aria-label', newMuteAriaLabel);\r\n                // Update tooltip to match aria-label\r\n                DOMUtils.attachTooltip(this.controls.mute, newMuteAriaLabel, this.player.options.classPrefix);\r\n            }\r\n        }\r\n\r\n        // Update volume slider attribute if it exists\r\n        if (this.controls.volumeSlider) {\r\n            this.controls.volumeSlider.setAttribute('aria-valuenow', String(Math.round(percent)));\r\n        }\r\n    }\r\n\r\n    updateBuffered() {\r\n        if (!this.controls.buffered || !this.player.element.buffered || this.player.element.buffered.length === 0) return;\r\n\r\n        const buffered = this.player.element.buffered.end(this.player.element.buffered.length - 1);\r\n        const percent = (buffered / this.player.state.duration) * 100;\r\n        this.controls.buffered.style.width = `${percent}%`;\r\n    }\r\n\r\n    updateSpeedDisplay() {\r\n        if (this.controls.speedText) {\r\n            this.controls.speedText.textContent = `${this.player.state.playbackSpeed}x`;\r\n        }\r\n    }\r\n\r\n    updateFullscreenButton() {\r\n        if (!this.controls.fullscreen) return;\r\n\r\n        const icon = this.controls.fullscreen.querySelector('.vidply-icon');\r\n        const isFullscreen = this.player.state.fullscreen;\r\n\r\n        icon.innerHTML = isFullscreen ?\r\n            createIconElement('fullscreenExit').innerHTML :\r\n            createIconElement('fullscreen').innerHTML;\r\n\r\n        this.controls.fullscreen.setAttribute('aria-label',\r\n            isFullscreen ? i18n.t('player.exitFullscreen') : i18n.t('player.fullscreen')\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Ensure quality button exists if qualities are available\r\n     * This is called after renderer initialization to dynamically add the button\r\n     */\r\n    ensureQualityButton() {\r\n        // Skip if quality button is disabled\r\n        if (!this.player.options.qualityButton) return;\r\n        \r\n        // Skip if button already exists\r\n        if (this.controls.quality) return;\r\n        \r\n        // Check if qualities are now available\r\n        if (!this.hasQualityLevels()) return;\r\n        \r\n        // Create and insert the quality button before the speed button\r\n        const qualityButton = this.createQualityButton();\r\n        \r\n        // Find the speed button or caption style button to insert before\r\n        const speedButton = this.rightButtons.querySelector(`.${this.player.options.classPrefix}-speed`);\r\n        const captionStyleButton = this.rightButtons.querySelector(`.${this.player.options.classPrefix}-caption-style`);\r\n        const insertBefore = captionStyleButton || speedButton;\r\n        \r\n        if (insertBefore) {\r\n            this.rightButtons.insertBefore(qualityButton, insertBefore);\r\n        } else {\r\n            // If no reference button, add it at the beginning of right buttons\r\n            this.rightButtons.insertBefore(qualityButton, this.rightButtons.firstChild);\r\n        }\r\n        \r\n        this.player.log('Quality button added dynamically', 'info');\r\n    }\r\n\r\n    updateQualityIndicator() {\r\n        if (!this.controls.qualityText) return;\r\n        if (!this.player.renderer || !this.player.renderer.getQualities) return;\r\n\r\n        const qualities = this.player.renderer.getQualities();\r\n        if (qualities.length === 0) {\r\n            this.controls.qualityText.textContent = '';\r\n            return;\r\n        }\r\n\r\n        // Get current quality\r\n        let currentQualityText = '';\r\n        \r\n        // Check if it's HLS with auto mode\r\n        if (this.player.renderer.hls && this.player.renderer.hls.currentLevel === -1) {\r\n            currentQualityText = 'Auto';\r\n        } else if (this.player.renderer.getCurrentQuality) {\r\n            const currentIndex = this.player.renderer.getCurrentQuality();\r\n            const currentQuality = qualities.find(q => q.index === currentIndex);\r\n            if (currentQuality) {\r\n                currentQualityText = currentQuality.height ? `${currentQuality.height}p` : '';\r\n            }\r\n        }\r\n\r\n        this.controls.qualityText.textContent = currentQualityText;\r\n    }\r\n\r\n    setupAutoHide() {\r\n        if (this.player.element.tagName !== 'VIDEO') return;\r\n\r\n        const showControls = () => {\r\n            this.element.classList.add(`${this.player.options.classPrefix}-controls-visible`);\r\n            this.player.container.classList.add(`${this.player.options.classPrefix}-controls-visible`);\r\n            this.player.state.controlsVisible = true;\r\n\r\n            clearTimeout(this.hideTimeout);\r\n\r\n            if (this.player.state.playing) {\r\n                // Use longer delay in fullscreen mode for better mobile UX\r\n                const delay = this.player.state.fullscreen \r\n                    ? this.player.options.hideControlsDelay * 1.5 \r\n                    : this.player.options.hideControlsDelay;\r\n                    \r\n                this.hideTimeout = setTimeout(() => {\r\n                    this.element.classList.remove(`${this.player.options.classPrefix}-controls-visible`);\r\n                    this.player.container.classList.remove(`${this.player.options.classPrefix}-controls-visible`);\r\n                    this.player.state.controlsVisible = false;\r\n                }, delay);\r\n            }\r\n        };\r\n\r\n        // Mouse and touch events to show controls\r\n        this.player.container.addEventListener('mousemove', showControls);\r\n        this.player.container.addEventListener('touchstart', showControls);\r\n        this.player.container.addEventListener('touchmove', showControls); // Also show on touch drag/swipe\r\n        this.player.container.addEventListener('click', showControls);\r\n        this.player.container.addEventListener('tap', showControls); // Some mobile browsers use tap event\r\n\r\n        // Show controls on focus\r\n        this.element.addEventListener('focusin', showControls);\r\n\r\n        // Always show when paused\r\n        this.player.on('pause', () => {\r\n            showControls();\r\n            clearTimeout(this.hideTimeout);\r\n        });\r\n\r\n        this.player.on('play', () => {\r\n            showControls();\r\n        });\r\n\r\n        // Show controls when entering fullscreen (especially important for mobile landscape)\r\n        this.player.on('enterfullscreen', () => {\r\n            showControls();\r\n            // In fullscreen, keep controls visible longer initially\r\n            if (this.player.state.fullscreen) {\r\n                clearTimeout(this.hideTimeout);\r\n                this.hideTimeout = setTimeout(() => {\r\n                    if (this.player.state.playing) {\r\n                        this.element.classList.remove(`${this.player.options.classPrefix}-controls-visible`);\r\n                        this.player.container.classList.remove(`${this.player.options.classPrefix}-controls-visible`);\r\n                        this.player.state.controlsVisible = false;\r\n                    }\r\n                }, this.player.options.hideControlsDelay * 2); // Double the delay in fullscreen\r\n            }\r\n        });\r\n\r\n        // Initial state\r\n        showControls();\r\n    }\r\n\r\n    createOverflowMenuButton() {\r\n        const ariaLabel = i18n.t('player.moreOptions');\r\n        const button = DOMUtils.createElement('button', {\r\n            className: `${this.player.options.classPrefix}-button ${this.player.options.classPrefix}-overflow-menu`,\r\n            attributes: {\r\n                'type': 'button',\r\n                'aria-label': ariaLabel,\r\n                'aria-expanded': 'false'\r\n            }\r\n        });\r\n\r\n        button.appendChild(createIconElement('moreVertical'));\r\n        DOMUtils.attachTooltip(button, ariaLabel, this.player.options.classPrefix);\r\n\r\n        button.addEventListener('click', () => {\r\n            this.showOverflowMenu(button);\r\n        });\r\n\r\n        this.controls.overflowMenu = button;\r\n        return button;\r\n    }\r\n\r\n    showOverflowMenu(button) {\r\n        // Remove existing menu if any (toggle behavior)\r\n        const existingMenu = document.querySelector(`.${this.player.options.classPrefix}-overflow-menu-list`);\r\n        if (existingMenu) {\r\n            existingMenu.remove();\r\n            button.setAttribute('aria-expanded', 'false');\r\n            if (this.openMenu === existingMenu) {\r\n                this.openMenu = null;\r\n                this.openMenuButton = null;\r\n            }\r\n            return;\r\n        }\r\n\r\n        const menu = DOMUtils.createElement('div', {\r\n            className: `${this.player.options.classPrefix}-overflow-menu-list ${this.player.options.classPrefix}-menu`,\r\n            attributes: {\r\n                'role': 'menu',\r\n                'aria-label': i18n.t('player.moreOptions')\r\n            }\r\n        });\r\n\r\n        // Get all overflow buttons (those currently hidden)\r\n        const overflowButtons = Array.from(this.rightButtons.querySelectorAll('button[data-in-overflow=\"true\"]'));\r\n\r\n        if (overflowButtons.length === 0) {\r\n            // No overflow items\r\n            const noItemsText = DOMUtils.createElement('div', {\r\n                className: `${this.player.options.classPrefix}-menu-item`,\r\n                textContent: i18n.t('player.noMoreOptions'),\r\n                attributes: {\r\n                    'role': 'menuitem'\r\n                },\r\n                style: {opacity: '0.5', cursor: 'default'}\r\n            });\r\n            menu.appendChild(noItemsText);\r\n        } else {\r\n            // Create menu items for each overflow button\r\n            overflowButtons.forEach(btn => {\r\n                const item = DOMUtils.createElement('button', {\r\n                    className: `${this.player.options.classPrefix}-menu-item`,\r\n                    attributes: {\r\n                        'type': 'button',\r\n                        'role': 'menuitem',\r\n                        'tabindex': '-1'\r\n                    }\r\n                });\r\n\r\n                // Get button label\r\n                const label = btn.getAttribute('aria-label') || btn.getAttribute('title') || '';\r\n                \r\n                // Copy icon if present (SVG icon or text icon like \"Aa\")\r\n                const icon = btn.querySelector('.vidply-icon');\r\n                if (icon) {\r\n                    const iconClone = icon.cloneNode(true);\r\n                    item.appendChild(iconClone);\r\n                } else {\r\n                    // Check for text icon (like caption styling \"Aa\")\r\n                    const firstChild = btn.querySelector('span');\r\n                    if (firstChild && firstChild.textContent && firstChild.textContent.length <= 3) {\r\n                        const iconClone = firstChild.cloneNode(true);\r\n                        iconClone.classList.add('vidply-icon'); // Add icon class for consistent styling\r\n                        item.appendChild(iconClone);\r\n                    }\r\n                }\r\n                \r\n                const labelSpan = DOMUtils.createElement('span', {\r\n                    textContent: label\r\n                });\r\n                item.appendChild(labelSpan);\r\n\r\n                // When clicked, trigger the original button's click\r\n                item.addEventListener('click', (e) => {\r\n                    // Store the overflow menu item as the positioning reference\r\n                    // This allows submenus to position relative to the visible menu item\r\n                    this._overflowMenuItemRef = item;\r\n                    \r\n                    // Temporarily make the original button visible for positioning\r\n                    const originalDisplay = btn.style.display;\r\n                    btn.style.display = '';\r\n                    btn.style.visibility = 'hidden'; // Keep it invisible but in layout\r\n                    \r\n                    // Trigger the button's menu\r\n                    btn.click();\r\n                    \r\n                    // Restore original state after menu is positioned\r\n                    setTimeout(() => {\r\n                        btn.style.display = originalDisplay;\r\n                        btn.style.visibility = '';\r\n                        this._overflowMenuItemRef = null;\r\n                    }, 100);\r\n                    \r\n                    // Close overflow menu\r\n                    this.closeMenuAndReturnFocus(menu, button);\r\n                });\r\n\r\n                menu.appendChild(item);\r\n            });\r\n\r\n            // Add keyboard navigation\r\n            this.attachMenuKeyboardNavigation(menu, button);\r\n\r\n            // Focus first item\r\n            setTimeout(() => {\r\n                const firstItem = menu.querySelector(`.${this.player.options.classPrefix}-menu-item`);\r\n                if (firstItem && firstItem.tagName === 'BUTTON') {\r\n                    firstItem.focus({ preventScroll: true });\r\n                }\r\n            }, 0);\r\n        }\r\n\r\n        // Position menu first (before it's visible) to prevent jumping\r\n        menu.style.visibility = 'hidden';\r\n        menu.style.display = 'block';\r\n        \r\n        // Insert menu into DOM (handles fullscreen positioning)\r\n        this.insertMenuIntoDOM(menu, button);\r\n        \r\n        // Position immediately (synchronously) while hidden\r\n        this.positionMenu(menu, button, true);\r\n        \r\n        // Make menu visible after positioning\r\n        requestAnimationFrame(() => {\r\n            menu.style.visibility = 'visible';\r\n        });\r\n\r\n        // Close menu on outside click\r\n        this.attachMenuCloseHandler(menu, button);\r\n    }\r\n\r\n    setupOverflowDetection() {\r\n        // Check for overflow after layout is stable\r\n        const checkOverflow = () => {\r\n            // Check screen size and orientation\r\n            const isDesktop = window.innerWidth >= 768;\r\n            const isLandscape = window.innerHeight < window.innerWidth;\r\n            const isFullscreen = this.player.state.fullscreen;\r\n            const isLandscapeFullscreen = isLandscape && isFullscreen;\r\n            \r\n            if (!this.rightButtons || this.rightButtons.children.length === 0) {\r\n                // Hide overflow button if no buttons exist\r\n                if (this.overflowMenuButton) {\r\n                    this.overflowMenuButton.style.display = 'none';\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Get all buttons (except the overflow menu button itself)\r\n            const allButtons = Array.from(this.rightButtons.children).filter(\r\n                btn => !btn.classList.contains(`${this.player.options.classPrefix}-overflow-menu`)\r\n            );\r\n\r\n            if (allButtons.length === 0) {\r\n                // Hide overflow button if no buttons exist\r\n                if (this.overflowMenuButton) {\r\n                    this.overflowMenuButton.style.display = 'none';\r\n                }\r\n                return;\r\n            }\r\n\r\n            // Determine if we should use overflow menu\r\n            // Only use overflow on mobile portrait (width < 768px and not in landscape)\r\n            // In landscape mode, always show all buttons (even on mobile) to ensure fullscreen button is accessible\r\n            const shouldUseOverflow = !isDesktop && !isLandscape;\r\n            \r\n            if (this.player.options.debug) {\r\n                console.log('Overflow detection:', {\r\n                    isDesktop,\r\n                    isFullscreen,\r\n                    isLandscape,\r\n                    isLandscapeFullscreen,\r\n                    shouldUseOverflow,\r\n                    width: window.innerWidth,\r\n                    height: window.innerHeight\r\n                });\r\n            }\r\n\r\n            // If we shouldn't use overflow menu, show all buttons and hide overflow button\r\n            if (!shouldUseOverflow) {\r\n                allButtons.forEach(btn => {\r\n                    btn.dataset.inOverflow = 'false';\r\n                    btn.style.display = '';\r\n                });\r\n                // Always hide overflow menu button\r\n                if (this.overflowMenuButton) {\r\n                    this.overflowMenuButton.style.display = 'none';\r\n                }\r\n                if (this.player.options.debug) {\r\n                    console.log('No overflow menu needed - all buttons visible, overflow button hidden');\r\n                }\r\n                return;\r\n            }\r\n            \r\n            // Continue with overflow detection for mobile portrait only\r\n            if (this.player.options.debug) {\r\n                console.log('Mobile portrait - checking for overflow...');\r\n            }\r\n\r\n            // First, make all buttons visible to measure their actual widths\r\n            allButtons.forEach(btn => {\r\n                btn.style.display = '';\r\n            });\r\n\r\n            // Get available width\r\n            const containerWidth = this.rightButtons.offsetWidth;\r\n            const overflowButtonWidth = 50; // Reserve space for overflow button + gap\r\n            const availableWidth = containerWidth - overflowButtonWidth;\r\n\r\n            // Calculate total width needed for all buttons including gaps\r\n            let totalWidth = 0;\r\n            const buttonWidths = allButtons.map(btn => {\r\n                const style = getComputedStyle(btn);\r\n                const width = btn.offsetWidth + \r\n                             parseInt(style.marginLeft || 0) + \r\n                             parseInt(style.marginRight || 0);\r\n                totalWidth += width;\r\n                return {btn, width};\r\n            });\r\n\r\n            // Add gap widths (8px per gap between buttons)\r\n            const gapWidth = 8;\r\n            totalWidth += (allButtons.length - 1) * gapWidth;\r\n\r\n            // Check if overflow is needed\r\n            const isSmallScreen = window.innerWidth < 768;\r\n            const needsOverflow = totalWidth > availableWidth || isSmallScreen || (isLandscapeFullscreen && !isDesktop); // Always overflow on mobile and mobile landscape fullscreen\r\n\r\n            // Debug logging\r\n            if (this.player.options.debug) {\r\n                console.log('Overflow detection:', {\r\n                    containerWidth,\r\n                    availableWidth,\r\n                    totalWidth,\r\n                    needsOverflow,\r\n                    isSmallScreen,\r\n                    reason: isSmallScreen ? 'mobile screen' : (totalWidth > availableWidth ? 'not enough space' : 'enough space'),\r\n                    buttonCount: allButtons.length\r\n                });\r\n            }\r\n\r\n            if (needsOverflow) {\r\n                // Use responsive priorities based on screen size\r\n                const isSmallScreen = window.innerWidth < 768;\r\n                const priorityAttr = isSmallScreen ? 'overflowPriorityMobile' : 'overflowPriority';\r\n                \r\n                if (this.player.options.debug) {\r\n                    console.log(`Using ${isSmallScreen ? 'mobile' : 'desktop'} priorities (width: ${window.innerWidth}px)`);\r\n                }\r\n                \r\n                // Sort buttons by priority (highest priority last)\r\n                const sortedButtons = buttonWidths.sort((a, b) => {\r\n                    const priorityA = parseInt(a.btn.dataset[priorityAttr] || a.btn.dataset.overflowPriority || '1');\r\n                    const priorityB = parseInt(b.btn.dataset[priorityAttr] || b.btn.dataset.overflowPriority || '1');\r\n                    return priorityB - priorityA; // Higher priority = lower number = later in array\r\n                });\r\n\r\n                // Hide buttons starting with lowest priority until fits\r\n                let currentWidth = totalWidth;\r\n                let movedToOverflow = 0;\r\n\r\n                for (const {btn, width} of sortedButtons) {\r\n                    const priority = parseInt(btn.dataset[priorityAttr] || btn.dataset.overflowPriority || '1');\r\n                    const buttonLabel = btn.getAttribute('aria-label') || 'unknown';\r\n                    \r\n                    // Never hide priority 1 buttons\r\n                    if (priority === 1) {\r\n                        btn.dataset.inOverflow = 'false';\r\n                        btn.style.display = '';\r\n                        continue;\r\n                    }\r\n\r\n                    // On mobile, hide all non-priority-1 buttons (priority 2 and 3)\r\n                    // On desktop, only hide if not enough space\r\n                    const shouldHide = isSmallScreen ? (priority > 1) : (currentWidth > availableWidth);\r\n\r\n                    if (shouldHide) {\r\n                        // Move to overflow\r\n                        btn.dataset.inOverflow = 'true';\r\n                        btn.style.display = 'none';\r\n                        currentWidth -= width;\r\n                        movedToOverflow++;\r\n                        if (this.player.options.debug) {\r\n                            console.log(`  → Hiding button: ${buttonLabel} (priority ${priority}, ${isSmallScreen ? 'mobile' : 'desktop'})`);\r\n                        }\r\n                    } else {\r\n                        // Keep visible\r\n                        btn.dataset.inOverflow = 'false';\r\n                        btn.style.display = '';\r\n                    }\r\n                }\r\n\r\n                // Show overflow menu button if we moved any buttons\r\n                if (this.player.options.debug) {\r\n                    console.log('Overflow button exists?', !!this.overflowMenuButton);\r\n                }\r\n                \r\n                if (!this.overflowMenuButton) {\r\n                    console.error('Overflow menu button not found!');\r\n                    return;\r\n                }\r\n                \r\n                if (movedToOverflow > 0) {\r\n                    this.overflowMenuButton.style.display = '';\r\n                    if (this.player.options.debug) {\r\n                        console.log('Showing overflow menu button -', movedToOverflow, 'buttons moved');\r\n                    }\r\n                } else {\r\n                    this.overflowMenuButton.style.display = 'none';\r\n                    if (this.player.options.debug) {\r\n                        console.log('Hiding overflow menu button - all buttons fit');\r\n                    }\r\n                }\r\n            } else {\r\n                // No overflow needed - show all buttons\r\n                allButtons.forEach(btn => {\r\n                    btn.dataset.inOverflow = 'false';\r\n                    btn.style.display = '';\r\n                });\r\n                this.overflowMenuButton.style.display = 'none';\r\n            }\r\n        };\r\n\r\n        // Check on resize\r\n        const resizeObserver = new ResizeObserver(() => {\r\n            requestAnimationFrame(checkOverflow);\r\n        });\r\n        resizeObserver.observe(this.rightButtons);\r\n\r\n        // Check on window resize\r\n        window.addEventListener('resize', () => {\r\n            requestAnimationFrame(checkOverflow);\r\n        });\r\n\r\n        // Check on fullscreen changes (important for desktop/tablet fullscreen)\r\n        this.player.on('fullscreenchange', () => {\r\n            // Use setTimeout to ensure fullscreen state is fully updated\r\n            setTimeout(() => {\r\n                requestAnimationFrame(checkOverflow);\r\n            }, 50);\r\n        });\r\n\r\n        // Initial checks at multiple intervals to ensure layout is stable\r\n        // Some browsers need more time for font loading, CSS rendering, etc.\r\n        requestAnimationFrame(() => {\r\n            checkOverflow();\r\n            setTimeout(() => checkOverflow(), 100);\r\n            setTimeout(() => checkOverflow(), 300);\r\n            setTimeout(() => checkOverflow(), 500);\r\n        });\r\n\r\n        // Also check when fonts are loaded\r\n        if (document.fonts && document.fonts.ready) {\r\n            document.fonts.ready.then(() => {\r\n                requestAnimationFrame(checkOverflow);\r\n            });\r\n        }\r\n\r\n        // Store for cleanup\r\n        this.overflowResizeObserver = resizeObserver;\r\n    }\r\n\r\n    show() {\r\n        this.element.style.display = '';\r\n    }\r\n\r\n    hide() {\r\n        this.element.style.display = 'none';\r\n    }\r\n\r\n    /**\r\n     * Update preview video source when player source changes (for playlists)\r\n     * Also re-initializes if preview wasn't set up initially\r\n     */\r\n    updatePreviewVideoSource() {\r\n        const renderer = this.player.renderer;\r\n        if (!renderer || !renderer.media || renderer.media.tagName !== 'VIDEO') {\r\n            return;\r\n        }\r\n\r\n        // If preview wasn't initialized yet, try to initialize it now\r\n        if (!this.previewSupported && !this.previewVideo) {\r\n            this.initPreviewThumbnail();\r\n        }\r\n\r\n        if (!this.previewSupported || !this.previewVideo) {\r\n            return;\r\n        }\r\n\r\n        const mainVideo = renderer.media;\r\n        const newSrc = mainVideo.src || mainVideo.querySelector('source')?.src;\r\n        \r\n        if (newSrc && this.previewVideo.src !== newSrc) {\r\n            // Clear cache when source changes\r\n            this.previewThumbnailCache.clear();\r\n            this.previewVideoReady = false;\r\n            this.previewVideo.src = newSrc;\r\n            \r\n            // Copy crossOrigin if set\r\n            if (mainVideo.crossOrigin) {\r\n                this.previewVideo.crossOrigin = mainVideo.crossOrigin;\r\n            }\r\n            \r\n            // Wait for new source to load\r\n            this.previewVideo.addEventListener('loadedmetadata', () => {\r\n                this.previewVideoReady = true;\r\n            }, { once: true });\r\n        } else if (newSrc && !this.previewVideoReady && this.previewVideo.readyState >= 1) {\r\n            // If source is the same but video is ready, mark as ready\r\n            this.previewVideoReady = true;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Cleanup preview thumbnail resources\r\n     */\r\n    cleanupPreviewThumbnail() {\r\n        if (this.previewThumbnailTimeout) {\r\n            clearTimeout(this.previewThumbnailTimeout);\r\n            this.previewThumbnailTimeout = null;\r\n        }\r\n        \r\n        if (this.previewVideo && this.previewVideo.parentNode) {\r\n            this.previewVideo.parentNode.removeChild(this.previewVideo);\r\n            this.previewVideo = null;\r\n        }\r\n        \r\n        this.previewThumbnailCache.clear();\r\n    }\r\n\r\n    destroy() {\r\n        if (this.hideTimeout) {\r\n            clearTimeout(this.hideTimeout);\r\n        }\r\n\r\n        if (this.overflowResizeObserver) {\r\n            this.overflowResizeObserver.disconnect();\r\n        }\r\n\r\n        // Cleanup preview thumbnail resources\r\n        this.cleanupPreviewThumbnail();\r\n\r\n        if (this.element && this.element.parentNode) {\r\n            this.element.parentNode.removeChild(this.element);\r\n        }\r\n    }\r\n}\r\n\r\n", "/**\r\n * Performance Utilities\r\n */\r\n\r\n/**\r\n * Debounce function - limits how often a function can be called\r\n * @param {Function} func - Function to debounce\r\n * @param {number} wait - Wait time in milliseconds\r\n * @returns {Function} Debounced function\r\n */\r\nexport function debounce(func, wait = 100) {\r\n    let timeout;\r\n    return function executedFunction(...args) {\r\n        const later = () => {\r\n            clearTimeout(timeout);\r\n            func(...args);\r\n        };\r\n        clearTimeout(timeout);\r\n        timeout = setTimeout(later, wait);\r\n    };\r\n}\r\n\r\n/**\r\n * Throttle function - ensures function is called at most once per interval\r\n * @param {Function} func - Function to throttle\r\n * @param {number} limit - Time limit in milliseconds\r\n * @returns {Function} Throttled function\r\n */\r\nexport function throttle(func, limit = 100) {\r\n    let inThrottle;\r\n    return function executedFunction(...args) {\r\n        if (!inThrottle) {\r\n            func(...args);\r\n            inThrottle = true;\r\n            setTimeout(() => inThrottle = false, limit);\r\n        }\r\n    };\r\n}\r\n\r\n/**\r\n * Check if current viewport is mobile size\r\n * @param {number} breakpoint - Mobile breakpoint in pixels (default 768)\r\n * @returns {boolean} True if mobile\r\n */\r\nexport function isMobile(breakpoint = 768) {\r\n    return window.innerWidth < breakpoint;\r\n}\r\n\r\n/**\r\n * Request animation frame with timeout fallback\r\n * @param {Function} callback - Function to call\r\n * @param {number} timeout - Timeout in ms (default 100)\r\n */\r\nexport function rafWithTimeout(callback, timeout = 100) {\r\n    let called = false;\r\n    \r\n    const execute = () => {\r\n        if (!called) {\r\n            called = true;\r\n            callback();\r\n        }\r\n    };\r\n    \r\n    requestAnimationFrame(execute);\r\n    setTimeout(execute, timeout);\r\n}\r\n\r\n", "/**\r\n * Utility for capturing frames from video elements\r\n */\r\n\r\n/**\r\n * Capture a frame from a video element at a specific time\r\n * @param {HTMLVideoElement} video - Video element to capture from\r\n * @param {number} time - Time in seconds to capture\r\n * @param {Object} options - Options for frame capture\r\n * @param {boolean} [options.restoreState=true] - Whether to restore video state after capture\r\n * @param {number} [options.quality=0.9] - JPEG quality (0-1)\r\n * @param {number} [options.maxWidth] - Maximum width for thumbnail\r\n * @param {number} [options.maxHeight] - Maximum height for thumbnail\r\n * @returns {Promise<string|null>} Data URL of the captured frame or null if failed\r\n */\r\nexport async function captureVideoFrame(video, time, options = {}) {\r\n    if (!video || video.tagName !== 'VIDEO') {\r\n        return null;\r\n    }\r\n\r\n    const {\r\n        restoreState = true,\r\n        quality = 0.9,\r\n        maxWidth,\r\n        maxHeight\r\n    } = options;\r\n\r\n    // Save original state if we need to restore it\r\n    const wasPlaying = !video.paused;\r\n    const originalTime = video.currentTime;\r\n    const originalMuted = video.muted;\r\n\r\n    // Ensure video is muted during capture to avoid audio playback\r\n    if (restoreState) {\r\n        video.muted = true;\r\n    }\r\n\r\n    return new Promise((resolve) => {\r\n        const captureFrame = () => {\r\n            try {\r\n                // Get video dimensions\r\n                let width = video.videoWidth || 640;\r\n                let height = video.videoHeight || 360;\r\n\r\n                // Scale down if max dimensions specified\r\n                if (maxWidth && width > maxWidth) {\r\n                    const ratio = maxWidth / width;\r\n                    width = maxWidth;\r\n                    height = Math.round(height * ratio);\r\n                }\r\n                if (maxHeight && height > maxHeight) {\r\n                    const ratio = maxHeight / height;\r\n                    height = maxHeight;\r\n                    width = Math.round(width * ratio);\r\n                }\r\n\r\n                // Create canvas to capture frame\r\n                const canvas = document.createElement('canvas');\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n                \r\n                const ctx = canvas.getContext('2d');\r\n                ctx.drawImage(video, 0, 0, width, height);\r\n                \r\n                const dataURL = canvas.toDataURL('image/jpeg', quality);\r\n                \r\n                // Restore original state if needed\r\n                if (restoreState) {\r\n                    video.currentTime = originalTime;\r\n                    video.muted = originalMuted;\r\n                    if (wasPlaying && !video.paused) {\r\n                        video.play().catch(() => {});\r\n                    }\r\n                }\r\n                \r\n                resolve(dataURL);\r\n            } catch (error) {\r\n                // Restore original state on error\r\n                if (restoreState) {\r\n                    video.currentTime = originalTime;\r\n                    video.muted = originalMuted;\r\n                    if (wasPlaying && !video.paused) {\r\n                        video.play().catch(() => {});\r\n                    }\r\n                }\r\n                resolve(null);\r\n            }\r\n        };\r\n\r\n        const onSeeked = () => {\r\n            video.removeEventListener('seeked', onSeeked);\r\n            // Wait for frame to be ready (double RAF for better frame quality)\r\n            requestAnimationFrame(() => {\r\n                requestAnimationFrame(captureFrame);\r\n            });\r\n        };\r\n\r\n        // Check if video is already at the right time and ready\r\n        const timeDiff = Math.abs(video.currentTime - time);\r\n        // Need at least HAVE_METADATA (1) to know duration, but HAVE_CURRENT_DATA (2) is better for frame capture\r\n        if (timeDiff < 0.1 && video.readyState >= 2) {\r\n            // Video is already at the right position, capture immediately\r\n            captureFrame();\r\n        } else if (video.readyState >= 1) {\r\n            // Video has metadata, we can seek\r\n            video.addEventListener('seeked', onSeeked);\r\n            video.currentTime = time;\r\n        } else {\r\n            // Video not ready yet, wait for metadata first\r\n            const onLoadedMetadata = () => {\r\n                video.removeEventListener('loadedmetadata', onLoadedMetadata);\r\n                video.addEventListener('seeked', onSeeked);\r\n                video.currentTime = time;\r\n            };\r\n            video.addEventListener('loadedmetadata', onLoadedMetadata);\r\n        }\r\n    });\r\n}\r\n\r\n", "/**\n * Caption/Subtitle Manager\n */\n\nimport {DOMUtils} from '../utils/DOMUtils.js';\nimport {i18n} from '../i18n/i18n.js';\nimport {StorageManager} from '../utils/StorageManager.js';\nimport {debounce, isMobile, rafWithTimeout} from '../utils/PerformanceUtils.js';\n\nexport class CaptionManager {\n    constructor(player) {\n        this.player = player;\n        this.element = null;\n        this.tracks = [];\n        this.currentTrack = null;\n        this.currentCue = null;\n        \n        // Storage manager\n        this.storage = new StorageManager('vidply');\n        \n        // Load saved preferences\n        this.loadSavedPreferences();\n\n        this.init();\n    }\n    \n    loadSavedPreferences() {\n        const saved = this.storage.getCaptionPreferences();\n        if (saved) {\n            // Override player options with saved preferences\n            if (saved.fontSize) this.player.options.captionsFontSize = saved.fontSize;\n            if (saved.fontFamily) this.player.options.captionsFontFamily = saved.fontFamily;\n            if (saved.color) this.player.options.captionsColor = saved.color;\n            if (saved.backgroundColor) this.player.options.captionsBackgroundColor = saved.backgroundColor;\n            if (saved.opacity !== undefined) this.player.options.captionsOpacity = saved.opacity;\n        }\n    }\n    \n    saveCaptionPreferences() {\n        this.storage.saveCaptionPreferences({\n            fontSize: this.player.options.captionsFontSize,\n            fontFamily: this.player.options.captionsFontFamily,\n            color: this.player.options.captionsColor,\n            backgroundColor: this.player.options.captionsBackgroundColor,\n            opacity: this.player.options.captionsOpacity\n        });\n    }\n\n    init() {\n        this.createElement();\n        this.loadTracks();\n        this.attachEvents();\n\n        // Only enable captions via captionsDefault option if no default track was found\n        // (loadTracks() already enables tracks with the default attribute)\n        if (this.player.options.captionsDefault && this.tracks.length > 0 && !this.currentTrack) {\n            this.enable();\n        }\n    }\n\n    createElement() {\n        this.element = DOMUtils.createElement('div', {\n            className: `${this.player.options.classPrefix}-captions`,\n            attributes: {\n                'role': 'region',\n                'aria-label': i18n.t('player.captions')\n            }\n        });\n\n        // Apply caption styles\n        this.updateStyles();\n\n        // Append to videoWrapper if it exists, otherwise to container\n        const target = this.player.videoWrapper || this.player.container;\n        target.appendChild(this.element);\n    }\n\n    loadTracks() {\n        const textTracks = this.player.element.textTracks;\n        let defaultTrackIndex = -1;\n\n        for (let i = 0; i < textTracks.length; i++) {\n            const track = textTracks[i];\n\n            if (track.kind === 'subtitles' || track.kind === 'captions') {\n                // Check if this track has the default attribute\n                const trackElement = this.player.findTrackElement(track);\n                const isDefault = trackElement && trackElement.hasAttribute('default');\n                \n                this.tracks.push({\n                    track: track,\n                    language: track.language,\n                    label: track.label,\n                    kind: track.kind,\n                    index: i,\n                    isDefault: isDefault\n                });\n\n                // Set all tracks to 'hidden' mode (not 'disabled' or 'showing')\n                // 'hidden' mode loads cues and fires events, but doesn't show native captions\n                // This is important even for default tracks - we want custom caption display\n                if (track.mode === 'showing') {\n                    // If browser set it to 'showing' (e.g., for default tracks), change to 'hidden'\n                    track.mode = 'hidden';\n                } else if (track.mode === 'disabled') {\n                    // If disabled, set to 'hidden' to load cues\n                    track.mode = 'hidden';\n                } else {\n                    // Ensure it's 'hidden' (might already be, but be explicit)\n                    track.mode = 'hidden';\n                }\n                \n                if (isDefault) {\n                    defaultTrackIndex = this.tracks.length - 1;\n                }\n            }\n        }\n        \n        // If a default track was found, enable it\n        // Use a small delay to ensure tracks are ready\n        if (defaultTrackIndex >= 0) {\n            requestAnimationFrame(() => {\n                this.enable(defaultTrackIndex);\n            });\n        }\n    }\n\n    attachEvents() {\n        this.player.on('timeupdate', () => {\n            this.updateCaptions();\n        });\n\n        this.player.on('captionschange', () => {\n            this.updateStyles();\n        });\n        \n        // Debounced resize handler to avoid excessive recalculations\n        this.debouncedPositionCaptions = debounce(() => {\n            this.positionCaptionsOnMobile();\n        }, 150);\n        \n        window.addEventListener('resize', this.debouncedPositionCaptions);\n        \n        // Recalculate on fullscreen change with RAF\n        this.player.on('enterfullscreen', () => {\n            rafWithTimeout(() => this.positionCaptionsOnMobile(), 100);\n        });\n        \n        this.player.on('exitfullscreen', () => {\n            rafWithTimeout(() => this.positionCaptionsOnMobile(), 100);\n        });\n    }\n\n    enable(trackIndex = 0) {\n        if (this.tracks.length === 0) {\n            return;\n        }\n\n        // Disable current track\n        if (this.currentTrack && this.currentTrack.track) {\n            // Remove cuechange listener from old track\n            if (this.cueChangeHandler) {\n                this.currentTrack.track.removeEventListener('cuechange', this.cueChangeHandler);\n            }\n            this.currentTrack.track.mode = 'hidden';\n        }\n\n        // Enable selected track\n        const selectedTrack = this.tracks[trackIndex];\n\n        if (selectedTrack && selectedTrack.track) {\n            // Set to 'hidden' not 'showing' to prevent browser from displaying native captions\n            // We'll handle the display ourselves\n            // But we need to set mode to 'hidden' to load cues\n            selectedTrack.track.mode = 'hidden';\n            this.currentTrack = selectedTrack;\n            this.player.state.captionsEnabled = true;\n            \n            // Set lang attribute for screen readers to pronounce text correctly\n            if (selectedTrack.language) {\n                this.element.setAttribute('lang', selectedTrack.language);\n            }\n\n            // Remove any existing cuechange listener from this track\n            if (this.cueChangeHandler) {\n                selectedTrack.track.removeEventListener('cuechange', this.cueChangeHandler);\n            }\n\n            // Add event listener for cue changes\n            this.cueChangeHandler = () => {\n                this.updateCaptions();\n            };\n            selectedTrack.track.addEventListener('cuechange', this.cueChangeHandler);\n\n            // Force track to load if it's not already loaded\n            // If track is not ready, wait for it to load\n            const ensureTrackReady = () => {\n                if (selectedTrack.track.readyState < 2) {\n                    // Track not loaded yet, wait for load event\n                    const onTrackLoad = () => {\n                        selectedTrack.track.removeEventListener('load', onTrackLoad);\n                        selectedTrack.track.removeEventListener('error', onTrackLoad);\n                        // Force initial update after track loads\n                        requestAnimationFrame(() => {\n                            if (this.currentTrack && this.currentTrack.track === selectedTrack.track) {\n                                this.updateCaptions();\n                            }\n                        });\n                    };\n                    selectedTrack.track.addEventListener('load', onTrackLoad, { once: true });\n                    selectedTrack.track.addEventListener('error', onTrackLoad, { once: true });\n                } else {\n                    // Track already loaded, force initial update\n                    requestAnimationFrame(() => {\n                        if (this.currentTrack && this.currentTrack.track === selectedTrack.track) {\n                            this.updateCaptions();\n                        }\n                    });\n                }\n            };\n\n            // Use requestAnimationFrame to ensure track is ready\n            requestAnimationFrame(() => {\n                if (this.currentTrack && this.currentTrack.track === selectedTrack.track) {\n                    ensureTrackReady();\n                }\n            });\n\n            this.player.emit('captionsenabled', selectedTrack);\n        }\n    }\n\n    disable() {\n        if (this.currentTrack) {\n            this.currentTrack.track.mode = 'hidden';\n            this.currentTrack = null;\n        }\n\n        this.element.style.display = 'none';\n        this.element.innerHTML = '';\n        this.element.removeAttribute('lang');\n        this.currentCue = null;\n        this.player.state.captionsEnabled = false;\n        this.player.emit('captionsdisabled');\n    }\n\n    updateCaptions() {\n        if (!this.currentTrack || !this.currentTrack.track) {\n            return;\n        }\n\n        // Ensure track mode is set to 'hidden' (not 'disabled') to receive cue updates\n        // 'hidden' mode loads cues and fires cuechange events, but doesn't show native captions\n        // If track is 'disabled', it won't have activeCues or fire events\n        if (this.currentTrack.track.mode === 'disabled') {\n            this.currentTrack.track.mode = 'hidden';\n        }\n\n        // Ensure track is in 'hidden' mode (not 'showing') for custom caption display\n        if (this.currentTrack.track.mode === 'showing') {\n            this.currentTrack.track.mode = 'hidden';\n        }\n\n        // Check if track has cues loaded\n        if (!this.currentTrack.track.activeCues) {\n            // If no activeCues property, track might not be ready yet\n            // Try to access cues directly\n            if (this.currentTrack.track.cues && this.currentTrack.track.cues.length > 0) {\n                // Track has cues but no active ones yet - this is normal\n                // Clear any existing caption\n                if (this.currentCue) {\n                    this.element.innerHTML = '';\n                    this.element.style.display = 'none';\n                    this.currentCue = null;\n                }\n            }\n            return;\n        }\n\n        const activeCues = this.currentTrack.track.activeCues;\n        const isAudioPlayer = this.player.element.tagName.toLowerCase() === 'audio';\n\n        if (activeCues.length > 0) {\n            const cue = activeCues[0];\n\n            // Only update if the cue has changed\n            if (this.currentCue !== cue) {\n                this.currentCue = cue;\n\n                // Parse and display cue text\n                let text = cue.text;\n\n                // Handle VTT formatting\n                text = this.parseVTTFormatting(text);\n\n                // Audio players: transcript-style accumulation\n                if (isAudioPlayer) {\n                    // Remove highlight from previous active cue\n                    const existingCues = this.element.querySelectorAll(`.${this.player.options.classPrefix}-caption-cue`);\n                    existingCues.forEach(el => el.classList.remove(`${this.player.options.classPrefix}-caption-active`));\n                    \n                    // Check if this cue is already displayed\n                    const cueId = `cue-${cue.startTime}-${cue.endTime}`;\n                    let cueElement = this.element.querySelector(`[data-cue-id=\"${cueId}\"]`);\n                    \n                    if (!cueElement) {\n                        // Create new cue element\n                        cueElement = document.createElement('div');\n                        cueElement.className = `${this.player.options.classPrefix}-caption-cue`;\n                        cueElement.setAttribute('data-cue-id', cueId);\n                        cueElement.innerHTML = DOMUtils.sanitizeHTML(text);\n                        this.element.appendChild(cueElement);\n                    }\n                    \n                    // Highlight active cue\n                    cueElement.classList.add(`${this.player.options.classPrefix}-caption-active`);\n                    \n                    // Scroll to active cue smoothly - center it for better visibility\n                    requestAnimationFrame(() => {\n                        if (cueElement) {\n                            cueElement.scrollIntoView({ behavior: 'smooth', block: 'center' });\n                        }\n                    });\n                } else {\n                    // Video players: replace content as before\n                    this.element.innerHTML = DOMUtils.sanitizeHTML(text);\n                }\n\n                // Make sure it's visible when there's content\n                this.element.style.display = 'block';\n                \n                // Position captions above controls on mobile\n                this.positionCaptionsOnMobile();\n\n                this.player.emit('captionchange', cue);\n            }\n        } else if (this.currentCue) {\n            // Clear caption when no active cues (video players only)\n            if (!isAudioPlayer) {\n                this.element.innerHTML = '';\n                this.element.style.display = 'none';\n            }\n            this.currentCue = null;\n        }\n    }\n    \n    positionCaptionsOnMobile() {\n        if (!this.element || this.element.style.display === 'none') {\n            return;\n        }\n        \n        const isFullscreen = this.player.state?.fullscreen || false;\n        const mobile = isMobile();\n        \n        if (!mobile && !isFullscreen) {\n            // Reset to CSS defaults on desktop\n            this.element.style.bottom = '';\n            return;\n        }\n        \n        const controls = this.player.controlBar?.element;\n        if (!controls) {\n            return;\n        }\n        \n        // Use requestAnimationFrame to ensure layout is complete\n        requestAnimationFrame(() => {\n            if (!this.element || this.element.style.display === 'none') {\n                return;\n            }\n            \n            const controlsRect = controls.getBoundingClientRect();\n            const wrapperRect = this.player.videoWrapper.getBoundingClientRect();\n            const bottomOffset = wrapperRect.bottom - controlsRect.top + 16;\n            \n            this.element.style.bottom = `${bottomOffset}px`;\n            \n            if (this.player.options.debug) {\n                console.log('[VidPly] Caption position:', {\n                    mobile,\n                    isFullscreen,\n                    controlsHeight: controlsRect.height,\n                    bottomOffset: `${bottomOffset}px`\n                });\n            }\n        });\n    }\n\n    parseVTTFormatting(text) {\n        // Basic VTT tag support\n        text = text.replace(/<c[^>]*>(.*?)<\\/c>/g, '<span class=\"caption-class\">$1</span>');\n        text = text.replace(/<b>(.*?)<\\/b>/g, '<strong>$1</strong>');\n        text = text.replace(/<i>(.*?)<\\/i>/g, '<em>$1</em>');\n        text = text.replace(/<u>(.*?)<\\/u>/g, '<u>$1</u>');\n\n        // Voice tags\n        text = text.replace(/<v\\s+([^>]+)>(.*?)<\\/v>/g, '<span class=\"caption-voice\" data-voice=\"$1\">$2</span>');\n\n        return text;\n    }\n\n    updateStyles() {\n        if (!this.element) return;\n\n        const options = this.player.options;\n\n        this.element.style.fontSize = options.captionsFontSize;\n        this.element.style.fontFamily = options.captionsFontFamily;\n        this.element.style.color = options.captionsColor;\n        this.element.style.backgroundColor = this.hexToRgba(\n            options.captionsBackgroundColor,\n            options.captionsOpacity\n        );\n    }\n\n    hexToRgba(hex, alpha) {\n        const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n        if (result) {\n            return `rgba(${parseInt(result[1], 16)}, ${parseInt(result[2], 16)}, ${parseInt(result[3], 16)}, ${alpha})`;\n        }\n        return hex;\n    }\n\n    setCaptionStyle(property, value) {\n        switch (property) {\n            case 'fontSize':\n                this.player.options.captionsFontSize = value;\n                break;\n            case 'fontFamily':\n                this.player.options.captionsFontFamily = value;\n                break;\n            case 'color':\n                this.player.options.captionsColor = value;\n                break;\n            case 'backgroundColor':\n                this.player.options.captionsBackgroundColor = value;\n                break;\n            case 'opacity':\n                this.player.options.captionsOpacity = value;\n                break;\n        }\n\n        this.updateStyles();\n        this.saveCaptionPreferences();\n        this.player.emit('captionschange');\n    }\n\n    getAvailableTracks() {\n        return this.tracks.map((t, index) => ({\n            index,\n            language: t.language,\n            label: t.label || t.language,\n            kind: t.kind\n        }));\n    }\n\n    switchTrack(trackIndex) {\n        if (trackIndex >= 0 && trackIndex < this.tracks.length) {\n            this.disable();\n            this.enable(trackIndex);\n        }\n    }\n\n    destroy() {\n        this.disable();\n\n        if (this.element && this.element.parentNode) {\n            this.element.parentNode.removeChild(this.element);\n        }\n    }\n}\n\n", "/**\r\n * Keyboard Accessibility Manager\r\n */\r\n\r\nexport class KeyboardManager {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.shortcuts = player.options.keyboardShortcuts;\r\n    \r\n    this.init();\r\n  }\r\n\r\n  init() {\r\n    this.attachEvents();\r\n  }\r\n\r\n  attachEvents() {\r\n    // Listen for keyboard events on the player container using CAPTURE phase\r\n    // This ensures we intercept events before they reach child elements\r\n    this.player.container.addEventListener('keydown', (e) => {\r\n      this.handleKeydown(e);\r\n    }, true); // Use capture phase\r\n\r\n    // Make player container focusable\r\n    if (!this.player.container.hasAttribute('tabindex')) {\r\n      this.player.container.setAttribute('tabindex', '0');\r\n    }\r\n  }\r\n\r\n  handleKeydown(e) {\r\n    // Don't handle if target is an input element\r\n    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA' || e.target.tagName === 'SELECT') {\r\n      return;\r\n    }\r\n    \r\n    // Don't handle if focus is inside a menu (let menu handle its own keyboard navigation)\r\n    const activeElement = document.activeElement;\r\n    if (activeElement) {\r\n      const menu = activeElement.closest('.vidply-menu, [role=\"menu\"]');\r\n      if (menu) {\r\n        return; // Let the menu handle keyboard events\r\n      }\r\n      \r\n        // Don't handle if focus is on a playlist button (let playlist handle navigation)\r\n        const playlistButton = activeElement.closest('.vidply-playlist-item-button');\r\n        if (playlistButton) {\r\n          return; // Let the playlist handle keyboard events\r\n        }\r\n\r\n      // Don't steal arrow keys when the sign-language overlay is in keyboard drag/resize mode.\r\n      // DraggableResizable listens on the overlay itself, but we run in CAPTURE phase, so we must opt out here.\r\n      const signWrapper = activeElement.closest('.vidply-sign-language-wrapper');\r\n      if (signWrapper) {\r\n        const draggable = this.player.signLanguageManager?.draggable;\r\n        if (draggable?.keyboardDragMode || draggable?.keyboardResizeMode) {\r\n          return;\r\n        }\r\n      }\r\n\r\n      // Same idea for the transcript floating window (it also uses DraggableResizable).\r\n      const transcriptWindow = activeElement.closest('.vidply-transcript-window');\r\n      if (transcriptWindow) {\r\n        const draggable = this.player.transcriptManager?.draggableResizable;\r\n        if (draggable?.keyboardDragMode || draggable?.keyboardResizeMode) {\r\n          return;\r\n        }\r\n      }\r\n    }\r\n\r\n    const key = e.key;\r\n    let handled = false;\r\n\r\n    // Special handling for ESC key - exit fullscreen (especially for iOS pseudo-fullscreen)\r\n    if (key === 'Escape' && this.player.state.fullscreen) {\r\n      this.player.exitFullscreen();\r\n      e.preventDefault();\r\n      e.stopPropagation();\r\n      return;\r\n    }\r\n\r\n    // Check each shortcut category\r\n    for (const [action, keys] of Object.entries(this.shortcuts)) {\r\n      if (keys.includes(key)) {\r\n        handled = this.executeAction(action, e);\r\n        if (handled) {\r\n          e.preventDefault();\r\n          e.stopPropagation();\r\n          this.announceAction(action);\r\n          break;\r\n        }\r\n      }\r\n    }\r\n    \r\n    // Log unhandled keys for debugging (in development)\r\n    if (!handled && this.player.options.debug) {\r\n      console.log('[VidPly] Unhandled key:', e.key, 'code:', e.code, 'shiftKey:', e.shiftKey);\r\n    }\r\n  }\r\n\r\n  executeAction(action, event) {\r\n    switch (action) {\r\n      case 'play-pause':\r\n        this.player.toggle();\r\n        return true;\r\n\r\n      case 'volume-up':\r\n        this.player.setVolume(Math.min(1, this.player.state.volume + 0.1));\r\n        return true;\r\n\r\n      case 'volume-down':\r\n        this.player.setVolume(Math.max(0, this.player.state.volume - 0.1));\r\n        return true;\r\n\r\n      case 'seek-forward':\r\n        this.player.seekForward();\r\n        return true;\r\n\r\n      case 'seek-backward':\r\n        this.player.seekBackward();\r\n        return true;\r\n\r\n      case 'mute':\r\n        this.player.toggleMute();\r\n        return true;\r\n\r\n      case 'fullscreen':\r\n        this.player.toggleFullscreen();\r\n        return true;\r\n\r\n      case 'captions':\r\n        // If only one caption track, toggle on/off\r\n        // If multiple tracks, open caption menu\r\n        if (this.player.captionManager && this.player.captionManager.tracks.length > 1) {\r\n          // Get captions button from control bar\r\n          const captionsButton = this.player.controlBar && this.player.controlBar.controls.captions;\r\n          if (captionsButton) {\r\n            this.player.controlBar.showCaptionsMenu(captionsButton);\r\n          } else {\r\n            // Fallback to toggle if button doesn't exist\r\n            this.player.toggleCaptions();\r\n          }\r\n        } else {\r\n          this.player.toggleCaptions();\r\n        }\r\n        return true;\r\n\r\n      case 'caption-style-menu':\r\n        // Open caption style menu\r\n        if (this.player.controlBar && this.player.controlBar.controls.captionStyle) {\r\n          this.player.controlBar.showCaptionStyleMenu(this.player.controlBar.controls.captionStyle);\r\n          return true;\r\n        }\r\n        return false;\r\n\r\n      case 'speed-up':\r\n        this.player.setPlaybackSpeed(\r\n          Math.min(2, this.player.state.playbackSpeed + 0.25)\r\n        );\r\n        return true;\r\n\r\n      case 'speed-down':\r\n        this.player.setPlaybackSpeed(\r\n          Math.max(0.25, this.player.state.playbackSpeed - 0.25)\r\n        );\r\n        return true;\r\n\r\n      case 'speed-menu':\r\n        // Open speed menu\r\n        if (this.player.controlBar && this.player.controlBar.controls.speed) {\r\n          this.player.controlBar.showSpeedMenu(this.player.controlBar.controls.speed);\r\n          return true;\r\n        }\r\n        return false;\r\n\r\n      case 'quality-menu':\r\n        // Open quality menu\r\n        if (this.player.controlBar && this.player.controlBar.controls.quality) {\r\n          this.player.controlBar.showQualityMenu(this.player.controlBar.controls.quality);\r\n          return true;\r\n        }\r\n        return false;\r\n\r\n      case 'chapters-menu':\r\n        // Open chapters menu\r\n        if (this.player.controlBar && this.player.controlBar.controls.chapters) {\r\n          this.player.controlBar.showChaptersMenu(this.player.controlBar.controls.chapters);\r\n          return true;\r\n        }\r\n        return false;\r\n\r\n      case 'transcript-toggle':\r\n        // Toggle transcript\r\n        if (this.player.transcriptManager) {\r\n          this.player.transcriptManager.toggleTranscript();\r\n          return true;\r\n        }\r\n        return false;\r\n\r\n      default:\r\n        return false;\r\n    }\r\n  }\r\n\r\n  announceAction(action) {\r\n    if (!this.player.options.screenReaderAnnouncements) return;\r\n\r\n    let message = '';\r\n\r\n    switch (action) {\r\n      case 'play-pause':\r\n        message = this.player.state.playing ? 'Playing' : 'Paused';\r\n        break;\r\n      case 'volume-up':\r\n        message = `Volume ${Math.round(this.player.state.volume * 100)}%`;\r\n        break;\r\n      case 'volume-down':\r\n        message = `Volume ${Math.round(this.player.state.volume * 100)}%`;\r\n        break;\r\n      case 'mute':\r\n        message = this.player.state.muted ? 'Muted' : 'Unmuted';\r\n        break;\r\n      case 'fullscreen':\r\n        message = this.player.state.fullscreen ? 'Fullscreen' : 'Exit fullscreen';\r\n        break;\r\n      case 'captions':\r\n        message = this.player.state.captionsEnabled ? 'Captions on' : 'Captions off';\r\n        break;\r\n      case 'speed-up':\r\n      case 'speed-down':\r\n        message = `Speed ${this.player.state.playbackSpeed}x`;\r\n        break;\r\n    }\r\n\r\n    if (message) {\r\n      this.announce(message);\r\n    }\r\n  }\r\n\r\n  announce(message, priority = 'polite') {\r\n    // Create or get announcement element\r\n    let announcer = document.getElementById('vidply-announcer');\r\n    \r\n    if (!announcer) {\r\n      announcer = document.createElement('div');\r\n      announcer.id = 'vidply-announcer';\r\n      announcer.className = 'vidply-sr-only';\r\n      announcer.setAttribute('aria-live', priority);\r\n      announcer.setAttribute('aria-atomic', 'true');\r\n      announcer.style.cssText = `\r\n        position: absolute;\r\n        left: -10000px;\r\n        width: 1px;\r\n        height: 1px;\r\n        overflow: hidden;\r\n      `;\r\n      document.body.appendChild(announcer);\r\n    }\r\n\r\n    // Clear and set new message\r\n    announcer.textContent = '';\r\n    setTimeout(() => {\r\n      announcer.textContent = message;\r\n    }, 100);\r\n  }\r\n\r\n  updateShortcut(action, keys) {\r\n    if (Array.isArray(keys)) {\r\n      this.shortcuts[action] = keys;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    // Event listeners are automatically removed when the container is destroyed\r\n  }\r\n}\r\n\r\n", "/**\r\n * Audio Description Manager\r\n * Handles audio-described video source switching and caption track swapping\r\n */\r\n\r\nimport { CaptionManager } from '../controls/CaptionManager.js';\r\n\r\nexport class AudioDescriptionManager {\r\n    constructor(player) {\r\n        this.player = player;\r\n        \r\n        // State\r\n        this.enabled = false;\r\n        this.desiredState = false;\r\n        \r\n        // Sources\r\n        this.src = player.options.audioDescriptionSrc;\r\n        this.sourceElement = null;\r\n        this.originalSource = null;\r\n        this.captionTracks = [];\r\n    }\r\n\r\n    /**\r\n     * Initialize audio description from source elements\r\n     * Called during player initialization\r\n     */\r\n    initFromSourceElements(sourceElements, trackElements) {\r\n        // Check for source elements with audio description attributes\r\n        for (const sourceEl of sourceElements) {\r\n            const descSrc = sourceEl.getAttribute('data-desc-src');\r\n            const origSrc = sourceEl.getAttribute('data-orig-src');\r\n            \r\n            if (descSrc || origSrc) {\r\n                if (!this.sourceElement) {\r\n                    this.sourceElement = sourceEl;\r\n                }\r\n                \r\n                if (origSrc) {\r\n                    if (!this.originalSource) {\r\n                        this.originalSource = origSrc;\r\n                    }\r\n                    if (!this.player.originalSrc) {\r\n                        this.player.originalSrc = origSrc;\r\n                    }\r\n                } else {\r\n                    const currentSrcAttr = sourceEl.getAttribute('src');\r\n                    if (!this.originalSource && currentSrcAttr) {\r\n                        this.originalSource = currentSrcAttr;\r\n                    }\r\n                    if (!this.player.originalSrc && currentSrcAttr) {\r\n                        this.player.originalSrc = currentSrcAttr;\r\n                    }\r\n                }\r\n                \r\n                if (descSrc && !this.src) {\r\n                    this.src = descSrc;\r\n                }\r\n            }\r\n        }\r\n\r\n        // Check for text tracks with audio description versions\r\n        trackElements.forEach(trackEl => {\r\n            const trackKind = trackEl.getAttribute('kind');\r\n            const trackDescSrc = trackEl.getAttribute('data-desc-src');\r\n            \r\n            if ((trackKind === 'captions' || trackKind === 'subtitles' || \r\n                 trackKind === 'chapters' || trackKind === 'descriptions') && trackDescSrc) {\r\n                this.captionTracks.push({\r\n                    trackElement: trackEl,\r\n                    originalSrc: trackEl.getAttribute('src'),\r\n                    describedSrc: trackDescSrc,\r\n                    originalTrackSrc: trackEl.getAttribute('data-orig-src') || trackEl.getAttribute('src'),\r\n                    explicit: true\r\n                });\r\n                this.player.log(`Found explicit described ${trackKind} track: ${trackEl.getAttribute('src')} -> ${trackDescSrc}`);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Check if audio description is available\r\n     */\r\n    isAvailable() {\r\n        const hasSourceElementsWithDesc = this.player.sourceElements.some(\r\n            el => el.getAttribute('data-desc-src')\r\n        );\r\n        return !!(this.src || hasSourceElementsWithDesc || this.captionTracks.length > 0);\r\n    }\r\n\r\n    /**\r\n     * Enable audio description\r\n     */\r\n    async enable() {\r\n        const hasSourceElementsWithDesc = this.player.sourceElements.some(\r\n            el => el.getAttribute('data-desc-src')\r\n        );\r\n        const hasTracksWithDesc = this.captionTracks.length > 0;\r\n        \r\n        if (!this.src && !hasSourceElementsWithDesc && !hasTracksWithDesc) {\r\n            console.warn('VidPly: No audio description source, source elements, or tracks provided');\r\n            return;\r\n        }\r\n\r\n        this.desiredState = true;\r\n\r\n        // Store current state for restoration\r\n        const currentTime = this.player.state.currentTime;\r\n        const wasPlaying = this.player.state.playing;\r\n        const posterValue = this.player.element.poster || \r\n                           this.player.element.getAttribute('poster') || \r\n                           this.player.options.poster;\r\n        const shouldKeepPoster = currentTime < 0.1 && !wasPlaying;\r\n\r\n        // Get current caption text for synchronization\r\n        const currentCaptionText = this._getCurrentCaptionText();\r\n\r\n        // Switch to audio-described version\r\n        if (this.sourceElement) {\r\n            await this._enableWithSourceElement(currentTime, wasPlaying, posterValue, shouldKeepPoster, currentCaptionText);\r\n        } else {\r\n            await this._enableWithDirectSrc(currentTime, wasPlaying, posterValue, shouldKeepPoster);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Disable audio description\r\n     */\r\n    async disable() {\r\n        if (!this.player.originalSrc) {\r\n            return;\r\n        }\r\n\r\n        this.desiredState = false;\r\n\r\n        // Store current state\r\n        const currentTime = this.player.state.currentTime;\r\n        const wasPlaying = this.player.state.playing;\r\n        const posterValue = this.player.element.poster || \r\n                           this.player.element.getAttribute('poster') || \r\n                           this.player.options.poster;\r\n        const shouldKeepPoster = currentTime < 0.1 && !wasPlaying;\r\n\r\n        // Get current caption for sync\r\n        const currentCaptionText = this._getCurrentCaptionText();\r\n\r\n        if (this.sourceElement) {\r\n            await this._disableWithSourceElement(currentTime, wasPlaying, posterValue, shouldKeepPoster, currentCaptionText);\r\n        } else {\r\n            await this._disableWithDirectSrc(currentTime, wasPlaying, posterValue);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Toggle audio description\r\n     */\r\n    async toggle() {\r\n        const descriptionTrack = this.player.findTextTrack('descriptions');\r\n        const hasAudioDescriptionSrc = this.isAvailable();\r\n        \r\n        if (descriptionTrack && !hasAudioDescriptionSrc) {\r\n            // Toggle description track playback\r\n            if (descriptionTrack.mode === 'showing') {\r\n                descriptionTrack.mode = 'hidden';\r\n                this.enabled = false;\r\n                this.player.emit('audiodescriptiondisabled');\r\n            } else {\r\n                descriptionTrack.mode = 'showing';\r\n                this.enabled = true;\r\n                this.player.emit('audiodescriptionenabled');\r\n            }\r\n        } else if (descriptionTrack && hasAudioDescriptionSrc) {\r\n            // Toggle both\r\n            if (this.enabled) {\r\n                this.desiredState = false;\r\n                await this.disable();\r\n            } else {\r\n                descriptionTrack.mode = 'showing';\r\n                this.desiredState = true;\r\n                await this.enable();\r\n            }\r\n        } else if (hasAudioDescriptionSrc) {\r\n            // Toggle source\r\n            if (this.enabled) {\r\n                this.desiredState = false;\r\n                await this.disable();\r\n            } else {\r\n                this.desiredState = true;\r\n                await this.enable();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Get current caption text for synchronization\r\n     */\r\n    _getCurrentCaptionText() {\r\n        if (this.player.captionManager && \r\n            this.player.captionManager.currentTrack && \r\n            this.player.captionManager.currentCue) {\r\n            return this.player.captionManager.currentCue.text;\r\n        }\r\n        return null;\r\n    }\r\n\r\n    /**\r\n     * Validate that a track URL exists\r\n     */\r\n    async _validateTrackExists(url) {\r\n        try {\r\n            const response = await fetch(url, { method: 'HEAD' });\r\n            return response.ok;\r\n        } catch {\r\n            return false;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Swap caption tracks to described versions\r\n     */\r\n    async _swapCaptionTracks(toDescribed = true) {\r\n        if (this.captionTracks.length === 0) return [];\r\n        \r\n        const swappedTracks = [];\r\n        \r\n        const validationPromises = this.captionTracks.map(async (trackInfo) => {\r\n            if (trackInfo.trackElement && trackInfo.describedSrc) {\r\n                if (trackInfo.explicit === true) {\r\n                    try {\r\n                        const exists = await this._validateTrackExists(\r\n                            toDescribed ? trackInfo.describedSrc : trackInfo.originalSrc\r\n                        );\r\n                        return { trackInfo, exists };\r\n                    } catch {\r\n                        return { trackInfo, exists: false };\r\n                    }\r\n                }\r\n            }\r\n            return { trackInfo, exists: false };\r\n        });\r\n        \r\n        const validationResults = await Promise.all(validationPromises);\r\n        const tracksToSwap = validationResults.filter(result => result.exists);\r\n        \r\n        if (tracksToSwap.length > 0) {\r\n            // Store track modes before removing\r\n            const trackModes = new Map();\r\n            tracksToSwap.forEach(({ trackInfo }) => {\r\n                const textTrack = trackInfo.trackElement.track;\r\n                if (textTrack) {\r\n                    trackModes.set(trackInfo, {\r\n                        wasShowing: textTrack.mode === 'showing',\r\n                        wasHidden: textTrack.mode === 'hidden'\r\n                    });\r\n                } else {\r\n                    trackModes.set(trackInfo, { wasShowing: false, wasHidden: false });\r\n                }\r\n            });\r\n            \r\n            // Store track info and remove\r\n            const tracksToReadd = tracksToSwap.map(({ trackInfo }) => {\r\n                const attributes = {};\r\n                Array.from(trackInfo.trackElement.attributes).forEach(attr => {\r\n                    attributes[attr.name] = attr.value;\r\n                });\r\n                \r\n                const result = {\r\n                    trackInfo,\r\n                    oldSrc: trackInfo.trackElement.getAttribute('src'),\r\n                    parent: trackInfo.trackElement.parentNode,\r\n                    nextSibling: trackInfo.trackElement.nextSibling,\r\n                    attributes\r\n                };\r\n                \r\n                trackInfo.trackElement.remove();\r\n                return result;\r\n            });\r\n            \r\n            // Force browser to process removal\r\n            this.player.element.load();\r\n            \r\n            // Re-add tracks with new src\r\n            await new Promise(resolve => {\r\n                setTimeout(() => {\r\n                    tracksToReadd.forEach(({ trackInfo, parent, nextSibling, attributes }) => {\r\n                        swappedTracks.push(trackInfo);\r\n                        \r\n                        const newTrackElement = document.createElement('track');\r\n                        const newSrc = toDescribed ? trackInfo.describedSrc : trackInfo.originalSrc;\r\n                        newTrackElement.setAttribute('src', newSrc);\r\n                        \r\n                        Object.keys(attributes).forEach(attrName => {\r\n                            if (attrName !== 'src' && attrName !== 'data-desc-src') {\r\n                                newTrackElement.setAttribute(attrName, attributes[attrName]);\r\n                            }\r\n                        });\r\n                        \r\n                        // Use the player's video element as parent if the original parent is null\r\n                        const targetParent = parent || this.player.element;\r\n                        \r\n                        if (nextSibling && nextSibling.parentNode) {\r\n                            targetParent.insertBefore(newTrackElement, nextSibling);\r\n                        } else {\r\n                            targetParent.appendChild(newTrackElement);\r\n                        }\r\n                        \r\n                        trackInfo.trackElement = newTrackElement;\r\n                    });\r\n                    \r\n                    this.player.invalidateTrackCache();\r\n                    \r\n                    // Setup new tracks\r\n                    const setupNewTracks = () => {\r\n                        this.player.setManagedTimeout(() => {\r\n                            swappedTracks.forEach((trackInfo) => {\r\n                                const newTextTrack = trackInfo.trackElement.track;\r\n                                if (newTextTrack) {\r\n                                    const modeInfo = trackModes.get(trackInfo) || { wasShowing: false, wasHidden: false };\r\n                                    newTextTrack.mode = 'hidden';\r\n                                    \r\n                                    const restoreMode = () => {\r\n                                        if (modeInfo.wasShowing || modeInfo.wasHidden) {\r\n                                            newTextTrack.mode = 'hidden';\r\n                                        } else {\r\n                                            newTextTrack.mode = 'disabled';\r\n                                        }\r\n                                    };\r\n                                    \r\n                                    if (newTextTrack.readyState >= 2) {\r\n                                        restoreMode();\r\n                                    } else {\r\n                                        newTextTrack.addEventListener('load', restoreMode, { once: true });\r\n                                        newTextTrack.addEventListener('error', restoreMode, { once: true });\r\n                                    }\r\n                                }\r\n                            });\r\n                        }, 300);\r\n                    };\r\n                    \r\n                    if (this.player.element.readyState >= 1) {\r\n                        setTimeout(setupNewTracks, 200);\r\n                    } else {\r\n                        this.player.element.addEventListener('loadedmetadata', setupNewTracks, { once: true });\r\n                        setTimeout(setupNewTracks, 2000);\r\n                    }\r\n                    \r\n                    resolve();\r\n                }, 100);\r\n            });\r\n        }\r\n        \r\n        return swappedTracks;\r\n    }\r\n\r\n    /**\r\n     * Update source elements to described versions\r\n     */\r\n    _updateSourceElements(toDescribed = true) {\r\n        const sourceElements = this.player.sourceElements;\r\n        const sourcesToUpdate = [];\r\n        \r\n        sourceElements.forEach((sourceEl) => {\r\n            const descSrcAttr = sourceEl.getAttribute('data-desc-src');\r\n            const currentSrc = sourceEl.getAttribute('src');\r\n            \r\n            if (descSrcAttr) {\r\n                const type = sourceEl.getAttribute('type');\r\n                let origSrc = sourceEl.getAttribute('data-orig-src') || currentSrc;\r\n                \r\n                sourcesToUpdate.push({\r\n                    src: toDescribed ? descSrcAttr : origSrc,\r\n                    type,\r\n                    origSrc,\r\n                    descSrc: descSrcAttr\r\n                });\r\n            } else {\r\n                sourcesToUpdate.push({\r\n                    src: sourceEl.getAttribute('src'),\r\n                    type: sourceEl.getAttribute('type'),\r\n                    origSrc: null,\r\n                    descSrc: null\r\n                });\r\n            }\r\n        });\r\n        \r\n        // Remove src attribute if present\r\n        if (this.player.element.hasAttribute('src')) {\r\n            this.player.element.removeAttribute('src');\r\n        }\r\n        \r\n        // Remove all source elements\r\n        sourceElements.forEach(sourceEl => sourceEl.remove());\r\n        \r\n        // Re-add with updated src\r\n        sourcesToUpdate.forEach(sourceInfo => {\r\n            const newSource = document.createElement('source');\r\n            newSource.setAttribute('src', sourceInfo.src);\r\n            if (sourceInfo.type) {\r\n                newSource.setAttribute('type', sourceInfo.type);\r\n            }\r\n            if (sourceInfo.origSrc) {\r\n                newSource.setAttribute('data-orig-src', sourceInfo.origSrc);\r\n            }\r\n            if (sourceInfo.descSrc) {\r\n                newSource.setAttribute('data-desc-src', sourceInfo.descSrc);\r\n            }\r\n            \r\n            const firstTrack = this.player.element.querySelector('track');\r\n            if (firstTrack) {\r\n                this.player.element.insertBefore(newSource, firstTrack);\r\n            } else {\r\n                this.player.element.appendChild(newSource);\r\n            }\r\n        });\r\n        \r\n        this.player._sourceElementsDirty = true;\r\n        this.player._sourceElementsCache = null;\r\n    }\r\n\r\n    /**\r\n     * Wait for media to be ready\r\n     */\r\n    async _waitForMediaReady(needSeek = false) {\r\n        // Wait for metadata\r\n        await new Promise((resolve) => {\r\n            if (this.player.element.readyState >= 1) {\r\n                resolve();\r\n            } else {\r\n                const onLoad = () => {\r\n                    this.player.element.removeEventListener('loadedmetadata', onLoad);\r\n                    resolve();\r\n                };\r\n                this.player.element.addEventListener('loadedmetadata', onLoad);\r\n            }\r\n        });\r\n        \r\n        // Wait for tracks\r\n        await new Promise(resolve => setTimeout(resolve, 300));\r\n        \r\n        // Wait for playback if needed\r\n        if (needSeek) {\r\n            await new Promise((resolve) => {\r\n                if (this.player.element.readyState >= 3) {\r\n                    resolve();\r\n                } else {\r\n                    const onCanPlay = () => {\r\n                        this.player.element.removeEventListener('canplay', onCanPlay);\r\n                        this.player.element.removeEventListener('canplaythrough', onCanPlay);\r\n                        resolve();\r\n                    };\r\n                    this.player.element.addEventListener('canplay', onCanPlay, { once: true });\r\n                    this.player.element.addEventListener('canplaythrough', onCanPlay, { once: true });\r\n                    setTimeout(() => {\r\n                        this.player.element.removeEventListener('canplay', onCanPlay);\r\n                        this.player.element.removeEventListener('canplaythrough', onCanPlay);\r\n                        resolve();\r\n                    }, 3000);\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Restore playback state after source change\r\n     */\r\n    async _restorePlaybackState(currentTime, wasPlaying, shouldKeepPoster, currentCaptionText) {\r\n        // Try to find matching caption for sync\r\n        let syncTime = currentTime;\r\n        if (currentCaptionText && this.player.captionManager && this.player.captionManager.tracks.length > 0) {\r\n            await new Promise(resolve => setTimeout(resolve, 500));\r\n            const matchingTime = this.player.findMatchingCaptionTime(\r\n                currentCaptionText, \r\n                this.player.captionManager.tracks\r\n            );\r\n            if (matchingTime !== null) {\r\n                syncTime = matchingTime;\r\n                if (this.player.options.debug) {\r\n                    this.player.log(`[VidPly] Syncing via caption: ${currentTime}s -> ${syncTime}s`);\r\n                }\r\n            }\r\n        }\r\n        \r\n        // Seek\r\n        if (syncTime > 0) {\r\n            this.player.seek(syncTime);\r\n            await new Promise(resolve => setTimeout(resolve, 100));\r\n        }\r\n        \r\n        // Play/pause\r\n        if (wasPlaying) {\r\n            await this.player.play();\r\n            this.player.setManagedTimeout(() => {\r\n                this.player.hidePosterOverlay();\r\n            }, 100);\r\n        } else {\r\n            this.player.pause();\r\n            if (!shouldKeepPoster) {\r\n                this.player.hidePosterOverlay();\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Enable with source element method\r\n     */\r\n    async _enableWithSourceElement(currentTime, wasPlaying, posterValue, shouldKeepPoster, currentCaptionText) {\r\n        // Swap caption tracks\r\n        await this._swapCaptionTracks(true);\r\n        \r\n        // Update source elements\r\n        this._updateSourceElements(true);\r\n        \r\n        // Preserve poster\r\n        if (posterValue && this.player.element.tagName === 'VIDEO') {\r\n            this.player.element.poster = posterValue;\r\n        }\r\n        \r\n        // Reload\r\n        this.player.element.load();\r\n        \r\n        // Wait for ready\r\n        await this._waitForMediaReady(currentTime > 0 || wasPlaying);\r\n        \r\n        // Restore playback\r\n        await this._restorePlaybackState(currentTime, wasPlaying, shouldKeepPoster, currentCaptionText);\r\n        \r\n        // Update state\r\n        if (!this.desiredState) return;\r\n        this.enabled = true;\r\n        this.player.state.audioDescriptionEnabled = true;\r\n        this.player.emit('audiodescriptionenabled');\r\n        \r\n        // Reload transcript if visible\r\n        this._reloadTranscript();\r\n    }\r\n\r\n    /**\r\n     * Enable with direct src method\r\n     */\r\n    async _enableWithDirectSrc(currentTime, wasPlaying, posterValue, shouldKeepPoster) {\r\n        // Swap caption tracks\r\n        await this._swapCaptionTracks(true);\r\n        \r\n        // Set poster\r\n        if (posterValue && this.player.element.tagName === 'VIDEO') {\r\n            this.player.element.poster = posterValue;\r\n        }\r\n        \r\n        // Set src\r\n        this.player.element.src = this.src;\r\n        \r\n        // Wait and restore\r\n        await this._waitForMediaReady(currentTime > 0 || wasPlaying);\r\n        \r\n        if (currentTime > 0) {\r\n            this.player.seek(currentTime);\r\n            await new Promise(resolve => setTimeout(resolve, 100));\r\n        }\r\n        \r\n        if (wasPlaying) {\r\n            await this.player.play();\r\n        } else {\r\n            this.player.pause();\r\n            if (!shouldKeepPoster) {\r\n                this.player.hidePosterOverlay();\r\n            }\r\n        }\r\n        \r\n        if (!this.desiredState) return;\r\n        this.enabled = true;\r\n        this.player.state.audioDescriptionEnabled = true;\r\n        this.player.emit('audiodescriptionenabled');\r\n        \r\n        // Reload transcript if visible\r\n        this._reloadTranscript();\r\n    }\r\n\r\n    /**\r\n     * Disable with source element method\r\n     */\r\n    async _disableWithSourceElement(currentTime, wasPlaying, posterValue, shouldKeepPoster, currentCaptionText) {\r\n        // Swap caption tracks back\r\n        await this._swapCaptionTracks(false);\r\n        \r\n        // Update source elements\r\n        this._updateSourceElements(false);\r\n        \r\n        // Preserve poster\r\n        if (posterValue && this.player.element.tagName === 'VIDEO') {\r\n            this.player.element.poster = posterValue;\r\n        }\r\n        \r\n        // Reload\r\n        this.player.element.load();\r\n        this.player.invalidateTrackCache();\r\n        \r\n        // Wait for ready\r\n        await this._waitForMediaReady(currentTime > 0 || wasPlaying);\r\n        \r\n        // Restore playback\r\n        await this._restorePlaybackState(currentTime, wasPlaying, shouldKeepPoster, currentCaptionText);\r\n        \r\n        // Reinitialize caption manager\r\n        if (this.player.captionManager) {\r\n            this.player.captionManager.destroy();\r\n            this.player.captionManager = new CaptionManager(this.player);\r\n        }\r\n        \r\n        // Update state\r\n        if (this.desiredState) return;\r\n        this.enabled = false;\r\n        this.player.state.audioDescriptionEnabled = false;\r\n        this.player.emit('audiodescriptiondisabled');\r\n        \r\n        // Reload transcript if visible\r\n        this._reloadTranscript();\r\n    }\r\n\r\n    /**\r\n     * Disable with direct src method\r\n     */\r\n    async _disableWithDirectSrc(currentTime, wasPlaying, posterValue) {\r\n        // Swap caption tracks back\r\n        await this._swapCaptionTracks(false);\r\n        \r\n        // Set poster\r\n        if (posterValue && this.player.element.tagName === 'VIDEO') {\r\n            this.player.element.poster = posterValue;\r\n        }\r\n        \r\n        // Restore original src\r\n        const originalSrcToUse = this.originalSource || this.player.originalSrc;\r\n        this.player.element.src = originalSrcToUse;\r\n        this.player.element.load();\r\n        \r\n        // Wait and restore\r\n        await this._waitForMediaReady(currentTime > 0 || wasPlaying);\r\n        \r\n        if (currentTime > 0) {\r\n            this.player.seek(currentTime);\r\n        }\r\n        \r\n        if (wasPlaying) {\r\n            await this.player.play();\r\n        }\r\n        \r\n        if (this.desiredState) return;\r\n        this.enabled = false;\r\n        this.player.state.audioDescriptionEnabled = false;\r\n        this.player.emit('audiodescriptiondisabled');\r\n        \r\n        // Reload transcript if visible\r\n        this._reloadTranscript();\r\n    }\r\n\r\n    /**\r\n     * Reload transcript after audio description state change\r\n     */\r\n    _reloadTranscript() {\r\n        if (this.player.transcriptManager && this.player.transcriptManager.isVisible) {\r\n            // Wait for tracks to load after source swap\r\n            this.player.setManagedTimeout(() => {\r\n                if (this.player.transcriptManager && this.player.transcriptManager.loadTranscriptData) {\r\n                    this.player.transcriptManager.loadTranscriptData();\r\n                }\r\n            }, 800);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Update sources (called when playlist changes)\r\n     */\r\n    updateSources(audioDescriptionSrc) {\r\n        this.src = audioDescriptionSrc || null;\r\n        // Reset state for new playlist item\r\n        this.enabled = false;\r\n        this.desiredState = false;\r\n        this.sourceElement = null;\r\n        this.originalSource = null;\r\n        this.captionTracks = [];\r\n    }\r\n    \r\n    /**\r\n     * Reinitialize from current player elements (called after playlist loads new tracks)\r\n     */\r\n    reinitialize() {\r\n        this.player.invalidateTrackCache();\r\n        this.initFromSourceElements(this.player.sourceElements, this.player.trackElements);\r\n    }\r\n\r\n    /**\r\n     * Cleanup\r\n     */\r\n    destroy() {\r\n        this.enabled = false;\r\n        this.desiredState = false;\r\n        this.captionTracks = [];\r\n        this.sourceElement = null;\r\n        this.originalSource = null;\r\n    }\r\n}\r\n\r\n", "/**\n * Sign Language Video Manager\n * Handles picture-in-picture sign language video overlay\n */\n\nimport { DOMUtils } from '../utils/DOMUtils.js';\nimport { createIconElement } from '../icons/Icons.js';\nimport { i18n } from '../i18n/i18n.js';\nimport { DraggableResizable } from '../utils/DraggableResizable.js';\nimport { createMenuItem, attachMenuKeyboardNavigation, focusFirstMenuItem } from '../utils/MenuUtils.js';\nimport { createLabeledSelect, preventDragOnElement } from '../utils/FormUtils.js';\n\nexport class SignLanguageManager {\n    constructor(player) {\n        this.player = player;\n        \n        // Sources\n        this.src = player.options.signLanguageSrc;\n        this.sources = player.options.signLanguageSources || {};\n        this.currentLanguage = null;\n        this.desiredPosition = player.options.signLanguagePosition || 'bottom-right';\n        \n        // DOM elements\n        this.wrapper = null;\n        this.header = null;\n        this.video = null;\n        this.selector = null;\n        this.settingsButton = null;\n        this.settingsMenu = null;\n        this.resizeHandles = [];\n        \n        // State\n        this.enabled = false;\n        this.inMainView = false; // sign language shown in main video (src swap, like audio description)\n        this.mainViewOriginalSrc = null;\n        this.mainViewOriginalSources = null;\n        this._mainViewUsingSourceSwap = false;\n        this._mainViewMutedBefore = false;\n        this.settingsMenuVisible = false;\n        this.settingsMenuJustOpened = false;\n        this.documentClickHandlerAdded = false;\n        \n        // Handlers\n        this.handlers = null;\n        this.settingsHandlers = null;\n        this.interactionHandlers = null;\n        this.draggable = null;\n        this.documentClickHandler = null;\n        this.settingsMenuKeyHandler = null;\n        this.customKeyHandler = null;\n        \n        // Menu option references\n        this.dragOptionButton = null;\n        this.dragOptionText = null;\n        this.resizeOptionButton = null;\n        this.resizeOptionText = null;\n    }\n\n    /**\n     * Check if sign language is available\n     */\n    isAvailable() {\n        return Object.keys(this.sources).length > 0 || !!this.src;\n    }\n\n    /**\n     * Enable sign language video\n     */\n    enable() {\n        const hasMultipleSources = Object.keys(this.sources).length > 0;\n        const hasSingleSource = !!this.src;\n        \n        if (!hasMultipleSources && !hasSingleSource) {\n            console.warn('No sign language video source provided');\n            return;\n        }\n\n        if (this.wrapper) {\n            // Already exists, just show it\n            this.wrapper.style.display = 'block';\n            this.enabled = true;\n            this.player.state.signLanguageEnabled = true;\n            this.player.emit('signlanguageenabled');\n            \n            // Focus settings button\n            this.player.setManagedTimeout(() => {\n                if (this.settingsButton && document.contains(this.settingsButton)) {\n                    this.settingsButton.focus({ preventScroll: true });\n                }\n            }, 150);\n            return;\n        }\n        \n        // Determine initial language\n        let initialLang = null;\n        let initialSrc = null;\n        \n        if (hasMultipleSources) {\n            initialLang = this._determineInitialLanguage();\n            initialSrc = this.sources[initialLang];\n            this.currentLanguage = initialLang;\n        } else {\n            initialSrc = this.src;\n        }\n\n        // Create UI\n        this._createWrapper();\n        this._createHeader(hasMultipleSources, initialLang);\n        this._createVideo(initialSrc);\n        this._createResizeHandles();\n        \n        // Assemble\n        this.wrapper.appendChild(this.header);\n        this.wrapper.appendChild(this.video);\n        this.resizeHandles.forEach(handle => this.wrapper.appendChild(handle));\n        \n        // Set initial size\n        this._applyInitialSize();\n        \n        // Add to container\n        this.player.container.appendChild(this.wrapper);\n        \n        // Position\n        requestAnimationFrame(() => {\n            this.constrainPosition();\n        });\n        \n        // Sync with main video\n        this.video.currentTime = this.player.state.currentTime;\n        if (!this.player.state.paused) {\n            this.video.play();\n        }\n        \n        // Setup interaction\n        this._setupInteraction();\n        \n        // Setup event handlers\n        this._setupEventHandlers(hasMultipleSources);\n        \n        this.enabled = true;\n        this.player.state.signLanguageEnabled = true;\n        this.player.emit('signlanguageenabled');\n        \n        // Focus settings button\n        this.player.setManagedTimeout(() => {\n            if (this.settingsButton && document.contains(this.settingsButton)) {\n                this.settingsButton.focus({ preventScroll: true });\n            }\n        }, 150);\n    }\n\n    /**\n     * Disable sign language video\n     */\n    disable() {\n        if (this.settingsMenuVisible) {\n            this.hideSettingsMenu({ focusButton: false });\n        }\n        \n        if (this.wrapper) {\n            this.wrapper.style.display = 'none';\n        }\n        this.enabled = false;\n        this.player.state.signLanguageEnabled = false;\n        this.player.emit('signlanguagedisabled');\n    }\n\n    /**\n     * Toggle sign language video\n     */\n    toggle() {\n        if (this.enabled) {\n            this.disable();\n        } else {\n            this.enable();\n        }\n    }\n\n    /**\n     * Enable sign language in main view: replace main video src with sign language URL (like audio description).\n     * Same video element, different URL; no overlay.\n     */\n    async enableInMainView() {\n        const hasMultipleSources = Object.keys(this.sources).length > 0;\n        const hasSingleSource = !!this.src;\n        if (!hasMultipleSources && !hasSingleSource) return;\n        if (!this.player.element || this.player.element.tagName !== 'VIDEO') return;\n        if (this.inMainView) return;\n\n        let signSrc;\n        if (hasMultipleSources) {\n            const initialLang = this._determineInitialLanguage();\n            this.currentLanguage = initialLang;\n            signSrc = this.sources[initialLang];\n        } else {\n            signSrc = this.src;\n        }\n\n        const el = this.player.element;\n        const currentTime = this.player.state.currentTime;\n        const wasPlaying = this.player.state.playing;\n        const posterValue = el.poster || el.getAttribute('poster') || this.player.options.poster;\n        const shouldKeepPoster = currentTime < 0.1 && !wasPlaying;\n\n        const sourceElements = Array.from(el.querySelectorAll('source'));\n        const firstSource = sourceElements[0];\n        this.mainViewOriginalSrc = (el.currentSrc && el.currentSrc.length > 0)\n            ? el.currentSrc\n            : (el.src && el.src.length > 0)\n                ? el.src\n                : (firstSource && firstSource.getAttribute('src'))\n                    ? firstSource.getAttribute('src')\n                    : '';\n        this._mainViewMutedBefore = this.player.state.muted;\n\n        if (posterValue && shouldKeepPoster && el.tagName === 'VIDEO') {\n            el.poster = posterValue;\n        }\n        if (sourceElements.length > 0) {\n            this.mainViewOriginalSources = sourceElements;\n            this.mainViewOriginalSources.forEach(source => source.remove());\n            const signSource = document.createElement('source');\n            signSource.setAttribute('src', signSrc);\n            const type = this._inferVideoType(signSrc);\n            if (type) {\n                signSource.setAttribute('type', type);\n            }\n            const trackNode = el.querySelector('track');\n            if (trackNode) {\n                el.insertBefore(signSource, trackNode);\n            } else {\n                el.appendChild(signSource);\n            }\n            this._mainViewUsingSourceSwap = true;\n        } else {\n            el.src = signSrc;\n            this._mainViewUsingSourceSwap = false;\n        }\n        el.muted = true;\n        this.player.currentSource = signSrc;\n        if (typeof this.player.invalidateTrackCache === 'function') {\n            this.player.invalidateTrackCache();\n        }\n        el.load();\n\n        await this._waitForMediaReadyMainView(currentTime > 0 || wasPlaying);\n\n        if (currentTime > 0) {\n            this.player.seek(currentTime);\n            await new Promise(r => setTimeout(r, 100));\n        }\n        if (wasPlaying) {\n            await this.player.play();\n        } else {\n            this.player.pause();\n            if (!shouldKeepPoster && this.player.hidePosterOverlay) {\n                this.player.hidePosterOverlay();\n            }\n        }\n\n        this.inMainView = true;\n        this.player.state.signLanguageInMainView = true;\n        if (this.player.videoWrapper) {\n            this.player.videoWrapper.classList.add('vidply-sign-language-main-view-active');\n        }\n        this.player.emit('signlanguageinmainviewenabled');\n    }\n\n    /**\n     * Disable sign language in main view: restore main video src.\n     */\n    async disableInMainView() {\n        if (!this.inMainView) return;\n        if (!this.mainViewOriginalSrc && !this.mainViewOriginalSources) {\n            this.inMainView = false;\n            this.player.state.signLanguageInMainView = false;\n            if (this.player.videoWrapper) {\n                this.player.videoWrapper.classList.remove('vidply-sign-language-main-view-active');\n            }\n            this.player.emit('signlanguageinmainviewdisabled');\n            return;\n        }\n\n        const el = this.player.element;\n        const currentTime = this.player.state.currentTime;\n        const wasPlaying = this.player.state.playing;\n        const posterValue = el.poster || el.getAttribute('poster') || this.player.options.poster;\n\n        if (this._mainViewUsingSourceSwap && this.mainViewOriginalSources && this.mainViewOriginalSources.length > 0) {\n            Array.from(el.querySelectorAll('source')).forEach(source => source.remove());\n            const trackNode = el.querySelector('track');\n            this.mainViewOriginalSources.forEach(source => {\n                if (trackNode) {\n                    el.insertBefore(source, trackNode);\n                } else {\n                    el.appendChild(source);\n                }\n            });\n            this._mainViewUsingSourceSwap = false;\n        } else if (this.mainViewOriginalSrc) {\n            el.src = this.mainViewOriginalSrc;\n        }\n        el.muted = this._mainViewMutedBefore;\n        this.player.currentSource = this.mainViewOriginalSrc || (el.querySelector('source') && el.querySelector('source').src) || '';\n        if (typeof this.player.invalidateTrackCache === 'function') {\n            this.player.invalidateTrackCache();\n        }\n        el.load();\n\n        await this._waitForMediaReadyMainView(currentTime > 0 || wasPlaying);\n\n        if (currentTime > 0) {\n            this.player.seek(currentTime);\n        }\n        if (wasPlaying) {\n            try {\n                await this.player.play();\n            } catch (e) {\n                this.player.log?.('Sign language main view: play after restore failed', e, 'warn');\n            }\n        }\n\n        this.mainViewOriginalSrc = null;\n        this.mainViewOriginalSources = null;\n        this.inMainView = false;\n        this.player.state.signLanguageInMainView = false;\n        if (this.player.videoWrapper) {\n            this.player.videoWrapper.classList.remove('vidply-sign-language-main-view-active');\n        }\n        this.player.emit('signlanguageinmainviewdisabled');\n    }\n\n    /**\n     * Wait for media ready (like AudioDescriptionManager).\n     */\n    async _waitForMediaReadyMainView(needSeek = false) {\n        const el = this.player.element;\n        const loadedMetaPromise = new Promise((resolve) => {\n            if (el.readyState >= 1) {\n                resolve();\n                return;\n            }\n            const onLoad = () => {\n                el.removeEventListener('loadedmetadata', onLoad);\n                el.removeEventListener('error', onError);\n                resolve();\n            };\n            const onError = () => {\n                el.removeEventListener('loadedmetadata', onLoad);\n                el.removeEventListener('error', onError);\n                resolve();\n            };\n            el.addEventListener('loadedmetadata', onLoad);\n            el.addEventListener('error', onError, { once: true });\n        });\n        const timeoutPromise = new Promise(r => setTimeout(r, 10000));\n        await Promise.race([loadedMetaPromise, timeoutPromise]);\n        await new Promise(r => setTimeout(r, 300));\n        if (needSeek) {\n            await new Promise((resolve) => {\n                if (el.readyState >= 3) resolve();\n                else {\n                    const onCanPlay = () => {\n                        el.removeEventListener('canplay', onCanPlay);\n                        el.removeEventListener('canplaythrough', onCanPlay);\n                        resolve();\n                    };\n                    el.addEventListener('canplay', onCanPlay, { once: true });\n                    el.addEventListener('canplaythrough', onCanPlay, { once: true });\n                    setTimeout(() => {\n                        el.removeEventListener('canplay', onCanPlay);\n                        el.removeEventListener('canplaythrough', onCanPlay);\n                        resolve();\n                    }, 3000);\n                }\n            });\n        }\n    }\n\n    /**\n     * Toggle sign language in main view (src swap, like audio description).\n     */\n    toggleInMainView() {\n        if (this.inMainView) {\n            this.disableInMainView();\n        } else {\n            this.enableInMainView();\n        }\n    }\n\n    /**\n     * Switch to a different sign language\n     */\n    switchLanguage(langCode) {\n        if (!this.sources[langCode]) return;\n\n        this.currentLanguage = langCode;\n\n        if (this.video) {\n            const currentTime = this.video.currentTime;\n            const wasPlaying = !this.video.paused;\n            this.video.src = this.sources[langCode];\n            this.video.currentTime = currentTime;\n            if (wasPlaying) {\n                this.video.play().catch(() => {});\n            }\n        }\n\n        if (this.inMainView && this.player.element && this.player.element.tagName === 'VIDEO') {\n            const currentTime = this.player.state.currentTime;\n            const wasPlaying = this.player.state.playing;\n            if (this._mainViewUsingSourceSwap) {\n                const signSource = this.player.element.querySelector('source');\n                if (signSource) {\n                    signSource.setAttribute('src', this.sources[langCode]);\n                    const type = this._inferVideoType(this.sources[langCode]);\n                    if (type) {\n                        signSource.setAttribute('type', type);\n                    }\n                }\n            } else {\n                this.player.element.src = this.sources[langCode];\n            }\n            this.player.currentSource = this.sources[langCode];\n            if (typeof this.player.invalidateTrackCache === 'function') {\n                this.player.invalidateTrackCache();\n            }\n            this.player.element.load();\n            this._waitForMediaReadyMainView(true).then(() => {\n                if (currentTime > 0) this.player.seek(currentTime);\n                if (wasPlaying) this.player.play();\n            });\n        }\n\n        this.player.emit('signlanguagelanguagechanged', langCode);\n    }\n\n    _inferVideoType(url) {\n        if (!url) return '';\n        const cleanUrl = url.split('?')[0].toLowerCase();\n        if (cleanUrl.endsWith('.mp4')) return 'video/mp4';\n        if (cleanUrl.endsWith('.webm')) return 'video/webm';\n        if (cleanUrl.endsWith('.ogv') || cleanUrl.endsWith('.ogg')) return 'video/ogg';\n        return '';\n    }\n\n    /**\n     * Get language label\n     */\n    getLanguageLabel(langCode) {\n        const langNames = {\n            'en': 'English',\n            'de': 'Deutsch',\n            'es': 'Español',\n            'fr': 'Français',\n            'it': 'Italiano',\n            'ja': '日本語',\n            'pt': 'Português',\n            'ar': 'العربية',\n            'hi': 'हिन्दी'\n        };\n        return langNames[langCode] || langCode.toUpperCase();\n    }\n\n    /**\n     * Determine initial sign language\n     */\n    _determineInitialLanguage() {\n        // Try caption language\n        if (this.player.captionManager && this.player.captionManager.currentTrack) {\n            const captionLang = this.player.captionManager.currentTrack.language?.toLowerCase().split('-')[0];\n            if (captionLang && this.sources[captionLang]) {\n                return captionLang;\n            }\n        }\n        \n        // Try player language\n        if (this.player.options.language) {\n            const playerLang = this.player.options.language.toLowerCase().split('-')[0];\n            if (this.sources[playerLang]) {\n                return playerLang;\n            }\n        }\n        \n        // First available\n        return Object.keys(this.sources)[0];\n    }\n\n    /**\n     * Create wrapper element\n     */\n    _createWrapper() {\n        this.wrapper = document.createElement('div');\n        this.wrapper.className = 'vidply-sign-language-wrapper';\n        this.wrapper.setAttribute('tabindex', '0');\n        this.wrapper.setAttribute('aria-label', i18n.t('player.signLanguageDragResize'));\n    }\n\n    /**\n     * Create header element\n     */\n    _createHeader(hasMultipleSources, initialLang) {\n        const classPrefix = this.player.options.classPrefix;\n        \n        this.header = DOMUtils.createElement('div', {\n            className: `${classPrefix}-sign-language-header`,\n            attributes: { 'tabindex': '0' }\n        });\n\n        const headerLeft = DOMUtils.createElement('div', {\n            className: `${classPrefix}-sign-language-header-left`\n        });\n\n        const title = DOMUtils.createElement('h3', {\n            textContent: i18n.t('player.signLanguageVideo')\n        });\n\n        // Settings button\n        this._createSettingsButton(headerLeft);\n\n        // Language selector\n        if (hasMultipleSources) {\n            this._createLanguageSelector(headerLeft, initialLang);\n        }\n\n        headerLeft.appendChild(title);\n        \n        // Close button\n        const closeButton = this._createCloseButton();\n        \n        this.header.appendChild(headerLeft);\n        this.header.appendChild(closeButton);\n        \n        // Initialize settings menu state\n        this.settingsMenuVisible = false;\n        this.settingsMenu = null;\n        this.settingsMenuJustOpened = false;\n    }\n\n    /**\n     * Create settings button\n     */\n    _createSettingsButton(container) {\n        const classPrefix = this.player.options.classPrefix;\n        const ariaLabel = i18n.t('player.signLanguageSettings');\n        \n        this.settingsButton = DOMUtils.createElement('button', {\n            className: `${classPrefix}-sign-language-settings`,\n            attributes: {\n                'type': 'button',\n                'aria-label': ariaLabel,\n                'aria-expanded': 'false'\n            }\n        });\n        this.settingsButton.appendChild(createIconElement('settings'));\n        DOMUtils.attachTooltip(this.settingsButton, ariaLabel, classPrefix);\n        \n        this.settingsHandlers = {\n            click: (e) => {\n                e.preventDefault();\n                e.stopPropagation();\n                if (this.documentClickHandler) {\n                    this.settingsMenuJustOpened = true;\n                    setTimeout(() => { this.settingsMenuJustOpened = false; }, 100);\n                }\n                if (this.settingsMenuVisible) {\n                    this.hideSettingsMenu();\n                } else {\n                    this.showSettingsMenu();\n                }\n            },\n            keydown: (e) => {\n                if (e.key === 'd' || e.key === 'D') {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.toggleKeyboardDragMode();\n                } else if (e.key === 'r' || e.key === 'R') {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.toggleResizeMode();\n                } else if (e.key === 'Escape' && this.settingsMenuVisible) {\n                    e.preventDefault();\n                    e.stopPropagation();\n                    this.hideSettingsMenu();\n                }\n            }\n        };\n        \n        this.settingsButton.addEventListener('click', this.settingsHandlers.click);\n        this.settingsButton.addEventListener('keydown', this.settingsHandlers.keydown);\n        container.appendChild(this.settingsButton);\n    }\n\n    /**\n     * Create language selector\n     */\n    _createLanguageSelector(container, initialLang) {\n        const classPrefix = this.player.options.classPrefix;\n        const selectId = `${classPrefix}-sign-language-select-${Date.now()}`;\n        \n        const options = Object.keys(this.sources).map(langCode => ({\n            value: langCode,\n            text: this.getLanguageLabel(langCode),\n            selected: langCode === initialLang\n        }));\n        \n        const { label, select } = createLabeledSelect({\n            classPrefix,\n            labelClass: `${classPrefix}-sign-language-label`,\n            selectClass: `${classPrefix}-sign-language-select`,\n            labelText: 'settings.language',\n            selectId,\n            options,\n            onChange: (e) => {\n                e.stopPropagation();\n                this.switchLanguage(e.target.value);\n            }\n        });\n        \n        this.selector = select;\n        \n        const selectorWrapper = DOMUtils.createElement('div', {\n            className: `${classPrefix}-sign-language-selector-wrapper`\n        });\n        selectorWrapper.appendChild(label);\n        selectorWrapper.appendChild(this.selector);\n        \n        preventDragOnElement(selectorWrapper);\n        container.appendChild(selectorWrapper);\n    }\n\n    /**\n     * Create close button\n     */\n    _createCloseButton() {\n        const classPrefix = this.player.options.classPrefix;\n        const ariaLabel = i18n.t('player.closeSignLanguage');\n        \n        const closeButton = DOMUtils.createElement('button', {\n            className: `${classPrefix}-sign-language-close`,\n            attributes: {\n                'type': 'button',\n                'aria-label': ariaLabel\n            }\n        });\n        closeButton.appendChild(createIconElement('close'));\n        DOMUtils.attachTooltip(closeButton, ariaLabel, classPrefix);\n        \n        closeButton.addEventListener('click', () => {\n            this.disable();\n            if (this.player.controlBar?.controls?.signLanguage) {\n                setTimeout(() => {\n                    this.player.controlBar.controls.signLanguage.focus({ preventScroll: true });\n                }, 0);\n            }\n        });\n        \n        return closeButton;\n    }\n\n    /**\n     * Create video element\n     */\n    _createVideo(src) {\n        this.video = document.createElement('video');\n        this.video.className = 'vidply-sign-language-video';\n        this.video.src = src;\n        this.video.setAttribute('aria-label', i18n.t('player.signLanguage'));\n        this.video.muted = true;\n        this.video.setAttribute('playsinline', '');\n    }\n\n    /**\n     * Create resize handles\n     */\n    _createResizeHandles() {\n        const classPrefix = this.player.options.classPrefix;\n        \n        this.resizeHandles = ['n', 's', 'e', 'w', 'ne', 'nw', 'se', 'sw'].map(dir => {\n            const handle = DOMUtils.createElement('div', {\n                className: `${classPrefix}-sign-resize-handle ${classPrefix}-sign-resize-${dir}`,\n                attributes: {\n                    'data-direction': dir,\n                    'data-vidply-managed-resize': 'true',\n                    'aria-hidden': 'true'\n                }\n            });\n            handle.style.display = 'none';\n            return handle;\n        });\n    }\n\n    /**\n     * Apply initial size\n     */\n    _applyInitialSize() {\n        const saved = this.player.storage.getSignLanguagePreferences();\n        if (saved?.size?.width) {\n            this.wrapper.style.width = saved.size.width;\n        } else {\n            this.wrapper.style.width = '280px';\n        }\n        this.wrapper.style.height = 'auto';\n    }\n\n    /**\n     * Setup interaction (drag and resize)\n     */\n    _setupInteraction() {\n        const isMobile = window.innerWidth < 768;\n        const isFullscreen = this.player.state.fullscreen;\n\n        // Historically, drag/resize was disabled on mobile unless fullscreen to avoid scroll conflicts.\n        // Now that we support touch/pointer dragging with proper `touch-action` handling, enable it\n        // by default on iOS/Android as well. Allow opting out via option.\n        if (isMobile && !isFullscreen && this.player?.options?.signLanguageDragOnMobile === false) {\n            if (this.draggable) {\n                this.draggable.destroy();\n                this.draggable = null;\n            }\n            return;\n        }\n\n        if (this.draggable) return;\n\n        const classPrefix = this.player.options.classPrefix;\n        \n        this.draggable = new DraggableResizable(this.wrapper, {\n            // Allow dragging from anywhere on the sign-language window (better for touch).\n            // We still block dragging when interacting with controls via `onDragStart` below.\n            dragHandle: this.wrapper,\n            resizeHandles: this.resizeHandles,\n            constrainToViewport: true,\n            maintainAspectRatio: true,\n            minWidth: 150,\n            minHeight: 100,\n            classPrefix: `${classPrefix}-sign`,\n            keyboardDragKey: 'd',\n            keyboardResizeKey: 'r',\n            keyboardStep: 10,\n            keyboardStepLarge: 50,\n            pointerResizeIndicatorText: i18n.t('player.signLanguageResizeActive'),\n            onPointerResizeToggle: (enabled) => {\n                this.resizeHandles.forEach(handle => {\n                    handle.style.display = enabled ? 'block' : 'none';\n                });\n            },\n            onDragStart: (e) => {\n                if (e.target.closest(`.${classPrefix}-sign-language-close`) ||\n                    e.target.closest(`.${classPrefix}-sign-language-settings`) ||\n                    e.target.closest(`.${classPrefix}-sign-language-select`) ||\n                    e.target.closest(`.${classPrefix}-sign-language-label`) ||\n                    e.target.closest(`.${classPrefix}-sign-language-settings-menu`)) {\n                    return false;\n                }\n                return true;\n            }\n        });\n\n        this._setupCustomKeyHandler();\n        \n        this.interactionHandlers = {\n            draggable: this.draggable,\n            customKeyHandler: this.customKeyHandler\n        };\n    }\n\n    /**\n     * Setup custom keyboard handler\n     */\n    _setupCustomKeyHandler() {\n        this.customKeyHandler = (e) => {\n            const key = e.key.toLowerCase();\n            \n            if (this.settingsMenuVisible) return;\n            \n            if (key === 'home') {\n                e.preventDefault();\n                e.stopPropagation();\n                if (this.draggable) {\n                    if (this.draggable.pointerResizeMode) {\n                        this.draggable.disablePointerResizeMode();\n                    }\n                    this.draggable.manuallyPositioned = false;\n                    this.constrainPosition();\n                }\n                return;\n            }\n            \n            if (key === 'r') {\n                e.preventDefault();\n                e.stopPropagation();\n                if (this.toggleResizeMode()) {\n                    this.wrapper.focus({ preventScroll: true });\n                }\n                return;\n            }\n            \n            if (key === 'escape') {\n                e.preventDefault();\n                e.stopPropagation();\n                if (this.draggable?.pointerResizeMode) {\n                    this.draggable.disablePointerResizeMode();\n                    return;\n                }\n                if (this.draggable?.keyboardDragMode) {\n                    this.draggable.disableKeyboardDragMode();\n                    return;\n                }\n                this.disable();\n                if (this.player.controlBar?.controls?.signLanguage) {\n                    setTimeout(() => {\n                        this.player.controlBar.controls.signLanguage.focus({ preventScroll: true });\n                    }, 0);\n                }\n            }\n        };\n        \n        this.wrapper.addEventListener('keydown', this.customKeyHandler);\n    }\n\n    /**\n     * Setup event handlers\n     */\n    _setupEventHandlers(hasMultipleSources) {\n        this.handlers = {\n            play: () => { if (this.video) this.video.play(); },\n            pause: () => { if (this.video) this.video.pause(); },\n            timeupdate: () => {\n                if (this.video && Math.abs(this.video.currentTime - this.player.state.currentTime) > 0.5) {\n                    this.video.currentTime = this.player.state.currentTime;\n                }\n            },\n            ratechange: () => {\n                if (this.video) this.video.playbackRate = this.player.state.playbackSpeed;\n            }\n        };\n\n        this.player.on('play', this.handlers.play);\n        this.player.on('pause', this.handlers.pause);\n        this.player.on('timeupdate', this.handlers.timeupdate);\n        this.player.on('ratechange', this.handlers.ratechange);\n        \n        if (hasMultipleSources) {\n            this.handlers.captionChange = () => {\n                if (this.player.captionManager?.currentTrack && this.selector) {\n                    const captionLang = this.player.captionManager.currentTrack.language?.toLowerCase().split('-')[0];\n                    if (captionLang && this.sources[captionLang] && this.currentLanguage !== captionLang) {\n                        this.switchLanguage(captionLang);\n                        this.selector.value = captionLang;\n                    }\n                }\n            };\n            this.player.on('captionsenabled', this.handlers.captionChange);\n        }\n    }\n\n    /**\n     * Constrain position within video wrapper\n     */\n    constrainPosition() {\n        if (!this.wrapper || !this.player.videoWrapper) return;\n        \n        if (this.draggable?.manuallyPositioned) return;\n        \n        if (!this.wrapper.style.width) {\n            this.wrapper.style.width = '280px';\n        }\n        \n        const videoWrapperRect = this.player.videoWrapper.getBoundingClientRect();\n        const containerRect = this.player.container.getBoundingClientRect();\n        const wrapperRect = this.wrapper.getBoundingClientRect();\n        \n        const videoWrapperLeft = videoWrapperRect.left - containerRect.left;\n        const videoWrapperTop = videoWrapperRect.top - containerRect.top;\n        const videoWrapperWidth = videoWrapperRect.width;\n        const videoWrapperHeight = videoWrapperRect.height;\n        \n        let wrapperWidth = wrapperRect.width || 280;\n        let wrapperHeight = wrapperRect.height || ((280 * 9) / 16);\n        \n        let left, top;\n        const margin = 16;\n        const controlsHeight = 95;\n        \n        const position = this.desiredPosition || 'bottom-right';\n        \n        switch (position) {\n            case 'bottom-right':\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\n                break;\n            case 'bottom-left':\n                left = videoWrapperLeft + margin;\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\n                break;\n            case 'top-right':\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\n                top = videoWrapperTop + margin;\n                break;\n            case 'top-left':\n                left = videoWrapperLeft + margin;\n                top = videoWrapperTop + margin;\n                break;\n            default:\n                left = videoWrapperLeft + videoWrapperWidth - wrapperWidth - margin;\n                top = videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight;\n        }\n        \n        left = Math.max(videoWrapperLeft, Math.min(left, videoWrapperLeft + videoWrapperWidth - wrapperWidth));\n        top = Math.max(videoWrapperTop, Math.min(top, videoWrapperTop + videoWrapperHeight - wrapperHeight - controlsHeight));\n        \n        this.wrapper.style.left = `${left}px`;\n        this.wrapper.style.top = `${top}px`;\n        this.wrapper.style.right = 'auto';\n        this.wrapper.style.bottom = 'auto';\n    }\n\n    /**\n     * Show settings menu\n     */\n    showSettingsMenu() {\n        this.settingsMenuJustOpened = true;\n        setTimeout(() => { this.settingsMenuJustOpened = false; }, 350);\n        \n        this._addDocumentClickHandler();\n        \n        if (this.settingsMenu) {\n            this.settingsMenu.style.display = 'block';\n            this.settingsMenuVisible = true;\n            this.settingsButton?.setAttribute('aria-expanded', 'true');\n            this._attachMenuKeyboardNavigation();\n            this._positionSettingsMenu();\n            this._updateDragOptionState();\n            this._updateResizeOptionState();\n            focusFirstMenuItem(this.settingsMenu, `.${this.player.options.classPrefix}-sign-language-settings-item`);\n            return;\n        }\n        \n        this._createSettingsMenu();\n    }\n\n    /**\n     * Hide settings menu\n     */\n    hideSettingsMenu({ focusButton = true } = {}) {\n        if (this.settingsMenu) {\n            this.settingsMenu.style.display = 'none';\n            this.settingsMenuVisible = false;\n            this.settingsMenuJustOpened = false;\n            \n            if (this.settingsMenuKeyHandler) {\n                this.settingsMenu.removeEventListener('keydown', this.settingsMenuKeyHandler);\n                this.settingsMenuKeyHandler = null;\n            }\n            \n            const classPrefix = this.player.options.classPrefix;\n            const menuItems = Array.from(this.settingsMenu.querySelectorAll(`.${classPrefix}-sign-language-settings-item`));\n            menuItems.forEach(item => item.setAttribute('tabindex', '-1'));\n            \n            if (this.settingsButton) {\n                this.settingsButton.setAttribute('aria-expanded', 'false');\n                if (focusButton) {\n                    this.settingsButton.focus({ preventScroll: true });\n                }\n            }\n        }\n    }\n\n    /**\n     * Add document click handler\n     */\n    _addDocumentClickHandler() {\n        if (this.documentClickHandlerAdded) return;\n        \n        this.documentClickHandler = (e) => {\n            if (this.settingsMenuJustOpened) return;\n            \n            if (this.settingsButton && \n                (this.settingsButton === e.target || this.settingsButton.contains(e.target))) {\n                return;\n            }\n            \n            if (this.settingsMenu && this.settingsMenu.contains(e.target)) {\n                return;\n            }\n            \n            if (this.settingsMenuVisible) {\n                this.hideSettingsMenu();\n            }\n        };\n        \n        setTimeout(() => {\n            document.addEventListener('mousedown', this.documentClickHandler, true);\n            this.documentClickHandlerAdded = true;\n        }, 300);\n    }\n\n    /**\n     * Create settings menu\n     */\n    _createSettingsMenu() {\n        const classPrefix = this.player.options.classPrefix;\n        \n        this.settingsMenu = DOMUtils.createElement('div', {\n            className: `${classPrefix}-sign-language-settings-menu`,\n            attributes: { 'role': 'menu' }\n        });\n\n        // Drag option\n        const dragOption = createMenuItem({\n            classPrefix,\n            itemClass: `${classPrefix}-sign-language-settings-item`,\n            icon: 'move',\n            label: 'player.enableSignDragMode',\n            hasTextClass: true,\n            onClick: () => {\n                this.toggleKeyboardDragMode();\n                // Keep focus off the settings button so arrow keys go to the draggable overlay.\n                this.hideSettingsMenu({ focusButton: false });\n                // If we just enabled keyboard drag mode, focus the overlay.\n                if (this.draggable?.keyboardDragMode) {\n                    setTimeout(() => {\n                        this.wrapper?.focus?.({ preventScroll: true });\n                    }, 20);\n                }\n            }\n        });\n        // Allow CSS to hide this option on touch/mobile where dragging is always enabled\n        dragOption.setAttribute('data-setting', 'keyboard-drag');\n        dragOption.setAttribute('role', 'switch');\n        dragOption.setAttribute('aria-checked', 'false');\n        this._removeTooltipFromMenuItem(dragOption);\n        this.dragOptionButton = dragOption;\n        this.dragOptionText = dragOption.querySelector(`.${classPrefix}-settings-text`);\n        this._updateDragOptionState();\n\n        // Resize option\n        const resizeOption = createMenuItem({\n            classPrefix,\n            itemClass: `${classPrefix}-sign-language-settings-item`,\n            icon: 'resize',\n            label: 'player.enableSignResizeMode',\n            hasTextClass: true,\n            onClick: (event) => {\n                event.preventDefault();\n                event.stopPropagation();\n                \n                const enabled = this.toggleResizeMode({ focus: false });\n                \n                if (enabled) {\n                    this.hideSettingsMenu({ focusButton: false });\n                    setTimeout(() => {\n                        if (this.wrapper) this.wrapper.focus({ preventScroll: true });\n                    }, 20);\n                } else {\n                    this.hideSettingsMenu({ focusButton: true });\n                }\n            }\n        });\n        resizeOption.setAttribute('role', 'switch');\n        resizeOption.setAttribute('aria-checked', 'false');\n        this._removeTooltipFromMenuItem(resizeOption);\n        this.resizeOptionButton = resizeOption;\n        this.resizeOptionText = resizeOption.querySelector(`.${classPrefix}-settings-text`);\n        this._updateResizeOptionState();\n\n        // Close option\n        const closeOption = createMenuItem({\n            classPrefix,\n            itemClass: `${classPrefix}-sign-language-settings-item`,\n            icon: 'close',\n            label: 'transcript.closeMenu',\n            onClick: () => this.hideSettingsMenu()\n        });\n        this._removeTooltipFromMenuItem(closeOption);\n\n        this.settingsMenu.appendChild(dragOption);\n        this.settingsMenu.appendChild(resizeOption);\n        this.settingsMenu.appendChild(closeOption);\n\n        // Position and show\n        this.settingsMenu.style.visibility = 'hidden';\n        this.settingsMenu.style.display = 'block';\n        \n        if (this.settingsButton?.parentNode) {\n            this.settingsButton.insertAdjacentElement('afterend', this.settingsMenu);\n        } else if (this.wrapper) {\n            this.wrapper.appendChild(this.settingsMenu);\n        }\n        \n        this._positionSettingsMenuImmediate();\n        \n        requestAnimationFrame(() => {\n            if (this.settingsMenu) {\n                this.settingsMenu.style.visibility = 'visible';\n            }\n        });\n        \n        this._attachMenuKeyboardNavigation();\n        \n        this.settingsMenuVisible = true;\n        this.settingsButton?.setAttribute('aria-expanded', 'true');\n        this._updateDragOptionState();\n        this._updateResizeOptionState();\n        \n        focusFirstMenuItem(this.settingsMenu, `.${classPrefix}-sign-language-settings-item`);\n    }\n\n    /**\n     * Remove tooltip from menu item\n     */\n    _removeTooltipFromMenuItem(item) {\n        const classPrefix = this.player.options.classPrefix;\n        const tooltip = item.querySelector(`.${classPrefix}-tooltip`);\n        if (tooltip) tooltip.remove();\n        const buttonText = item.querySelector(`.${classPrefix}-button-text`);\n        if (buttonText) buttonText.remove();\n    }\n\n    /**\n     * Attach menu keyboard navigation\n     */\n    _attachMenuKeyboardNavigation() {\n        if (this.settingsMenuKeyHandler) {\n            this.settingsMenu.removeEventListener('keydown', this.settingsMenuKeyHandler);\n        }\n        \n        this.settingsMenuKeyHandler = attachMenuKeyboardNavigation(\n            this.settingsMenu,\n            this.settingsButton,\n            `.${this.player.options.classPrefix}-sign-language-settings-item`,\n            () => this.hideSettingsMenu({ focusButton: true })\n        );\n    }\n\n    /**\n     * Position settings menu immediately\n     */\n    _positionSettingsMenuImmediate() {\n        if (!this.settingsMenu || !this.settingsButton) return;\n        \n        const buttonRect = this.settingsButton.getBoundingClientRect();\n        const menuRect = this.settingsMenu.getBoundingClientRect();\n        const viewportWidth = window.innerWidth;\n        const viewportHeight = window.innerHeight;\n        \n        const parentContainer = this.settingsButton.parentElement;\n        if (!parentContainer) return;\n        \n        const parentRect = parentContainer.getBoundingClientRect();\n        \n        const buttonCenterX = buttonRect.left + buttonRect.width / 2 - parentRect.left;\n        const buttonBottom = buttonRect.bottom - parentRect.top;\n        const buttonTop = buttonRect.top - parentRect.top;\n        \n        const spaceAbove = buttonRect.top;\n        const spaceBelow = viewportHeight - buttonRect.bottom;\n        \n        let menuTop = buttonBottom + 8;\n        let menuBottom = null;\n        \n        if (spaceBelow < menuRect.height + 20 && spaceAbove > spaceBelow) {\n            menuTop = null;\n            const parentHeight = parentRect.bottom - parentRect.top;\n            menuBottom = parentHeight - buttonTop + 8;\n            this.settingsMenu.classList.add('vidply-menu-above');\n        } else {\n            this.settingsMenu.classList.remove('vidply-menu-above');\n        }\n        \n        let menuLeft = buttonCenterX - menuRect.width / 2;\n        let menuRight = 'auto';\n        let transformX = 'translateX(0)';\n        \n        const menuLeftAbsolute = buttonRect.left + buttonRect.width / 2 - menuRect.width / 2;\n        if (menuLeftAbsolute < 10) {\n            menuLeft = 0;\n        } else if (menuLeftAbsolute + menuRect.width > viewportWidth - 10) {\n            menuLeft = 'auto';\n            menuRight = 0;\n        } else {\n            menuLeft = buttonCenterX;\n            transformX = 'translateX(-50%)';\n        }\n        \n        if (menuTop !== null) {\n            this.settingsMenu.style.top = `${menuTop}px`;\n            this.settingsMenu.style.bottom = 'auto';\n        } else if (menuBottom !== null) {\n            this.settingsMenu.style.top = 'auto';\n            this.settingsMenu.style.bottom = `${menuBottom}px`;\n        }\n        \n        if (menuLeft !== 'auto') {\n            this.settingsMenu.style.left = `${menuLeft}px`;\n            this.settingsMenu.style.right = 'auto';\n        } else {\n            this.settingsMenu.style.left = 'auto';\n            this.settingsMenu.style.right = `${menuRight}px`;\n        }\n        \n        this.settingsMenu.style.transform = transformX;\n    }\n\n    /**\n     * Position settings menu with RAF\n     */\n    _positionSettingsMenu() {\n        requestAnimationFrame(() => {\n            setTimeout(() => {\n                this._positionSettingsMenuImmediate();\n            }, 10);\n        });\n    }\n\n    /**\n     * Toggle keyboard drag mode\n     */\n    toggleKeyboardDragMode() {\n        if (this.draggable) {\n            const wasEnabled = this.draggable.keyboardDragMode;\n            this.draggable.toggleKeyboardDragMode();\n            const isEnabled = this.draggable.keyboardDragMode;\n            if (!wasEnabled && isEnabled) {\n                this._enableMoveMode();\n            }\n            this._updateDragOptionState();\n        }\n    }\n\n    /**\n     * Enable move mode visual feedback\n     */\n    _enableMoveMode() {\n        this.wrapper.classList.add(`${this.player.options.classPrefix}-sign-move-mode`);\n        this._updateResizeOptionState();\n        setTimeout(() => {\n            this.wrapper.classList.remove(`${this.player.options.classPrefix}-sign-move-mode`);\n        }, 2000);\n    }\n\n    /**\n     * Toggle resize mode\n     */\n    toggleResizeMode({ focus = true } = {}) {\n        if (!this.draggable) return false;\n\n        if (this.draggable.pointerResizeMode) {\n            this.draggable.disablePointerResizeMode({ focus });\n            this._updateResizeOptionState();\n            return false;\n        }\n\n        this.draggable.enablePointerResizeMode({ focus });\n        this._updateResizeOptionState();\n        return true;\n    }\n\n    /**\n     * Update drag option state\n     */\n    _updateDragOptionState() {\n        if (!this.dragOptionButton) return;\n        \n        const isEnabled = !!(this.draggable?.keyboardDragMode);\n        const text = isEnabled\n            ? i18n.t('player.disableSignDragMode')\n            : i18n.t('player.enableSignDragMode');\n        const ariaLabel = isEnabled\n            ? i18n.t('player.disableSignDragModeAria')\n            : i18n.t('player.enableSignDragModeAria');\n\n        this.dragOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\n        this.dragOptionButton.setAttribute('aria-label', ariaLabel);\n\n        if (this.dragOptionText) {\n            this.dragOptionText.textContent = text;\n        }\n    }\n\n    /**\n     * Update resize option state\n     */\n    _updateResizeOptionState() {\n        if (!this.resizeOptionButton) return;\n        \n        const isEnabled = !!(this.draggable?.pointerResizeMode);\n        const text = isEnabled\n            ? i18n.t('player.disableSignResizeMode')\n            : i18n.t('player.enableSignResizeMode');\n        const ariaLabel = isEnabled\n            ? i18n.t('player.disableSignResizeModeAria')\n            : i18n.t('player.enableSignResizeModeAria');\n\n        this.resizeOptionButton.setAttribute('aria-checked', isEnabled ? 'true' : 'false');\n        this.resizeOptionButton.setAttribute('aria-label', ariaLabel);\n\n        if (this.resizeOptionText) {\n            this.resizeOptionText.textContent = text;\n        }\n    }\n\n    /**\n     * Save preferences\n     */\n    savePreferences() {\n        if (!this.wrapper) return;\n        \n        this.player.storage.saveSignLanguagePreferences({\n            size: { width: this.wrapper.style.width }\n        });\n    }\n\n    /**\n     * Update sources (called when playlist changes)\n     */\n    updateSources(signLanguageSrc, signLanguageSources) {\n        this.src = signLanguageSrc || null;\n        this.sources = signLanguageSources || {};\n        // Reset state for new playlist item (cleanup is called separately before this)\n        this.currentLanguage = null;\n    }\n\n    /**\n     * Cleanup\n     */\n    cleanup() {\n        if (this.inMainView && this.player.element) {\n            const el = this.player.element;\n            if (this._mainViewUsingSourceSwap && this.mainViewOriginalSources && this.mainViewOriginalSources.length > 0) {\n                Array.from(el.querySelectorAll('source')).forEach(source => source.remove());\n                const trackNode = el.querySelector('track');\n                this.mainViewOriginalSources.forEach(source => {\n                    if (trackNode) {\n                        el.insertBefore(source, trackNode);\n                    } else {\n                        el.appendChild(source);\n                    }\n                });\n                this._mainViewUsingSourceSwap = false;\n            } else if (this.mainViewOriginalSrc) {\n                el.src = this.mainViewOriginalSrc;\n            }\n            el.muted = this._mainViewMutedBefore;\n            if (typeof this.player.invalidateTrackCache === 'function') {\n                this.player.invalidateTrackCache();\n            }\n            el.load();\n            this.mainViewOriginalSrc = null;\n            this.mainViewOriginalSources = null;\n            this.inMainView = false;\n            this.player.state.signLanguageInMainView = false;\n            if (this.player.videoWrapper) {\n                this.player.videoWrapper.classList.remove('vidply-sign-language-main-view-active');\n            }\n            this.player.emit('signlanguageinmainviewdisabled');\n        }\n        if (this.settingsMenuVisible) {\n            this.hideSettingsMenu({ focusButton: false });\n        }\n        \n        // Remove document click handler\n        if (this.documentClickHandler && this.documentClickHandlerAdded) {\n            document.removeEventListener('mousedown', this.documentClickHandler, true);\n            this.documentClickHandlerAdded = false;\n            this.documentClickHandler = null;\n        }\n        \n        // Remove settings handlers\n        if (this.settingsHandlers && this.settingsButton) {\n            this.settingsButton.removeEventListener('click', this.settingsHandlers.click);\n            this.settingsButton.removeEventListener('keydown', this.settingsHandlers.keydown);\n        }\n        this.settingsHandlers = null;\n        \n        // Remove event handlers\n        if (this.handlers) {\n            this.player.off('play', this.handlers.play);\n            this.player.off('pause', this.handlers.pause);\n            this.player.off('timeupdate', this.handlers.timeupdate);\n            this.player.off('ratechange', this.handlers.ratechange);\n            if (this.handlers.captionChange) {\n                this.player.off('captionsenabled', this.handlers.captionChange);\n            }\n            this.handlers = null;\n        }\n\n        // Remove custom key handler\n        if (this.wrapper && this.customKeyHandler) {\n            this.wrapper.removeEventListener('keydown', this.customKeyHandler);\n        }\n\n        // Destroy draggable\n        if (this.draggable) {\n            if (this.draggable.pointerResizeMode) {\n                this.draggable.disablePointerResizeMode();\n            }\n            this.draggable.destroy();\n            this.draggable = null;\n        }\n        \n        this.interactionHandlers = null;\n\n        // Remove video and wrapper\n        if (this.wrapper?.parentNode) {\n            if (this.video) {\n                this.video.pause();\n                this.video.src = '';\n            }\n            this.wrapper.parentNode.removeChild(this.wrapper);\n        }\n        \n        this.wrapper = null;\n        this.video = null;\n        this.settingsButton = null;\n        this.settingsMenu = null;\n    }\n\n    /**\n     * Destroy\n     */\n    destroy() {\n        this.cleanup();\n        this.enabled = false;\n    }\n}\n\n", "/**\r\n * VidPly Playlist Manager\r\n * Manages playlists for audio and video content\r\n */\r\n\r\nimport { DOMUtils } from '../utils/DOMUtils.js';\r\nimport { createIconElement } from '../icons/Icons.js';\r\nimport { i18n } from '../i18n/i18n.js';\r\nimport { TimeUtils } from '../utils/TimeUtils.js';\r\n\r\n// Static counter for unique IDs\r\nlet playlistInstanceCounter = 0;\r\n\r\nexport class PlaylistManager {\r\n  constructor(player, options = {}) {\r\n    this.player = player;\r\n    this.tracks = [];\r\n    this.initialTracks = Array.isArray(options.tracks) ? options.tracks : [];\r\n    this.currentIndex = -1;\r\n    \r\n    // Generate unique instance ID for this playlist\r\n    this.instanceId = ++playlistInstanceCounter;\r\n    this.uniqueId = `vidply-playlist-${this.instanceId}`;\r\n    \r\n    // Options\r\n    this.options = {\r\n      autoAdvance: options.autoAdvance !== false, // Default true\r\n      autoPlayFirst: options.autoPlayFirst !== false, // Default true - auto-play first track on load\r\n      loop: options.loop || false,\r\n      showPanel: options.showPanel !== false, // Default true\r\n      recreatePlayers: options.recreatePlayers || false, // New: recreate player for each track type\r\n      ...options\r\n    };\r\n    \r\n    // UI elements\r\n    this.container = null;\r\n    this.playlistPanel = null;\r\n    this.trackInfoElement = null;\r\n    this.navigationFeedback = null; // Live region for keyboard navigation feedback\r\n    this.isPanelVisible = this.options.showPanel !== false;\r\n    \r\n    // Track change guard to prevent cascade of next() calls\r\n    this.isChangingTrack = false;\r\n    \r\n    // Store the host element for player recreation\r\n    this.hostElement = options.hostElement || null;\r\n    this.PlayerClass = options.PlayerClass || null;\r\n    \r\n    // Bind methods\r\n    this.handleTrackEnd = this.handleTrackEnd.bind(this);\r\n    this.handleTrackError = this.handleTrackError.bind(this);\r\n    \r\n    // Register this playlist manager with the player\r\n    this.player.playlistManager = this;\r\n    \r\n    // Initialize\r\n    this.init();\r\n    \r\n    // Update controls to add playlist buttons\r\n    this.updatePlayerControls();\r\n    \r\n    // Load tracks if provided in options (after UI is ready)\r\n    if (this.initialTracks.length > 0) {\r\n      this.loadPlaylist(this.initialTracks);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Determine the media type for a track\r\n   * @param {Object} track - Track object\r\n   * @returns {string} - 'audio', 'video', 'youtube', 'vimeo', 'soundcloud', 'hls'\r\n   */\r\n  getTrackMediaType(track) {\r\n    const src = track.src || '';\r\n    \r\n    if (src.includes('youtube.com') || src.includes('youtu.be')) {\r\n      return 'youtube';\r\n    }\r\n    if (src.includes('vimeo.com')) {\r\n      return 'vimeo';\r\n    }\r\n    if (src.includes('soundcloud.com') || src.includes('api.soundcloud.com')) {\r\n      return 'soundcloud';\r\n    }\r\n    if (src.includes('.m3u8')) {\r\n      return 'hls';\r\n    }\r\n    if (track.type && track.type.startsWith('audio/')) {\r\n      return 'audio';\r\n    }\r\n    // Default to video for video types or unknown\r\n    return 'video';\r\n  }\r\n  \r\n  /**\r\n   * Recreate the player with the appropriate element type for the track\r\n   * @param {Object} track - Track to load\r\n   * @param {boolean} autoPlay - Whether to auto-play after creation\r\n   */\r\n  async recreatePlayerForTrack(track, autoPlay = false) {\r\n    if (!this.hostElement || !this.PlayerClass) {\r\n      console.warn('VidPly Playlist: Cannot recreate player - missing hostElement or PlayerClass');\r\n      return false;\r\n    }\r\n    \r\n    const mediaType = this.getTrackMediaType(track);\r\n    // SoundCloud uses an iframe widget, so it doesn't need an audio element\r\n    // Only local audio files need an actual <audio> element\r\n    const elementType = (mediaType === 'audio') ? 'audio' : 'video';\r\n    \r\n    // Store playlist panel state\r\n    const wasVisible = this.isPanelVisible;\r\n    const savedTracks = [...this.tracks]; // Keep track data\r\n    const savedIndex = this.currentIndex;\r\n    \r\n    // Detach all playlist UI elements from DOM (keep references)\r\n    // These will be reattached to the new player container\r\n    if (this.trackArtworkElement && this.trackArtworkElement.parentNode) {\r\n      this.trackArtworkElement.parentNode.removeChild(this.trackArtworkElement);\r\n    }\r\n    if (this.trackInfoElement && this.trackInfoElement.parentNode) {\r\n      this.trackInfoElement.parentNode.removeChild(this.trackInfoElement);\r\n    }\r\n    if (this.navigationFeedback && this.navigationFeedback.parentNode) {\r\n      this.navigationFeedback.parentNode.removeChild(this.navigationFeedback);\r\n    }\r\n    if (this.playlistPanel && this.playlistPanel.parentNode) {\r\n      this.playlistPanel.parentNode.removeChild(this.playlistPanel);\r\n    }\r\n    \r\n    // Preserve existing player options so recreated players behave consistently\r\n    const preservedPlayerOptions = this.player?.options ? { ...this.player.options } : {};\r\n\r\n    // Remove event listeners before destroying\r\n    if (this.player) {\r\n      this.player.off('ended', this.handleTrackEnd);\r\n      this.player.off('error', this.handleTrackError);\r\n      this.player.destroy();\r\n    }\r\n    \r\n    // Clear the host element\r\n    this.hostElement.innerHTML = '';\r\n    \r\n    // Create new media element with appropriate type\r\n    const mediaElement = document.createElement(elementType);\r\n    // Respect configured preload (playlists should behave like single videos even with deferLoad)\r\n    const preloadValue = preservedPlayerOptions.preload || 'metadata';\r\n    mediaElement.setAttribute('preload', preloadValue);\r\n    \r\n    // For video elements with local media, set poster\r\n    if (elementType === 'video' && track.poster && \r\n        (mediaType === 'video' || mediaType === 'hls')) {\r\n      mediaElement.setAttribute('poster', track.poster);\r\n    }\r\n    \r\n    // For external renderers (YouTube, Vimeo, SoundCloud, HLS), don't add source\r\n    // The renderer will handle the source directly\r\n    const isExternalRenderer = ['youtube', 'vimeo', 'soundcloud', 'hls'].includes(mediaType);\r\n    \r\n    if (!isExternalRenderer) {\r\n      // Add source for HTML5 media\r\n      const source = document.createElement('source');\r\n      source.src = track.src;\r\n      if (track.type) {\r\n        source.type = track.type;\r\n      }\r\n      mediaElement.appendChild(source);\r\n      \r\n      // Add tracks (captions, chapters, etc.)\r\n      if (track.tracks && track.tracks.length > 0) {\r\n        track.tracks.forEach(trackConfig => {\r\n          const trackEl = document.createElement('track');\r\n          trackEl.src = trackConfig.src;\r\n          trackEl.kind = trackConfig.kind || 'captions';\r\n          trackEl.srclang = trackConfig.srclang || 'en';\r\n          trackEl.label = trackConfig.label || trackConfig.srclang;\r\n          if (trackConfig.default) {\r\n            trackEl.default = true;\r\n          }\r\n          mediaElement.appendChild(trackEl);\r\n        });\r\n      }\r\n    }\r\n    \r\n    this.hostElement.appendChild(mediaElement);\r\n    \r\n    // Create new player with the media element\r\n    // Pass the source for external renderers via options\r\n    const playerOptions = {\r\n      mediaType: elementType,\r\n      poster: track.poster,\r\n      audioDescriptionSrc: track.audioDescriptionSrc || null,\r\n      audioDescriptionDuration: track.audioDescriptionDuration || null,\r\n      signLanguageSrc: track.signLanguageSrc || null\r\n    };\r\n    // Merge back preserved options (so deferLoad/preload/etc remain active)\r\n    Object.assign(playerOptions, preservedPlayerOptions);\r\n    \r\n    this.player = new this.PlayerClass(mediaElement, playerOptions);\r\n    \r\n    // Re-register playlist manager\r\n    this.player.playlistManager = this;\r\n    \r\n    // Wait for player to be ready\r\n    await new Promise(resolve => {\r\n      this.player.on('ready', resolve);\r\n    });\r\n    \r\n    // Re-attach event listeners\r\n    this.player.on('ended', this.handleTrackEnd);\r\n    this.player.on('error', this.handleTrackError);\r\n    \r\n    // Re-attach all playlist UI elements to the new player's container\r\n    if (this.player.container) {\r\n      // Track artwork goes before video wrapper\r\n      if (this.trackArtworkElement) {\r\n        const videoWrapper = this.player.container.querySelector('.vidply-video-wrapper');\r\n        if (videoWrapper) {\r\n          this.player.container.insertBefore(this.trackArtworkElement, videoWrapper);\r\n        } else {\r\n          this.player.container.appendChild(this.trackArtworkElement);\r\n        }\r\n      }\r\n      // Track info\r\n      if (this.trackInfoElement) {\r\n        this.player.container.appendChild(this.trackInfoElement);\r\n      }\r\n      // Navigation feedback (screen reader only)\r\n      if (this.navigationFeedback) {\r\n        this.player.container.appendChild(this.navigationFeedback);\r\n      }\r\n      // Playlist panel\r\n      if (this.playlistPanel) {\r\n        this.player.container.appendChild(this.playlistPanel);\r\n      }\r\n    }\r\n    \r\n    // Update container reference\r\n    this.container = this.player.container;\r\n    \r\n    // Update controls (adds playlist prev/next buttons)\r\n    this.updatePlayerControls();\r\n    \r\n    // Restore tracks data (we kept it during recreation)\r\n    this.tracks = savedTracks;\r\n    this.currentIndex = savedIndex;\r\n    \r\n    // Update playlist UI to reflect current state\r\n    this.updatePlaylistUI();\r\n    \r\n    // Restore playlist panel visibility\r\n    this.isPanelVisible = wasVisible;\r\n    if (this.playlistPanel) {\r\n      this.playlistPanel.style.display = wasVisible ? '' : 'none';\r\n    }\r\n    \r\n    // For external renderers, load the track via player.load()\r\n    // For HTML5, the source is already set on the element\r\n    if (isExternalRenderer) {\r\n      this.player.load({\r\n        src: track.src,\r\n        type: track.type,\r\n        poster: track.poster,\r\n        tracks: track.tracks || [],\r\n        audioDescriptionSrc: track.audioDescriptionSrc || null,\r\n        signLanguageSrc: track.signLanguageSrc || null\r\n      });\r\n    } else {\r\n      // For HTML5 media, also load to set up accessibility features\r\n      this.player.load({\r\n        src: track.src,\r\n        type: track.type,\r\n        poster: track.poster,\r\n        tracks: track.tracks || [],\r\n        audioDescriptionSrc: track.audioDescriptionSrc || null,\r\n        signLanguageSrc: track.signLanguageSrc || null\r\n      });\r\n    }\r\n    \r\n    // Auto-play if requested\r\n    if (autoPlay) {\r\n      setTimeout(() => {\r\n        this.player.play();\r\n      }, 100);\r\n    }\r\n    \r\n    return true;\r\n  }\r\n  \r\n  init() {\r\n    // Listen for track end\r\n    this.player.on('ended', this.handleTrackEnd);\r\n    this.player.on('error', this.handleTrackError);\r\n    \r\n    // Listen for playback state changes to show/hide playlist in fullscreen\r\n    this.player.on('play', this.handlePlaybackStateChange.bind(this));\r\n    this.player.on('pause', this.handlePlaybackStateChange.bind(this));\r\n    this.player.on('ended', this.handlePlaybackStateChange.bind(this));\r\n    // Use fullscreenchange event which is what the player actually emits\r\n    this.player.on('fullscreenchange', this.handleFullscreenChange.bind(this));\r\n    \r\n    // Listen for audio description state changes to update duration displays\r\n    this.player.on('audiodescriptionenabled', this.handleAudioDescriptionChange.bind(this));\r\n    this.player.on('audiodescriptiondisabled', this.handleAudioDescriptionChange.bind(this));\r\n    \r\n    // Create UI if needed\r\n    if (this.options.showPanel) {\r\n      this.createUI();\r\n    }\r\n    \r\n    // Check for data-playlist attribute on player container (only if tracks weren't provided in options)\r\n    if (this.tracks.length === 0 && this.initialTracks.length === 0) {\r\n      this.loadPlaylistFromAttribute();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Load playlist from data-playlist attribute if present\r\n   */\r\n  loadPlaylistFromAttribute() {\r\n    // Check the original wrapper element for data-playlist\r\n    // Structure: #audio-player -> .vidply-player -> .vidply-video-wrapper -> <audio>\r\n    // So we need to go up 3 levels\r\n    if (!this.player.element || !this.player.element.parentElement) {\r\n      console.log('VidPly Playlist: No player element found');\r\n      return;\r\n    }\r\n    \r\n    const videoWrapper = this.player.element.parentElement; // .vidply-video-wrapper\r\n    const playerContainer = videoWrapper.parentElement; // .vidply-player\r\n    const originalElement = playerContainer ? playerContainer.parentElement : null; // #audio-player (original div)\r\n    \r\n    if (!originalElement) {\r\n      console.log('VidPly Playlist: No original element found');\r\n      return;\r\n    }\r\n    \r\n    // Load playlist options from data attributes\r\n    this.loadOptionsFromAttributes(originalElement);\r\n    \r\n    const playlistData = originalElement.getAttribute('data-playlist');\r\n    if (!playlistData) {\r\n      console.log('VidPly Playlist: No data-playlist attribute found');\r\n      return;\r\n    }\r\n    \r\n    console.log('VidPly Playlist: Found data-playlist attribute, parsing...');\r\n    try {\r\n      const tracks = JSON.parse(playlistData);\r\n      if (Array.isArray(tracks) && tracks.length > 0) {\r\n        console.log(`VidPly Playlist: Loaded ${tracks.length} tracks from data-playlist`);\r\n        this.loadPlaylist(tracks);\r\n      } else {\r\n        console.warn('VidPly Playlist: data-playlist is not a valid array or is empty');\r\n      }\r\n    } catch (error) {\r\n      console.error('VidPly Playlist: Failed to parse data-playlist attribute', error);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Load playlist options from data attributes\r\n   * @param {HTMLElement} element - Element to read attributes from\r\n   */\r\n  loadOptionsFromAttributes(element) {\r\n    // data-playlist-auto-advance\r\n    const autoAdvance = element.getAttribute('data-playlist-auto-advance');\r\n    if (autoAdvance !== null) {\r\n      this.options.autoAdvance = autoAdvance === 'true';\r\n    }\r\n    \r\n    // data-playlist-auto-play-first\r\n    const autoPlayFirst = element.getAttribute('data-playlist-auto-play-first');\r\n    if (autoPlayFirst !== null) {\r\n      this.options.autoPlayFirst = autoPlayFirst === 'true';\r\n    }\r\n    \r\n    // data-playlist-loop\r\n    const loop = element.getAttribute('data-playlist-loop');\r\n    if (loop !== null) {\r\n      this.options.loop = loop === 'true';\r\n    }\r\n    \r\n    // data-playlist-show-panel\r\n    const showPanel = element.getAttribute('data-playlist-show-panel');\r\n    if (showPanel !== null) {\r\n      this.options.showPanel = showPanel === 'true';\r\n    }\r\n    \r\n    console.log('VidPly Playlist: Options from attributes:', this.options);\r\n  }\r\n  \r\n  /**\r\n   * Update player controls to add playlist navigation buttons\r\n   */\r\n  updatePlayerControls() {\r\n    if (!this.player.controlBar) return;\r\n    \r\n    const controlBar = this.player.controlBar;\r\n    \r\n    // Clear existing controls content (except the element itself)\r\n    controlBar.element.innerHTML = '';\r\n    \r\n    // Recreate controls with playlist buttons now available\r\n    controlBar.createControls();\r\n    \r\n    // Reattach events for the new controls\r\n    controlBar.attachEvents();\r\n    controlBar.setupAutoHide();\r\n  }\r\n  \r\n  /**\r\n   * Load a playlist\r\n   * @param {Array} tracks - Array of track objects\r\n   */\r\n  loadPlaylist(tracks) {\r\n    this.tracks = tracks;\r\n    this.currentIndex = -1;\r\n    \r\n    // Add playlist class to container\r\n    if (this.container) {\r\n      this.container.classList.add('vidply-has-playlist');\r\n    }\r\n    \r\n    // Update UI\r\n    if (this.playlistPanel) {\r\n      this.renderPlaylist();\r\n    }\r\n    \r\n    // Auto-play first track (if enabled)\r\n    if (tracks.length > 0) {\r\n      if (this.options.autoPlayFirst) {\r\n        this.play(0);\r\n      } else {\r\n        // Behave like a single video: load the first track (metadata/manifest)\r\n        // but do not start playback.\r\n        void this.loadTrack(0).catch(() => {\r\n          // ignore\r\n        });\r\n      }\r\n    }\r\n    \r\n    // Update visibility based on current state\r\n    this.updatePlaylistVisibilityInFullscreen();\r\n  }\r\n  \r\n  /**\r\n   * Load a track without playing\r\n   * This is the playlist equivalent of a \"single video initialized but not started yet\":\r\n   * it updates UI selection and loads the media into the player so metadata/manifests\r\n   * and feature managers can be ready, but it does not start playback.\r\n   * @param {number} index - Track index\r\n   */\r\n  async loadTrack(index) {\r\n    if (index < 0 || index >= this.tracks.length) {\r\n      console.warn('VidPly Playlist: Invalid track index', index);\r\n      return;\r\n    }\r\n    \r\n    const track = this.tracks[index];\r\n    \r\n    // Always update UI immediately (poster, buttons, duration, etc.).\r\n    // Note: this is UI-only; actual media loading is performed by player.load() below.\r\n    this.selectTrack(index);\r\n    \r\n    // Set guard flag to prevent cascade of next() calls during track change\r\n    this.isChangingTrack = true;\r\n    \r\n    // Check if we should recreate the player for this track type\r\n    if (this.options.recreatePlayers && this.hostElement && this.PlayerClass) {\r\n      const currentMediaType = this.player ? \r\n        (this.player.element.tagName === 'AUDIO' ? 'audio' : 'video') : null;\r\n      const newMediaType = this.getTrackMediaType(track);\r\n      const newElementType = (newMediaType === 'audio' || newMediaType === 'soundcloud') ? 'audio' : 'video';\r\n      \r\n      // Recreate if element type is different\r\n      if (currentMediaType !== newElementType) {\r\n        await this.recreatePlayerForTrack(track, false);\r\n        // Re-apply selection to the newly created player (poster/tracks/buttons)\r\n        this.selectTrack(index);\r\n        \r\n        // Emit event\r\n        this.player.emit('playlisttrackchange', {\r\n          index: index,\r\n          item: track,\r\n          total: this.tracks.length\r\n        });\r\n        \r\n        // Clear guard flag\r\n        setTimeout(() => {\r\n          this.isChangingTrack = false;\r\n        }, 150);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    // Load track into player (normal path)\r\n    const loadPromise = this.player.load({\r\n      src: track.src,\r\n      type: track.type,\r\n      poster: track.poster,\r\n      tracks: track.tracks || [],\r\n      audioDescriptionSrc: track.audioDescriptionSrc || null,\r\n      signLanguageSrc: track.signLanguageSrc || null,\r\n      signLanguageSources: track.signLanguageSources || {}\r\n    });\r\n\r\n    // For playlist UX parity with single videos: fetch metadata/manifest now,\r\n    // but do not start playback.\r\n    if (this.player?.options?.deferLoad && typeof this.player.ensureLoaded === 'function') {\r\n      Promise.resolve(loadPromise)\r\n        .then(() => this.player?.ensureLoaded?.())\r\n        .catch(() => {\r\n          // ignore\r\n        });\r\n    }\r\n    \r\n    // Emit event\r\n    this.player.emit('playlisttrackchange', {\r\n      index: index,\r\n      item: track,\r\n      total: this.tracks.length\r\n    });\r\n    \r\n    // Clear guard flag after a short delay to ensure track is loaded\r\n    setTimeout(() => {\r\n      this.isChangingTrack = false;\r\n    }, 150);\r\n  }\r\n\r\n  /**\r\n   * Select a track (UI/selection only; does NOT set the media src / does NOT initialize renderer)\r\n   *\r\n   * In \"B always\" playlist mode, you typically want `loadTrack()` on selection so the\r\n   * selected item behaves like a single video (metadata/manifest loaded, features ready)\r\n   * without auto-playing.\r\n   * @param {number} index - Track index\r\n   */\r\n  selectTrack(index) {\r\n    if (index < 0 || index >= this.tracks.length) {\r\n      console.warn('VidPly Playlist: Invalid track index', index);\r\n      return;\r\n    }\r\n\r\n    const track = this.tracks[index];\r\n    this.currentIndex = index;\r\n\r\n    // Apply per-track metadata without touching the media source.\r\n    // This ensures poster + feature buttons (chapters/captions/transcript/sign-language)\r\n    // can be updated instantly even before any media network activity happens.\r\n    try {\r\n      // Poster for video element\r\n      if (this.player?.element?.tagName === 'VIDEO') {\r\n        if (track.poster) {\r\n          const posterUrl = typeof this.player.resolvePosterPath === 'function'\r\n            ? this.player.resolvePosterPath(track.poster)\r\n            : track.poster;\r\n          this.player.element.poster = posterUrl;\r\n          this.player.applyPosterAspectRatio?.(posterUrl);\r\n        } else {\r\n          this.player.element.removeAttribute('poster');\r\n        }\r\n      }\r\n\r\n      // Update sign language / audio description sources (used for button visibility)\r\n      this.player.audioDescriptionSrc = track.audioDescriptionSrc || null;\r\n      this.player.signLanguageSrc = track.signLanguageSrc || null;\r\n      this.player.signLanguageSources = track.signLanguageSources || {};\r\n\r\n      // Fill duration early for UI (progress/time display) without loading media\r\n      if (track.duration && Number(track.duration) > 0) {\r\n        this.player.state.duration = Number(track.duration);\r\n      }\r\n      // Also sync feature managers (they keep their own copy of sources)\r\n      if (this.player.audioDescriptionManager) {\r\n        this.player.audioDescriptionManager.src = track.audioDescriptionSrc || null;\r\n        // Remember original (non-described) source for switching back later\r\n        this.player.audioDescriptionManager.originalSource = track.src || this.player.originalSrc || null;\r\n      }\r\n      if (this.player.signLanguageManager) {\r\n        this.player.signLanguageManager.src = track.signLanguageSrc || null;\r\n        this.player.signLanguageManager.sources = track.signLanguageSources || {};\r\n        this.player.signLanguageManager.currentLanguage = null;\r\n      }\r\n\r\n      // For audio description switching, remember original source even before first play\r\n      if (track.src && !this.player.originalSrc) {\r\n        this.player.originalSrc = track.src;\r\n      }\r\n\r\n      // Replace <track> elements so captions/chapters/transcript can be detected/loaded\r\n      const existing = Array.from(this.player.element.querySelectorAll('track'));\r\n      existing.forEach(t => t.remove());\r\n\r\n      if (Array.isArray(track.tracks)) {\r\n        track.tracks.forEach(tc => {\r\n          if (!tc?.src) return;\r\n          const el = document.createElement('track');\r\n          el.src = tc.src;\r\n          el.kind = tc.kind || 'captions';\r\n          el.srclang = tc.srclang || 'en';\r\n          el.label = tc.label || tc.srclang || 'Track';\r\n          if (tc.default) el.default = true;\r\n          if (tc.describedSrc) {\r\n            el.setAttribute('data-desc-src', tc.describedSrc);\r\n          }\r\n          this.player.element.appendChild(el);\r\n        });\r\n      }\r\n\r\n      if (typeof this.player.invalidateTrackCache === 'function') {\r\n        this.player.invalidateTrackCache();\r\n      }\r\n\r\n      // Re-scan described-track metadata for AudioDescriptionManager\r\n      if (this.player.audioDescriptionManager && typeof this.player.audioDescriptionManager.initFromSourceElements === 'function') {\r\n        try {\r\n          this.player.audioDescriptionManager.captionTracks = [];\r\n          this.player.audioDescriptionManager.initFromSourceElements(this.player.sourceElements, this.player.trackElements);\r\n        } catch (e) {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      // Refresh caption/transcript managers so menus reflect newly injected <track> elements\r\n      // (important when we defer MP4/MP3 loading but still want VTT-based UI to work).\r\n      if (this.player.captionManager && typeof this.player.captionManager.loadTracks === 'function') {\r\n        try {\r\n          this.player.captionManager.tracks = [];\r\n          this.player.captionManager.currentTrack = null;\r\n          this.player.captionManager.loadTracks();\r\n        } catch (e) {\r\n          // ignore\r\n        }\r\n      }\r\n\r\n      // TranscriptManager reads from TextTracks too; it will be correct after media starts.\r\n      // For now, we just ensure control bar is rebuilt so the button is present.\r\n\r\n      // Rebuild controls so feature buttons appear immediately\r\n      if (typeof this.player.updateControlBar === 'function') {\r\n        this.player.updateControlBar();\r\n      }\r\n    } catch (e) {\r\n      // ignore preview errors; selection should still work\r\n    }\r\n\r\n    this.updateTrackInfo(track);\r\n    this.updatePlaylistUI();\r\n\r\n    this.player.emit('playlisttrackselect', {\r\n      index,\r\n      item: track,\r\n      total: this.tracks.length\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Play a specific track\r\n   * @param {number} index - Track index\r\n   * @param {boolean} userInitiated - Whether this was triggered by user action (default: false)\r\n   */\r\n  async play(index, userInitiated = false) {\r\n    if (index < 0 || index >= this.tracks.length) {\r\n      console.warn('VidPly Playlist: Invalid track index', index);\r\n      return;\r\n    }\r\n    \r\n    const track = this.tracks[index];\r\n    \r\n    // Set guard flag to prevent cascade of next() calls during track change\r\n    this.isChangingTrack = true;\r\n    \r\n    // Update current index\r\n    this.currentIndex = index;\r\n    \r\n    // Check if we should recreate the player for this track type\r\n    if (this.options.recreatePlayers && this.hostElement && this.PlayerClass) {\r\n      const currentMediaType = this.player ? \r\n        (this.player.element.tagName === 'AUDIO' ? 'audio' : 'video') : null;\r\n      const newMediaType = this.getTrackMediaType(track);\r\n      const newElementType = (newMediaType === 'audio' || newMediaType === 'soundcloud') ? 'audio' : 'video';\r\n      \r\n      // Recreate if element type is different\r\n      if (currentMediaType !== newElementType) {\r\n        await this.recreatePlayerForTrack(track, true); // true = autoPlay\r\n        // Update UI after recreation\r\n        this.updateTrackInfo(track);\r\n        this.updatePlaylistUI();\r\n        \r\n        // Emit event\r\n        this.player.emit('playlisttrackchange', {\r\n          index: index,\r\n          item: track,\r\n          total: this.tracks.length\r\n        });\r\n        \r\n        // Clear guard flag\r\n        setTimeout(() => {\r\n          this.isChangingTrack = false;\r\n        }, 150);\r\n        return;\r\n      }\r\n    }\r\n    \r\n    // Load track into player (normal path)\r\n    // If audio description was toggled before the first play, load the described source directly.\r\n    let srcToLoad = track.src;\r\n    if (this.player?.audioDescriptionManager?.desiredState && track.audioDescriptionSrc) {\r\n      // Preserve original for later toggling back\r\n      this.player.originalSrc = track.src;\r\n      this.player.audioDescriptionManager.originalSource = track.src;\r\n      this.player.audioDescriptionManager.src = track.audioDescriptionSrc;\r\n      srcToLoad = track.audioDescriptionSrc;\r\n    }\r\n\r\n    this.player.load({\r\n      src: srcToLoad,\r\n      type: track.type,\r\n      poster: track.poster,\r\n      tracks: track.tracks || [],\r\n      audioDescriptionSrc: track.audioDescriptionSrc || null,\r\n      signLanguageSrc: track.signLanguageSrc || null,\r\n      signLanguageSources: track.signLanguageSources || {}\r\n    });\r\n    \r\n    // Update UI\r\n    this.updateTrackInfo(track);\r\n    this.updatePlaylistUI();\r\n    \r\n    // Emit event\r\n    this.player.emit('playlisttrackchange', {\r\n      index: index,\r\n      item: track,\r\n      total: this.tracks.length\r\n    });\r\n    \r\n    // Auto-play and clear guard flag after playback starts\r\n    setTimeout(() => {\r\n      this.player.play();\r\n      // Clear guard flag after a short delay to ensure track has started\r\n      setTimeout(() => {\r\n        this.isChangingTrack = false;\r\n      }, 50);\r\n    }, 100);\r\n  }\r\n  \r\n  /**\r\n   * Play next track\r\n   */\r\n  next() {\r\n    let nextIndex = this.currentIndex + 1;\r\n    \r\n    if (nextIndex >= this.tracks.length) {\r\n      if (this.options.loop) {\r\n        nextIndex = 0;\r\n      } else {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    this.play(nextIndex);\r\n  }\r\n  \r\n  /**\r\n   * Play previous track\r\n   */\r\n  previous() {\r\n    let prevIndex = this.currentIndex - 1;\r\n    \r\n    if (prevIndex < 0) {\r\n      if (this.options.loop) {\r\n        prevIndex = this.tracks.length - 1;\r\n      } else {\r\n        return;\r\n      }\r\n    }\r\n    \r\n    this.play(prevIndex);\r\n  }\r\n  \r\n  /**\r\n   * Handle track end\r\n   */\r\n  handleTrackEnd() {\r\n    // Don't auto-advance if we're already in the process of changing tracks\r\n    // This prevents a cascade of next() calls when loading a new track triggers an 'ended' event\r\n    if (this.isChangingTrack) {\r\n      return;\r\n    }\r\n    \r\n    if (this.options.autoAdvance) {\r\n      this.next();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Check if a source URL requires an external renderer\r\n   * @param {string} src - Source URL\r\n   * @returns {boolean}\r\n   */\r\n  isExternalRendererUrl(src) {\r\n    if (!src) return false;\r\n    return src.includes('youtube.com') || \r\n           src.includes('youtu.be') || \r\n           src.includes('vimeo.com') || \r\n           src.includes('soundcloud.com') || \r\n           src.includes('api.soundcloud.com') ||\r\n           src.includes('.m3u8');\r\n  }\r\n\r\n  /**\r\n   * Handle track error\r\n   */\r\n  handleTrackError(e) {\r\n    // Don't auto-advance for external renderer tracks\r\n    // External renderers (YouTube, Vimeo, SoundCloud, HLS) may trigger HTML5 errors\r\n    // that should be ignored since the external renderer handles playback\r\n    const currentTrack = this.getCurrentTrack();\r\n    if (currentTrack && currentTrack.src && this.isExternalRendererUrl(currentTrack.src)) {\r\n      // Silently ignore errors for external renderer tracks\r\n      return;\r\n    }\r\n    \r\n    // Don't auto-advance if we're in the process of changing tracks\r\n    // This prevents a cascade of next() calls when switching between renderer types\r\n    if (this.isChangingTrack) {\r\n      return;\r\n    }\r\n    \r\n    console.error('VidPly Playlist: Track error', e);\r\n    \r\n    // Try next track\r\n    if (this.options.autoAdvance) {\r\n      setTimeout(() => {\r\n        this.next();\r\n      }, 1000);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Handle playback state changes (for fullscreen playlist visibility)\r\n   */\r\n  handlePlaybackStateChange() {\r\n    this.updatePlaylistVisibilityInFullscreen();\r\n  }\r\n  \r\n  /**\r\n   * Handle fullscreen state changes\r\n   */\r\n  handleFullscreenChange() {\r\n    // Use a small delay to ensure fullscreen state is fully applied\r\n    setTimeout(() => {\r\n      this.updatePlaylistVisibilityInFullscreen();\r\n    }, 50);\r\n  }\r\n  \r\n  /**\r\n   * Handle audio description state changes\r\n   * Updates duration displays to show audio-described version duration when AD is enabled\r\n   */\r\n  handleAudioDescriptionChange() {\r\n    const currentTrack = this.getCurrentTrack();\r\n    if (!currentTrack) return;\r\n    \r\n    // Update the track info display with the appropriate duration\r\n    this.updateTrackInfo(currentTrack);\r\n    \r\n    // Update the playlist UI to reflect duration changes (aria-labels)\r\n    this.updatePlaylistUI();\r\n    \r\n    // Update visual duration elements in playlist panel\r\n    this.updatePlaylistDurations();\r\n  }\r\n  \r\n  /**\r\n   * Update the visual duration displays in the playlist panel\r\n   * Called when audio description state changes\r\n   */\r\n  updatePlaylistDurations() {\r\n    if (!this.playlistPanel) return;\r\n    \r\n    const items = this.playlistPanel.querySelectorAll('.vidply-playlist-item');\r\n    \r\n    items.forEach((item, index) => {\r\n      const track = this.tracks[index];\r\n      if (!track) return;\r\n      \r\n      const effectiveDuration = this.getEffectiveDuration(track);\r\n      const trackDuration = effectiveDuration ? TimeUtils.formatTime(effectiveDuration) : '';\r\n      \r\n      // Update duration badge on thumbnail (if exists)\r\n      const durationBadge = item.querySelector('.vidply-playlist-duration-badge');\r\n      if (durationBadge) {\r\n        durationBadge.textContent = trackDuration;\r\n      }\r\n      \r\n      // Update inline duration (if exists)\r\n      const inlineDuration = item.querySelector('.vidply-playlist-item-duration');\r\n      if (inlineDuration) {\r\n        inlineDuration.textContent = trackDuration;\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Get the effective duration for a track based on audio description state\r\n   * @param {Object} track - Track object\r\n   * @returns {number|null} - Duration in seconds or null if not available\r\n   */\r\n  getEffectiveDuration(track) {\r\n    if (!track) return null;\r\n    \r\n    const isAudioDescriptionEnabled = this.player.state.audioDescriptionEnabled;\r\n    \r\n    // If audio description is enabled and track has audioDescriptionDuration, use it\r\n    if (isAudioDescriptionEnabled && track.audioDescriptionDuration) {\r\n      return track.audioDescriptionDuration;\r\n    }\r\n    \r\n    // Otherwise use regular duration\r\n    return track.duration || null;\r\n  }\r\n  \r\n  /**\r\n   * Update playlist visibility based on fullscreen and playback state\r\n   * In fullscreen: show when paused/not started, hide when playing\r\n   * Outside fullscreen: respect original panel visibility setting\r\n   */\r\n  updatePlaylistVisibilityInFullscreen() {\r\n    if (!this.playlistPanel || !this.tracks.length) return;\r\n    \r\n    const isFullscreen = this.player.state.fullscreen;\r\n    const isPlaying = this.player.state.playing;\r\n    \r\n    if (isFullscreen) {\r\n      // In fullscreen: show only when not playing (paused or not started)\r\n      // Check playing state explicitly since paused might not be set initially\r\n      if (!isPlaying) {\r\n        this.playlistPanel.classList.add('vidply-playlist-fullscreen-visible');\r\n        this.playlistPanel.style.display = 'block';\r\n      } else {\r\n        this.playlistPanel.classList.remove('vidply-playlist-fullscreen-visible');\r\n        // Add a smooth fade out with delay to match CSS transition\r\n        setTimeout(() => {\r\n          // Double-check state hasn't changed before hiding\r\n          if (this.player.state.playing && this.player.state.fullscreen) {\r\n            this.playlistPanel.style.display = 'none';\r\n          }\r\n        }, 300); // Match CSS transition duration\r\n      }\r\n    } else {\r\n      // Outside fullscreen: restore original behavior\r\n      this.playlistPanel.classList.remove('vidply-playlist-fullscreen-visible');\r\n      if (this.isPanelVisible && this.tracks.length > 0) {\r\n        this.playlistPanel.style.display = 'block';\r\n      } else {\r\n        this.playlistPanel.style.display = 'none';\r\n      }\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Create playlist UI\r\n   */\r\n  createUI() {\r\n    // Find player container\r\n    this.container = this.player.container;\r\n    \r\n    if (!this.container) {\r\n      console.warn('VidPly Playlist: No container found');\r\n      return;\r\n    }\r\n    \r\n    // Track artwork element (shows album art/poster for audio tracks).\r\n    // Important: in mixed playlists the player may start as <video> and later recreate to <audio>,\r\n    // so we create this lazily in `updateTrackArtwork()` when we actually have an audio element.\r\n    \r\n    // Create track info element (shows current track)\r\n    this.trackInfoElement = DOMUtils.createElement('div', {\r\n      className: 'vidply-track-info',\r\n      attributes: {\r\n        role: 'status'\r\n      }\r\n    });\r\n    this.trackInfoElement.style.display = 'none';\r\n    \r\n    this.container.appendChild(this.trackInfoElement);\r\n    \r\n    // Create navigation feedback live region\r\n    this.navigationFeedback = DOMUtils.createElement('div', {\r\n      className: 'vidply-sr-only',\r\n      attributes: {\r\n        role: 'status',\r\n        'aria-live': 'polite',\r\n        'aria-atomic': 'true'\r\n      }\r\n    });\r\n    this.container.appendChild(this.navigationFeedback);\r\n    \r\n    // Create playlist panel with proper landmark\r\n    this.playlistPanel = DOMUtils.createElement('div', {\r\n      className: 'vidply-playlist-panel',\r\n      attributes: {\r\n        id: `${this.uniqueId}-panel`,\r\n        role: 'region',\r\n        'aria-label': i18n.t('playlist.title'),\r\n        'aria-labelledby': `${this.uniqueId}-heading`\r\n      }\r\n    });\r\n    this.playlistPanel.style.display = this.isPanelVisible ? 'none' : 'none'; // Will be shown when playlist is loaded\r\n    \r\n    this.container.appendChild(this.playlistPanel);\r\n  }\r\n  \r\n  /**\r\n   * Update track info display\r\n   */\r\n  updateTrackInfo(track) {\r\n    if (!this.trackInfoElement) return;\r\n    \r\n    const trackNumber = this.currentIndex + 1;\r\n    const totalTracks = this.tracks.length;\r\n    const trackTitle = track.title || i18n.t('playlist.untitled');\r\n    const trackArtist = track.artist || '';\r\n    \r\n    // Use effective duration (audio description duration when AD is enabled)\r\n    const effectiveDuration = this.getEffectiveDuration(track);\r\n    const trackDuration = effectiveDuration ? TimeUtils.formatTime(effectiveDuration) : '';\r\n    const trackDurationReadable = effectiveDuration ? TimeUtils.formatDuration(effectiveDuration) : '';\r\n    \r\n    // Screen reader announcement - include duration if available\r\n    const artistPart = trackArtist ? i18n.t('playlist.by') + trackArtist : '';\r\n    const durationPart = trackDurationReadable ? `. ${trackDurationReadable}` : '';\r\n    const announcement = i18n.t('playlist.nowPlaying', {\r\n      current: trackNumber,\r\n      total: totalTracks,\r\n      title: trackTitle,\r\n      artist: artistPart\r\n    }) + durationPart;\r\n    \r\n    const trackOfText = i18n.t('playlist.trackOf', {\r\n      current: trackNumber,\r\n      total: totalTracks\r\n    });\r\n    \r\n    // Build duration HTML if available\r\n    const durationHtml = trackDuration \r\n      ? `<span class=\"vidply-track-duration\" aria-hidden=\"true\">${DOMUtils.escapeHTML(trackDuration)}</span>` \r\n      : '';\r\n    \r\n    // Get description if available\r\n    const trackDescription = track.description || '';\r\n    \r\n    this.trackInfoElement.innerHTML = `\r\n      <span class=\"vidply-sr-only\">${DOMUtils.escapeHTML(announcement)}</span>\r\n      <div class=\"vidply-track-header\" aria-hidden=\"true\">\r\n        <span class=\"vidply-track-number\">${DOMUtils.escapeHTML(trackOfText)}</span>\r\n        ${durationHtml}\r\n      </div>\r\n      <div class=\"vidply-track-title\" aria-hidden=\"true\">${DOMUtils.escapeHTML(trackTitle)}</div>\r\n      ${trackArtist ? `<div class=\"vidply-track-artist\" aria-hidden=\"true\">${DOMUtils.escapeHTML(trackArtist)}</div>` : ''}\r\n      ${trackDescription ? `<div class=\"vidply-track-description\" aria-hidden=\"true\">${DOMUtils.escapeHTML(trackDescription)}</div>` : ''}\r\n    `;\r\n    \r\n    this.trackInfoElement.style.display = 'block';\r\n    \r\n    // Update track artwork if available (for audio playlists)\r\n    this.updateTrackArtwork(track);\r\n  }\r\n  \r\n  /**\r\n   * Update track artwork display (for audio playlists)\r\n   */\r\n  updateTrackArtwork(track) {\r\n    // Only show artwork for audio players.\r\n    // In mixed playlists we may recreate from <video> -> <audio> later, so ensure the element exists lazily.\r\n    if (this.player?.element?.tagName !== 'AUDIO') {\r\n      if (this.trackArtworkElement) {\r\n        this.trackArtworkElement.style.display = 'none';\r\n      }\r\n      return;\r\n    }\r\n\r\n    // Lazily create artwork element once we have an audio element/container.\r\n    if (!this.trackArtworkElement && this.container) {\r\n      this.trackArtworkElement = DOMUtils.createElement('div', {\r\n        className: 'vidply-track-artwork',\r\n        attributes: {\r\n          'aria-hidden': 'true'\r\n        }\r\n      });\r\n      this.trackArtworkElement.style.display = 'none';\r\n\r\n      // Insert before video wrapper (if present) for consistent layout.\r\n      const videoWrapper = this.container.querySelector('.vidply-video-wrapper');\r\n      if (videoWrapper) {\r\n        this.container.insertBefore(this.trackArtworkElement, videoWrapper);\r\n      } else {\r\n        this.container.appendChild(this.trackArtworkElement);\r\n      }\r\n    }\r\n\r\n    if (!this.trackArtworkElement) return;\r\n    \r\n    // If track has a poster/artwork, show it\r\n    if (track.poster) {\r\n      this.trackArtworkElement.style.backgroundImage = `url(${track.poster})`;\r\n      this.trackArtworkElement.style.display = 'block';\r\n    } else {\r\n      // No artwork available, hide the element\r\n      this.trackArtworkElement.style.display = 'none';\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Render playlist\r\n   */\r\n  renderPlaylist() {\r\n    if (!this.playlistPanel) return;\r\n    \r\n    // Clear existing\r\n    this.playlistPanel.innerHTML = '';\r\n    \r\n    // Create header\r\n    const header = DOMUtils.createElement('h2', {\r\n      className: 'vidply-playlist-header',\r\n      attributes: {\r\n        id: `${this.uniqueId}-heading`\r\n      }\r\n    });\r\n    header.textContent = `${i18n.t('playlist.title')} (${this.tracks.length})`;\r\n    this.playlistPanel.appendChild(header);\r\n    \r\n    // Add keyboard instructions (visually hidden)\r\n    const instructions = DOMUtils.createElement('div', {\r\n      className: 'vidply-sr-only',\r\n      attributes: {\r\n        id: `${this.uniqueId}-keyboard-instructions`\r\n      }\r\n    });\r\n    instructions.textContent = i18n.t('playlist.keyboardInstructions');\r\n    this.playlistPanel.appendChild(instructions);\r\n    \r\n    // Create list (proper ul element)\r\n    const list = DOMUtils.createElement('ul', {\r\n      className: 'vidply-playlist-list',\r\n      attributes: {\r\n        role: 'listbox',\r\n        'aria-labelledby': `${this.uniqueId}-heading`,\r\n        'aria-describedby': `${this.uniqueId}-keyboard-instructions`\r\n      }\r\n    });\r\n    \r\n    this.tracks.forEach((track, index) => {\r\n      const item = this.createPlaylistItem(track, index);\r\n      list.appendChild(item);\r\n    });\r\n    \r\n    this.playlistPanel.appendChild(list);\r\n    \r\n    // Show panel if it should be visible\r\n    if (this.isPanelVisible) {\r\n      this.playlistPanel.style.display = 'block';\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Create playlist item element\r\n   */\r\n  createPlaylistItem(track, index) {\r\n    const trackPosition = i18n.t('playlist.trackOf', {\r\n      current: index + 1,\r\n      total: this.tracks.length\r\n    });\r\n    const trackTitle = track.title || i18n.t('playlist.trackUntitled', { number: index + 1 });\r\n    const trackArtist = track.artist ? i18n.t('playlist.by') + track.artist : '';\r\n    \r\n    // Use effective duration (audio description duration when AD is enabled)\r\n    const effectiveDuration = this.getEffectiveDuration(track);\r\n    const trackDuration = effectiveDuration ? TimeUtils.formatTime(effectiveDuration) : '';\r\n    const trackDurationReadable = effectiveDuration ? TimeUtils.formatDuration(effectiveDuration) : '';\r\n    const isActive = index === this.currentIndex;\r\n    \r\n    // Build accessible label for screen readers\r\n    // With role=\"option\" and aria-checked, screen reader will announce selection state\r\n    // Position is already announced via aria-posinset/aria-setsize\r\n    // Format: \"Title by Artist. 3 minutes, 45 seconds.\"\r\n    let ariaLabel = `${trackTitle}${trackArtist}`;\r\n    if (trackDurationReadable) {\r\n      ariaLabel += `. ${trackDurationReadable}`;\r\n    }\r\n    \r\n    // Create list item container (semantic HTML)\r\n    const item = DOMUtils.createElement('li', {\r\n      className: isActive ? 'vidply-playlist-item vidply-playlist-item-active' : 'vidply-playlist-item',\r\n      attributes: {\r\n        'data-playlist-index': index\r\n      }\r\n    });\r\n    \r\n    // Create button wrapper for interactive content\r\n    const button = DOMUtils.createElement('button', {\r\n      className: 'vidply-playlist-item-button',\r\n      attributes: {\r\n        type: 'button',\r\n        role: 'option',\r\n        tabIndex: index === 0 ? 0 : -1, // Only first item is in tab order initially\r\n        'aria-label': ariaLabel,\r\n        'aria-posinset': index + 1,\r\n        'aria-setsize': this.tracks.length,\r\n        'aria-checked': isActive ? 'true' : 'false'\r\n      }\r\n    });\r\n    \r\n    // Add aria-current if active\r\n    if (isActive) {\r\n      button.setAttribute('aria-current', 'true');\r\n      button.setAttribute('tabIndex', '0'); // Active item should always be tabbable\r\n    }\r\n    \r\n    // Thumbnail container with optional duration badge\r\n    const thumbnailContainer = DOMUtils.createElement('span', {\r\n      className: 'vidply-playlist-thumbnail-container',\r\n      attributes: {\r\n        'aria-hidden': 'true'\r\n      }\r\n    });\r\n    \r\n    // Thumbnail or icon\r\n    const thumbnail = DOMUtils.createElement('span', {\r\n      className: 'vidply-playlist-thumbnail'\r\n    });\r\n    \r\n    if (track.poster) {\r\n      thumbnail.style.backgroundImage = `url(${track.poster})`;\r\n    } else {\r\n      // Show music/speaker icon for audio tracks\r\n      const icon = createIconElement('music');\r\n      icon.classList.add('vidply-playlist-thumbnail-icon');\r\n      thumbnail.appendChild(icon);\r\n    }\r\n    \r\n    thumbnailContainer.appendChild(thumbnail);\r\n    \r\n    // Duration badge on thumbnail (like YouTube) - only show if there's a poster\r\n    if (trackDuration && track.poster) {\r\n      const durationBadge = DOMUtils.createElement('span', {\r\n        className: 'vidply-playlist-duration-badge'\r\n      });\r\n      durationBadge.textContent = trackDuration;\r\n      thumbnailContainer.appendChild(durationBadge);\r\n    }\r\n    \r\n    button.appendChild(thumbnailContainer);\r\n    \r\n    // Info section (title, artist, description)\r\n    const info = DOMUtils.createElement('span', {\r\n      className: 'vidply-playlist-item-info',\r\n      attributes: {\r\n        'aria-hidden': 'true'\r\n      }\r\n    });\r\n    \r\n    // Title row with optional inline duration (for when no thumbnail)\r\n    const titleRow = DOMUtils.createElement('span', {\r\n      className: 'vidply-playlist-item-title-row'\r\n    });\r\n    \r\n    const title = DOMUtils.createElement('span', {\r\n      className: 'vidply-playlist-item-title'\r\n    });\r\n    title.textContent = trackTitle;\r\n    titleRow.appendChild(title);\r\n    \r\n    // Inline duration (shown when no poster/thumbnail)\r\n    if (trackDuration && !track.poster) {\r\n      const inlineDuration = DOMUtils.createElement('span', {\r\n        className: 'vidply-playlist-item-duration'\r\n      });\r\n      inlineDuration.textContent = trackDuration;\r\n      titleRow.appendChild(inlineDuration);\r\n    }\r\n    \r\n    info.appendChild(titleRow);\r\n    \r\n    // Artist\r\n    if (track.artist) {\r\n      const artist = DOMUtils.createElement('span', {\r\n        className: 'vidply-playlist-item-artist'\r\n      });\r\n      artist.textContent = track.artist;\r\n      info.appendChild(artist);\r\n    }\r\n    \r\n    // Description (truncated)\r\n    if (track.description) {\r\n      const description = DOMUtils.createElement('span', {\r\n        className: 'vidply-playlist-item-description'\r\n      });\r\n      description.textContent = track.description;\r\n      info.appendChild(description);\r\n    }\r\n    \r\n    button.appendChild(info);\r\n    \r\n    // Play icon\r\n    const playIcon = createIconElement('play');\r\n    playIcon.classList.add('vidply-playlist-item-icon');\r\n    playIcon.setAttribute('aria-hidden', 'true');\r\n    button.appendChild(playIcon);\r\n    \r\n    // Click handler\r\n    button.addEventListener('click', () => {\r\n      const track = this.tracks[index];\r\n      const isExternalRenderer = this.isExternalRendererUrl(track?.src);\r\n      \r\n      // Exit fullscreen for external renderer tracks (YouTube, Vimeo, SoundCloud)\r\n      // These have their own native controls that work better outside vidply's fullscreen\r\n      if (isExternalRenderer && this.player.state.fullscreen) {\r\n        this.player.exitFullscreen();\r\n        // Small delay to let fullscreen exit before loading\r\n        setTimeout(() => {\r\n          this.play(index, true);\r\n        }, 100);\r\n      } else {\r\n        this.play(index, true); // User-initiated\r\n      }\r\n    });\r\n    \r\n    // Keyboard handler\r\n    button.addEventListener('keydown', (e) => {\r\n      this.handlePlaylistItemKeydown(e, index);\r\n    });\r\n    \r\n    // Append button to list item\r\n    item.appendChild(button);\r\n    \r\n    return item;\r\n  }\r\n  \r\n  /**\r\n   * Handle keyboard navigation in playlist items\r\n   */\r\n  handlePlaylistItemKeydown(e, index) {\r\n    const buttons = Array.from(this.playlistPanel.querySelectorAll('.vidply-playlist-item-button'));\r\n    let newIndex = -1;\r\n    let announcement = '';\r\n    \r\n    switch(e.key) {\r\n      case 'Enter':\r\n      case ' ':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        {\r\n          const track = this.tracks[index];\r\n          const isExternalRenderer = this.isExternalRendererUrl(track?.src);\r\n          \r\n          // Exit fullscreen for external renderer tracks (YouTube, Vimeo, SoundCloud)\r\n          if (isExternalRenderer && this.player.state.fullscreen) {\r\n            this.player.exitFullscreen();\r\n            setTimeout(() => {\r\n              this.play(index, true);\r\n            }, 100);\r\n          } else {\r\n            this.play(index, true); // User-initiated\r\n          }\r\n        }\r\n        return; // No need to move focus\r\n        \r\n      case 'ArrowDown':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move to next item\r\n        if (index < buttons.length - 1) {\r\n          newIndex = index + 1;\r\n        } else {\r\n          // At the end, announce boundary\r\n          announcement = i18n.t('playlist.endOfPlaylist', { current: buttons.length, total: buttons.length });\r\n        }\r\n        break;\r\n\r\n      case 'ArrowUp':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move to previous item\r\n        if (index > 0) {\r\n          newIndex = index - 1;\r\n        } else {\r\n          // At the beginning, announce boundary\r\n          announcement = i18n.t('playlist.beginningOfPlaylist', { total: buttons.length });\r\n        }\r\n        break;\r\n\r\n      case 'PageDown':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move 5 items down (or to end)\r\n        newIndex = Math.min(index + 5, buttons.length - 1);\r\n        if (newIndex === buttons.length - 1 && index !== newIndex) {\r\n          announcement = i18n.t('playlist.jumpedToLastTrack', { current: newIndex + 1, total: buttons.length });\r\n        }\r\n        break;\r\n\r\n      case 'PageUp':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move 5 items up (or to beginning)\r\n        newIndex = Math.max(index - 5, 0);\r\n        if (newIndex === 0 && index !== newIndex) {\r\n          announcement = i18n.t('playlist.jumpedToFirstTrack', { total: buttons.length });\r\n        }\r\n        break;\r\n\r\n      case 'Home':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move to first item\r\n        newIndex = 0;\r\n        if (index !== 0) {\r\n          announcement = i18n.t('playlist.firstTrack', { total: buttons.length });\r\n        }\r\n        break;\r\n\r\n      case 'End':\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        // Move to last item\r\n        newIndex = buttons.length - 1;\r\n        if (index !== buttons.length - 1) {\r\n          announcement = i18n.t('playlist.lastTrack', { current: buttons.length, total: buttons.length });\r\n        }\r\n        break;\r\n    }\r\n    \r\n    // Update tab indices for roving tabindex pattern\r\n    if (newIndex !== -1 && newIndex !== index) {\r\n      buttons[index].setAttribute('tabIndex', '-1');\r\n      buttons[newIndex].setAttribute('tabIndex', '0');\r\n      buttons[newIndex].focus({ preventScroll: false });\r\n      \r\n      // Scroll the focused item into view (same behavior as mouse interaction)\r\n      const item = buttons[newIndex].closest('.vidply-playlist-item');\r\n      if (item) {\r\n        item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n      }\r\n    }\r\n    \r\n    // Announce navigation feedback\r\n    if (announcement && this.navigationFeedback) {\r\n      this.navigationFeedback.textContent = announcement;\r\n      // Clear after a short delay to allow for repeated announcements\r\n      setTimeout(() => {\r\n        if (this.navigationFeedback) {\r\n          this.navigationFeedback.textContent = '';\r\n        }\r\n      }, 1000);\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Update playlist UI (highlight current track)\r\n   */\r\n  updatePlaylistUI() {\r\n    if (!this.playlistPanel) return;\r\n    \r\n    const items = this.playlistPanel.querySelectorAll('.vidply-playlist-item');\r\n    const buttons = this.playlistPanel.querySelectorAll('.vidply-playlist-item-button');\r\n    \r\n    items.forEach((item, index) => {\r\n      const button = buttons[index];\r\n      if (!button) return;\r\n      \r\n      const track = this.tracks[index];\r\n      const trackPosition = i18n.t('playlist.trackOf', {\r\n        current: index + 1,\r\n        total: this.tracks.length\r\n      });\r\n      const trackTitle = track.title || i18n.t('playlist.trackUntitled', { number: index + 1 });\r\n      const trackArtist = track.artist ? i18n.t('playlist.by') + track.artist : '';\r\n      \r\n      // Use effective duration (audio description duration when AD is enabled)\r\n      const effectiveDuration = this.getEffectiveDuration(track);\r\n      const trackDurationReadable = effectiveDuration ? TimeUtils.formatDuration(effectiveDuration) : '';\r\n      \r\n      if (index === this.currentIndex) {\r\n        // Update list item styling\r\n        item.classList.add('vidply-playlist-item-active');\r\n        \r\n        // Update button ARIA attributes\r\n        button.setAttribute('aria-current', 'true');\r\n        button.setAttribute('aria-checked', 'true');\r\n        button.setAttribute('tabIndex', '0'); // Active item should be tabbable\r\n        \r\n        // Simplified aria-label - status and actions are announced via ARIA roles\r\n        let ariaLabel = `${trackTitle}${trackArtist}`;\r\n        if (trackDurationReadable) {\r\n          ariaLabel += `. ${trackDurationReadable}`;\r\n        }\r\n        button.setAttribute('aria-label', ariaLabel);\r\n        \r\n        // Scroll into view within playlist panel (uses 'nearest' to minimize page scroll)\r\n        item.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\r\n      } else {\r\n        // Update list item styling\r\n        item.classList.remove('vidply-playlist-item-active');\r\n        \r\n        // Update button ARIA attributes\r\n        button.removeAttribute('aria-current');\r\n        button.setAttribute('aria-checked', 'false');\r\n        button.setAttribute('tabIndex', '-1'); // Remove from tab order (use arrow keys)\r\n        \r\n        // Simplified aria-label - status and actions are announced via ARIA roles\r\n        let ariaLabel = `${trackTitle}${trackArtist}`;\r\n        if (trackDurationReadable) {\r\n          ariaLabel += `. ${trackDurationReadable}`;\r\n        }\r\n        button.setAttribute('aria-label', ariaLabel);\r\n      }\r\n    });\r\n  }\r\n  \r\n  /**\r\n   * Get current track\r\n   */\r\n  getCurrentTrack() {\r\n    return this.tracks[this.currentIndex] || null;\r\n  }\r\n  \r\n  /**\r\n   * Get playlist info\r\n   */\r\n  getPlaylistInfo() {\r\n    return {\r\n      currentIndex: this.currentIndex,\r\n      totalTracks: this.tracks.length,\r\n      currentTrack: this.getCurrentTrack(),\r\n      hasNext: this.hasNext(),\r\n      hasPrevious: this.hasPrevious()\r\n    };\r\n  }\r\n  \r\n  /**\r\n   * Check if there is a next track\r\n   */\r\n  hasNext() {\r\n    if (this.options.loop) return true;\r\n    return this.currentIndex < this.tracks.length - 1;\r\n  }\r\n  \r\n  /**\r\n   * Check if there is a previous track\r\n   */\r\n  hasPrevious() {\r\n    if (this.options.loop) return true;\r\n    return this.currentIndex > 0;\r\n  }\r\n  \r\n  /**\r\n   * Add track to playlist\r\n   */\r\n  addTrack(track) {\r\n    this.tracks.push(track);\r\n    \r\n    if (this.playlistPanel) {\r\n      this.renderPlaylist();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Remove track from playlist\r\n   */\r\n  removeTrack(index) {\r\n    if (index < 0 || index >= this.tracks.length) return;\r\n    \r\n    this.tracks.splice(index, 1);\r\n    \r\n    // Adjust current index if needed\r\n    if (index < this.currentIndex) {\r\n      this.currentIndex--;\r\n    } else if (index === this.currentIndex) {\r\n      // Current track was removed, play next or stop\r\n      if (this.currentIndex >= this.tracks.length) {\r\n        this.currentIndex = this.tracks.length - 1;\r\n      }\r\n      \r\n      if (this.currentIndex >= 0) {\r\n        this.play(this.currentIndex);\r\n      }\r\n    }\r\n    \r\n    if (this.playlistPanel) {\r\n      this.renderPlaylist();\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Clear playlist\r\n   */\r\n  clear() {\r\n    this.tracks = [];\r\n    this.currentIndex = -1;\r\n    \r\n    if (this.playlistPanel) {\r\n      this.playlistPanel.innerHTML = '';\r\n      this.playlistPanel.style.display = 'none';\r\n    }\r\n    \r\n    if (this.trackInfoElement) {\r\n      this.trackInfoElement.innerHTML = '';\r\n      this.trackInfoElement.style.display = 'none';\r\n    }\r\n    \r\n    if (this.trackArtworkElement) {\r\n      this.trackArtworkElement.style.backgroundImage = '';\r\n      this.trackArtworkElement.style.display = 'none';\r\n    }\r\n  }\r\n  \r\n  /**\r\n   * Toggle playlist panel visibility\r\n   * @param {boolean} show - Optional: force show (true) or hide (false)\r\n   * @returns {boolean} - New visibility state\r\n   */\r\n  togglePanel(show) {\r\n    if (!this.playlistPanel) return false;\r\n    \r\n    // Determine new state\r\n    const shouldShow = show !== undefined ? show : this.playlistPanel.style.display === 'none';\r\n    \r\n    if (shouldShow) {\r\n      this.playlistPanel.style.display = 'block';\r\n      this.isPanelVisible = true;\r\n      \r\n      // Focus first item if playlist has tracks\r\n      if (this.tracks.length > 0) {\r\n        setTimeout(() => {\r\n          const firstItem = this.playlistPanel.querySelector('.vidply-playlist-item[tabindex=\"0\"]');\r\n          if (firstItem) {\r\n            firstItem.focus({ preventScroll: true });\r\n          }\r\n        }, 100);\r\n      }\r\n      \r\n      // Update toggle button state if it exists\r\n      if (this.player.controlBar && this.player.controlBar.controls.playlistToggle) {\r\n        this.player.controlBar.controls.playlistToggle.setAttribute('aria-expanded', 'true');\r\n        this.player.controlBar.controls.playlistToggle.setAttribute('aria-pressed', 'true');\r\n      }\r\n    } else {\r\n      this.playlistPanel.style.display = 'none';\r\n      this.isPanelVisible = false;\r\n      \r\n      // Update toggle button state if it exists\r\n      if (this.player.controlBar && this.player.controlBar.controls.playlistToggle) {\r\n        this.player.controlBar.controls.playlistToggle.setAttribute('aria-expanded', 'false');\r\n        this.player.controlBar.controls.playlistToggle.setAttribute('aria-pressed', 'false');\r\n        \r\n        // Return focus to toggle button\r\n        this.player.controlBar.controls.playlistToggle.focus({ preventScroll: true });\r\n      }\r\n    }\r\n    \r\n    return this.isPanelVisible;\r\n  }\r\n  \r\n  /**\r\n   * Show playlist panel\r\n   */\r\n  showPanel() {\r\n    return this.togglePanel(true);\r\n  }\r\n  \r\n  /**\r\n   * Hide playlist panel\r\n   */\r\n  hidePanel() {\r\n    return this.togglePanel(false);\r\n  }\r\n  \r\n  /**\r\n   * Destroy playlist manager\r\n   */\r\n  destroy() {\r\n    // Remove event listeners\r\n    this.player.off('ended', this.handleTrackEnd);\r\n    this.player.off('error', this.handleTrackError);\r\n    \r\n    // Remove UI\r\n    if (this.trackArtworkElement) {\r\n      this.trackArtworkElement.remove();\r\n    }\r\n    \r\n    if (this.trackInfoElement) {\r\n      this.trackInfoElement.remove();\r\n    }\r\n    \r\n    if (this.playlistPanel) {\r\n      this.playlistPanel.remove();\r\n    }\r\n    \r\n    // Clear data\r\n    this.clear();\r\n  }\r\n}\r\n\r\nexport default PlaylistManager;\r\n", "/**\r\n * VidPly - Universal Video Player\r\n * Main Entry Point\r\n */\r\n\r\nimport { Player } from './core/Player.js';\r\nimport { PlaylistManager } from './features/PlaylistManager.js';\r\n\r\n// Auto-initialize players\r\nfunction initializePlayers() {\r\n  const elements = document.querySelectorAll('[data-vidply]');\r\n  \r\n  elements.forEach(element => {\r\n    // Parse options from data attribute (JSON format)\r\n    const options = element.dataset.vidplyOptions \r\n      ? JSON.parse(element.dataset.vidplyOptions)\r\n      : {};\r\n    \r\n    // Parse individual data attributes and merge with options\r\n    // This allows for easier HTML-based configuration\r\n    const dataOptions = parseDataAttributes(element.dataset);\r\n    const mergedOptions = { ...dataOptions, ...options };\r\n    \r\n    // Create player instance\r\n    new Player(element, mergedOptions);\r\n  });\r\n}\r\n\r\n// Helper function to parse data attributes into options\r\nfunction parseDataAttributes(dataset) {\r\n  const options = {};\r\n  \r\n  // Map of data attribute names to option keys (camelCase conversion)\r\n  const attributeMap = {\r\n    // Sign Language\r\n    'signLanguageSrc': 'signLanguageSrc',\r\n    'signLanguageButton': 'signLanguageButton',\r\n    'signLanguagePosition': 'signLanguagePosition',\r\n    'signLanguageDisplayMode': 'signLanguageDisplayMode',\r\n    \r\n    // Audio Description\r\n    'audioDescriptionSrc': 'audioDescriptionSrc',\r\n    'audioDescriptionButton': 'audioDescriptionButton',\r\n    \r\n    // Other common options\r\n    'autoplay': 'autoplay',\r\n    'loop': 'loop',\r\n    'muted': 'muted',\r\n    'controls': 'controls',\r\n    'poster': 'poster',\r\n    'width': 'width',\r\n    'height': 'height',\r\n    'language': 'language',\r\n    'captions': 'captions',\r\n    'captionsDefault': 'captionsDefault',\r\n    'transcript': 'transcript',\r\n    'transcriptButton': 'transcriptButton',\r\n    'keyboard': 'keyboard',\r\n    'responsive': 'responsive',\r\n    'pipButton': 'pipButton',\r\n    'fullscreenButton': 'fullscreenButton',\r\n\r\n    // Layout\r\n  };\r\n  \r\n  // Parse each data attribute\r\n  Object.keys(attributeMap).forEach(dataKey => {\r\n    const optionKey = attributeMap[dataKey];\r\n    const value = dataset[dataKey];\r\n    \r\n    if (value !== undefined) {\r\n      // Convert string values to appropriate types\r\n      if (value === 'true') {\r\n        options[optionKey] = true;\r\n      } else if (value === 'false') {\r\n        options[optionKey] = false;\r\n      } else if (!isNaN(value) && value !== '') {\r\n        options[optionKey] = Number(value);\r\n      } else {\r\n        options[optionKey] = value;\r\n      }\r\n    }\r\n  });\r\n  \r\n  // Parse sign language sources with language codes (e.g., data-sign-language-src-en, data-sign-language-src-de)\r\n  // In dataset, hyphens become camelCase: data-sign-language-src-en -> signLanguageSrcEn\r\n  const signLanguageSources = {};\r\n  Object.keys(dataset).forEach(key => {\r\n    if (key.startsWith('signLanguageSrc') && key !== 'signLanguageSrc') {\r\n      // Extract language code from key (e.g., 'signLanguageSrcEn' -> 'en', 'signLanguageSrcDe' -> 'de')\r\n      // Handle both single and multi-word language codes\r\n      const langMatch = key.match(/^signLanguageSrc([A-Z][a-z]*)$/);\r\n      if (langMatch) {\r\n        const langCode = langMatch[1].toLowerCase();\r\n        signLanguageSources[langCode] = dataset[key];\r\n      }\r\n    }\r\n  });\r\n  \r\n  if (Object.keys(signLanguageSources).length > 0) {\r\n    options.signLanguageSources = signLanguageSources;\r\n    // If there's also a single signLanguageSrc, use it as default/fallback\r\n    if (dataset.signLanguageSrc && !options.signLanguageSrc) {\r\n      options.signLanguageSrc = dataset.signLanguageSrc;\r\n    }\r\n  }\r\n  \r\n  // Handle language file attributes\r\n  // Support for multiple language files: data-vidply-language-files='{\"pt\": \"path/to/pt.json\", \"it\": \"path/to/it.json\"}'\r\n  if (dataset.vidplyLanguageFiles) {\r\n    try {\r\n      options.languageFiles = JSON.parse(dataset.vidplyLanguageFiles);\r\n    } catch (e) {\r\n      console.warn('Invalid JSON in data-vidply-language-files:', e);\r\n    }\r\n  }\r\n  \r\n  // Support for single language file: data-vidply-language-file='{\"pt\": \"path/to/pt.json\"}'\r\n  // or data-vidply-language-file-code=\"pt\" + data-vidply-language-file-url=\"path/to/pt.json\"\r\n  if (dataset.vidplyLanguageFile) {\r\n    try {\r\n      const parsed = JSON.parse(dataset.vidplyLanguageFile);\r\n      // If it's an object, treat it as languageFiles\r\n      if (typeof parsed === 'object' && parsed !== null) {\r\n        options.languageFiles = parsed;\r\n      }\r\n    } catch (e) {\r\n      // If parsing fails, check for separate code and URL attributes\r\n      if (dataset.vidplyLanguageFileCode && dataset.vidplyLanguageFileUrl) {\r\n        options.languageFile = dataset.vidplyLanguageFileCode;\r\n        options.languageFileUrl = dataset.vidplyLanguageFileUrl;\r\n      }\r\n    }\r\n  } else if (dataset.vidplyLanguageFileCode && dataset.vidplyLanguageFileUrl) {\r\n    // Support separate attributes for single language file\r\n    options.languageFile = dataset.vidplyLanguageFileCode;\r\n    options.languageFileUrl = dataset.vidplyLanguageFileUrl;\r\n  }\r\n  \r\n  return options;\r\n}\r\n\r\n// Auto-initialize on DOM ready\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', initializePlayers);\r\n} else {\r\n  initializePlayers();\r\n}\r\n\r\n// Export for manual initialization\r\nexport { Player, PlaylistManager };\r\nexport default Player;\r\n\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,MAKa;AALb;AAAA;AAKO,MAAM,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOtB,cAAc,KAAK,UAAU,CAAC,GAAG;AAC/B,gBAAM,UAAU,SAAS,cAAc,GAAG;AAE1C,cAAI,QAAQ,WAAW;AACrB,oBAAQ,YAAY,QAAQ;AAAA,UAC9B;AAEA,cAAI,QAAQ,YAAY;AACtB,uBAAW,CAAC,KAAK,KAAK,KAAK,OAAO,QAAQ,QAAQ,UAAU,GAAG;AAC7D,sBAAQ,aAAa,KAAK,KAAK;AAAA,YACjC;AAAA,UACF;AAEA,cAAI,QAAQ,WAAW;AACrB,oBAAQ,YAAY,QAAQ;AAAA,UAC9B;AAEA,cAAI,QAAQ,aAAa;AACvB,oBAAQ,cAAc,QAAQ;AAAA,UAChC;AAEA,cAAI,QAAQ,OAAO;AACjB,mBAAO,OAAO,QAAQ,OAAO,QAAQ,KAAK;AAAA,UAC5C;AAEA,cAAI,QAAQ,UAAU;AACpB,uBAAW,SAAS,QAAQ,UAAU;AACpC,kBAAI,MAAO,SAAQ,YAAY,KAAK;AAAA,YACtC;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,KAAK,SAAS;AACZ,8CAAS,WAAU,QAAQ,MAAM,UAAU;AAAA,QAC7C;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,KAAK,SAAS;AACZ,8CAAS,WAAU,QAAQ,MAAM,UAAU;AAAA,QAC7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,OAAO,SAAS,WAAW,KAAK,YAAY;AAC1C,cAAI,CAAC,QAAS;AAGd,kBAAQ,MAAM,UAAU;AACxB,kBAAQ,MAAM,UAAU;AACxB,kBAAQ,MAAM,aAAa,WAAW,iBAAQ;AAG9C,kBAAQ;AAGR,kBAAQ,MAAM,UAAU;AAGxB,cAAI,YAAY;AACd,kBAAM,UAAU,MAAM;AACpB,sBAAQ,oBAAoB,iBAAiB,OAAO;AACpD,yBAAW;AAAA,YACb;AACA,oBAAQ,iBAAiB,iBAAiB,SAAS,EAAE,MAAM,KAAK,CAAC;AAEjE,uBAAW,SAAS,WAAW,EAAE;AAAA,UACnC;AAAA,QACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,QAAQ,SAAS,WAAW,KAAK,YAAY;AAC3C,cAAI,CAAC,QAAS;AAEd,kBAAQ,MAAM,aAAa,WAAW,iBAAQ;AAC9C,kBAAQ,MAAM,UAAU;AAExB,gBAAM,UAAU,MAAM;AACpB,oBAAQ,oBAAoB,iBAAiB,OAAO;AACpD,oBAAQ,MAAM,UAAU;AACxB,gBAAI,WAAY,YAAW;AAAA,UAC7B;AAEA,kBAAQ,iBAAiB,iBAAiB,SAAS,EAAE,MAAM,KAAK,CAAC;AAEjE,qBAAW,SAAS,WAAW,EAAE;AAAA,QACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,OAAO,SAAS;AACd,cAAI,CAAC,QAAS,QAAO,EAAE,KAAK,GAAG,MAAM,GAAG,OAAO,GAAG,QAAQ,EAAE;AAE5D,gBAAM,OAAO,QAAQ,sBAAsB;AAC3C,iBAAO;AAAA,YACL,KAAK,KAAK,MAAM,OAAO;AAAA,YACvB,MAAM,KAAK,OAAO,OAAO;AAAA,YACzB,OAAO,KAAK;AAAA,YACZ,QAAQ,KAAK;AAAA,UACf;AAAA,QACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,WAAW,KAAK;AACd,gBAAM,YAAY;AAAA,YAChB,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,UACP;AACA,iBAAO,IAAI,QAAQ,YAAY,UAAQ,UAAU,IAAI,CAAC;AAAA,QACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,aAAa,MAAM;AAEjB,gBAAM,WAAW,KACd,QAAQ,uDAAuD,EAAE,EACjE,QAAQ,uDAAuD,EAAE,EACjE,QAAQ,eAAe,EAAE,EACzB,QAAQ,iBAAiB,EAAE;AAG9B,gBAAM,OAAO,SAAS,cAAc,KAAK;AACzC,eAAK,YAAY;AACjB,iBAAO,KAAK;AAAA,QACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,cAAc,MAAM,cAAc,UAAU;AAC1C,iBAAO,KAAK,cAAc,QAAQ;AAAA,YAChC,WAAW,GAAG,oBAAW;AAAA,YACzB,aAAa;AAAA,YACb,YAAY,EAAE,eAAe,OAAO;AAAA,UACtC,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,cAAc,SAAS,MAAM,cAAc,UAAU;AA9LvD;AA+LI,cAAI,CAAC,WAAW,CAAC,KAAM;AAGvB,wBAAQ,cAAc,IAAI,oBAAW,WAAU,MAA/C,mBAAkD;AAElD,gBAAM,UAAU,KAAK,cAAc,MAAM,WAAW;AACpD,kBAAQ,YAAY,OAAO;AAE3B,gBAAM,eAAe,GAAG,oBAAW;AACnC,gBAAM,OAAO,MAAM,QAAQ,UAAU,IAAI,YAAY;AACrD,gBAAM,OAAO,MAAM,QAAQ,UAAU,OAAO,YAAY;AAExD,kBAAQ,iBAAiB,cAAc,IAAI;AAC3C,kBAAQ,iBAAiB,cAAc,IAAI;AAC3C,kBAAQ,iBAAiB,SAAS,IAAI;AACtC,kBAAQ,iBAAiB,QAAQ,IAAI;AAAA,QACvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,iBAAiB,MAAM,cAAc,UAAU;AAC7C,iBAAO,KAAK,cAAc,QAAQ;AAAA,YAChC,WAAW,GAAG,oBAAW;AAAA,YACzB,aAAa;AAAA,YACb,YAAY,EAAE,eAAe,OAAO;AAAA,UACtC,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,SAAS,SAAS,WAAW;AApO/B;AAqOI,mDAAS,cAAT,mBAAoB,IAAI;AAAA,QAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,YAAY,SAAS,WAAW;AA7OlC;AA8OI,mDAAS,cAAT,mBAAoB,OAAO;AAAA,QAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,YAAY,SAAS,WAAW;AAtPlC;AAuPI,mDAAS,cAAT,mBAAoB,OAAO;AAAA,QAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,SAAS,SAAS,WAAW;AAhQ/B;AAiQI,kBAAO,8CAAS,cAAT,mBAAoB,SAAS,eAA7B,YAA2C;AAAA,QACpD;AAAA,MACF;AAAA;AAAA;;;ACnQA,MAIa;AAJb;AAAA;AAIO,MAAM,KAAK;AAAA,QAChB,QAAQ;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,eAAe;AAAA,UACf,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,kBAAkB;AAAA,UAClB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,OAAO;AAAA,UACP,KAAK;AAAA,UACL,aAAa;AAAA,UACb,UAAU;AAAA,UACV,UAAU;AAAA,UACV,aAAa;AAAA,UACb,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,iBAAiB;AAAA,UACjB,OAAO;AAAA,UACP,WAAW;AAAA,UACX,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,oBAAoB;AAAA,UACpB,kCAAkC;AAAA,UAClC,8BAA8B;AAAA,UAC9B,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,aAAa;AAAA,UACb,WAAW;AAAA,UACX,wBAAwB;AAAA,UACxB,wBAAwB;AAAA,UACxB,0BAA0B;AAAA,UAC1B,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,UACzB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,0BAA0B;AAAA,UAC1B,2BAA2B;AAAA,UAC3B,cAAc;AAAA,UACd,aAAa;AAAA,UACb,eAAe;AAAA,QACjB;AAAA,QACA,UAAU;AAAA,UACR,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,iBAAiB;AAAA,UACjB,SAAS;AAAA,QACX;AAAA,QACA,WAAW;AAAA,UACT,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,QAAQ;AAAA,QACV;AAAA,QACA,cAAc;AAAA,UACZ,WAAW;AAAA,UACX,OAAO;AAAA,UACP,WAAW;AAAA,QACb;AAAA,QACA,aAAa;AAAA,UACX,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS;AAAA,QACX;AAAA,QACA,kBAAkB;AAAA,UAChB,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,cAAc;AAAA,UACZ,MAAM;AAAA,UACN,MAAM;AAAA,UACN,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,QAClB;AAAA,QACA,YAAY;AAAA,UACV,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS;AAAA,UACT,cAAc;AAAA,UACd,UAAU;AAAA,UACV,kBAAkB;AAAA,UAClB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,kBAAkB;AAAA,UAClB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,cAAc;AAAA,UACd,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,cAAc;AAAA,UACd,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,UAChB,oBAAoB;AAAA,UACpB,oBAAoB;AAAA,QACtB;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,OAAO;AAAA,UACP,UAAU;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACT;AAAA,QACA,QAAQ;AAAA,UACN,QAAQ;AAAA,QACV;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,eAAe;AAAA,UACf,kBAAkB;AAAA,UAClB,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,qBAAqB;AAAA,UACrB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,YAAY;AAAA,UACZ,WAAW;AAAA,QACb;AAAA,MACF;AAAA;AAAA;;;ACzLA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,KAAK;AAAA,QACd,QAAQ;AAAA,UACJ,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,eAAe;AAAA,UACf,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,kBAAkB;AAAA,UAClB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,OAAO;AAAA,UACP,KAAK;AAAA,UACL,aAAa;AAAA,UACb,UAAU;AAAA,UACV,UAAU;AAAA,UACV,aAAa;AAAA,UACb,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,iBAAiB;AAAA,UACjB,OAAO;AAAA,UACP,WAAW;AAAA,UACX,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,oBAAoB;AAAA,UACpB,kCAAkC;AAAA,UAClC,8BAA8B;AAAA,UAC9B,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,aAAa;AAAA,UACb,WAAW;AAAA,UACX,wBAAwB;AAAA,UACxB,wBAAwB;AAAA,UACxB,0BAA0B;AAAA,UAC1B,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,UACzB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,0BAA0B;AAAA,UAC1B,2BAA2B;AAAA,UAC3B,cAAc;AAAA,UACd,aAAa;AAAA,UACb,eAAe;AAAA,QACnB;AAAA,QACA,UAAU;AAAA,UACN,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,iBAAiB;AAAA,UACjB,SAAS;AAAA,QACb;AAAA,QACA,WAAW;AAAA,UACP,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,QAAQ;AAAA,QACZ;AAAA,QACA,cAAc;AAAA,UACV,WAAW;AAAA,UACX,OAAO;AAAA,UACP,WAAW;AAAA,QACf;AAAA,QACA,aAAa;AAAA,UACT,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS;AAAA,QACb;AAAA,QACA,kBAAkB;AAAA,UACd,QAAQ;AAAA,UACR,SAAS;AAAA,QACb;AAAA,QACA,cAAc;AAAA,UACV,MAAM;AAAA,UACN,MAAM;AAAA,UACN,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,QACpB;AAAA,QACA,YAAY;AAAA,UACR,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS;AAAA,UACT,cAAc;AAAA,UACd,UAAU;AAAA,UACV,kBAAkB;AAAA,UAClB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,kBAAkB;AAAA,UAClB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,cAAc;AAAA,UACd,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,cAAc;AAAA,UACd,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,UAChB,oBAAoB;AAAA,UACpB,oBAAoB;AAAA,QACxB;AAAA,QACA,UAAU;AAAA,UACN,OAAO;AAAA,UACP,SAAS;AAAA,UACT,OAAO;AAAA,UACP,UAAU;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACX;AAAA,QACA,QAAQ;AAAA,UACJ,QAAQ;AAAA,QACZ;AAAA,QACA,MAAM;AAAA,UACF,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,QACb;AAAA,QACA,UAAU;AAAA,UACN,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,eAAe;AAAA,UACf,kBAAkB;AAAA,UAClB,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,qBAAqB;AAAA,UACrB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,YAAY;AAAA,UACZ,WAAW;AAAA,QACf;AAAA,MACJ;AAAA;AAAA;;;ACzLA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,KAAK;AAAA,QAChB,QAAQ;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,eAAe;AAAA,UACf,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,kBAAkB;AAAA,UAClB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,OAAO;AAAA,UACP,KAAK;AAAA,UACL,aAAa;AAAA,UACb,UAAU;AAAA,UACV,UAAU;AAAA,UACV,aAAa;AAAA,UACb,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,iBAAiB;AAAA,UACjB,OAAO;AAAA,UACP,WAAW;AAAA,UACX,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,aAAa;AAAA,UACb,WAAW;AAAA,UACX,wBAAwB;AAAA,UACxB,wBAAwB;AAAA,UACxB,0BAA0B;AAAA,UAC1B,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,UACzB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,0BAA0B;AAAA,UAC1B,2BAA2B;AAAA,UAC3B,cAAc;AAAA,UACd,aAAa;AAAA,UACb,eAAe;AAAA,QACjB;AAAA,QACA,UAAU;AAAA,UACR,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,iBAAiB;AAAA,UACjB,SAAS;AAAA,QACX;AAAA,QACA,WAAW;AAAA,UACT,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,QAAQ;AAAA,QACV;AAAA,QACA,cAAc;AAAA,UACZ,WAAW;AAAA,UACX,OAAO;AAAA,UACP,WAAW;AAAA,QACb;AAAA,QACA,aAAa;AAAA,UACX,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS;AAAA,QACX;AAAA,QACA,kBAAkB;AAAA,UAChB,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,cAAc;AAAA,UACZ,MAAM;AAAA,UACN,MAAM;AAAA,UACN,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,QAClB;AAAA,QACA,YAAY;AAAA,UACV,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS;AAAA,UACT,cAAc;AAAA,UACd,UAAU;AAAA,UACV,kBAAkB;AAAA,UAClB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,kBAAkB;AAAA,UAClB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,cAAc;AAAA,UACd,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,cAAc;AAAA,UACd,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,UAChB,oBAAoB;AAAA,UACpB,oBAAoB;AAAA,QACtB;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,OAAO;AAAA,UACP,UAAU;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACT;AAAA,QACA,QAAQ;AAAA,UACN,QAAQ;AAAA,QACV;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,eAAe;AAAA,UACf,kBAAkB;AAAA,UAClB,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,qBAAqB;AAAA,UACrB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,YAAY;AAAA,UACZ,WAAW;AAAA,QACb;AAAA,MACF;AAAA;AAAA;;;ACtLA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,KAAK;AAAA,QAChB,QAAQ;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,eAAe;AAAA,UACf,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,kBAAkB;AAAA,UAClB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,OAAO;AAAA,UACP,KAAK;AAAA,UACL,aAAa;AAAA,UACb,UAAU;AAAA,UACV,UAAU;AAAA,UACV,aAAa;AAAA,UACb,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,iBAAiB;AAAA,UACjB,OAAO;AAAA,UACP,WAAW;AAAA,UACX,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,aAAa;AAAA,UACb,WAAW;AAAA,UACX,wBAAwB;AAAA,UACxB,wBAAwB;AAAA,UACxB,0BAA0B;AAAA,UAC1B,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,UACzB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,0BAA0B;AAAA,UAC1B,2BAA2B;AAAA,UAC3B,cAAc;AAAA,UACd,aAAa;AAAA,UACb,eAAe;AAAA,QACjB;AAAA,QACA,UAAU;AAAA,UACR,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,iBAAiB;AAAA,UACjB,SAAS;AAAA,QACX;AAAA,QACA,WAAW;AAAA,UACT,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,QAAQ;AAAA,QACV;AAAA,QACA,cAAc;AAAA,UACZ,WAAW;AAAA,UACX,OAAO;AAAA,UACP,WAAW;AAAA,QACb;AAAA,QACA,aAAa;AAAA,UACX,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS;AAAA,QACX;AAAA,QACA,kBAAkB;AAAA,UAChB,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,cAAc;AAAA,UACZ,MAAM;AAAA,UACN,MAAM;AAAA,UACN,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,QAClB;AAAA,QACA,YAAY;AAAA,UACV,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS;AAAA,UACT,cAAc;AAAA,UACd,UAAU;AAAA,UACV,kBAAkB;AAAA,UAClB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,kBAAkB;AAAA,UAClB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,cAAc;AAAA,UACd,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,cAAc;AAAA,UACd,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,UAChB,oBAAoB;AAAA,UACpB,oBAAoB;AAAA,QACtB;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,OAAO;AAAA,UACP,UAAU;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACT;AAAA,QACA,QAAQ;AAAA,UACN,QAAQ;AAAA,QACV;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,eAAe;AAAA,UACf,kBAAkB;AAAA,UAClB,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,qBAAqB;AAAA,UACrB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,YAAY;AAAA,UACZ,WAAW;AAAA,QACb;AAAA,MACF;AAAA;AAAA;;;ACtLA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,KAAK;AAAA,QAChB,QAAQ;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,OAAO;AAAA,UACP,MAAM;AAAA,UACN,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,eAAe;AAAA,UACf,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,MAAM;AAAA,UACN,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,MAAM;AAAA,UACN,QAAQ;AAAA,UACR,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,UAAU;AAAA,UACV,UAAU;AAAA,UACV,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,YAAY;AAAA,UACZ,kBAAkB;AAAA,UAClB,cAAc;AAAA,UACd,UAAU;AAAA,UACV,OAAO;AAAA,UACP,KAAK;AAAA,UACL,aAAa;AAAA,UACb,UAAU;AAAA,UACV,UAAU;AAAA,UACV,aAAa;AAAA,UACb,cAAc;AAAA,UACd,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,SAAS;AAAA,UACT,iBAAiB;AAAA,UACjB,OAAO;AAAA,UACP,WAAW;AAAA,UACX,mBAAmB;AAAA,UACnB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,aAAa;AAAA,UACb,WAAW;AAAA,UACX,wBAAwB;AAAA,UACxB,wBAAwB;AAAA,UACxB,0BAA0B;AAAA,UAC1B,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,wBAAwB;AAAA,UACxB,yBAAyB;AAAA,UACzB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,0BAA0B;AAAA,UAC1B,2BAA2B;AAAA,UAC3B,cAAc;AAAA,UACd,aAAa;AAAA,UACb,eAAe;AAAA,QACjB;AAAA,QACA,UAAU;AAAA,UACR,KAAK;AAAA,UACL,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,YAAY;AAAA,UACZ,OAAO;AAAA,UACP,iBAAiB;AAAA,UACjB,SAAS;AAAA,QACX;AAAA,QACA,WAAW;AAAA,UACT,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,OAAO;AAAA,UACP,QAAQ;AAAA,QACV;AAAA,QACA,cAAc;AAAA,UACZ,WAAW;AAAA,UACX,OAAO;AAAA,UACP,WAAW;AAAA,QACb;AAAA,QACA,aAAa;AAAA,UACX,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,SAAS;AAAA,QACX;AAAA,QACA,kBAAkB;AAAA,UAChB,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,cAAc;AAAA,UACZ,MAAM;AAAA,UACN,MAAM;AAAA,UACN,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,QAClB;AAAA,QACA,YAAY;AAAA,UACV,OAAO;AAAA,UACP,WAAW;AAAA,UACX,OAAO;AAAA,UACP,SAAS;AAAA,UACT,cAAc;AAAA,UACd,UAAU;AAAA,UACV,kBAAkB;AAAA,UAClB,oBAAoB;AAAA,UACpB,kBAAkB;AAAA,UAClB,iBAAiB;AAAA,UACjB,kBAAkB;AAAA,UAClB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,UACjB,oBAAoB;AAAA,UACpB,qBAAqB;AAAA,UACrB,cAAc;AAAA,UACd,qBAAqB;AAAA,UACrB,kBAAkB;AAAA,UAClB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,uBAAuB;AAAA,UACvB,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,eAAe;AAAA,UACf,iBAAiB;AAAA,UACjB,WAAW;AAAA,UACX,YAAY;AAAA,UACZ,YAAY;AAAA,UACZ,cAAc;AAAA,UACd,gBAAgB;AAAA,UAChB,gBAAgB;AAAA,UAChB,oBAAoB;AAAA,UACpB,oBAAoB;AAAA,QACtB;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,OAAO;AAAA,UACP,UAAU;AAAA,UACV,UAAU;AAAA,UACV,OAAO;AAAA,UACP,OAAO;AAAA,QACT;AAAA,QACA,QAAQ;AAAA,UACN,QAAQ;AAAA,QACV;AAAA,QACA,MAAM;AAAA,UACJ,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,IAAI;AAAA,UACJ,MAAM;AAAA,UACN,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,QAAQ;AAAA,UACR,SAAS;AAAA,QACX;AAAA,QACA,UAAU;AAAA,UACR,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,IAAI;AAAA,UACJ,UAAU;AAAA,UACV,eAAe;AAAA,UACf,kBAAkB;AAAA,UAClB,YAAY;AAAA,UACZ,gBAAgB;AAAA,UAChB,mBAAmB;AAAA,UACnB,sBAAsB;AAAA,UACtB,eAAe;AAAA,UACf,qBAAqB;AAAA,UACrB,mBAAmB;AAAA,UACnB,oBAAoB;AAAA,UACpB,YAAY;AAAA,UACZ,WAAW;AAAA,QACb;AAAA,MACF;AAAA;AAAA;;;ACpKO,WAAS,sBAAsB;AACpC,WAAO,EAAE,GAAG;AAAA,EACd;AAKO,WAAS,4BAA4B;AAC1C,WAAO;AAAA,EACT;AAOA,iBAAsB,uBAAuB,MAAM;AACjD,UAAM,SAAS,uBAAuB,IAAI;AAC1C,QAAI,CAAC,OAAQ,QAAO;AAEpB,UAAM,SAAS,MAAM,OAAO;AAC5B,WAAO,OAAO,IAAI,KAAK,OAAO,WAAW;AAAA,EAC3C;AAxCA,MAOM,wBAuCO;AA9Cb;AAAA;AAKA;AAEA,MAAM,yBAAyB;AAAA,QAC7B,IAAI,MAAM;AAAA,QACV,IAAI,MAAM;AAAA,QACV,IAAI,MAAM;AAAA,QACV,IAAI,MAAM;AAAA,MACZ;AAkCO,MAAM,eAAe,oBAAoB;AAAA;AAAA;;;AC9ChD,MAMM,MAgLO;AAtLb;AAAA;AAIA;AAEA,MAAM,OAAN,MAAW;AAAA,QACT,cAAc;AACZ,eAAK,kBAAkB;AACvB,eAAK,eAAe,oBAAoB;AACxC,eAAK,kBAAkB,oBAAI,IAAI;AAC/B,eAAK,yBAAyB,0BAA0B;AAAA,QAC1D;AAAA,QAEA,YAAY,MAAM;AAChB,cAAI,KAAK,aAAa,IAAI,GAAG;AAC3B,iBAAK,kBAAkB;AAAA,UACzB,OAAO;AACL,oBAAQ,KAAK,aAAa,aAAI,uCAAsC;AACpE,iBAAK,kBAAkB;AAAA,UACzB;AAAA,QACF;AAAA,QAEA,cAAc;AACZ,iBAAO,KAAK;AAAA,QACd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,MAAM,eAAe,MAAM;AACzB,gBAAM,kBAAkB,QAAQ,IAAI,YAAY;AAChD,cAAI,CAAC,eAAgB,QAAO,KAAK;AAEjC,cAAI,KAAK,aAAa,cAAc,GAAG;AACrC,mBAAO;AAAA,UACT;AAEA,cAAI,KAAK,gBAAgB,IAAI,cAAc,GAAG;AAC5C,kBAAM,KAAK,gBAAgB,IAAI,cAAc;AAC7C,mBAAO,KAAK,aAAa,cAAc,IAAI,iBAAiB;AAAA,UAC9D;AAEA,cAAI,CAAC,KAAK,uBAAuB,cAAc,GAAG;AAChD,mBAAO;AAAA,UACT;AAEA,gBAAM,eAAe,YAAY;AAC/B,gBAAI;AACF,oBAAM,SAAS,MAAM,uBAAuB,cAAc;AAC1D,kBAAI,QAAQ;AACV,qBAAK,aAAa,cAAc,IAAI;AAAA,cACtC;AAAA,YACF,SAAS,OAAO;AACd,sBAAQ,KAAK,aAAa,uBAAc,sBAAqB,KAAK;AAAA,YACpE,UAAE;AACA,mBAAK,gBAAgB,OAAO,cAAc;AAAA,YAC5C;AAAA,UACF,GAAG;AAEH,eAAK,gBAAgB,IAAI,gBAAgB,WAAW;AACpD,gBAAM;AAEN,iBAAO,KAAK,aAAa,cAAc,IAAI,iBAAiB;AAAA,QAC9D;AAAA,QAEA,EAAE,KAAK,eAAe,CAAC,GAAG;AACxB,gBAAM,OAAO,IAAI,MAAM,GAAG;AAC1B,cAAI,QAAQ,KAAK,aAAa,KAAK,eAAe;AAElD,qBAAW,KAAK,MAAM;AACpB,gBAAI,SAAS,OAAO,UAAU,YAAY,KAAK,OAAO;AACpD,sBAAQ,MAAM,CAAC;AAAA,YACjB,OAAO;AAEL,sBAAQ,KAAK,aAAa;AAC1B,yBAAW,eAAe,MAAM;AAC9B,oBAAI,SAAS,OAAO,UAAU,YAAY,eAAe,OAAO;AAC9D,0BAAQ,MAAM,WAAW;AAAA,gBAC3B,OAAO;AACL,yBAAO;AAAA,gBACT;AAAA,cACF;AACA;AAAA,YACF;AAAA,UACF;AAGA,cAAI,OAAO,UAAU,UAAU;AAC7B,mBAAO,QAAQ,YAAY,EAAE,QAAQ,CAAC,CAAC,aAAa,WAAW,MAAM;AACnE,sBAAQ,MAAM,QAAQ,IAAI,OAAO,IAAI,oBAAW,MAAK,GAAG,GAAG,WAAW;AAAA,YACxE,CAAC;AAAA,UACH;AAEA,iBAAO;AAAA,QACT;AAAA,QAEA,eAAe,MAAMA,eAAc;AACjC,cAAI,CAAC,KAAK,aAAa,IAAI,GAAG;AAC5B,iBAAK,aAAa,IAAI,IAAI,CAAC;AAAA,UAC7B;AACA,iBAAO,OAAO,KAAK,aAAa,IAAI,GAAGA,aAAY;AAAA,QACrD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,MAAM,oBAAoB,UAAU,KAAK;AAEvC,cAAI,KAAK,gBAAgB,IAAI,GAAG,GAAG;AACjC,mBAAO,KAAK,gBAAgB,IAAI,GAAG;AAAA,UACrC;AAEA,gBAAM,eAAe,YAAY;AAC/B,gBAAI;AACF,oBAAM,WAAW,MAAM,MAAM,GAAG;AAChC,kBAAI,CAAC,SAAS,IAAI;AAChB,sBAAM,IAAI,MAAM,iCAAiC,gBAAS,WAAY;AAAA,cACxE;AAEA,oBAAM,cAAc,SAAS,QAAQ,IAAI,cAAc,KAAK;AAC5D,kBAAIA;AAEJ,oBAAM,SAAS,MAAM,SAAS,YAAY;AAC1C,oBAAM,WAAW,IAAI,YAAY,OAAO,EAAE,OAAO,MAAM;AAEvD,kBAAI,YAAY,SAAS,kBAAkB,KAAK,IAAI,SAAS,OAAO,GAAG;AACrE,gBAAAA,gBAAe,KAAK,MAAM,QAAQ;AAAA,cACpC,WAAW,YAAY,SAAS,WAAW,KAAK,YAAY,SAAS,oBAAoB,KAAK,IAAI,SAAS,OAAO,KAAK,IAAI,SAAS,MAAM,GAAG;AAI3I,oBAAI;AAEF,kBAAAA,gBAAe,KAAK,MAAM,QAAQ;AAAA,gBACpC,SAAS,GAAG;AAEV,sBAAI,OAAO,WAAW,eAAe,OAAO,QAAQ;AAClD,oBAAAA,gBAAe,OAAO,OAAO,KAAK,QAAQ;AAAA,kBAC5C,OAAO;AACL,4BAAQ,KAAK,8EAA8E;AAC3F,0BAAM,IAAI,MAAM,gFAAgF;AAAA,kBAClG;AAAA,gBACF;AAAA,cACF,OAAO;AAEL,gBAAAA,gBAAe,KAAK,MAAM,QAAQ;AAAA,cACpC;AAEA,mBAAK,eAAe,UAAUA,aAAY;AAC1C,qBAAOA;AAAA,YACT,SAAS,OAAO;AACd,sBAAQ,MAAM,oCAAoC,YAAG,MAAK,KAAK;AAC/D,oBAAM;AAAA,YACR,UAAE;AAEA,mBAAK,gBAAgB,OAAO,GAAG;AAAA,YACjC;AAAA,UACF,GAAG;AAEH,eAAK,gBAAgB,IAAI,KAAK,WAAW;AACzC,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,MAAM,sBAAsB,aAAa;AACvC,gBAAM,WAAW,OAAO,QAAQ,WAAW,EAAE;AAAA,YAAI,CAAC,CAAC,UAAU,GAAG,MAC9D,KAAK,oBAAoB,UAAU,GAAG;AAAA,UACxC;AACA,gBAAM,QAAQ,IAAI,QAAQ;AAAA,QAC5B;AAAA,MACF;AAEO,MAAM,OAAO,IAAI,KAAK;AAAA;AAAA;;;ACtL7B,MAMa;AANb;AAAA;AAIA;AAEO,MAAM,YAAY;AAAA;AAAA;AAAA;AAAA,QAIvB,WAAW,SAAS,kBAAkB,OAAO;AAC3C,cAAI,CAAC,SAAS,OAAO,KAAK,UAAU,GAAG;AACrC,mBAAO,kBAAkB,aAAa;AAAA,UACxC;AAEA,gBAAM,QAAQ,KAAK,MAAM,UAAU,IAAI;AACvC,gBAAM,UAAU,KAAK,MAAO,UAAU,OAAQ,EAAE;AAChD,gBAAM,OAAO,KAAK,MAAM,UAAU,EAAE;AAEpC,gBAAM,MAAM,CAAC,QAAQ,OAAO,GAAG,EAAE,SAAS,GAAG,GAAG;AAEhD,cAAI,QAAQ,KAAK,iBAAiB;AAChC,mBAAO,GAAG,WAAI,KAAK,GAAC,KAAI,WAAI,OAAO,GAAC,KAAI,WAAI,IAAI;AAAA,UAClD;AAEA,iBAAO,GAAG,WAAI,OAAO,GAAC,KAAI,WAAI,IAAI;AAAA,QACpC;AAAA;AAAA;AAAA;AAAA,QAKA,UAAU,YAAY;AACpB,gBAAM,QAAQ,WAAW,MAAM,GAAG,EAAE,IAAI,OAAK,SAAS,GAAG,EAAE,CAAC;AAE5D,cAAI,MAAM,WAAW,GAAG;AAEtB,mBAAO,MAAM,CAAC,IAAI,OAAO,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC;AAAA,UAClD,WAAW,MAAM,WAAW,GAAG;AAE7B,mBAAO,MAAM,CAAC,IAAI,KAAK,MAAM,CAAC;AAAA,UAChC,WAAW,MAAM,WAAW,GAAG;AAE7B,mBAAO,MAAM,CAAC;AAAA,UAChB;AAEA,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,eAAe,SAAS;AACtB,cAAI,CAAC,SAAS,OAAO,KAAK,UAAU,GAAG;AACrC,mBAAO,KAAK,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC;AAAA,UAC5C;AAEA,gBAAM,QAAQ,KAAK,MAAM,UAAU,IAAI;AACvC,gBAAM,UAAU,KAAK,MAAO,UAAU,OAAQ,EAAE;AAChD,gBAAM,OAAO,KAAK,MAAM,UAAU,EAAE;AAEpC,gBAAM,QAAQ,CAAC;AAEf,cAAI,QAAQ,GAAG;AACb,kBAAM,MAAM,UAAU,IAAI,cAAc;AACxC,kBAAM,KAAK,KAAK,EAAE,KAAK,EAAE,OAAO,MAAM,CAAC,CAAC;AAAA,UAC1C;AACA,cAAI,UAAU,GAAG;AACf,kBAAM,MAAM,YAAY,IAAI,gBAAgB;AAC5C,kBAAM,KAAK,KAAK,EAAE,KAAK,EAAE,OAAO,QAAQ,CAAC,CAAC;AAAA,UAC5C;AACA,cAAI,OAAO,KAAK,MAAM,WAAW,GAAG;AAClC,kBAAM,MAAM,SAAS,IAAI,gBAAgB;AACzC,kBAAM,KAAK,KAAK,EAAE,KAAK,EAAE,OAAO,KAAK,CAAC,CAAC;AAAA,UACzC;AAEA,iBAAO,MAAM,KAAK,IAAI;AAAA,QACxB;AAAA;AAAA;AAAA;AAAA,QAKA,iBAAiB,OAAO,OAAO;AAC7B,cAAI,UAAU,EAAG,QAAO;AACxB,iBAAO,KAAK,MAAO,QAAQ,QAAS,GAAG;AAAA,QACzC;AAAA,MACF;AAAA;AAAA;;;ACOO,WAAS,QAAQ,MAAM;AAC1B,WAAO,MAAM,IAAI,KAAK,MAAM;AAAA,EAChC;AAEO,WAAS,kBAAkB,MAAM,YAAY,IAAI;AACpD,UAAM,UAAU,SAAS,cAAc,MAAM;AAC7C,YAAQ,YAAY,eAAe,kBAAY,KAAK;AACpD,YAAQ,YAAY,QAAQ,IAAI;AAChC,YAAQ,aAAa,eAAe,MAAM;AAC1C,WAAO;AAAA,EACX;AAMO,WAAS,oBAAoB;AAChC,UAAM,MAAM,SAAS,gBAAgB,8BAA8B,KAAK;AACxE,QAAI,aAAa,SAAS,qBAAqB;AAC/C,QAAI,aAAa,WAAW,WAAW;AACvC,QAAI,aAAa,SAAS,IAAI;AAC9B,QAAI,aAAa,UAAU,IAAI;AAC/B,QAAI,aAAa,eAAe,MAAM;AACtC,QAAI,aAAa,QAAQ,cAAc;AACvC,QAAI,MAAM,SAAS;AAGnB,UAAM,OAAO,SAAS,gBAAgB,8BAA8B,MAAM;AAC1E,UAAM,WAAW,sBAAsB,YAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC;AAC7E,UAAM,SAAS,SAAS,gBAAgB,8BAA8B,QAAQ;AAC9E,WAAO,aAAa,MAAM,QAAQ;AAClC,WAAO,aAAa,KAAK,MAAM;AAC/B,WAAO,aAAa,KAAK,MAAM;AAC/B,WAAO,aAAa,SAAS,MAAM;AACnC,WAAO,aAAa,UAAU,MAAM;AAEpC,UAAM,iBAAiB,SAAS,gBAAgB,8BAA8B,gBAAgB;AAC9F,mBAAe,aAAa,MAAM,aAAa;AAC/C,mBAAe,aAAa,gBAAgB,GAAG;AAE/C,UAAM,WAAW,SAAS,gBAAgB,8BAA8B,UAAU;AAClF,aAAS,aAAa,MAAM,GAAG;AAC/B,aAAS,aAAa,MAAM,GAAG;AAC/B,aAAS,aAAa,UAAU,YAAY;AAE5C,UAAM,sBAAsB,SAAS,gBAAgB,8BAA8B,qBAAqB;AACxG,UAAM,UAAU,SAAS,gBAAgB,8BAA8B,SAAS;AAChF,YAAQ,aAAa,QAAQ,QAAQ;AACrC,YAAQ,aAAa,SAAS,KAAK;AACnC,wBAAoB,YAAY,OAAO;AAEvC,UAAM,UAAU,SAAS,gBAAgB,8BAA8B,SAAS;AAChF,UAAM,eAAe,SAAS,gBAAgB,8BAA8B,aAAa;AACzF,UAAM,eAAe,SAAS,gBAAgB,8BAA8B,aAAa;AACzF,iBAAa,aAAa,MAAM,eAAe;AAC/C,YAAQ,YAAY,YAAY;AAChC,YAAQ,YAAY,YAAY;AAEhC,WAAO,YAAY,cAAc;AACjC,WAAO,YAAY,QAAQ;AAC3B,WAAO,YAAY,mBAAmB;AACtC,WAAO,YAAY,OAAO;AAC1B,SAAK,YAAY,MAAM;AACvB,QAAI,YAAY,IAAI;AAGpB,UAAM,SAAS,SAAS,gBAAgB,8BAA8B,QAAQ;AAC9E,WAAO,aAAa,MAAM,IAAI;AAC9B,WAAO,aAAa,MAAM,IAAI;AAC9B,WAAO,aAAa,KAAK,IAAI;AAC7B,WAAO,aAAa,QAAQ,2BAA2B;AACvD,WAAO,aAAa,UAAU,QAAQ,iBAAQ,IAAG;AACjD,WAAO,aAAa,SAAS,wBAAwB;AACrD,QAAI,YAAY,MAAM;AAGtB,UAAM,eAAe,SAAS,gBAAgB,8BAA8B,SAAS;AACrF,iBAAa,aAAa,UAAU,mBAAmB;AACvD,iBAAa,aAAa,QAAQ,SAAS;AAC3C,iBAAa,aAAa,SAAS,0BAA0B;AAC7D,QAAI,YAAY,YAAY;AAE5B,WAAO;AAAA,EACX;AA/KA,MAMM,WA+EA,YAGO;AAxFb;AAAA;AAMA,MAAM,YAAY;AAAA,QACd,MAAM;AAAA,QAEN,OAAO;AAAA,QAEP,MAAM;AAAA,QAEN,QAAQ;AAAA,QAER,SAAS;AAAA,QAET,cAAc;AAAA,QAEd,UAAU;AAAA,QAEV,SAAS;AAAA,QAET,YAAY;AAAA,QAEZ,cAAc;AAAA,QAEd,WAAW;AAAA,QAEX,aAAa;AAAA,QAEb,YAAY;AAAA,QAEZ,gBAAgB;AAAA,QAEhB,UAAU;AAAA,QAEV,UAAU;AAAA,QAEV,aAAa;AAAA,QAEb,KAAK;AAAA,QAEL,OAAO;AAAA,QAEP,OAAO;AAAA,QAEP,OAAO;AAAA,QAEP,SAAS;AAAA,QAET,OAAO;AAAA,QAEP,UAAU;AAAA,QAEV,IAAI;AAAA,QAEJ,YAAY;AAAA,QAEZ,UAAU;AAAA,QAEV,kBAAkB;AAAA,QAElB,oBAAoB;AAAA,QAEpB,cAAc;AAAA,QAEd,gBAAgB;AAAA,QAEhB,iBAAiB;AAAA,QAEjB,mBAAmB;AAAA,QAEnB,OAAO;AAAA,QAEP,cAAc;AAAA,QAEd,MAAM;AAAA,QAEN,QAAQ;AAAA,QAER,OAAO;AAAA,MACX;AAGA,MAAM,aAAa,CAAC,UAAU,gDAAgD,cAAK;AAG5E,MAAM,QAAQ,OAAO;AAAA,QACxB,OAAO,QAAQ,SAAS,EAAE,IAAI,CAAC,CAAC,KAAK,KAAK,MAAM,CAAC,KAAK,WAAW,KAAK,CAAC,CAAC;AAAA,MAC5E;AAAA;AAAA;;;AC/EO,WAAS,aAAa,SAAS,EAAE,QAAQ,GAAG,gBAAgB,KAAK,IAAI,CAAC,GAAG;AAC5E,QAAI,CAAC,QAAS;AAEd,0BAAsB,MAAM;AACxB,iBAAW,MAAM;AACb,YAAI,WAAW,SAAS,SAAS,OAAO,GAAG;AACvC,kBAAQ,MAAM,EAAE,cAAc,CAAC;AAAA,QACnC;AAAA,MACJ,GAAG,KAAK;AAAA,IACZ,CAAC;AAAA,EACL;AAQO,WAAS,kBAAkB,WAAW,UAAU,UAAU,CAAC,GAAG;AACjE,QAAI,CAAC,UAAW;AAChB,UAAM,UAAU,UAAU,cAAc,QAAQ;AAChD,QAAI,SAAS;AACT,mBAAa,SAAS,OAAO;AAAA,IACjC;AAAA,EACJ;AAnCA;AAAA;AAAA;AAAA;;;ACAA,MAIa;AAJb;AAAA;AAIO,MAAM,iBAAN,MAAqB;AAAA,QAC1B,YAAY,YAAY,UAAU;AAChC,eAAK,YAAY;AACjB,eAAK,UAAU,KAAK,mBAAmB,IAAI,eAAe;AAAA,QAC5D;AAAA;AAAA;AAAA;AAAA,QAKA,qBAAqB;AACnB,cAAI;AACF,kBAAM,OAAO;AACb,yBAAa,QAAQ,MAAM,IAAI;AAC/B,yBAAa,WAAW,IAAI;AAC5B,mBAAO;AAAA,UACT,SAAS,GAAG;AACV,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,OAAO,KAAK;AACV,iBAAO,GAAG,YAAK,WAAS,KAAI;AAAA,QAC9B;AAAA;AAAA;AAAA;AAAA,QAKA,IAAI,KAAK,OAAO;AACd,cAAI,CAAC,KAAK,QAAS,QAAO;AAE1B,cAAI;AACF,kBAAM,gBAAgB,KAAK,OAAO,GAAG;AACrC,iBAAK,QAAQ,QAAQ,eAAe,KAAK,UAAU,KAAK,CAAC;AACzD,mBAAO;AAAA,UACT,SAAS,GAAG;AACV,oBAAQ,KAAK,mCAAmC,CAAC;AACjD,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,IAAI,KAAK,eAAe,MAAM;AAC5B,cAAI,CAAC,KAAK,QAAS,QAAO;AAE1B,cAAI;AACF,kBAAM,gBAAgB,KAAK,OAAO,GAAG;AACrC,kBAAM,QAAQ,KAAK,QAAQ,QAAQ,aAAa;AAChD,mBAAO,QAAQ,KAAK,MAAM,KAAK,IAAI;AAAA,UACrC,SAAS,GAAG;AACV,oBAAQ,KAAK,qCAAqC,CAAC;AACnD,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,OAAO,KAAK;AACV,cAAI,CAAC,KAAK,QAAS,QAAO;AAE1B,cAAI;AACF,kBAAM,gBAAgB,KAAK,OAAO,GAAG;AACrC,iBAAK,QAAQ,WAAW,aAAa;AACrC,mBAAO;AAAA,UACT,SAAS,GAAG;AACV,oBAAQ,KAAK,uCAAuC,CAAC;AACrD,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,QAAQ;AACN,cAAI,CAAC,KAAK,QAAS,QAAO;AAE1B,cAAI;AACF,kBAAM,OAAO,OAAO,KAAK,KAAK,OAAO;AACrC,iBAAK,QAAQ,SAAO;AAClB,kBAAI,IAAI,WAAW,KAAK,SAAS,GAAG;AAClC,qBAAK,QAAQ,WAAW,GAAG;AAAA,cAC7B;AAAA,YACF,CAAC;AACD,mBAAO;AAAA,UACT,SAAS,GAAG;AACV,oBAAQ,KAAK,iCAAiC,CAAC;AAC/C,mBAAO;AAAA,UACT;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,0BAA0B,aAAa;AACrC,iBAAO,KAAK,IAAI,0BAA0B,WAAW;AAAA,QACvD;AAAA;AAAA;AAAA;AAAA,QAKA,2BAA2B;AACzB,iBAAO,KAAK,IAAI,0BAA0B,IAAI;AAAA,QAChD;AAAA;AAAA;AAAA;AAAA,QAKA,uBAAuB,aAAa;AAClC,iBAAO,KAAK,IAAI,uBAAuB,WAAW;AAAA,QACpD;AAAA;AAAA;AAAA;AAAA,QAKA,wBAAwB;AACtB,iBAAO,KAAK,IAAI,uBAAuB,IAAI;AAAA,QAC7C;AAAA;AAAA;AAAA;AAAA,QAKA,sBAAsB,aAAa;AACjC,iBAAO,KAAK,IAAI,sBAAsB,WAAW;AAAA,QACnD;AAAA;AAAA;AAAA;AAAA,QAKA,uBAAuB;AACrB,iBAAO,KAAK,IAAI,sBAAsB,IAAI;AAAA,QAC5C;AAAA;AAAA;AAAA;AAAA,QAKA,4BAA4B,aAAa;AACvC,iBAAO,KAAK,IAAI,6BAA6B,WAAW;AAAA,QAC1D;AAAA;AAAA;AAAA;AAAA,QAKA,6BAA6B;AAC3B,iBAAO,KAAK,IAAI,6BAA6B,IAAI;AAAA,QACnD;AAAA,MACF;AAAA;AAAA;;;AC1JA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,gBAAN,MAAoB;AAAA,QACzB,YAAY,QAAQ;AAClB,eAAK,SAAS;AACd,eAAK,QAAQ,OAAO;AACpB,eAAK,mBAAmB;AAAA,QAC1B;AAAA,QAEA,MAAM,OAAO;AAEX,eAAK,MAAM,WAAW;AACtB,eAAK,MAAM,gBAAgB,UAAU;AAErC,eAAK,aAAa;AAGlB,cAAI,KAAK,OAAO,QAAQ,WAAW;AAGjC,iBAAK,MAAM,UAAU,KAAK,OAAO,QAAQ,WAAW;AAAA,UACtD,OAAO;AACL,iBAAK,MAAM,UAAU,KAAK,OAAO,QAAQ;AAEzC,iBAAK,MAAM,KAAK;AAAA,UAClB;AAGA,cAAI,KAAK,OAAO,WAAW;AACzB,iBAAK,OAAO,UAAU,UAAU,OAAO,0BAA0B;AAAA,UACnE;AAAA,QACF;AAAA,QAEA,eAAe;AAEb,eAAK,MAAM,iBAAiB,kBAAkB,MAAM;AAClD,iBAAK,OAAO,MAAM,WAAW,KAAK,MAAM;AACxC,iBAAK,OAAO,KAAK,gBAAgB;AAGjC,gBAAI,KAAK,MAAM,YAAY,SAAS;AAClC,mBAAK,OAAO,mBAAmB,EAAE,MAAM,WAAS;AAC9C,qBAAK,OAAO,IAAI,mCAAmC,OAAO,MAAM;AAAA,cAClE,CAAC;AAAA,YACH;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,QAAQ,MAAM;AACxC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,MAAM;AAEvB,gBAAI,KAAK,OAAO,QAAQ,QAAQ;AAC9B,mBAAK,OAAO,QAAQ,OAAO,KAAK,KAAK,MAAM;AAAA,YAC7C;AAGA,gBAAI,KAAK,OAAO,QAAQ,mBAAmB;AACzC,mBAAK,kBAAkB;AAAA,YACzB;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,MAAM;AACzC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,MAAM;AACzC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAGA,gBAAI,KAAK,OAAO,QAAQ,MAAM;AAC5B,mBAAK,OAAO,KAAK,CAAC;AAClB,mBAAK,OAAO,KAAK;AAAA,YACnB;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,cAAc,MAAM;AAC9C,iBAAK,OAAO,MAAM,cAAc,KAAK,MAAM;AAC3C,iBAAK,OAAO,KAAK,cAAc,KAAK,MAAM,WAAW;AAErD,gBAAI,KAAK,OAAO,QAAQ,cAAc;AACpC,mBAAK,OAAO,QAAQ,aAAa,KAAK,KAAK,QAAQ,KAAK,MAAM,WAAW;AAAA,YAC3E;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,gBAAgB,MAAM;AAChD,iBAAK,OAAO,MAAM,SAAS,KAAK,MAAM;AACtC,iBAAK,OAAO,MAAM,QAAQ,KAAK,MAAM;AACrC,iBAAK,OAAO,KAAK,gBAAgB,KAAK,MAAM,MAAM;AAElD,gBAAI,KAAK,OAAO,QAAQ,gBAAgB;AACtC,mBAAK,OAAO,QAAQ,eAAe,KAAK,KAAK,QAAQ,KAAK,MAAM,MAAM;AAAA,YACxE;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,WAAW,MAAM;AAC3C,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,iBAAiB,UAAU,MAAM;AAC1C,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,KAAK,QAAQ;AAAA,UAC3B,CAAC;AAED,eAAK,MAAM,iBAAiB,WAAW,MAAM;AAC3C,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,iBAAiB,WAAW,MAAM;AAC3C,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,iBAAiB,YAAY,MAAM;AAC5C,gBAAI,KAAK,MAAM,SAAS,SAAS,GAAG;AAClC,oBAAM,WAAW,KAAK,MAAM,SAAS,IAAI,KAAK,MAAM,SAAS,SAAS,CAAC;AACvE,mBAAK,OAAO,KAAK,YAAY,QAAQ;AAAA,YACvC;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,CAAC,MAAM;AAC1C,iBAAK,OAAO,YAAY,KAAK,MAAM,KAAK;AAAA,UAC1C,CAAC;AAED,eAAK,MAAM,iBAAiB,cAAc,MAAM;AAC9C,iBAAK,OAAO,MAAM,gBAAgB,KAAK,MAAM;AAC7C,iBAAK,OAAO,KAAK,cAAc,KAAK,MAAM,YAAY;AAAA,UACxD,CAAC;AAAA,QACH;AAAA,QAEA,oBAAoB;AAElB,gBAAM,aAAa,SAAS,iBAAiB,gBAAgB;AAC7D,qBAAW,QAAQ,cAAY;AAC7B,gBAAI,aAAa,KAAK,OAAO,WAAW;AACtC,oBAAM,QAAQ,SAAS,cAAc,cAAc;AACnD,kBAAI,SAAS,CAAC,MAAM,QAAQ;AAC1B,sBAAM,MAAM;AAAA,cACd;AAAA,YACF;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QAEA,OAAO;AAEL,gBAAM,UAAU,OAAO;AACvB,gBAAM,UAAU,OAAO;AAGvB,cAAI,KAAK,OAAO,QAAQ,aAAa,CAAC,KAAK,kBAAkB;AAC3D,gBAAI;AAEF,kBAAI,KAAK,MAAM,eAAe,GAAG;AAC/B,qBAAK,MAAM,KAAK;AAAA,cAClB;AAAA,YACF,SAAS,GAAG;AAAA,YAEZ;AACA,iBAAK,mBAAmB;AAAA,UAC1B;AAEA,gBAAM,UAAU,KAAK,MAAM,KAAK;AAGhC,iBAAO,SAAS,SAAS,OAAO;AAEhC,cAAI,YAAY,QAAW;AACzB,oBAAQ,MAAM,WAAS;AACrB,mBAAK,OAAO,IAAI,gBAAgB,OAAO,MAAM;AAG7C,kBAAI,KAAK,OAAO,QAAQ,YAAY,CAAC,KAAK,OAAO,MAAM,OAAO;AAC5D,qBAAK,OAAO,IAAI,kCAAkC,MAAM;AACxD,qBAAK,MAAM,QAAQ;AAGnB,sBAAM,eAAe,OAAO;AAC5B,sBAAM,eAAe,OAAO;AAC5B,qBAAK,MAAM,KAAK,EAAE,KAAK,MAAM;AAC3B,yBAAO,SAAS,cAAc,YAAY;AAAA,gBAC5C,CAAC,EAAE,MAAM,SAAO;AACd,uBAAK,OAAO,YAAY,GAAG;AAAA,gBAC7B,CAAC;AAAA,cACH;AAAA,YACF,CAAC;AACD,mBAAO;AAAA,UACT;AACA,iBAAO,QAAQ,QAAQ;AAAA,QACzB;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,eAAe;AACb,cAAI,CAAC,KAAK,OAAO,QAAQ,aAAa,KAAK,kBAAkB;AAC3D;AAAA,UACF;AAEA,cAAI;AACF,gBAAI,KAAK,MAAM,eAAe,GAAG;AAC/B,mBAAK,MAAM,KAAK;AAAA,YAClB;AAAA,UACF,SAAS,GAAG;AAAA,UAEZ;AACA,eAAK,mBAAmB;AAAA,QAC1B;AAAA,QAEA,QAAQ;AACN,eAAK,MAAM,MAAM;AAAA,QACnB;AAAA,QAEA,KAAK,MAAM;AACT,eAAK,MAAM,cAAc;AAAA,QAC3B;AAAA,QAEA,UAAU,QAAQ;AAChB,eAAK,MAAM,SAAS;AAAA,QACtB;AAAA,QAEA,SAAS,OAAO;AACd,eAAK,MAAM,QAAQ;AAAA,QACrB;AAAA,QAEA,iBAAiB,OAAO;AACtB,eAAK,MAAM,eAAe;AAAA,QAC5B;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,eAAe;AACb,gBAAM,UAAU,MAAM,KAAK,KAAK,MAAM,iBAAiB,QAAQ,CAAC;AAEhE,cAAI,QAAQ,UAAU,GAAG;AACvB,mBAAO,CAAC;AAAA,UACV;AAEA,iBAAO,QAAQ,IAAI,CAAC,QAAQ,UAAU;AAEpC,kBAAM,QAAQ,OAAO,aAAa,cAAc,KAAK,OAAO,aAAa,OAAO,KAAK;AACrF,kBAAM,SAAS,OAAO,aAAa,aAAa,KAAK,KAAK,uBAAuB,KAAK;AACtF,kBAAM,QAAQ,OAAO,aAAa,YAAY,KAAK;AAEnD,mBAAO;AAAA,cACL;AAAA,cACA,QAAQ,SAAS,SAAS,MAAM,IAAI;AAAA,cACpC,OAAO,QAAQ,SAAS,KAAK,IAAI;AAAA,cACjC,KAAK,OAAO;AAAA,cACZ,MAAM,OAAO;AAAA,cACb,MAAM,UAAU,SAAS,GAAG,eAAM,OAAM,WAAW,eAAQ;AAAA,YAC7D;AAAA,UACF,CAAC,EAAE,OAAO,OAAK,EAAE,SAAS,CAAC;AAAA,QAC7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,uBAAuB,OAAO;AAC5B,gBAAM,QAAQ,MAAM,MAAM,SAAS;AACnC,iBAAO,QAAQ,SAAS,MAAM,CAAC,CAAC,IAAI;AAAA,QACtC;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,cAAc,cAAc;AAC1B,gBAAM,YAAY,KAAK,aAAa;AAEpC,cAAI,eAAe,KAAK,gBAAgB,UAAU,QAAQ;AACxD,iBAAK,OAAO,IAAI,yBAAyB,MAAM;AAC/C;AAAA,UACF;AAEA,gBAAM,UAAU,UAAU,YAAY;AACtC,gBAAM,cAAc,KAAK,MAAM;AAC/B,gBAAM,aAAa,CAAC,KAAK,MAAM;AAG/B,gBAAM,aAAa,KAAK,MAAM;AAG9B,cAAI,eAAe,QAAQ,KAAK;AAC9B,iBAAK,OAAO,IAAI,iCAAiC,MAAM;AACvD;AAAA,UACF;AAEA,eAAK,OAAO,IAAI,yBAAyB,eAAQ,OAAQ,MAAM;AAG/D,eAAK,MAAM,MAAM,QAAQ;AAGzB,gBAAM,mBAAmB,MAAM;AAC7B,iBAAK,MAAM,oBAAoB,kBAAkB,gBAAgB;AAGjE,iBAAK,MAAM,cAAc;AAGzB,gBAAI,YAAY;AACd,mBAAK,MAAM,KAAK,EAAE,MAAM,SAAO;AAC7B,qBAAK,OAAO,IAAI,kDAAkD,MAAM;AAAA,cAC1E,CAAC;AAAA,YACH;AAGA,iBAAK,OAAO,KAAK,iBAAiB,EAAE,SAAS,QAAQ,MAAM,OAAO,aAAa,CAAC;AAAA,UAClF;AAEA,eAAK,MAAM,iBAAiB,kBAAkB,gBAAgB;AAC9D,eAAK,MAAM,KAAK;AAAA,QAClB;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,oBAAoB;AAClB,gBAAM,YAAY,KAAK,aAAa;AACpC,gBAAM,aAAa,KAAK,MAAM;AAE9B,mBAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AACzC,gBAAI,UAAU,CAAC,EAAE,QAAQ,YAAY;AACnC,qBAAO;AAAA,YACT;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAAA,QAEA,UAAU;AAER,eAAK,MAAM,oBAAoB,kBAAkB,MAAM;AAAA,UAAC,CAAC;AACzD,eAAK,MAAM,oBAAoB,QAAQ,MAAM;AAAA,UAAC,CAAC;AAC/C,eAAK,MAAM,oBAAoB,SAAS,MAAM;AAAA,UAAC,CAAC;AAAA,QAElD;AAAA,MACF;AAAA;AAAA;;;ACzWA,MAKa;AALb;AAAA;AAKO,MAAM,qBAAN,MAAyB;AAAA,QAC9B,YAAY,SAAS,UAAU,CAAC,GAAG;AACjC,eAAK,UAAU;AACf,eAAK,UAAU;AAAA,YACb,YAAY;AAAA;AAAA,YACZ,eAAe,CAAC;AAAA;AAAA,YAChB,aAAa;AAAA,YACb,QAAQ;AAAA,YACR,WAAW;AAAA,YACX,eAAe;AAAA,YACf,UAAU;AAAA,YACV,aAAa;AAAA,YACb,qBAAqB;AAAA;AAAA,YACrB,UAAU;AAAA,YACV,WAAW;AAAA,YACX,qBAAqB;AAAA,YACrB,iBAAiB;AAAA,YACjB,mBAAmB;AAAA,YACnB,cAAc;AAAA,YACd,mBAAmB;AAAA,YACnB,UAAU;AAAA,YACV,WAAW;AAAA,YACX,4BAA4B;AAAA,YAC5B,uBAAuB;AAAA,YACvB,aAAa;AAAA,YACb,SAAS;AAAA;AAAA,YACT,YAAY;AAAA,aACT;AAIL,eAAK,aAAa;AAClB,eAAK,aAAa;AAClB,eAAK,kBAAkB;AACvB,eAAK,cAAc;AACnB,eAAK,cAAc;AACnB,eAAK,kBAAkB;AACvB,eAAK,kBAAkB;AACvB,eAAK,gBAAgB;AACrB,eAAK,gBAAgB;AACrB,eAAK,0BAA0B;AAC/B,eAAK,eAAe;AACpB,eAAK,eAAe;AACpB,eAAK,mBAAmB;AACxB,eAAK,oBAAoB;AACzB,eAAK,kBAAkB;AACvB,eAAK,iBAAiB;AACtB,eAAK,mBAAmB;AACxB,eAAK,qBAAqB;AAC1B,eAAK,oBAAoB;AACzB,eAAK,qBAAqB;AAC1B,eAAK,uBAAuB,oBAAI,IAAI;AACpC,eAAK,yBAAyB;AAG9B,eAAK,WAAW;AAAA,YACd,WAAW,KAAK,YAAY,KAAK,IAAI;AAAA,YACrC,WAAW,KAAK,YAAY,KAAK,IAAI;AAAA,YACrC,SAAS,KAAK,UAAU,KAAK,IAAI;AAAA,YACjC,YAAY,KAAK,aAAa,KAAK,IAAI;AAAA,YACvC,WAAW,KAAK,YAAY,KAAK,IAAI;AAAA,YACrC,UAAU,KAAK,WAAW,KAAK,IAAI;AAAA,YACnC,aAAa,KAAK,cAAc,KAAK,IAAI;AAAA,YACzC,aAAa,KAAK,cAAc,KAAK,IAAI;AAAA,YACzC,WAAW,KAAK,YAAY,KAAK,IAAI;AAAA,YACrC,eAAe,KAAK,YAAY,KAAK,IAAI;AAAA,YACzC,SAAS,KAAK,UAAU,KAAK,IAAI;AAAA,YACjC,uBAAuB,KAAK,wBAAwB,KAAK,IAAI;AAAA,YAC7D,yBAAyB,KAAK,0BAA0B,KAAK,IAAI;AAAA,UACnE;AAGA,eAAK,kBAAkB;AACvB,eAAK,oBAAoB;AAEzB,eAAK,KAAK;AAAA,QACZ;AAAA,QAEA,0BAA0B;AACxB,iBAAO,MAAM,KAAK,KAAK,qBAAqB,OAAO,CAAC,EAAE,KAAK,OAAO;AAAA,QACpE;AAAA,QAEA,2BAA2B,QAAQ;AACjC,cAAI,CAAC,OAAO,QAAQ,iBAAiB;AACnC,mBAAO,QAAQ,kBAAkB,OAAO,MAAM,WAAW;AAAA,UAC3D;AAAA,QACF;AAAA,QAEA,iBAAiB,QAAQ;AACvB,iBAAO,MAAM,UAAU;AACvB,iBAAO,aAAa,eAAe,MAAM;AAAA,QAC3C;AAAA,QAEA,iBAAiB,QAAQ;AACvB,gBAAM,WAAW,OAAO,QAAQ,oBAAoB,SAAY,OAAO,QAAQ,kBAAkB;AACjG,iBAAO,MAAM,UAAU;AACvB,iBAAO,gBAAgB,aAAa;AAAA,QACtC;AAAA,QAEA,yBAAyB,SAAS;AAChC,cAAI,CAAC,KAAK,QAAQ,iBAAiB,KAAK,QAAQ,cAAc,WAAW,GAAG;AAC1E;AAAA,UACF;AAEA,eAAK,QAAQ,cAAc,QAAQ,YAAU;AAC3C,gBAAI,CAAC,KAAK,qBAAqB,IAAI,MAAM,GAAG;AAC1C;AAAA,YACF;AAEA,gBAAI,SAAS;AACX,mBAAK,iBAAiB,MAAM;AAAA,YAC9B,OAAO;AACL,mBAAK,iBAAiB,MAAM;AAAA,YAC9B;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QAEA,OAAO;AACL,gBAAM,aAAa,KAAK,QAAQ,cAAc,KAAK;AAGnD,cAAI,OAAO,WAAW,eAAe,kBAAkB,QAAQ;AAC7D,uBAAW,iBAAiB,eAAe,KAAK,SAAS,WAAW;AAGpE,qBAAS,iBAAiB,eAAe,KAAK,SAAS,aAAa,EAAE,SAAS,MAAM,CAAC;AACtF,qBAAS,iBAAiB,aAAa,KAAK,SAAS,SAAS;AAC9D,qBAAS,iBAAiB,iBAAiB,KAAK,SAAS,aAAa;AAAA,UACxE,OAAO;AAEL,uBAAW,iBAAiB,aAAa,KAAK,SAAS,SAAS;AAChE,uBAAW,iBAAiB,cAAc,KAAK,SAAS,YAAY,EAAE,SAAS,MAAM,CAAC;AAGtF,qBAAS,iBAAiB,aAAa,KAAK,SAAS,SAAS;AAC9D,qBAAS,iBAAiB,WAAW,KAAK,SAAS,OAAO;AAC1D,qBAAS,iBAAiB,aAAa,KAAK,SAAS,WAAW,EAAE,SAAS,MAAM,CAAC;AAClF,qBAAS,iBAAiB,YAAY,KAAK,SAAS,QAAQ;AAAA,UAC9D;AAGA,eAAK,QAAQ,iBAAiB,WAAW,KAAK,SAAS,OAAO;AAG9D,cAAI,KAAK,QAAQ,iBAAiB,KAAK,QAAQ,cAAc,SAAS,GAAG;AACvE,iBAAK,QAAQ,cAAc,QAAQ,YAAU;AAC3C,kBAAI,OAAO,WAAW,eAAe,kBAAkB,QAAQ;AAC7D,uBAAO,iBAAiB,eAAe,KAAK,SAAS,uBAAuB;AAAA,cAC9E,OAAO;AACL,uBAAO,iBAAiB,aAAa,KAAK,SAAS,qBAAqB;AACxE,uBAAO,iBAAiB,cAAc,KAAK,SAAS,uBAAuB,EAAE,SAAS,MAAM,CAAC;AAAA,cAC/F;AAEA,oBAAM,UAAU,OAAO,QAAQ,wBAAwB;AACvD,mBAAK,qBAAqB,IAAI,QAAQ,OAAO;AAC7C,kBAAI,SAAS;AACX,qBAAK,2BAA2B,MAAM;AACtC,qBAAK,iBAAiB,MAAM;AAAA,cAC9B;AAAA,YACF,CAAC;AAAA,UACH;AAAA,QACF;AAAA,QAEA,cAAc,GAAG;AAxKnB;AA0KI,cAAI,EAAE,cAAc,MAAO;AAG3B,cAAI,EAAE,gBAAgB,WAAW,EAAE,WAAW,EAAG;AAGjD,cAAI,EAAE,OAAO,UAAU,SAAS,GAAG,YAAK,QAAQ,aAAW,iBAAgB,GAAG;AAC5E;AAAA,UACF;AAGA,cAAI,KAAK,QAAQ,eAAe,CAAC,KAAK,QAAQ,YAAY,CAAC,GAAG;AAC5D;AAAA,UACF;AAEA,eAAK,kBAAkB,EAAE;AACzB,eAAK,oBAAoB,EAAE;AAG3B,cAAI;AACF,0BAAE,kBAAF,mBAAiB,sBAAjB,4BAAqC,EAAE;AAAA,UACzC,SAAQC,IAAA;AAAA,UAER;AAEA,eAAK,cAAc,EAAE,SAAS,EAAE,OAAO;AACvC,YAAE,eAAe;AAAA,QACnB;AAAA,QAEA,cAAc,GAAG;AACf,cAAI,KAAK,oBAAoB,QAAQ,EAAE,cAAc,KAAK,gBAAiB;AAE3E,cAAI,KAAK,YAAY;AACnB,iBAAK,KAAK,EAAE,SAAS,EAAE,OAAO;AAC9B,cAAE,eAAe;AAAA,UACnB,WAAW,KAAK,YAAY;AAC1B,iBAAK,OAAO,EAAE,SAAS,EAAE,OAAO;AAChC,cAAE,eAAe;AAAA,UACnB;AAAA,QACF;AAAA,QAEA,YAAY,GAAG;AACb,cAAI,KAAK,oBAAoB,QAAQ,EAAE,cAAc,KAAK,gBAAiB;AAE3E,cAAI,KAAK,YAAY;AACnB,iBAAK,aAAa;AAAA,UACpB,WAAW,KAAK,YAAY;AAC1B,iBAAK,aAAa;AAAA,UACpB;AAEA,eAAK,kBAAkB;AACvB,eAAK,oBAAoB;AAAA,QAC3B;AAAA,QAEA,YAAY,GAAG;AAEb,cAAI,EAAE,OAAO,UAAU,SAAS,GAAG,YAAK,QAAQ,aAAW,iBAAgB,GAAG;AAC5E;AAAA,UACF;AAGA,cAAI,KAAK,QAAQ,eAAe,CAAC,KAAK,QAAQ,YAAY,CAAC,GAAG;AAC5D;AAAA,UACF;AAEA,eAAK,cAAc,EAAE,SAAS,EAAE,OAAO;AACvC,YAAE,eAAe;AAAA,QACnB;AAAA,QAEA,aAAa,GAAG;AAEd,cAAI,EAAE,OAAO,UAAU,SAAS,GAAG,YAAK,QAAQ,aAAW,iBAAgB,GAAG;AAC5E;AAAA,UACF;AAGA,cAAI,KAAK,QAAQ,eAAe,CAAC,KAAK,QAAQ,YAAY,CAAC,GAAG;AAC5D;AAAA,UACF;AAEA,gBAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,eAAK,cAAc,MAAM,SAAS,MAAM,OAAO;AAE/C,YAAE,eAAe;AAAA,QACnB;AAAA,QAEA,0BAA0B,GAAG;AAhQ/B;AAkQI,cAAI,EAAE,cAAc,MAAO;AAG3B,cAAI,EAAE,gBAAgB,WAAW,EAAE,WAAW,EAAG;AAEjD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,gBAAM,SAAS,EAAE;AACjB,eAAK,kBAAkB,OAAO,aAAa,gBAAgB;AAE3D,eAAK,kBAAkB,EAAE;AACzB,eAAK,oBAAoB,EAAE;AAE3B,cAAI;AACF,0BAAE,kBAAF,mBAAiB,sBAAjB,4BAAqC,EAAE;AAAA,UACzC,SAAQA,IAAA;AAAA,UAER;AAEA,eAAK,cAAc,EAAE,SAAS,EAAE,OAAO;AAAA,QACzC;AAAA,QAEA,wBAAwB,GAAG;AAzR7B;AA0RI,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,gBAAM,SAAS,EAAE;AACjB,eAAK,kBAAkB,OAAO,aAAa,gBAAgB;AAE3D,gBAAM,UAAU,EAAE,aAAW,aAAE,YAAF,mBAAY,OAAZ,mBAAgB;AAC7C,gBAAM,UAAU,EAAE,aAAW,aAAE,YAAF,mBAAY,OAAZ,mBAAgB;AAE7C,eAAK,cAAc,SAAS,OAAO;AAAA,QACrC;AAAA,QAEA,YAAY,GAAG;AACb,cAAI,KAAK,YAAY;AACnB,iBAAK,KAAK,EAAE,SAAS,EAAE,OAAO;AAC9B,cAAE,eAAe;AAAA,UACnB,WAAW,KAAK,YAAY;AAC1B,iBAAK,OAAO,EAAE,SAAS,EAAE,OAAO;AAChC,cAAE,eAAe;AAAA,UACnB;AAAA,QACF;AAAA,QAEA,YAAY,GAAG;AACb,cAAI,KAAK,cAAc,KAAK,YAAY;AACtC,kBAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,gBAAI,KAAK,YAAY;AACnB,mBAAK,KAAK,MAAM,SAAS,MAAM,OAAO;AAAA,YACxC,OAAO;AACL,mBAAK,OAAO,MAAM,SAAS,MAAM,OAAO;AAAA,YAC1C;AACA,cAAE,eAAe;AAAA,UACnB;AAAA,QACF;AAAA,QAEA,YAAY;AACV,cAAI,KAAK,YAAY;AACnB,iBAAK,aAAa;AAAA,UACpB,WAAW,KAAK,YAAY;AAC1B,iBAAK,aAAa;AAAA,UACpB;AAAA,QACF;AAAA,QAEA,aAAa;AACX,cAAI,KAAK,YAAY;AACnB,iBAAK,aAAa;AAAA,UACpB,WAAW,KAAK,YAAY;AAC1B,iBAAK,aAAa;AAAA,UACpB;AAAA,QACF;AAAA,QAEA,UAAU,GAAG;AAEX,cAAI,EAAE,IAAI,YAAY,MAAM,KAAK,QAAQ,gBAAgB,YAAY,GAAG;AACtE,cAAE,eAAe;AACjB,iBAAK,uBAAuB;AAC5B;AAAA,UACF;AAGA,cAAI,EAAE,IAAI,YAAY,MAAM,KAAK,QAAQ,kBAAkB,YAAY,GAAG;AACxE,cAAE,eAAe;AACjB,gBAAI,KAAK,wBAAwB,GAAG;AAClC,mBAAK,wBAAwB;AAAA,YAC/B,OAAO;AACL,mBAAK,yBAAyB;AAAA,YAChC;AACA;AAAA,UACF;AAGA,cAAI,EAAE,QAAQ,UAAU;AACtB,gBAAI,KAAK,mBAAmB;AAC1B,gBAAE,eAAe;AACjB,mBAAK,yBAAyB;AAC9B;AAAA,YACF;AACA,gBAAI,KAAK,oBAAoB,KAAK,oBAAoB;AACpD,gBAAE,eAAe;AACjB,mBAAK,wBAAwB;AAC7B,mBAAK,0BAA0B;AAC/B;AAAA,YACF;AAAA,UACF;AAGA,cAAI,CAAC,aAAa,cAAc,WAAW,WAAW,EAAE,SAAS,EAAE,GAAG,GAAG;AACvE,gBAAI,KAAK,kBAAkB;AACzB,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,aAAa,EAAE,KAAK,EAAE,QAAQ;AAAA,YACrC,WAAW,KAAK,oBAAoB;AAClC,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,eAAe,EAAE,KAAK,EAAE,QAAQ;AAAA,YACvC;AAAA,UACF;AAGA,cAAI,EAAE,QAAQ,WAAW,KAAK,oBAAoB,KAAK,qBAAqB;AAC1E,cAAE,eAAe;AACjB,iBAAK,cAAc;AAAA,UACrB;AAAA,QACF;AAAA,QAEA,cAAc,SAAS,SAAS;AAE9B,gBAAM,OAAO,KAAK,QAAQ,sBAAsB;AAIhD,gBAAM,gBAAgB,OAAO,iBAAiB,KAAK,OAAO;AAC1D,gBAAM,kBAAkB,cAAc,UAAU,UACzB,cAAc,WAAW,UACzB,cAAc,cAAc;AAEnD,eAAK,kBAAkB;AACvB,eAAK,kBAAkB;AAEvB,cAAI,iBAAiB;AAEnB,gBAAI,YAAY;AAEhB,gBAAI,cAAc,aAAa,YAAY;AAEzC,oBAAM,eAAe,KAAK,QAAQ,gBAAgB,SAAS;AAC3D,oBAAM,aAAa,aAAa,sBAAsB;AACtD,2BAAa,KAAK,OAAO,WAAW;AACpC,0BAAY,KAAK,MAAM,WAAW;AAClC,mBAAK,kBAAkB,WAAW;AAClC,mBAAK,kBAAkB,WAAW;AAAA,YACpC,WAAW,cAAc,aAAa,SAAS;AAC7C,oBAAM,aAAa,WAAW,cAAc,IAAI;AAChD,oBAAM,YAAY,WAAW,cAAc,GAAG;AAC9C,oBAAM,UAAU,OAAO,SAAS,UAAU;AAC1C,oBAAM,SAAS,OAAO,SAAS,SAAS;AACxC,2BAAa,UAAU,aAAa,KAAK;AACzC,0BAAY,SAAS,YAAY,KAAK;AACtC,mBAAK,kBAAkB,KAAK,OAAO;AACnC,mBAAK,kBAAkB,KAAK,MAAM;AAAA,YACpC,OAAO;AAEL,2BAAa,KAAK;AAClB,0BAAY,KAAK;AACjB,mBAAK,kBAAkB,KAAK,OAAO;AACnC,mBAAK,kBAAkB,KAAK,MAAM;AAAA,YACpC;AAGA,kBAAM,iBAAiB,KAAK,QAAQ,MAAM;AAC1C,gBAAI,aAAa,eACd,MAAM,GAAG,EACT,OAAO,UAAQ;AACd,oBAAM,UAAU,KAAK,KAAK;AAE1B,kBAAI,CAAC,QAAS,QAAO;AAErB,oBAAM,aAAa,QAAQ,QAAQ,GAAG;AACtC,kBAAI,eAAe,GAAI,QAAO;AAE9B,oBAAM,WAAW,QAAQ,UAAU,GAAG,UAAU,EAAE,KAAK;AACvD,oBAAM,QAAQ,QAAQ,UAAU,aAAa,CAAC,EAAE,KAAK;AAGrD,kBAAI,CAAC,SAAS,UAAU,GAAI,QAAO;AAGnC,kBAAI,aAAa,WAAW,aAAa,YAAY,aAAa,eAC9D,aAAa,UAAU,aAAa,SAAS,aAAa,SAAS;AACrE,uBAAO;AAAA,cACT;AAGA,kBAAI,SAAS,WAAW,cAAc,GAAG;AACvC,uBAAO;AAAA,cACT;AAEA,qBAAO;AAAA,YACT,CAAC,EACA,KAAK,IAAI;AAEZ,gBAAI,WAAY,eAAc;AAC9B,0BAAc,SAAS,mBAAU,aAAY,kBAAS;AAGtD,iBAAK,QAAQ,MAAM,UAAU;AAAA,UAC/B;AAIA,gBAAM,YAAY,KAAK,QAAQ,sBAAsB;AACrD,eAAK,cAAc,UAAU,UAAU;AACvC,eAAK,cAAc,UAAU,UAAU;AAEvC,eAAK,aAAa;AAClB,eAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,YAAW;AACjE,mBAAS,KAAK,MAAM,SAAS;AAC7B,mBAAS,KAAK,MAAM,aAAa;AAAA,QACnC;AAAA,QAEA,KAAK,SAAS,SAAS;AACrB,cAAI,CAAC,KAAK,WAAY;AAGtB,cAAI,OAAO,UAAU,KAAK,cAAc,KAAK;AAC7C,cAAI,OAAO,UAAU,KAAK,cAAc,KAAK;AAG7C,cAAI,KAAK,QAAQ,qBAAqB;AACpC,kBAAM,OAAO,KAAK,QAAQ,sBAAsB;AAChD,kBAAM,gBAAgB,SAAS,gBAAgB;AAC/C,kBAAM,iBAAiB,SAAS,gBAAgB;AAGhD,kBAAM,aAAa;AACnB,kBAAM,OAAO,EAAE,KAAK,QAAQ;AAC5B,kBAAM,OAAO,EAAE,KAAK,SAAS;AAC7B,kBAAM,OAAO,gBAAgB;AAC7B,kBAAM,OAAO,iBAAiB;AAE9B,mBAAO,KAAK,IAAI,MAAM,KAAK,IAAI,MAAM,IAAI,CAAC;AAC1C,mBAAO,KAAK,IAAI,MAAM,KAAK,IAAI,MAAM,IAAI,CAAC;AAAA,UAC5C;AAEA,eAAK,QAAQ,MAAM,OAAO,GAAG,aAAI;AACjC,eAAK,QAAQ,MAAM,MAAM,GAAG,aAAI;AAGhC,cAAI,KAAK,QAAQ,QAAQ;AACvB,iBAAK,QAAQ,OAAO,EAAE,GAAG,MAAM,GAAG,KAAK,CAAC;AAAA,UAC1C;AAAA,QACF;AAAA,QAEA,eAAe;AACb,eAAK,aAAa;AAClB,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,YAAW;AACpE,mBAAS,KAAK,MAAM,SAAS;AAC7B,mBAAS,KAAK,MAAM,aAAa;AAGjC,eAAK,qBAAqB;AAG1B,cAAI,KAAK,QAAQ,WAAW;AAC1B,iBAAK,QAAQ,UAAU;AAAA,UACzB;AAAA,QACF;AAAA,QAEA,cAAc,SAAS,SAAS;AAC9B,eAAK,aAAa;AAClB,eAAK,eAAe;AACpB,eAAK,eAAe;AAEpB,gBAAM,OAAO,KAAK,QAAQ,sBAAsB;AAChD,eAAK,mBAAmB,KAAK;AAC7B,eAAK,oBAAoB,KAAK;AAC9B,eAAK,kBAAkB,KAAK;AAC5B,eAAK,iBAAiB,KAAK;AAE3B,eAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,YAAW;AACjE,mBAAS,KAAK,MAAM,aAAa;AAGjC,cAAI,KAAK,QAAQ,eAAe;AAC9B,iBAAK,QAAQ,cAAc;AAAA,UAC7B;AAAA,QACF;AAAA,QAEA,OAAO,SAAS,SAAS;AACvB,cAAI,CAAC,KAAK,WAAY;AAEtB,gBAAM,SAAS,UAAU,KAAK;AAC9B,gBAAM,SAAS,UAAU,KAAK;AAE9B,cAAI,WAAW,KAAK;AACpB,cAAI,YAAY,KAAK;AACrB,cAAI,UAAU,KAAK;AACnB,cAAI,SAAS,KAAK;AAGlB,cAAI,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACtC,uBAAW,KAAK,IAAI,KAAK,QAAQ,UAAU,KAAK,mBAAmB,MAAM;AAAA,UAC3E;AACA,cAAI,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACtC,kBAAM,gBAAgB,KAAK,IAAI,KAAK,QAAQ,UAAU,KAAK,mBAAmB,MAAM;AACpF,sBAAU,KAAK,mBAAmB,KAAK,mBAAmB;AAC1D,uBAAW;AAAA,UACb;AAEA,gBAAM,iBAAiB,OAAO,KAAK,QAAQ,aAAa,aACpD,KAAK,QAAQ,SAAS,IACtB,KAAK,QAAQ;AACjB,cAAI,OAAO,SAAS,cAAc,GAAG;AACnC,kBAAM,eAAe,KAAK,IAAI,UAAU,cAAc;AACtD,gBAAI,iBAAiB,YAAY,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACnE,yBAAW,WAAW;AAAA,YACxB;AACA,uBAAW;AAAA,UACb;AAGA,cAAI,CAAC,KAAK,QAAQ,qBAAqB;AACrC,gBAAI,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACtC,0BAAY,KAAK,IAAI,KAAK,QAAQ,WAAW,KAAK,oBAAoB,MAAM;AAAA,YAC9E;AACA,gBAAI,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACtC,oBAAM,iBAAiB,KAAK,IAAI,KAAK,QAAQ,WAAW,KAAK,oBAAoB,MAAM;AACvF,uBAAS,KAAK,kBAAkB,KAAK,oBAAoB;AACzD,0BAAY;AAAA,YACd;AAEA,kBAAM,kBAAkB,OAAO,KAAK,QAAQ,cAAc,aACtD,KAAK,QAAQ,UAAU,IACvB,KAAK,QAAQ;AACjB,gBAAI,OAAO,SAAS,eAAe,GAAG;AACpC,oBAAM,gBAAgB,KAAK,IAAI,WAAW,eAAe;AACzD,kBAAI,kBAAkB,aAAa,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACrE,0BAAU,YAAY;AAAA,cACxB;AACA,0BAAY;AAAA,YACd;AAAA,UACF;AAGA,eAAK,QAAQ,MAAM,QAAQ,GAAG,iBAAQ;AACtC,cAAI,CAAC,KAAK,QAAQ,qBAAqB;AACrC,iBAAK,QAAQ,MAAM,SAAS,GAAG,kBAAS;AAAA,UAC1C,OAAO;AACL,iBAAK,QAAQ,MAAM,SAAS;AAAA,UAC9B;AAGA,cAAI,KAAK,gBAAgB,SAAS,GAAG,GAAG;AACtC,iBAAK,QAAQ,MAAM,OAAO,GAAG,gBAAO;AAAA,UACtC;AACA,cAAI,KAAK,gBAAgB,SAAS,GAAG,KAAK,CAAC,KAAK,QAAQ,qBAAqB;AAC3E,iBAAK,QAAQ,MAAM,MAAM,GAAG,eAAM;AAAA,UACpC;AAGA,cAAI,KAAK,QAAQ,UAAU;AACzB,iBAAK,QAAQ,SAAS,EAAE,OAAO,UAAU,QAAQ,WAAW,MAAM,SAAS,KAAK,OAAO,CAAC;AAAA,UAC1F;AAAA,QACF;AAAA,QAEA,eAAe;AACb,eAAK,aAAa;AAClB,eAAK,kBAAkB;AACvB,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,YAAW;AACpE,mBAAS,KAAK,MAAM,aAAa;AAGjC,eAAK,qBAAqB;AAG1B,cAAI,KAAK,QAAQ,aAAa;AAC5B,iBAAK,QAAQ,YAAY;AAAA,UAC3B;AAAA,QACF;AAAA,QAEA,yBAAyB;AACvB,cAAI,KAAK,kBAAkB;AACzB,iBAAK,wBAAwB;AAAA,UAC/B,OAAO;AACL,iBAAK,uBAAuB;AAAA,UAC9B;AAAA,QACF;AAAA,QAEA,yBAAyB;AACvB,eAAK,mBAAmB;AACxB,eAAK,qBAAqB;AAC1B,eAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,iBAAgB;AACtE,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,mBAAkB;AAC3E,eAAK,aAAa;AAAA,QACpB;AAAA,QAEA,0BAA0B;AACxB,eAAK,mBAAmB;AACxB,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,iBAAgB;AAAA,QAC3E;AAAA,QAEA,2BAA2B;AACzB,cAAI,KAAK,oBAAoB;AAC3B,iBAAK,0BAA0B;AAAA,UACjC,OAAO;AACL,iBAAK,yBAAyB;AAAA,UAChC;AAAA,QACF;AAAA,QAEA,2BAA2B;AACzB,eAAK,qBAAqB;AAC1B,eAAK,mBAAmB;AACxB,eAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,mBAAkB;AACxE,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,iBAAgB;AACzE,eAAK,aAAa;AAAA,QACpB;AAAA,QAEA,4BAA4B;AAC1B,eAAK,qBAAqB;AAC1B,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,mBAAkB;AAAA,QAC7E;AAAA,QAEA,wBAAwB,EAAE,QAAQ,KAAK,IAAI,CAAC,GAAG;AAC7C,cAAI,CAAC,KAAK,wBAAwB,GAAG;AACnC,iBAAK,yBAAyB;AAC9B;AAAA,UACF;AAEA,cAAI,KAAK,mBAAmB;AAC1B;AAAA,UACF;AAEA,eAAK,oBAAoB;AACzB,eAAK,yBAAyB,IAAI;AAClC,eAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,aAAY;AAClE,eAAK,yBAAyB;AAE9B,cAAI,OAAO;AACT,iBAAK,aAAa;AAAA,UACpB;AAEA,cAAI,OAAO,KAAK,QAAQ,0BAA0B,YAAY;AAC5D,iBAAK,QAAQ,sBAAsB,IAAI;AAAA,UACzC;AAAA,QACF;AAAA,QAEA,yBAAyB,EAAE,QAAQ,MAAM,IAAI,CAAC,GAAG;AAC/C,cAAI,CAAC,KAAK,mBAAmB;AAC3B;AAAA,UACF;AAEA,eAAK,oBAAoB;AACzB,eAAK,yBAAyB,KAAK;AACnC,eAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,aAAY;AACrE,eAAK,0BAA0B;AAE/B,cAAI,OAAO;AACT,iBAAK,aAAa;AAAA,UACpB;AAEA,cAAI,OAAO,KAAK,QAAQ,0BAA0B,YAAY;AAC5D,iBAAK,QAAQ,sBAAsB,KAAK;AAAA,UAC1C;AAAA,QACF;AAAA,QAEA,0BAA0B;AACxB,cAAI,KAAK,mBAAmB;AAC1B,iBAAK,yBAAyB;AAAA,UAChC,OAAO;AACL,iBAAK,wBAAwB;AAAA,UAC/B;AACA,iBAAO,KAAK;AAAA,QACd;AAAA,QAEA,eAAe;AACb,cAAI,OAAO,KAAK,QAAQ,UAAU,YAAY;AAC5C,gBAAI;AACF,mBAAK,QAAQ,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC5C,SAAS,GAAG;AAEV,mBAAK,QAAQ,MAAM;AAAA,YACrB;AAAA,UACF;AAAA,QACF;AAAA,QAEA,aAAa,KAAK,UAAU;AAC1B,gBAAM,OAAO,WAAW,KAAK,QAAQ,oBAAoB,KAAK,QAAQ;AAGtE,cAAI,cAAc,WAAW,KAAK,QAAQ,MAAM,IAAI,KAAK;AACzD,cAAI,aAAa,WAAW,KAAK,QAAQ,MAAM,GAAG,KAAK;AAGvD,gBAAM,gBAAgB,OAAO,iBAAiB,KAAK,OAAO;AAC1D,cAAI,cAAc,cAAc,QAAQ;AACtC,kBAAM,OAAO,KAAK,QAAQ,sBAAsB;AAChD,0BAAc,KAAK;AACnB,yBAAa,KAAK;AAClB,iBAAK,QAAQ,MAAM,YAAY;AAC/B,iBAAK,QAAQ,MAAM,OAAO,GAAG,oBAAW;AACxC,iBAAK,QAAQ,MAAM,MAAM,GAAG,mBAAU;AAAA,UACxC;AAGA,cAAI,OAAO;AACX,cAAI,OAAO;AAEX,kBAAO,KAAK;AAAA,YACV,KAAK;AACH,sBAAQ;AACR;AAAA,YACF,KAAK;AACH,sBAAQ;AACR;AAAA,YACF,KAAK;AACH,sBAAQ;AACR;AAAA,YACF,KAAK;AACH,sBAAQ;AACR;AAAA,UACJ;AAGA,eAAK,QAAQ,MAAM,OAAO,GAAG,aAAI;AACjC,eAAK,QAAQ,MAAM,MAAM,GAAG,aAAI;AAGhC,cAAI,KAAK,QAAQ,QAAQ;AACvB,iBAAK,QAAQ,OAAO,EAAE,GAAG,MAAM,GAAG,KAAK,CAAC;AAAA,UAC1C;AAAA,QACF;AAAA,QAEA,eAAe,KAAK,UAAU;AAC5B,gBAAM,OAAO,WAAW,KAAK,QAAQ,oBAAoB,KAAK,QAAQ;AACtE,gBAAM,OAAO,KAAK,QAAQ,sBAAsB;AAEhD,cAAI,QAAQ,KAAK;AACjB,cAAI,SAAS,KAAK;AAGlB,kBAAO,KAAK;AAAA,YACV,KAAK;AACH,uBAAS;AACT;AAAA,YACF,KAAK;AACH,uBAAS;AACT;AAAA,YACF,KAAK;AACH,kBAAI,KAAK,QAAQ,qBAAqB;AACpC,yBAAS;AAAA,cACX,OAAO;AACL,0BAAU;AAAA,cACZ;AACA;AAAA,YACF,KAAK;AACH,kBAAI,KAAK,QAAQ,qBAAqB;AACpC,yBAAS;AAAA,cACX,OAAO;AACL,0BAAU;AAAA,cACZ;AACA;AAAA,UACJ;AAGA,kBAAQ,KAAK,IAAI,KAAK,QAAQ,UAAU,KAAK;AAC7C,mBAAS,KAAK,IAAI,KAAK,QAAQ,WAAW,MAAM;AAGhD,eAAK,QAAQ,MAAM,QAAQ,GAAG,cAAK;AACnC,cAAI,CAAC,KAAK,QAAQ,qBAAqB;AACrC,iBAAK,QAAQ,MAAM,SAAS,GAAG,eAAM;AAAA,UACvC,OAAO;AACL,iBAAK,QAAQ,MAAM,SAAS;AAAA,UAC9B;AAGA,cAAI,KAAK,QAAQ,UAAU;AACzB,iBAAK,QAAQ,SAAS,EAAE,OAAO,OAAO,CAAC;AAAA,UACzC;AAAA,QACF;AAAA,QAEA,gBAAgB;AACd,eAAK,QAAQ,MAAM,OAAO;AAC1B,eAAK,QAAQ,MAAM,MAAM;AACzB,eAAK,QAAQ,MAAM,YAAY;AAC/B,eAAK,QAAQ,MAAM,QAAQ;AAC3B,eAAK,QAAQ,MAAM,SAAS;AAG5B,eAAK,qBAAqB;AAG1B,cAAI,KAAK,QAAQ,QAAQ;AACvB,iBAAK,QAAQ,OAAO,EAAE,UAAU,KAAK,CAAC;AAAA,UACxC;AAAA,QACF;AAAA,QAEA,UAAU;AACR,gBAAM,aAAa,KAAK,QAAQ,cAAc,KAAK;AAEnD,eAAK,yBAAyB;AAG9B,qBAAW,oBAAoB,aAAa,KAAK,SAAS,SAAS;AACnE,qBAAW,oBAAoB,cAAc,KAAK,SAAS,UAAU;AACrE,qBAAW,oBAAoB,eAAe,KAAK,SAAS,WAAW;AAGvE,mBAAS,oBAAoB,aAAa,KAAK,SAAS,SAAS;AACjE,mBAAS,oBAAoB,WAAW,KAAK,SAAS,OAAO;AAC7D,mBAAS,oBAAoB,aAAa,KAAK,SAAS,SAAS;AACjE,mBAAS,oBAAoB,YAAY,KAAK,SAAS,QAAQ;AAC/D,mBAAS,oBAAoB,eAAe,KAAK,SAAS,WAAW;AACrE,mBAAS,oBAAoB,aAAa,KAAK,SAAS,SAAS;AACjE,mBAAS,oBAAoB,iBAAiB,KAAK,SAAS,aAAa;AAGzE,eAAK,QAAQ,oBAAoB,WAAW,KAAK,SAAS,OAAO;AAGjE,cAAI,KAAK,QAAQ,iBAAiB,KAAK,QAAQ,cAAc,SAAS,GAAG;AACvE,iBAAK,QAAQ,cAAc,QAAQ,YAAU;AAC3C,qBAAO,oBAAoB,aAAa,KAAK,SAAS,qBAAqB;AAC3E,qBAAO,oBAAoB,cAAc,KAAK,SAAS,qBAAqB;AAC5E,qBAAO,oBAAoB,eAAe,KAAK,SAAS,uBAAuB;AAAA,YACjF,CAAC;AAAA,UACH;AAGA,eAAK,QAAQ,UAAU;AAAA,YACrB,GAAG,YAAK,QAAQ,aAAW;AAAA,YAC3B,GAAG,YAAK,QAAQ,aAAW;AAAA,YAC3B,GAAG,YAAK,QAAQ,aAAW;AAAA,YAC3B,GAAG,YAAK,QAAQ,aAAW;AAAA,UAC7B;AAAA,QACF;AAAA,MACF;AAAA;AAAA;;;AC52BO,WAAS,eAAe,EAAE,aAAa,WAAW,MAAM,OAAO,WAAW,SAAS,eAAe,MAAM,GAAG;AAE9G,UAAM,mBAAmB,OAAO,UAAU,aAAa,MAAM,WAAW,aAAa,KAAK,MAAM,WAAW,SAAS,KAAK,MAAM,WAAW,WAAW;AACrJ,UAAM,gBAAgB,cAAc,mBAAoB,KAAK,EAAE,KAAK,KAAK,QAAS;AAElF,UAAM,SAAS,SAAS,cAAc,UAAU;AAAA,MAC5C,WAAW;AAAA,MACX,YAAY;AAAA,QACR,QAAQ;AAAA,QACR,cAAc;AAAA,QACd,YAAY;AAAA,MAChB;AAAA,IACJ,CAAC;AAED,QAAI,MAAM;AACN,aAAO,YAAY,kBAAkB,IAAI,CAAC;AAAA,IAC9C;AAGA,UAAM,YAAY,OAAO,UAAU,aAAa,MAAM,WAAW,aAAa,KAAK,MAAM,WAAW,SAAS,KAAK,MAAM,WAAW,WAAW;AAC9I,UAAM,cAAc,YAAa,KAAK,EAAE,KAAK,KAAK,QAAS;AAE3D,UAAM,OAAO,SAAS,cAAc,QAAQ;AAAA,MACxC;AAAA,MACA,WAAW,eAAe,GAAG,oBAAW,oBAAmB;AAAA,MAC3D,YAAY;AAAA,QACR,eAAe;AAAA,MACnB;AAAA,IACJ,CAAC;AACD,WAAO,YAAY,IAAI;AAEvB,QAAI,SAAS;AACT,aAAO,iBAAiB,SAAS,OAAO;AAAA,IAC5C;AAEA,WAAO;AAAA,EACX;AASO,WAAS,6BAA6B,MAAM,QAAQ,cAAc,SAAS;AAC9E,QAAI,CAAC,KAAM;AAEX,UAAM,YAAY,MAAM,KAAK,KAAK,iBAAiB,YAAY,CAAC;AAChE,QAAI,UAAU,WAAW,EAAG;AAE5B,UAAM,gBAAgB,CAAC,MAAM;AACzB,YAAM,eAAe,UAAU,QAAQ,SAAS,aAAa;AAE7D,cAAQ,EAAE,KAAK;AAAA,QACX,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,gBAAM,aAAa,eAAe,KAAK,UAAU;AACjD,oBAAU,QAAQ,CAAC,MAAM,QAAQ;AAC7B,iBAAK,aAAa,YAAY,QAAQ,YAAY,MAAM,IAAI;AAAA,UAChE,CAAC;AACD,oBAAU,SAAS,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AACnD,oBAAU,SAAS,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAC5E;AAAA,QAEJ,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,gBAAM,aAAa,eAAe,IAAI,UAAU,UAAU,UAAU;AACpE,oBAAU,QAAQ,CAAC,MAAM,QAAQ;AAC7B,iBAAK,aAAa,YAAY,QAAQ,YAAY,MAAM,IAAI;AAAA,UAChE,CAAC;AACD,oBAAU,SAAS,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AACnD,oBAAU,SAAS,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAC5E;AAAA,QAEJ,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,oBAAU,QAAQ,CAAC,MAAM,QAAQ;AAC7B,iBAAK,aAAa,YAAY,QAAQ,IAAI,MAAM,IAAI;AAAA,UACxD,CAAC;AACD,oBAAU,CAAC,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AAC3C,oBAAU,CAAC,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AACpE;AAAA,QAEJ,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,gBAAM,YAAY,UAAU,SAAS;AACrC,oBAAU,QAAQ,CAAC,MAAM,QAAQ;AAC7B,iBAAK,aAAa,YAAY,QAAQ,YAAY,MAAM,IAAI;AAAA,UAChE,CAAC;AACD,oBAAU,SAAS,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AACnD,oBAAU,SAAS,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAC5E;AAAA,QAEJ,KAAK;AAAA,QACL,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,SAAS,iBAAiB,UAAU,SAAS,SAAS,aAAa,GAAG;AACtE,qBAAS,cAAc,MAAM;AAC7B,gBAAI,SAAS;AACT,yBAAW,MAAM;AACb,oBAAI,UAAU,SAAS,SAAS,MAAM,GAAG;AACrC,yBAAO,MAAM;AAAA,gBACjB;AAAA,cACJ,GAAG,CAAC;AAAA,YACR;AAAA,UACJ;AACA;AAAA,QAEJ,KAAK;AACD,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,SAAS;AACT,oBAAQ;AAAA,UACZ;AACA;AAAA,MACR;AAAA,IACJ;AAEA,SAAK,iBAAiB,WAAW,eAAe,IAAI;AACpD,WAAO;AAAA,EACX;AAQO,WAAS,mBAAmB,MAAM,cAAc,QAAQ,GAAG;AAC9D,QAAI,CAAC,KAAM;AAEX,eAAW,MAAM;AACb,YAAM,YAAY,MAAM,KAAK,KAAK,iBAAiB,YAAY,CAAC;AAChE,UAAI,UAAU,SAAS,GAAG;AACtB,kBAAU,QAAQ,CAAC,MAAM,UAAU;AAC/B,eAAK,aAAa,YAAY,UAAU,IAAI,MAAM,IAAI;AAAA,QAC1D,CAAC;AACD,qBAAa,UAAU,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC;AAEvC,kBAAU,CAAC,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAAA,MACxE;AAAA,IACJ,GAAG,KAAK;AAAA,EACZ;AAzKA;AAAA;AAIA;AACA;AACA;AACA;AAAA;AAAA;;;ACaO,WAAS,oBAAoB;AAAA,IAClC;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAS;AAAA,IACT,WAAW;AAAA,IACX,UAAU,CAAC;AAAA,EACb,GAAG;AAED,UAAM,YAAY,OAAO,cAAc,aACpC,UAAU,WAAW,aAAa,KAClC,UAAU,WAAW,SAAS,KAC9B,UAAU,WAAW,WAAW,KAChC,UAAU,WAAW,WAAW;AACnC,UAAM,mBAAmB,YAAa,KAAK,EAAE,SAAS,KAAK,YAAa;AAExE,UAAM,QAAQ,SAAS,cAAc,SAAS;AAAA,MAC5C,WAAW;AAAA,MACX,aAAa;AAAA,MACb,YAAY;AAAA,QACV,OAAO;AAAA,QACP,SAAS,SAAS,mBAAmB;AAAA,MACvC;AAAA,IACF,CAAC;AAED,UAAM,SAAS,SAAS,cAAc,UAAU;AAAA,MAC9C,WAAW;AAAA,MACX,YAAY;AAAA,QACV,MAAM;AAAA,QACN,SAAS,SAAS,mBAAmB;AAAA,MACvC;AAAA,IACF,CAAC;AAGD,YAAQ,QAAQ,SAAO;AACrB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC9C,aAAa,IAAI;AAAA,QACjB,YAAY;AAAA,UACV,SAAS,IAAI;AAAA,UACb,YAAY,IAAI,WAAW,aAAa;AAAA,QAC1C;AAAA,MACF,CAAC;AACD,aAAO,YAAY,MAAM;AAAA,IAC3B,CAAC;AAGD,QAAI,UAAU;AACZ,aAAO,iBAAiB,UAAU,QAAQ;AAAA,IAC5C;AAEA,WAAO,EAAE,OAAO,OAAO;AAAA,EACzB;AAqBO,WAAS,qBAAqB,SAAS;AAC5C,QAAI,CAAC,QAAS;AAEd,KAAC,aAAa,OAAO,EAAE,QAAQ,eAAa;AAC1C,cAAQ,iBAAiB,WAAW,CAAC,MAAM;AACzC,UAAE,gBAAgB;AAAA,MACpB,CAAC;AAAA,IACH,CAAC;AAAA,EACH;AAtGA;AAAA;AAIA;AACA;AAAA;AAAA;;;ACLA;AAAA;AAAA;AAAA;AAAA,MAea;AAfb;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEO,MAAM,oBAAN,MAAwB;AAAA,QAC7B,YAAY,QAAQ;AAhBtB;AAiBI,eAAK,SAAS;AACd,eAAK,mBAAmB;AACxB,eAAK,oBAAoB,CAAC;AAC1B,eAAK,eAAe,CAAC;AACrB,eAAK,qBAAqB;AAC1B,eAAK,YAAY;AAGjB,eAAK,UAAU,IAAI,eAAe,QAAQ;AAG1C,eAAK,qBAAqB;AAG1B,eAAK,sBAAsB;AAC3B,eAAK,eAAe;AACpB,eAAK,iBAAiB;AACtB,eAAK,yBAAyB;AAG9B,eAAK,qBAAqB;AAC1B,eAAK,mBAAmB;AACxB,eAAK,mBAAmB;AACxB,eAAK,iBAAiB;AACtB,eAAK,sBAAsB;AAC3B,eAAK,6BAA6B;AAClC,eAAK,0BAA0B,CAAC;AAChC,eAAK,aAAa;AAGlB,eAAK,cAAc;AACnB,eAAK,qBAAqB;AAC1B,eAAK,wBAAwB;AAG7B,eAAK,mBAAmB;AACxB,eAAK,gBAAgB;AACrB,eAAK,4BAA4B;AACjC,eAAK,+BAA+B,CAAC;AACrC,eAAK,0BAA0B;AAG/B,gBAAM,mBAAmB,KAAK,QAAQ,yBAAyB;AAG/D,eAAK,qBAAoB,qDAAkB,gBAAe,SAAY,iBAAiB,aAAa;AAGpG,eAAK,kBAAiB,qDAAkB,oBAAmB,SAAY,iBAAiB,iBAAiB;AAGzG,eAAK,kBAAkB;AAAA,YACrB,WAAU,qDAAkB,aAAY,KAAK,OAAO,QAAQ,sBAAsB;AAAA,YAClF,aAAY,qDAAkB,eAAc,KAAK,OAAO,QAAQ,wBAAwB;AAAA,YACxF,QAAO,qDAAkB,UAAS,KAAK,OAAO,QAAQ,mBAAmB;AAAA,YACzE,kBAAiB,qDAAkB,oBAAmB,KAAK,OAAO,QAAQ,6BAA6B;AAAA,YACvG,UAAS,gEAAkB,YAAlB,YAA6B,KAAK,OAAO,QAAQ,sBAAjD,YAAsE;AAAA,UACjF;AAGA,eAAK,WAAW;AAAA,YACd,YAAY,MAAM,KAAK,kBAAkB;AAAA,YACzC,yBAAyB,MAAM;AAC7B,kBAAI,KAAK,WAAW;AAClB,qBAAK,mBAAmB;AAAA,cAC1B;AAAA,YACF;AAAA,YACA,0BAA0B,MAAM;AAC9B,kBAAI,KAAK,WAAW;AAClB,qBAAK,mBAAmB;AAAA,cAC1B;AAAA,YACF;AAAA,YACA,QAAQ;AAAA,YACR,eAAe;AAAA,YACf,iBAAiB;AAAA,YACjB,eAAe;AAAA,YACf,oBAAoB;AAAA,UACtB;AAGA,eAAK,WAAW,oBAAI,IAAI;AAExB,eAAK,KAAK;AAAA,QACZ;AAAA,QAEA,OAAO;AAEL,eAAK,4BAA4B;AAGjC,eAAK,OAAO,GAAG,cAAc,KAAK,SAAS,UAAU;AAGrD,eAAK,OAAO,GAAG,2BAA2B,KAAK,SAAS,uBAAuB;AAC/E,eAAK,OAAO,GAAG,4BAA4B,KAAK,SAAS,wBAAwB;AAGjF,eAAK,OAAO,GAAG,oBAAoB,MAAM;AACvC,gBAAI,KAAK,WAAW;AAGlB,oBAAMC,YAAW,OAAO,aAAa;AACrC,kBAAIA,WAAU;AACZ,qBAAK,iBAAiB;AAAA,cACxB;AAGA,kBAAI,CAAC,KAAK,sBAAsB,CAAC,KAAK,mBAAmB,oBAAoB;AAE3E,qBAAK,kBAAkB,MAAM,KAAK,mBAAmB,GAAG,GAAG;AAAA,cAC7D;AAAA,YACF;AAAA,UACF,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA,QAKA,mBAAmB;AACjB,cAAI,KAAK,WAAW;AAClB,iBAAK,eAAe;AAAA,UACtB,OAAO;AACL,iBAAK,eAAe;AAAA,UACtB;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,iBAAiB;AACf,cAAI,KAAK,kBAAkB;AACzB,iBAAK,iBAAiB,MAAM,UAAU;AACtC,iBAAK,YAAY;AAEjB,gBAAI,KAAK,OAAO,cAAc,OAAO,KAAK,OAAO,WAAW,2BAA2B,YAAY;AACjG,mBAAK,OAAO,WAAW,uBAAuB;AAAA,YAChD;AAGA,yBAAa,KAAK,gBAAgB,EAAE,OAAO,IAAI,CAAC;AAChD;AAAA,UACF;AAGA,eAAK,uBAAuB;AAC5B,eAAK,mBAAmB;AAGxB,cAAI,KAAK,kBAAkB;AACzB,iBAAK,iBAAiB,MAAM,UAAU;AAItC,gBAAI,CAAC,KAAK,sBAAsB,CAAC,KAAK,mBAAmB,oBAAoB;AAC3E,mBAAK,kBAAkB,MAAM,KAAK,mBAAmB,GAAG,CAAC;AAAA,YAC3D;AAGA,yBAAa,KAAK,gBAAgB,EAAE,OAAO,IAAI,CAAC;AAAA,UAClD;AACA,eAAK,YAAY;AAAA,QACnB;AAAA;AAAA;AAAA;AAAA,QAKA,eAAe,EAAE,cAAc,MAAM,IAAI,CAAC,GAAG;AAvL/C;AAwLI,cAAI,KAAK,kBAAkB;AACzB,iBAAK,iBAAiB,MAAM,UAAU;AACtC,iBAAK,YAAY;AAAA,UACnB;AACA,cAAI,KAAK,sBAAsB,KAAK,mBAAmB,mBAAmB;AACxE,iBAAK,mBAAmB,yBAAyB;AACjD,iBAAK,wBAAwB;AAAA,UAC/B;AACA,eAAK,wBAAwB;AAC7B,eAAK,aAAa,EAAE;AAGpB,cAAI,KAAK,OAAO,cAAc,OAAO,KAAK,OAAO,WAAW,2BAA2B,YAAY;AACjG,iBAAK,OAAO,WAAW,uBAAuB;AAAA,UAChD;AAEA,cAAI,aAAa;AACf,kBAAM,oBAAmB,gBAAK,OAAO,eAAZ,mBAAwB,aAAxB,mBAAkC;AAC3D,gBAAI,oBAAoB,OAAO,iBAAiB,UAAU,YAAY;AACpE,+BAAiB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAChD;AAAA,UACF;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,yBAAyB;AACvB,eAAK,mBAAmB,SAAS,cAAc,OAAO;AAAA,YACpD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,QAAQ;AAAA,cACR,cAAc,KAAK,EAAE,sBAAsB;AAAA,cAC3C,YAAY;AAAA,YACd;AAAA,UACF,CAAC;AAGD,eAAK,mBAAmB,SAAS,cAAc,OAAO;AAAA,YACpD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,YAAY;AAAA,YACd;AAAA,UACF,CAAC;AAGD,eAAK,aAAa,SAAS,cAAc,OAAO;AAAA,YAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAGD,gBAAM,oBAAoB,KAAK,EAAE,yBAAyB;AAC1D,eAAK,iBAAiB,SAAS,cAAc,UAAU;AAAA,YACrD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,QAAQ;AAAA,cACR,cAAc;AAAA,cACd,iBAAiB;AAAA,YACnB;AAAA,UACF,CAAC;AACD,eAAK,eAAe,YAAY,kBAAkB,UAAU,CAAC;AAC7D,mBAAS,cAAc,KAAK,gBAAgB,mBAAmB,KAAK,OAAO,QAAQ,WAAW;AAC9F,eAAK,SAAS,gBAAgB,CAAC,MAAM;AACnC,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,gBAAI,KAAK,qBAAqB;AAC5B,mBAAK,iBAAiB;AAAA,YACxB,OAAO;AACL,mBAAK,iBAAiB;AAAA,YACxB;AAAA,UACF;AACA,eAAK,eAAe,iBAAiB,SAAS,KAAK,SAAS,aAAa;AAGzE,eAAK,SAAS,kBAAkB,CAAC,MAAM;AAErC,gBAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AAClC,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,uBAAuB;AAAA,YAC9B,WAES,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AACvC,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,iBAAiB;AAAA,YACxB,WAES,EAAE,QAAQ,YAAY,KAAK,qBAAqB;AACvD,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,iBAAiB;AAAA,YACxB;AAAA,UACF;AACA,eAAK,eAAe,iBAAiB,WAAW,KAAK,SAAS,eAAe;AAE7E,gBAAM,QAAQ,SAAS,cAAc,MAAM;AAAA,YACzC,aAAa,GAAG,YAAK,EAAE,kBAAkB,GAAC,MAAK,YAAK,EAAE,6BAA6B;AAAA,UACrF,CAAC;AAGD,gBAAM,eAAe,GAAG,YAAK,OAAO,QAAQ,aAAW,2BAA0B,YAAK,IAAI;AAE1F,gBAAM,kBAAkB,SAAS,cAAc,SAAS;AAAA,YACtD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,OAAO;AAAA,YACT;AAAA,UACF,CAAC;AAED,eAAK,qBAAqB,SAAS,cAAc,SAAS;AAAA,YACxD,YAAY;AAAA,cACV,MAAM;AAAA,cACN,QAAQ;AAAA,YACV;AAAA,UACF,CAAC;AAED,cAAI,KAAK,mBAAmB;AAC1B,iBAAK,mBAAmB,UAAU;AAAA,UACpC;AAEA,gBAAM,iBAAiB,SAAS,cAAc,QAAQ;AAAA,YACpD,aAAa,KAAK,EAAE,uBAAuB;AAAA,YAC3C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAED,0BAAgB,YAAY,KAAK,kBAAkB;AACnD,0BAAgB,YAAY,cAAc;AAG1C,eAAK,mBAAmB,iBAAiB,UAAU,CAAC,MAAM;AACxD,iBAAK,oBAAoB,EAAE,OAAO;AAClC,iBAAK,yBAAyB;AAAA,UAChC,CAAC;AAED,eAAK,iBAAiB,YAAY,KAAK;AACvC,eAAK,WAAW,YAAY,KAAK,cAAc;AAC/C,eAAK,WAAW,YAAY,eAAe;AAG3C,gBAAM,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,gCAA+B,YAAK,IAAI;AAC3F,gBAAM,EAAE,OAAO,eAAe,QAAQ,iBAAiB,IAAI,oBAAoB;AAAA,YAC7E,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC9C,aAAa,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC/C,WAAW;AAAA,YACX;AAAA,YACA,QAAQ;AAAA;AAAA,UACV,CAAC;AAED,eAAK,gBAAgB;AACrB,eAAK,mBAAmB;AAGxB,gBAAM,0BAA0B,SAAS,cAAc,OAAO;AAAA,YAC5D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,SAAS;AAAA;AAAA,YACX;AAAA,UACF,CAAC;AACD,kCAAwB,YAAY,KAAK,aAAa;AACtD,kCAAwB,YAAY,KAAK,gBAAgB;AACzD,eAAK,0BAA0B;AAG/B,+BAAqB,uBAAuB;AAE5C,eAAK,WAAW,YAAY,uBAAuB;AAEnD,gBAAM,iBAAiB,KAAK,EAAE,kBAAkB;AAChD,gBAAM,cAAc,SAAS,cAAc,UAAU;AAAA,YACnD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,QAAQ;AAAA,cACR,cAAc;AAAA,YAChB;AAAA,UACF,CAAC;AACD,sBAAY,YAAY,kBAAkB,OAAO,CAAC;AAClD,mBAAS,cAAc,aAAa,gBAAgB,KAAK,OAAO,QAAQ,WAAW;AACnF,sBAAY,iBAAiB,SAAS,MAAM,KAAK,eAAe,EAAE,aAAa,KAAK,CAAC,CAAC;AAEtF,eAAK,iBAAiB,YAAY,KAAK,UAAU;AACjD,eAAK,iBAAiB,YAAY,WAAW;AAG7C,eAAK,oBAAoB,SAAS,cAAc,OAAO;AAAA,YACrD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAED,eAAK,iBAAiB,YAAY,KAAK,gBAAgB;AACvD,eAAK,iBAAiB,YAAY,KAAK,iBAAiB;AAExD,eAAK,oBAAoB;AAGzB,eAAK,aAAa,SAAS,cAAc,OAAO;AAAA,YAC9C,WAAW;AAAA,YACX,YAAY;AAAA,cACV,aAAa;AAAA,cACb,eAAe;AAAA,YACjB;AAAA,UACF,CAAC;AACD,eAAK,iBAAiB,YAAY,KAAK,UAAU;AAGjD,eAAK,OAAO,UAAU,YAAY,KAAK,gBAAgB;AAGvD,eAAK,iBAAiB;AAItB,cAAI,CAAC,KAAK,sBAAsB,CAAC,KAAK,mBAAmB,oBAAoB;AAC3E,iBAAK,mBAAmB;AAAA,UAC1B;AAIA,eAAK,SAAS,gBAAgB,CAAC,MAAM;AAEnC,gBAAI,KAAK,wBAAwB;AAC/B;AAAA,YACF;AAGA,gBAAI,KAAK,uBAAuB;AAC9B;AAAA,YACF;AAGA,gBAAI,KAAK,kBAAkB,KAAK,eAAe,SAAS,EAAE,MAAM,GAAG;AACjE;AAAA,YACF;AAGA,gBAAI,KAAK,gBAAgB,KAAK,aAAa,SAAS,EAAE,MAAM,GAAG;AAC7D;AAAA,YACF;AAGA,gBAAI,KAAK,qBAAqB;AAC5B,mBAAK,iBAAiB;AAAA,YACxB;AAGA,gBAAI,KAAK,sBAAsB,KAAK,eAChC,CAAC,KAAK,YAAY,SAAS,EAAE,MAAM,GAAG;AACxC,mBAAK,gBAAgB;AAAA,YACvB;AAAA,UACF;AAEA,eAAK,4BAA4B;AAGjC,cAAI;AACJ,eAAK,SAAS,SAAS,MAAM;AAC3B,gBAAI,eAAe;AACjB,mBAAK,oBAAoB,aAAa;AAAA,YACxC;AACA,4BAAgB,KAAK,kBAAkB,MAAM;AAE3C,kBAAI,CAAC,KAAK,sBAAsB,CAAC,KAAK,mBAAmB,oBAAoB;AAC3E,qBAAK,mBAAmB;AAAA,cAC1B;AAAA,YACF,GAAG,GAAG;AAAA,UACR;AACA,iBAAO,iBAAiB,UAAU,KAAK,SAAS,MAAM;AAAA,QACxD;AAAA,QAEA,sBAAsB;AACpB,cAAI,CAAC,KAAK,iBAAkB;AAE5B,gBAAM,aAAa,CAAC,KAAK,KAAK,KAAK,KAAK,MAAM,MAAM,MAAM,IAAI;AAC9D,eAAK,0BAA0B,WAAW,IAAI,eAAa;AACzD,kBAAM,SAAS,SAAS,cAAc,OAAO;AAAA,cAC3C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,8BAA6B,YAAK,OAAO,QAAQ,aAAW,uBAAsB;AAAA,cAC/H,YAAY;AAAA,gBACV,kBAAkB;AAAA,gBAClB,8BAA8B;AAAA,gBAC9B,eAAe;AAAA,cACjB;AAAA,YACF,CAAC;AAED,mBAAO,MAAM,UAAU;AACvB,iBAAK,iBAAiB,YAAY,MAAM;AACxC,mBAAO;AAAA,UACT,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA,QAKA,qBAAqB;AACnB,cAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,OAAO,gBAAgB,CAAC,KAAK,UAAW;AAG5E,cAAI,KAAK,sBAAsB,KAAK,mBAAmB,oBAAoB;AACzE;AAAA,UACF;AAEA,gBAAMA,YAAW,OAAO,aAAa;AACrC,gBAAM,YAAY,KAAK,OAAO,aAAa,sBAAsB;AAGjE,gBAAM,eAAe,KAAK,OAAO,MAAM;AAEvC,cAAIA,aAAY,CAAC,cAAc;AAE7B,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,OAAO;AACnC,iBAAK,iBAAiB,MAAM,QAAQ;AACpC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,iBAAK,iBAAiB,MAAM,MAAM;AAClC,iBAAK,iBAAiB,MAAM,QAAQ;AACpC,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,YAAY;AACxC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,iBAAK,iBAAiB,MAAM,eAAe;AAC3C,iBAAK,iBAAiB,MAAM,YAAY;AACxC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,iBAAK,iBAAiB,MAAM,YAAY;AAExC,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,eAAe;AAC1D,iBAAK,iBAAiB,MAAM,eAAe,aAAa;AAExD,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,YAAY;AAExC,gBAAI,KAAK,kBAAkB;AACzB,mBAAK,iBAAiB,MAAM,SAAS;AAAA,YACvC;AAGA,gBAAI,KAAK,iBAAiB,eAAe,KAAK,OAAO,WAAW;AAC9D,mBAAK,OAAO,UAAU,YAAY,KAAK,gBAAgB;AAAA,YACzD;AAAA,UACF,WAAW,cAAc;AAEvB,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,OAAO;AACnC,iBAAK,iBAAiB,MAAM,QAAQ;AACpC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,iBAAK,iBAAiB,MAAM,MAAM;AAClC,iBAAK,iBAAiB,MAAM,YAAY;AACxC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,kBAAM,qBAAqB;AAC3B,kBAAM,sBAAsB,KAAK,IAAI,oBAAoB,OAAO,aAAa,EAAE;AAC/E,kBAAM,oBAAoB,WAAW,KAAK,iBAAiB,MAAM,KAAK,KAAK;AAC3E,kBAAM,kBAAkB,KAAK,IAAI,oBAAoB,KAAK,IAAI,mBAAmB,mBAAmB,CAAC;AACrG,iBAAK,iBAAiB,MAAM,QAAQ,GAAG,wBAAe;AACtD,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,eAAe;AAC3C,iBAAK,iBAAiB,MAAM,SAAS;AAErC,iBAAK,iBAAiB,MAAM,eAAe,YAAY;AACvD,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,eAAe;AAC1D,iBAAK,iBAAiB,MAAM,eAAe,aAAa;AAExD,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAEhE,gBAAI,KAAK,kBAAkB;AACzB,mBAAK,iBAAiB,MAAM,SAAS;AAAA,YACvC;AAGA,gBAAI,KAAK,iBAAiB,eAAe,KAAK,OAAO,WAAW;AAC9D,mBAAK,OAAO,UAAU,YAAY,KAAK,gBAAgB;AAAA,YACzD;AAAA,UACF,OAAO;AAEL,kBAAM,kBAAkB,WAAW,KAAK,iBAAiB,MAAM,KAAK,KAAK;AACzE,kBAAM,UAAU;AAChB,kBAAM,WAAW;AACjB,kBAAM,gBAAgB,KAAK,OAAO,UAAU,sBAAsB;AAElE,kBAAM,4BAA4B,MAAM;AACtC,oBAAM,WAAW,OAAO,iBAAiB,KAAK,OAAO,SAAS;AAC9D,kBAAI,SAAS,aAAa,UAAU;AAClC,qBAAK,OAAO,UAAU,MAAM,WAAW;AAAA,cACzC;AAAA,YACF;AAEA,sCAA0B;AAE1B,kBAAM,OAAQ,UAAU,QAAQ,cAAc,OAAQ;AACtD,kBAAM,iBAAiB,OAAO,aAAa,UAAU,QAAQ;AAC7D,kBAAM,eAAe,KAAK,IAAI,UAAU,KAAK,IAAI,iBAAiB,cAAc,CAAC;AACjF,kBAAM,gBAAgB,UAAU;AAEhC,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,OAAO,GAAG,aAAI;AAC1C,iBAAK,iBAAiB,MAAM,QAAQ;AACpC,iBAAK,iBAAiB,MAAM,SAAS;AACrC,iBAAK,iBAAiB,MAAM,MAAM;AAClC,iBAAK,iBAAiB,MAAM,SAAS,GAAG,sBAAa;AACrD,iBAAK,iBAAiB,MAAM,YAAY;AACxC,iBAAK,iBAAiB,MAAM,QAAQ,GAAG,qBAAY;AACnD,iBAAK,iBAAiB,MAAM,WAAW;AACvC,iBAAK,iBAAiB,MAAM,eAAe;AAC3C,iBAAK,iBAAiB,MAAM,SAAS;AAErC,iBAAK,iBAAiB,MAAM,eAAe,YAAY;AACvD,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,eAAe;AAC1D,iBAAK,iBAAiB,MAAM,eAAe,aAAa;AAExD,iBAAK,iBAAiB,MAAM,eAAe,cAAc;AACzD,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,oBAAoB;AAC/D,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAChE,iBAAK,iBAAiB,MAAM,eAAe,qBAAqB;AAEhE,gBAAI,KAAK,kBAAkB;AACzB,mBAAK,iBAAiB,MAAM,SAAS;AAAA,YACvC;AAGA,gBAAI,KAAK,iBAAiB,eAAe,KAAK,OAAO,WAAW;AAC9D,mBAAK,OAAO,UAAU,YAAY,KAAK,gBAAgB;AAAA,YACzD;AAAA,UACF;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,kCAAkC;AAChC,gBAAM,aAAa,KAAK,OAAO;AAC/B,gBAAM,YAAY,oBAAI,IAAI;AAG1B,qBAAW,QAAQ,WAAS;AAC1B,iBAAK,MAAM,SAAS,cAAc,MAAM,SAAS,gBAAgB,MAAM,UAAU;AAC/E,kBAAI,CAAC,UAAU,IAAI,MAAM,QAAQ,GAAG;AAClC,0BAAU,IAAI,MAAM,UAAU;AAAA,kBAC5B,UAAU,MAAM;AAAA,kBAChB,OAAO,MAAM,SAAS,MAAM;AAAA,kBAC5B;AAAA,gBACF,CAAC;AAAA,cACH;AAAA,YACF;AAAA,UACF,CAAC;AAED,iBAAO,MAAM,KAAK,UAAU,OAAO,CAAC;AAAA,QACtC;AAAA;AAAA;AAAA;AAAA,QAKA,yBAAyB;AACvB,cAAI,CAAC,KAAK,iBAAkB;AAE5B,eAAK,+BAA+B,KAAK,gCAAgC;AAGzE,eAAK,iBAAiB,YAAY;AAGlC,cAAI,KAAK,6BAA6B,SAAS,GAAG;AAChD,gBAAI,KAAK,yBAAyB;AAChC,mBAAK,wBAAwB,MAAM,UAAU;AAAA,YAC/C;AACA;AAAA,UACF;AAGA,cAAI,KAAK,yBAAyB;AAChC,iBAAK,wBAAwB,MAAM,UAAU;AAAA,UAC/C;AAEA,eAAK,6BAA6B,QAAQ,CAAC,UAAU,UAAU;AAC7D,kBAAM,SAAS,SAAS,cAAc,UAAU;AAAA,cAC9C,aAAa,SAAS;AAAA,cACtB,YAAY;AAAA,gBACV,SAAS,SAAS;AAAA,gBAClB,QAAQ,SAAS;AAAA,cACnB;AAAA,YACF,CAAC;AACD,iBAAK,iBAAiB,YAAY,MAAM;AAAA,UAC1C,CAAC;AAGD,cAAI,KAAK,2BAA2B;AAClC,iBAAK,iBAAiB,QAAQ,KAAK;AAAA,UACrC,WAAW,KAAK,6BAA6B,SAAS,GAAG;AAEvD,kBAAM,cAAc,KAAK,OAAO,WAAW;AAAA,cACzC,YAAU,MAAM,SAAS,cAAc,MAAM,SAAS,gBAAgB,MAAM,SAAS;AAAA,YACvF;AACA,iBAAK,4BAA4B,cAAc,YAAY,WAAW,KAAK,6BAA6B,CAAC,EAAE;AAC3G,iBAAK,iBAAiB,QAAQ,KAAK;AAAA,UACrC;AAGA,cAAI,KAAK,yBAAyB;AAChC,iBAAK,iBAAiB,oBAAoB,UAAU,KAAK,uBAAuB;AAAA,UAClF;AAGA,eAAK,0BAA0B,CAAC,MAAM;AACpC,iBAAK,4BAA4B,EAAE,OAAO;AAC1C,iBAAK,mBAAmB;AAGxB,gBAAI,KAAK,qBAAqB,KAAK,2BAA2B;AAC5D,mBAAK,kBAAkB,aAAa,QAAQ,KAAK,yBAAyB;AAAA,YAC5E;AAAA,UACF;AACA,eAAK,iBAAiB,iBAAiB,UAAU,KAAK,uBAAuB;AAAA,QAC/E;AAAA;AAAA;AAAA;AAAA,QAKA,qBAAqB;AACnB,eAAK,oBAAoB,CAAC;AAC1B,eAAK,kBAAkB,YAAY;AAGnC,gBAAM,aAAa,KAAK,OAAO;AAG/B,cAAI,eAAe;AACnB,cAAI,KAAK,2BAA2B;AAClC,2BAAe,WAAW;AAAA,cACxB,YAAU,MAAM,SAAS,cAAc,MAAM,SAAS,gBAC7C,MAAM,aAAa,KAAK;AAAA,YACnC;AAAA,UACF;AAGA,cAAI,CAAC,cAAc;AACjB,2BAAe,WAAW;AAAA,cACxB,WAAS,MAAM,SAAS,cAAc,MAAM,SAAS;AAAA,YACvD;AACA,gBAAI,cAAc;AAChB,mBAAK,4BAA4B,aAAa;AAAA,YAChD;AAAA,UACF;AAGA,cAAI,mBAAmB;AACvB,cAAI,KAAK,2BAA2B;AAClC,+BAAmB,WAAW;AAAA,cAC5B,WAAS,MAAM,SAAS,kBAAkB,MAAM,aAAa,KAAK;AAAA,YACpE;AAAA,UACF;AAEA,cAAI,CAAC,kBAAkB;AACrB,+BAAmB,WAAW,KAAK,WAAS,MAAM,SAAS,cAAc;AAAA,UAC3E;AAEA,gBAAM,gBAAgB,WAAW,KAAK,WAAS,MAAM,SAAS,UAAU;AAIxE,cAAI,CAAC,gBAAgB,CAAC,oBAAoB,CAAC,eAAe;AACxD,iBAAK,wBAAwB;AAC7B;AAAA,UACF;AAGA,gBAAM,eAAe,CAAC,cAAc,kBAAkB,aAAa,EAAE,OAAO,OAAO;AACnF,uBAAa,QAAQ,WAAS;AAC5B,gBAAI,MAAM,SAAS,YAAY;AAC7B,oBAAM,OAAO;AAAA,YACf;AAAA,UACF,CAAC;AAGD,gBAAM,eAAe,aAAa,KAAK,WAAS,CAAC,MAAM,QAAQ,MAAM,KAAK,WAAW,CAAC;AAEtF,cAAI,cAAc;AAEhB,kBAAM,iBAAiB,SAAS,cAAc,OAAO;AAAA,cACnD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,aAAa,KAAK,EAAE,oBAAoB;AAAA,YAC1C,CAAC;AACD,iBAAK,kBAAkB,YAAY,cAAc;AAEjD,gBAAI,SAAS;AACb,kBAAM,SAAS,MAAM;AACnB;AACA,kBAAI,UAAU,aAAa,QAAQ;AACjC,qBAAK,mBAAmB;AAAA,cAC1B;AAAA,YACF;AAEA,yBAAa,QAAQ,WAAS;AAC5B,oBAAM,iBAAiB,QAAQ,QAAQ,EAAE,MAAM,KAAK,CAAC;AAAA,YACvD,CAAC;AAGD,iBAAK,kBAAkB,MAAM;AAC3B,mBAAK,mBAAmB;AAAA,YAC1B,GAAG,GAAG;AAEN;AAAA,UACF;AAGA,gBAAM,UAAU,CAAC;AAEjB,cAAI,gBAAgB,aAAa,MAAM;AACrC,kBAAM,KAAK,aAAa,IAAI,EAAE,QAAQ,SAAO;AAC3C,sBAAQ,KAAK,EAAE,KAAK,MAAM,UAAU,CAAC;AAAA,YACvC,CAAC;AAAA,UACH;AAKA,cAAI,oBAAoB,iBAAiB,MAAM;AAC7C,kBAAM,KAAK,iBAAiB,IAAI,EAAE,QAAQ,SAAO;AAC/C,sBAAQ,KAAK,EAAE,KAAK,MAAM,cAAc,CAAC;AAAA,YAC3C,CAAC;AAAA,UACH;AAGA,cAAI,iBAAiB,cAAc,MAAM;AACvC,iBAAK,eAAe,MAAM,KAAK,cAAc,IAAI;AACjD,iBAAK,sBAAsB;AAAA,UAC7B;AAGA,kBAAQ,KAAK,CAAC,GAAG,MAAM,EAAE,IAAI,YAAY,EAAE,IAAI,SAAS;AAGxD,kBAAQ,QAAQ,CAAC,MAAM,UAAU;AAC/B,kBAAM,QAAQ,KAAK,sBAAsB,KAAK,KAAK,OAAO,KAAK,IAAI;AACnE,iBAAK,kBAAkB,KAAK;AAAA,cAC1B,SAAS;AAAA,cACT,KAAK,KAAK;AAAA,cACV,MAAM,KAAK;AAAA,cACX,WAAW,KAAK,IAAI;AAAA,cACpB,SAAS,KAAK,IAAI;AAAA,YACpB,CAAC;AACD,iBAAK,kBAAkB,YAAY,KAAK;AAAA,UAC1C,CAAC;AAGD,eAAK,sBAAsB;AAG3B,eAAK,0BAA0B;AAG/B,cAAI,KAAK,qBAAqB,KAAK,2BAA2B;AAC5D,iBAAK,kBAAkB,aAAa,QAAQ,KAAK,yBAAyB;AAAA,UAC5E;AAGA,eAAK,uBAAuB;AAAA,QAC9B;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,8BAA8B;AAE5B,gBAAM,gBAAgB,MAAM;AAC1B,kBAAM,aAAa,KAAK,OAAO;AAC/B,kBAAM,gBAAgB,WAAW,KAAK,WAAS,MAAM,SAAS,UAAU;AAExE,gBAAI,eAAe;AAGjB,kBAAI,cAAc,SAAS,YAAY;AACrC,8BAAc,OAAO;AAAA,cACvB;AAGA,kBAAI,KAAK,0BAA0B;AACjC,8BAAc,oBAAoB,aAAa,KAAK,wBAAwB;AAAA,cAC9E;AAGA,mBAAK,2BAA2B,MAAM;AACpC,sBAAM,aAAa,MAAM,KAAK,cAAc,cAAc,CAAC,CAAC;AAC5D,oBAAI,WAAW,SAAS,GAAG;AAEzB,sBAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,4BAAQ,IAAI,kCAAkC,WAAW,IAAI,QAAM;AAAA,sBACjE,OAAO,EAAE;AAAA,sBACT,KAAK,EAAE;AAAA,sBACP,MAAM,EAAE;AAAA,oBACV,EAAE,CAAC;AAAA,kBACL;AAAA,gBACF;AACA,2BAAW,QAAQ,SAAO;AACxB,uBAAK,kBAAkB,GAAG;AAAA,gBAC5B,CAAC;AAAA,cACH;AAEA,4BAAc,iBAAiB,aAAa,KAAK,wBAAwB;AAGzE,kBAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,sBAAM,WAAW,cAAc,OAAO,cAAc,KAAK,SAAS;AAClE,wBAAQ,IAAI,oCAAoC,UAAU,gBAAgB;AAAA,cAC5E;AAAA,YACF,WAAW,KAAK,OAAO,QAAQ,OAAO;AACpC,sBAAQ,KAAK,2CAA2C;AAAA,YAC1D;AAAA,UACF;AAGA,wBAAc;AAGd,eAAK,OAAO,GAAG,kBAAkB,aAAa;AAAA,QAChD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,wBAAwB;AACtB,cAAI,CAAC,KAAK,gBAAgB,KAAK,aAAa,WAAW,GAAG;AACxD;AAAA,UACF;AAIA,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,oBAAQ,IAAI,qBAAqB,KAAK,aAAa,QAAQ,kCAAkC;AAAA,UAC/F;AAAA,QACF;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,kBAAkB,KAAK;AACrB,gBAAM,OAAO,IAAI,KAAK,KAAK;AAG3B,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,oBAAQ,IAAI,qCAAqC;AAAA,cAC/C,MAAM,IAAI;AAAA,cACV;AAAA,YACF,CAAC;AAAA,UACH;AAGA,eAAK,OAAO,KAAK,YAAY;AAAA,YAC3B,MAAM,IAAI;AAAA,YACV,SAAS,IAAI;AAAA,YACb;AAAA,YACA;AAAA,UACF,CAAC;AAGD,cAAI,KAAK,SAAS,OAAO,GAAG;AAE1B,gBAAI,CAAC,KAAK,OAAO,MAAM,QAAQ;AAC7B,kBAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,wBAAQ,IAAI,sCAAsC,IAAI,SAAS;AAAA,cACjE;AACA,mBAAK,OAAO,MAAM;AAAA,YACpB;AAEA,iBAAK,OAAO,KAAK,kBAAkB,EAAE,MAAM,IAAI,WAAW,KAAW,CAAC;AAAA,UACxE;AAGA,gBAAM,aAAa,KAAK,MAAM,iBAAiB;AAC/C,cAAI,YAAY;AACd,kBAAM,iBAAiB,WAAW,CAAC;AAEnC,kBAAM,gBAAgB,SAAS,cAAc,cAAc;AAC3D,gBAAI,eAAe;AACjB,kBAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,wBAAQ,IAAI,uCAAuC,cAAc;AAAA,cACnE;AAEA,mBAAK,kBAAkB,MAAM;AAC3B,8BAAc,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC7C,GAAG,EAAE;AAAA,YACP,WAAW,KAAK,OAAO,QAAQ,OAAO;AACpC,sBAAQ,KAAK,wCAAwC,cAAc;AAAA,YACrE;AAEA,iBAAK,OAAO,KAAK,kBAAkB;AAAA,cACjC,MAAM,IAAI;AAAA,cACV,QAAQ;AAAA,cACR,SAAS;AAAA,cACT;AAAA,YACF,CAAC;AAAA,UACH;AAGA,gBAAM,WAAW,KAAK,MAAM,UAAU;AACtC,cAAI,UAAU;AACZ,gBAAI,KAAK,OAAO,QAAQ,OAAO;AAC7B,sBAAQ,IAAI,qCAAqC,QAAQ;AAAA,YAC3D;AACA,iBAAK,OAAO,KAAK,qBAAqB;AAAA,cACpC,MAAM,IAAI;AAAA,cACV;AAAA,cACA;AAAA,YACF,CAAC;AAAA,UACH;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,sBAAsB,KAAK,OAAO,OAAO,WAAW;AAClD,gBAAM,YAAY,KAAK,mBAAmB,IAAI,IAAI;AAElD,gBAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,sBAAqB,YAAK,OAAO,QAAQ,aAAW,gBAAe;AAAA,YAChH,YAAY;AAAA,cACV,YAAY;AAAA,cACZ,cAAc,OAAO,IAAI,SAAS;AAAA,cAClC,YAAY,OAAO,IAAI,OAAO;AAAA,cAC9B,aAAa;AAAA,YACf;AAAA,UACF,CAAC;AAED,gBAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,YAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,UAAU,WAAW,IAAI,SAAS;AAAA,YAC/C,YAAY;AAAA,cACV,eAAe;AAAA;AAAA,YACjB;AAAA,UACF,CAAC;AAED,gBAAM,OAAO,SAAS,cAAc,QAAQ;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa;AAAA,UACf,CAAC;AAED,gBAAM,YAAY,SAAS;AAC3B,gBAAM,YAAY,IAAI;AAGtB,gBAAM,aAAa,MAAM;AACvB,iBAAK,OAAO,KAAK,IAAI,SAAS;AAC9B,gBAAI,KAAK,OAAO,MAAM,QAAQ;AAC5B,mBAAK,OAAO,KAAK;AAAA,YACnB;AAAA,UACF;AAEA,gBAAM,iBAAiB,SAAS,UAAU;AAC1C,gBAAM,iBAAiB,WAAW,CAAC,MAAM;AACvC,gBAAI,EAAE,QAAQ,WAAW,EAAE,QAAQ,KAAK;AACtC,gBAAE,eAAe;AACjB,yBAAW;AAAA,YACb;AAAA,UACF,CAAC;AAED,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,mBAAmB,MAAM;AAEvB,iBAAO,KACJ,QAAQ,YAAY,EAAE,EACtB,QAAQ,OAAO,GAAG,EAClB,KAAK;AAAA,QACV;AAAA;AAAA;AAAA;AAAA,QAKA,0BAA0B;AACxB,gBAAM,UAAU,SAAS,cAAc,OAAO;AAAA,YAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,KAAK,EAAE,yBAAyB;AAAA,UAC/C,CAAC;AACD,eAAK,kBAAkB,YAAY,OAAO;AAAA,QAC5C;AAAA;AAAA;AAAA;AAAA,QAKA,oBAAoB;AAClB,cAAI,CAAC,KAAK,aAAa,KAAK,kBAAkB,WAAW,EAAG;AAE5D,gBAAM,cAAc,KAAK,OAAO,MAAM;AAGtC,gBAAM,cAAc,KAAK,kBAAkB;AAAA,YACzC,WAAS,eAAe,MAAM,aAAa,cAAc,MAAM;AAAA,UACjE;AAEA,cAAI,eAAe,gBAAgB,KAAK,oBAAoB;AAE1D,gBAAI,KAAK,oBAAoB;AAC3B,mBAAK,mBAAmB,QAAQ,UAAU;AAAA,gBACxC,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cACpC;AAAA,YACF;AAGA,wBAAY,QAAQ,UAAU;AAAA,cAC5B,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YACpC;AAGA,iBAAK,cAAc,YAAY,OAAO;AAEtC,iBAAK,qBAAqB;AAAA,UAC5B,WAAW,CAAC,eAAe,KAAK,oBAAoB;AAElD,iBAAK,mBAAmB,QAAQ,UAAU;AAAA,cACxC,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YACpC;AACA,iBAAK,qBAAqB;AAAA,UAC5B;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,cAAc,cAAc;AAC1B,cAAI,CAAC,KAAK,qBAAqB,CAAC,KAAK,kBAAmB;AAExD,gBAAM,cAAc,KAAK,kBAAkB,sBAAsB;AACjE,gBAAM,YAAY,aAAa,sBAAsB;AAGrD,cAAI,UAAU,MAAM,YAAY,OAAO,UAAU,SAAS,YAAY,QAAQ;AAE5E,kBAAM,YAAY,aAAa,YAAa,KAAK,kBAAkB,eAAe,IAAM,aAAa,eAAe;AACpH,iBAAK,kBAAkB,SAAS;AAAA,cAC9B,KAAK;AAAA,cACL,UAAU;AAAA,YACZ,CAAC;AAAA,UACH;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,2BAA2B;AACzB,gBAAM,mBAAmB,KAAK,QAAQ,yBAAyB,KAAK,CAAC;AACrE,2BAAiB,aAAa,KAAK;AACnC,eAAK,QAAQ,0BAA0B,gBAAgB;AAAA,QACzD;AAAA;AAAA;AAAA;AAAA,QAKA,mBAAmB;AACjB,cAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,iBAAkB;AAGtD,gBAAMA,YAAW,OAAO,aAAa;AACrC,gBAAM,eAAe,KAAK,OAAO,MAAM;AAIvC,cAAIA,aAAY,CAAC,cAAc;AAE7B,gBAAI,KAAK,oBAAoB;AAC3B,mBAAK,mBAAmB,QAAQ;AAChC,mBAAK,qBAAqB;AAAA,YAC5B;AACA;AAAA,UACF;AAGA,cAAI,KAAK,oBAAoB;AAC3B;AAAA,UACF;AAGA,eAAK,qBAAqB,IAAI,mBAAmB,KAAK,kBAAkB;AAAA,YACtE,YAAY,KAAK;AAAA,YACjB,eAAe,KAAK;AAAA,YACpB,qBAAqB;AAAA,YACrB,aAAa,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC/C,iBAAiB;AAAA,YACjB,mBAAmB;AAAA,YACnB,cAAc;AAAA,YACd,mBAAmB;AAAA,YACnB,UAAU;AAAA,YACV,WAAW;AAAA,YACX,UAAU,MAAM,KAAK,IAAI,KAAK,OAAO,aAAa,EAAE;AAAA,YACpD,WAAW,MAAM,KAAK,IAAI,KAAK,OAAO,cAAc,GAAG;AAAA,YACvD,4BAA4B,KAAK,EAAE,2BAA2B;AAAA,YAC9D,uBAAuB,CAAC,YAAY;AAElC,mBAAK,wBAAwB,QAAQ,YAAU;AAC7C,uBAAO,MAAM,UAAU,UAAU,UAAU;AAAA,cAC7C,CAAC;AAED,mBAAK,0BAA0B,OAAO;AAAA,YACxC;AAAA,YACA,aAAa,CAAC,MAAM;AAElB,oBAAM,kBAAkB;AAAA,gBACtB,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,gBACnC,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,gBACnC,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,gBACnC,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,gBACnC,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,gBACnC,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,cACrC;AAEA,yBAAW,YAAY,iBAAiB;AACtC,oBAAI,EAAE,OAAO,QAAQ,QAAQ,GAAG;AAC9B,yBAAO;AAAA,gBACT;AAAA,cACF;AAEA,qBAAO;AAAA,YACT;AAAA,UACF,CAAC;AAGD,eAAK,mBAAmB,CAAC,MAAM;AAC7B,kBAAM,MAAM,EAAE,IAAI,YAAY;AAC9B,kBAAM,mBAAmB,EAAE;AAG3B,gBAAI,KAAK,uBAAuB,KAAK,oBAAoB;AACvD;AAAA,YACF;AAEA,gBAAI,QAAQ,QAAQ;AAClB,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,kBAAI,KAAK,oBAAoB;AAC3B,oBAAI,KAAK,mBAAmB,mBAAmB;AAC7C,uBAAK,mBAAmB,yBAAyB;AAAA,gBACnD;AACA,qBAAK,mBAAmB,qBAAqB;AAC7C,qBAAK,mBAAmB;AACxB,qBAAK,wBAAwB;AAC7B,qBAAK,aAAa,KAAK,EAAE,0BAA0B,CAAC;AAAA,cACtD;AACA;AAAA,YACF;AAEA,gBAAI,QAAQ,KAAK;AACf,kBAAI,kBAAkB;AACpB;AAAA,cACF;AACA,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,oBAAM,UAAU,KAAK,iBAAiB;AACtC,kBAAI,SAAS;AACX,qBAAK,iBAAiB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cACrD;AACA;AAAA,YACF;AAEA,gBAAI,QAAQ,UAAU;AAGpB,kBAAI,KAAK,sBAAsB,KAAK,mBAAmB,mBAAmB;AACxE,kBAAE,eAAe;AACjB,kBAAE,gBAAgB;AAClB,qBAAK,mBAAmB,yBAAyB;AACjD;AAAA,cACF;AACA,kBAAI,KAAK,sBAAsB,KAAK,mBAAmB,kBAAkB;AACvE,kBAAE,eAAe;AACjB,kBAAE,gBAAgB;AAClB,qBAAK,mBAAmB,wBAAwB;AAChD,qBAAK,aAAa,KAAK,EAAE,6BAA6B,CAAC;AACvD;AAAA,cACF;AAEA,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,eAAe,EAAE,aAAa,KAAK,CAAC;AACzC;AAAA,YACF;AAAA,UACF;AAEA,eAAK,iBAAiB,iBAAiB,WAAW,KAAK,gBAAgB;AAAA,QACzE;AAAA;AAAA;AAAA;AAAA,QAMA,yBAAyB;AACvB,cAAI,KAAK,oBAAoB;AAC3B,kBAAM,aAAa,KAAK,mBAAmB;AAC3C,iBAAK,mBAAmB,uBAAuB;AAC/C,kBAAM,YAAY,KAAK,mBAAmB;AAC1C,gBAAI,CAAC,cAAc,WAAW;AAC5B,mBAAK,eAAe;AAAA,YACtB;AAGA,iBAAK,sBAAsB;AAG3B,gBAAI,KAAK,qBAAqB;AAC5B,mBAAK,iBAAiB;AAAA,YACxB;AAGA,iBAAK,iBAAiB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UACrD;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,qBAAqB;AACnB,cAAI,KAAK,qBAAqB;AAC5B,iBAAK,iBAAiB;AAAA,UACxB,OAAO;AACL,iBAAK,iBAAiB;AAAA,UACxB;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,mBAAmB;AAEjB,eAAK,yBAAyB;AAC9B,qBAAW,MAAM;AACf,iBAAK,yBAAyB;AAAA,UAChC,GAAG,GAAG;AAGN,cAAI,CAAC,KAAK,2BAA2B;AACnC,uBAAW,MAAM;AACf,uBAAS,iBAAiB,SAAS,KAAK,SAAS,aAAa;AAC9D,mBAAK,4BAA4B;AAAA,YACnC,GAAG,GAAG;AAAA,UACR;AAEA,cAAI,KAAK,cAAc;AACrB,iBAAK,aAAa,MAAM,UAAU;AAClC,iBAAK,sBAAsB;AAC3B,gBAAI,KAAK,gBAAgB;AACvB,mBAAK,eAAe,aAAa,iBAAiB,MAAM;AAAA,YAC1D;AAEA,iBAAK,qCAAqC;AAE1C,iBAAK,8BAA8B;AACnC,iBAAK,wBAAwB;AAE7B,uBAAW,MAAM;AACf,oBAAM,YAAY,KAAK,aAAa,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,4BAA2B;AACnH,kBAAI,UAAU,SAAS,GAAG;AACxB,0BAAU,CAAC,EAAE,aAAa,YAAY,GAAG;AACzC,yBAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AACzC,4BAAU,CAAC,EAAE,aAAa,YAAY,IAAI;AAAA,gBAC5C;AACA,0BAAU,CAAC,EAAE,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC5C;AAAA,YACF,GAAG,EAAE;AACL;AAAA,UACF;AAEA,eAAK,eAAe,SAAS,cAAc,OAAO;AAAA,YAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,QAAQ;AAAA,YACV;AAAA,UACF,CAAC;AAGD,gBAAM,qBAAqB,eAAe;AAAA,YACxC,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,MAAM;AAAA,YACN,OAAO;AAAA,YACP,cAAc;AAAA,YACd,SAAS,MAAM;AACb,mBAAK,uBAAuB;AAC5B,mBAAK,iBAAiB;AAAA,YACxB;AAAA,UACF,CAAC;AACD,6BAAmB,aAAa,QAAQ,QAAQ;AAChD,6BAAmB,aAAa,gBAAgB,OAAO;AAEvD,gBAAM,cAAc,mBAAmB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAClG,cAAI,YAAa,aAAY,OAAO;AACpC,gBAAM,iBAAiB,mBAAmB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACzG,cAAI,eAAgB,gBAAe,OAAO;AAC1C,eAAK,mBAAmB;AACxB,eAAK,iBAAiB,mBAAmB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAC1G,eAAK,sBAAsB;AAG3B,gBAAM,cAAc,eAAe;AAAA,YACjC,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,MAAM;AAAA,YACN,OAAO;AAAA,YACP,SAAS,CAAC,MAAM;AACd,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,iBAAiB;AAEtB,yBAAW,MAAM;AACf,qBAAK,gBAAgB;AAAA,cACvB,GAAG,EAAE;AAAA,YACP;AAAA,UACF,CAAC;AAED,gBAAM,eAAe,YAAY,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAC5F,cAAI,aAAc,cAAa,OAAO;AACtC,gBAAM,kBAAkB,YAAY,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACnG,cAAI,gBAAiB,iBAAgB,OAAO;AAG5C,gBAAM,eAAe,eAAe;AAAA,YAClC,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,MAAM;AAAA,YACN,OAAO;AAAA,YACP,cAAc;AAAA,YACd,SAAS,CAAC,UAAU;AAClB,oBAAM,eAAe;AACrB,oBAAM,gBAAgB;AAEtB,oBAAM,UAAU,KAAK,iBAAiB,EAAE,OAAO,MAAM,CAAC;AAEtD,kBAAI,SAAS;AACX,qBAAK,iBAAiB,EAAE,aAAa,MAAM,CAAC;AAE5C,2BAAW,MAAM;AACf,sBAAI,KAAK,kBAAkB;AACzB,yBAAK,iBAAiB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,kBACrD;AAAA,gBACF,GAAG,EAAE;AAAA,cACP,OAAO;AACL,qBAAK,iBAAiB,EAAE,aAAa,KAAK,CAAC;AAAA,cAC7C;AAAA,YACF;AAAA,UACF,CAAC;AACD,uBAAa,aAAa,QAAQ,QAAQ;AAC1C,uBAAa,aAAa,gBAAgB,OAAO;AAEjD,gBAAM,gBAAgB,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAC9F,cAAI,cAAe,eAAc,OAAO;AACxC,gBAAM,mBAAmB,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACrG,cAAI,iBAAkB,kBAAiB,OAAO;AAC9C,eAAK,qBAAqB;AAC1B,eAAK,mBAAmB,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AACtG,eAAK,wBAAwB;AAG7B,gBAAM,uBAAuB,eAAe;AAAA,YAC1C,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,MAAM;AAAA,YACN,OAAO;AAAA,YACP,cAAc;AAAA,YACd,SAAS,MAAM;AACb,mBAAK,qBAAqB;AAAA,YAC5B;AAAA,UACF,CAAC;AACD,+BAAqB,aAAa,QAAQ,QAAQ;AAClD,+BAAqB,aAAa,gBAAgB,KAAK,iBAAiB,SAAS,OAAO;AAExF,gBAAM,oBAAoB,qBAAqB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAC1G,cAAI,kBAAmB,mBAAkB,OAAO;AAChD,gBAAM,uBAAuB,qBAAqB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACjH,cAAI,qBAAsB,sBAAqB,OAAO;AACtD,eAAK,uBAAuB;AAC5B,eAAK,qBAAqB,qBAAqB,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAChH,eAAK,0BAA0B;AAG/B,gBAAM,cAAc,eAAe;AAAA,YACjC,aAAa,KAAK,OAAO,QAAQ;AAAA,YACjC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,MAAM;AAAA,YACN,OAAO;AAAA,YACP,SAAS,MAAM;AACb,mBAAK,iBAAiB;AAAA,YACxB;AAAA,UACF,CAAC;AAED,gBAAM,eAAe,YAAY,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAC5F,cAAI,aAAc,cAAa,OAAO;AACtC,gBAAM,kBAAkB,YAAY,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACnG,cAAI,gBAAiB,iBAAgB,OAAO;AAE5C,eAAK,aAAa,YAAY,kBAAkB;AAChD,eAAK,aAAa,YAAY,YAAY;AAC1C,eAAK,aAAa,YAAY,WAAW;AACzC,eAAK,aAAa,YAAY,oBAAoB;AAClD,eAAK,aAAa,YAAY,WAAW;AAIzC,eAAK,aAAa,MAAM,aAAa;AACrC,eAAK,aAAa,MAAM,UAAU;AAGlC,cAAI,KAAK,kBAAkB,KAAK,eAAe,YAAY;AACzD,iBAAK,eAAe,sBAAsB,YAAY,KAAK,YAAY;AAAA,UACzE,WAAW,KAAK,YAAY;AAC1B,iBAAK,WAAW,YAAY,KAAK,YAAY;AAAA,UAC/C,WAAW,KAAK,kBAAkB;AAChC,iBAAK,iBAAiB,YAAY,KAAK,YAAY;AAAA,UACrD,OAAO;AACL,iBAAK,iBAAiB,YAAY,KAAK,YAAY;AAAA,UACrD;AAGA,eAAK,8BAA8B;AAGnC,gCAAsB,MAAM;AAC1B,gBAAI,KAAK,cAAc;AACrB,mBAAK,aAAa,MAAM,aAAa;AAAA,YACvC;AAAA,UACF,CAAC;AAGD,eAAK,yBAAyB;AAAA,YAC5B,KAAK;AAAA,YACL,KAAK;AAAA,YACL,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,YACnC,MAAM,KAAK,iBAAiB,EAAE,aAAa,KAAK,CAAC;AAAA,UACnD;AAGA,eAAK,sBAAsB;AAC3B,eAAK,aAAa,MAAM,UAAU;AAGlC,cAAI,KAAK,gBAAgB;AACvB,iBAAK,eAAe,aAAa,iBAAiB,MAAM;AAAA,UAC1D;AACA,eAAK,wBAAwB;AAG7B,qBAAW,MAAM;AACf,kBAAM,YAAY,KAAK,aAAa,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,4BAA2B;AACnH,gBAAI,UAAU,SAAS,GAAG;AACxB,wBAAU,CAAC,EAAE,aAAa,YAAY,GAAG;AACzC,uBAAS,IAAI,GAAG,IAAI,UAAU,QAAQ,KAAK;AACzC,0BAAU,CAAC,EAAE,aAAa,YAAY,IAAI;AAAA,cAC5C;AACA,wBAAU,CAAC,EAAE,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC5C;AAAA,UACF,GAAG,EAAE;AAAA,QACP;AAAA;AAAA;AAAA;AAAA,QAKA,gCAAgC;AAC9B,cAAI,CAAC,KAAK,gBAAgB,CAAC,KAAK,eAAgB;AAGhD,gBAAM,YAAY,KAAK,eAAe;AACtC,cAAI,CAAC,UAAW;AAGhB,gBAAM,aAAa,KAAK,eAAe,sBAAsB;AAC7D,gBAAM,gBAAgB,UAAU,sBAAsB;AACtD,gBAAM,WAAW,KAAK,aAAa,sBAAsB;AACzD,gBAAM,iBAAiB,OAAO;AAG9B,gBAAM,aAAa,WAAW,OAAO,cAAc;AACnD,gBAAM,eAAe,WAAW,SAAS,cAAc;AACvD,gBAAM,YAAY,WAAW,MAAM,cAAc;AAEjD,gBAAM,aAAa,iBAAiB,WAAW;AAC/C,gBAAM,aAAa,WAAW;AAG9B,cAAI,UAAU,eAAe;AAG7B,cAAI,aAAa,SAAS,SAAS,MAAM,aAAa,YAAY;AAEhE,sBAAU,YAAY,SAAS,SAAS;AACxC,iBAAK,aAAa,UAAU,IAAI,mBAAmB;AAAA,UACrD,OAAO;AACL,iBAAK,aAAa,UAAU,OAAO,mBAAmB;AAAA,UACxD;AAGA,eAAK,aAAa,MAAM,MAAM,GAAG,gBAAO;AACxC,eAAK,aAAa,MAAM,OAAO,GAAG,mBAAU;AAC5C,eAAK,aAAa,MAAM,QAAQ;AAChC,eAAK,aAAa,MAAM,SAAS;AAAA,QACnC;AAAA;AAAA;AAAA;AAAA,QAKA,uBAAuB;AACrB,cAAI,CAAC,KAAK,gBAAgB,CAAC,KAAK,eAAgB;AAGhD,gCAAsB,MAAM;AAC1B,uBAAW,MAAM;AACf,mBAAK,8BAA8B;AAAA,YACrC,GAAG,EAAE;AAAA,UACP,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA,QAKA,uCAAuC;AACrC,cAAI,CAAC,KAAK,aAAc;AAGxB,cAAI,KAAK,wBAAwB;AAC/B,iBAAK,aAAa,oBAAoB,WAAW,KAAK,wBAAwB,IAAI;AAAA,UACpF;AAEA,gBAAM,UAAU;AAAA,YACd,KAAK;AAAA,YACL,KAAK;AAAA,YACL,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,YACnC,MAAM,KAAK,iBAAiB,EAAE,aAAa,KAAK,CAAC;AAAA,UACnD;AAGA,eAAK,yBAAyB;AAAA,QAEhC;AAAA;AAAA;AAAA;AAAA,QAKA,iBAAiB,EAAE,cAAc,KAAK,IAAI,CAAC,GAAG;AAC5C,cAAI,KAAK,cAAc;AACrB,iBAAK,aAAa,MAAM,UAAU;AAClC,iBAAK,sBAAsB;AAC3B,iBAAK,yBAAyB;AAG9B,gBAAI,KAAK,wBAAwB;AAC/B,mBAAK,aAAa,oBAAoB,WAAW,KAAK,wBAAwB,IAAI;AAClF,mBAAK,yBAAyB;AAAA,YAChC;AAGA,gBAAI,KAAK,gBAAgB;AACvB,mBAAK,eAAe,aAAa,iBAAiB,OAAO;AACzD,kBAAI,aAAa;AAEf,qBAAK,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cACnD;AAAA,YACF;AAAA,UACF;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,iBAAiB;AACf,eAAK,wBAAwB;AAG7B,eAAK,iBAAiB,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,wBAAuB;AAG7F,gBAAM,UAAU,SAAS,cAAc,OAAO;AAAA,YAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa;AAAA,UACf,CAAC;AACD,eAAK,iBAAiB,YAAY,OAAO;AAGzC,qBAAW,MAAM;AACf,iBAAK,iBAAiB,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,wBAAuB;AAChG,gBAAI,QAAQ,YAAY;AACtB,sBAAQ,OAAO;AAAA,YACjB;AAAA,UACF,GAAG,GAAI;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,iBAAiB,EAAE,QAAQ,KAAK,IAAI,CAAC,GAAG;AACtC,cAAI,CAAC,KAAK,oBAAoB;AAC5B,mBAAO;AAAA,UACT;AAEA,cAAI,KAAK,mBAAmB,mBAAmB;AAC7C,iBAAK,mBAAmB,yBAAyB,EAAE,MAAM,CAAC;AAC1D,mBAAO;AAAA,UACT;AAEA,eAAK,mBAAmB,wBAAwB,EAAE,MAAM,CAAC;AACzD,iBAAO;AAAA,QACT;AAAA,QAEA,wBAAwB;AACtB,cAAI,CAAC,KAAK,kBAAkB;AAC1B;AAAA,UACF;AAEA,gBAAM,YAAY,CAAC,EAAE,KAAK,sBAAsB,KAAK,mBAAmB;AACxE,gBAAM,OAAO,YACT,KAAK,EAAE,4BAA4B,IACnC,KAAK,EAAE,2BAA2B;AACtC,gBAAM,YAAY,YACd,KAAK,EAAE,gCAAgC,IACvC,KAAK,EAAE,+BAA+B;AAE1C,eAAK,iBAAiB,aAAa,gBAAgB,YAAY,SAAS,OAAO;AAC/E,eAAK,iBAAiB,aAAa,cAAc,SAAS;AAE1D,cAAI,KAAK,gBAAgB;AACvB,iBAAK,eAAe,cAAc;AAAA,UACpC;AAAA,QACF;AAAA,QAEA,0BAA0B;AACxB,cAAI,CAAC,KAAK,oBAAoB;AAC5B;AAAA,UACF;AAEA,gBAAM,YAAY,CAAC,EAAE,KAAK,sBAAsB,KAAK,mBAAmB;AACxE,gBAAM,OAAO,YACT,KAAK,EAAE,8BAA8B,IACrC,KAAK,EAAE,6BAA6B;AACxC,gBAAM,YAAY,YACd,KAAK,EAAE,kCAAkC,IACzC,KAAK,EAAE,iCAAiC;AAE5C,eAAK,mBAAmB,aAAa,gBAAgB,YAAY,SAAS,OAAO;AACjF,eAAK,mBAAmB,aAAa,cAAc,SAAS;AAE5D,cAAI,KAAK,kBAAkB;AACzB,iBAAK,iBAAiB,cAAc;AAAA,UACtC;AAAA,QACF;AAAA,QAEA,uBAAuB;AACrB,eAAK,iBAAiB,CAAC,KAAK;AAC5B,eAAK,0BAA0B;AAC/B,eAAK,0BAA0B;AAC/B,eAAK,yBAAyB;AAAA,QAChC;AAAA,QAEA,4BAA4B;AAC1B,cAAI,CAAC,KAAK,sBAAsB;AAC9B;AAAA,UACF;AAEA,gBAAM,OAAO,KAAK,iBACd,KAAK,EAAE,2BAA2B,IAClC,KAAK,EAAE,2BAA2B;AACtC,gBAAM,YAAY,KAAK,iBACnB,KAAK,EAAE,+BAA+B,IACtC,KAAK,EAAE,+BAA+B;AAE1C,eAAK,qBAAqB,aAAa,gBAAgB,KAAK,iBAAiB,SAAS,OAAO;AAC7F,eAAK,qBAAqB,aAAa,cAAc,SAAS;AAE9D,cAAI,KAAK,oBAAoB;AAC3B,iBAAK,mBAAmB,cAAc;AAAA,UACxC;AAAA,QACF;AAAA,QAEA,4BAA4B;AAC1B,cAAI,CAAC,KAAK,kBAAmB;AAE7B,gBAAM,aAAa,KAAK,kBAAkB,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,mBAAkB;AAChH,qBAAW,QAAQ,eAAa;AAC9B,sBAAU,MAAM,UAAU,KAAK,iBAAiB,KAAK;AAAA,UACvD,CAAC;AAAA,QACH;AAAA,QAEA,2BAA2B;AACzB,gBAAM,mBAAmB,KAAK,QAAQ,yBAAyB,KAAK,CAAC;AACrE,2BAAiB,iBAAiB,KAAK;AACvC,eAAK,QAAQ,0BAA0B,gBAAgB;AAAA,QACzD;AAAA,QAEA,0BAA0B;AACxB,cAAI,CAAC,KAAK,kBAAkB;AAC1B;AAAA,UACF;AAEA,eAAK,wBAAwB;AAE7B,gBAAM,YAAY,SAAS,cAAc,OAAO;AAAA,YAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,KAAK,EAAE,2BAA2B,KAAK;AAAA,UACtD,CAAC;AAED,eAAK,iBAAiB,YAAY,SAAS;AAC3C,eAAK,sBAAsB;AAE3B,eAAK,6BAA6B,KAAK,kBAAkB,MAAM;AAC7D,iBAAK,wBAAwB;AAAA,UAC/B,GAAG,GAAI;AAAA,QACT;AAAA,QAEA,0BAA0B;AACxB,cAAI,KAAK,4BAA4B;AACnC,iBAAK,oBAAoB,KAAK,0BAA0B;AACxD,iBAAK,6BAA6B;AAAA,UACpC;AAEA,cAAI,KAAK,uBAAuB,KAAK,oBAAoB,YAAY;AACnE,iBAAK,oBAAoB,OAAO;AAAA,UAClC;AAEA,eAAK,sBAAsB;AAAA,QAC7B;AAAA,QAEA,0BAA0B,SAAS;AACjC,eAAK,wBAAwB;AAE7B,cAAI,SAAS;AACX,iBAAK,wBAAwB;AAC7B,iBAAK,aAAa,KAAK,EAAE,8BAA8B,CAAC;AAAA,UAC1D,OAAO;AACL,iBAAK,wBAAwB;AAC7B,iBAAK,aAAa,KAAK,EAAE,+BAA+B,CAAC;AAAA,UAC3D;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,kBAAkB;AAEhB,cAAI,KAAK,aAAa;AACpB,iBAAK,YAAY,MAAM,UAAU;AACjC,iBAAK,qBAAqB;AAG1B,gBAAI,KAAK,SAAS,oBAAoB;AACpC,uBAAS,iBAAiB,WAAW,KAAK,SAAS,kBAAkB;AAAA,YACvE;AAGA,iBAAK,wBAAwB;AAC7B,uBAAW,MAAM;AACf,mBAAK,wBAAwB;AAAA,YAC/B,GAAG,GAAG;AAGN,uBAAW,MAAM;AACf,oBAAM,cAAc,KAAK,YAAY,cAAc,eAAe;AAClE,kBAAI,aAAa;AACf,4BAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC3C;AAAA,YACF,GAAG,CAAC;AACJ;AAAA,UACF;AAGA,eAAK,cAAc,SAAS,cAAc,OAAO;AAAA,YAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAGD,gBAAM,QAAQ,SAAS,cAAc,MAAM;AAAA,YACzC,aAAa,KAAK,EAAE,uBAAuB;AAAA,YAC3C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AACD,eAAK,YAAY,YAAY,KAAK;AAGlC,gBAAM,kBAAkB,KAAK;AAAA,YAC3B,KAAK,EAAE,mBAAmB;AAAA,YAC1B;AAAA,YACA;AAAA,cACE,EAAE,OAAO,KAAK,EAAE,iBAAiB,GAAG,OAAO,MAAM;AAAA,cACjD,EAAE,OAAO,KAAK,EAAE,kBAAkB,GAAG,OAAO,OAAO;AAAA,cACnD,EAAE,OAAO,KAAK,EAAE,iBAAiB,GAAG,OAAO,OAAO;AAAA,cAClD,EAAE,OAAO,KAAK,EAAE,kBAAkB,GAAG,OAAO,OAAO;AAAA,YACrD;AAAA,UACF;AACA,eAAK,YAAY,YAAY,eAAe;AAG5C,gBAAM,oBAAoB,KAAK;AAAA,YAC7B,KAAK,EAAE,qBAAqB;AAAA,YAC5B;AAAA,YACA;AAAA,cACE,EAAE,OAAO,KAAK,EAAE,wBAAwB,GAAG,OAAO,aAAa;AAAA,cAC/D,EAAE,OAAO,KAAK,EAAE,oBAAoB,GAAG,OAAO,QAAQ;AAAA,cACtD,EAAE,OAAO,KAAK,EAAE,wBAAwB,GAAG,OAAO,YAAY;AAAA,YAChE;AAAA,UACF;AACA,eAAK,YAAY,YAAY,iBAAiB;AAG9C,gBAAM,eAAe,KAAK,wBAAwB,KAAK,EAAE,gBAAgB,GAAG,OAAO;AACnF,eAAK,YAAY,YAAY,YAAY;AAGzC,gBAAM,iBAAiB,KAAK,wBAAwB,KAAK,EAAE,0BAA0B,GAAG,iBAAiB;AACzG,eAAK,YAAY,YAAY,cAAc;AAG3C,gBAAM,iBAAiB,KAAK,0BAA0B,KAAK,EAAE,kBAAkB,GAAG,SAAS;AAC3F,eAAK,YAAY,YAAY,cAAc;AAG3C,gBAAM,WAAW,SAAS,cAAc,UAAU;AAAA,YAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,KAAK,EAAE,gBAAgB;AAAA,YACpC,YAAY;AAAA,cACV,QAAQ;AAAA,YACV;AAAA,UACF,CAAC;AACD,mBAAS,iBAAiB,SAAS,MAAM,KAAK,gBAAgB,CAAC;AAC/D,eAAK,YAAY,YAAY,QAAQ;AAGrC,eAAK,SAAS,qBAAqB,CAAC,MAAM;AAExC,gBAAI,CAAC,KAAK,mBAAoB;AAG9B,gBAAI,EAAE,QAAQ,UAAU;AACtB,gBAAE,eAAe;AACjB,gBAAE,gBAAgB;AAClB,mBAAK,gBAAgB;AACrB;AAAA,YACF;AAGA,gBAAI,EAAE,QAAQ,OAAO;AAEnB,oBAAM,oBAAoB,KAAK,YAAY;AAAA,gBACzC;AAAA,cACF;AACA,oBAAM,eAAe,kBAAkB,CAAC;AACxC,oBAAM,cAAc,kBAAkB,kBAAkB,SAAS,CAAC;AAGlE,kBAAI,EAAE,YAAY,SAAS,kBAAkB,cAAc;AACzD,kBAAE,eAAe;AACjB,4BAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC3C,WAAW,CAAC,EAAE,YAAY,SAAS,kBAAkB,aAAa;AAChE,kBAAE,eAAe;AACjB,6BAAa,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC5C;AAAA,YACF;AAAA,UACF;AACA,mBAAS,iBAAiB,WAAW,KAAK,SAAS,kBAAkB;AAGrE,cAAI,KAAK,YAAY;AACnB,iBAAK,WAAW,YAAY,KAAK,WAAW;AAAA,UAC9C,OAAO;AACL,iBAAK,iBAAiB,YAAY,KAAK,WAAW;AAAA,UACpD;AAGA,eAAK,sBAAsB;AAG3B,eAAK,qBAAqB;AAC1B,eAAK,YAAY,MAAM,UAAU;AAGjC,eAAK,wBAAwB;AAC7B,qBAAW,MAAM;AACf,iBAAK,wBAAwB;AAAA,UAC/B,GAAG,GAAG;AAGN,qBAAW,MAAM;AACf,kBAAM,cAAc,KAAK,YAAY,cAAc,eAAe;AAClE,gBAAI,aAAa;AACf,0BAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC3C;AAAA,UACF,GAAG,CAAC;AAAA,QACN;AAAA;AAAA;AAAA;AAAA,QAKA,kBAAkB;AAChB,cAAI,KAAK,aAAa;AACpB,iBAAK,YAAY,MAAM,UAAU;AACjC,iBAAK,qBAAqB;AAG1B,gBAAI,KAAK,SAAS,oBAAoB;AACpC,uBAAS,oBAAoB,WAAW,KAAK,SAAS,kBAAkB;AAAA,YAC1E;AAGA,gBAAI,KAAK,gBAAgB;AACvB,mBAAK,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YACnD;AAAA,UACF;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,yBAAyB,OAAO,UAAU,SAAS;AACjD,gBAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAGD,gBAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,gBAAe,iBAAQ,KAAI,YAAK,IAAI;AAExF,gBAAM,UAAU,SAAS,cAAc,SAAS;AAAA,YAC9C,aAAa;AAAA,YACb,YAAY;AAAA,cACV,OAAO;AAAA,YACT;AAAA,UACF,CAAC;AACD,gBAAM,YAAY,OAAO;AAEzB,gBAAM,SAAS,SAAS,cAAc,UAAU;AAAA,YAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACV,MAAM;AAAA,YACR;AAAA,UACF,CAAC;AAED,kBAAQ,QAAQ,SAAO;AACrB,kBAAM,SAAS,SAAS,cAAc,UAAU;AAAA,cAC9C,aAAa,IAAI;AAAA,cACjB,YAAY;AAAA,gBACV,SAAS,IAAI;AAAA,cACf;AAAA,YACF,CAAC;AACD,gBAAI,KAAK,gBAAgB,QAAQ,MAAM,IAAI,OAAO;AAChD,qBAAO,WAAW;AAAA,YACpB;AACA,mBAAO,YAAY,MAAM;AAAA,UAC3B,CAAC;AAED,iBAAO,iBAAiB,UAAU,CAAC,MAAM;AACvC,iBAAK,gBAAgB,QAAQ,IAAI,EAAE,OAAO;AAC1C,iBAAK,sBAAsB;AAC3B,iBAAK,gBAAgB;AAAA,UACvB,CAAC;AAED,gBAAM,YAAY,MAAM;AACxB,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,wBAAwB,OAAO,UAAU;AACvC,gBAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAGD,gBAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,gBAAe,iBAAQ,KAAI,YAAK,IAAI;AAExF,gBAAM,UAAU,SAAS,cAAc,SAAS;AAAA,YAC9C,aAAa;AAAA,YACb,YAAY;AAAA,cACV,OAAO;AAAA,YACT;AAAA,UACF,CAAC;AACD,gBAAM,YAAY,OAAO;AAEzB,gBAAM,QAAQ,SAAS,cAAc,SAAS;AAAA,YAC5C,YAAY;AAAA,cACV,MAAM;AAAA,cACN,QAAQ;AAAA,cACR,SAAS,KAAK,gBAAgB,QAAQ;AAAA,YACxC;AAAA,YACA,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAED,gBAAM,iBAAiB,SAAS,CAAC,MAAM;AACrC,iBAAK,gBAAgB,QAAQ,IAAI,EAAE,OAAO;AAC1C,iBAAK,sBAAsB;AAC3B,iBAAK,gBAAgB;AAAA,UACvB,CAAC;AAED,gBAAM,YAAY,KAAK;AACvB,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,0BAA0B,OAAO,UAAU;AACzC,gBAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAGD,gBAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,gBAAe,iBAAQ,KAAI,YAAK,IAAI;AAExF,gBAAM,UAAU,SAAS,cAAc,SAAS;AAAA,YAC9C,aAAa;AAAA,YACb,YAAY;AAAA,cACV,OAAO;AAAA,YACT;AAAA,UACF,CAAC;AACD,gBAAM,YAAY,OAAO;AAEzB,gBAAM,eAAe,SAAS,cAAc,QAAQ;AAAA,YAClD,aAAa,KAAK,MAAM,KAAK,gBAAgB,QAAQ,IAAI,GAAG,IAAI;AAAA,YAChE,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAED,gBAAM,QAAQ,SAAS,cAAc,SAAS;AAAA,YAC5C,YAAY;AAAA,cACV,MAAM;AAAA,cACN,QAAQ;AAAA,cACR,OAAO;AAAA,cACP,OAAO;AAAA,cACP,QAAQ;AAAA,cACR,SAAS,OAAO,KAAK,gBAAgB,QAAQ,CAAC;AAAA,YAChD;AAAA,YACA,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AAED,gBAAM,iBAAiB,SAAS,CAAC,MAAM;AACrC,kBAAM,QAAQ,WAAW,EAAE,OAAO,KAAK;AACvC,iBAAK,gBAAgB,QAAQ,IAAI;AACjC,yBAAa,cAAc,KAAK,MAAM,QAAQ,GAAG,IAAI;AACrD,iBAAK,sBAAsB;AAC3B,iBAAK,gBAAgB;AAAA,UACvB,CAAC;AAED,gBAAM,iBAAiB,SAAS,cAAc,OAAO;AAAA,YACnD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC/C,CAAC;AACD,yBAAe,YAAY,KAAK;AAChC,yBAAe,YAAY,YAAY;AAEvC,gBAAM,YAAY,OAAO;AACzB,gBAAM,YAAY,cAAc;AAChC,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA,QAKA,kBAAkB;AAChB,eAAK,QAAQ,0BAA0B,KAAK,eAAe;AAAA,QAC7D;AAAA;AAAA;AAAA;AAAA,QAKA,wBAAwB;AACtB,cAAI,CAAC,KAAK,iBAAkB;AAG5B,eAAK,iBAAiB,MAAM,kBAAkB,KAAK,gBAAgB;AACnE,eAAK,iBAAiB,MAAM,UAAU,OAAO,KAAK,gBAAgB,OAAO;AAGzE,cAAI,KAAK,mBAAmB;AAC1B,iBAAK,kBAAkB,MAAM,WAAW,KAAK,gBAAgB;AAC7D,iBAAK,kBAAkB,MAAM,aAAa,KAAK,gBAAgB;AAC/D,iBAAK,kBAAkB,MAAM,QAAQ,KAAK,gBAAgB;AAAA,UAC5D;AAGA,gBAAM,cAAc,KAAK,iBAAiB,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,mBAAkB;AAChH,sBAAY,QAAQ,WAAS;AAC3B,kBAAM,MAAM,WAAW,KAAK,gBAAgB;AAC5C,kBAAM,MAAM,aAAa,KAAK,gBAAgB;AAC9C,kBAAM,MAAM,QAAQ,KAAK,gBAAgB;AAAA,UAC3C,CAAC;AAGD,gBAAM,cAAc,KAAK,iBAAiB,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,mBAAkB;AAChH,sBAAY,QAAQ,WAAS;AAC3B,kBAAM,MAAM,aAAa,KAAK,gBAAgB;AAAA,UAChD,CAAC;AAAA,QACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAQA,kBAAkB,UAAU,OAAO;AACjC,gBAAM,YAAY,WAAW,MAAM;AACjC,iBAAK,SAAS,OAAO,SAAS;AAC9B,qBAAS;AAAA,UACX,GAAG,KAAK;AACR,eAAK,SAAS,IAAI,SAAS;AAC3B,iBAAO;AAAA,QACT;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,oBAAoB,WAAW;AAC7B,cAAI,WAAW;AACb,yBAAa,SAAS;AACtB,iBAAK,SAAS,OAAO,SAAS;AAAA,UAChC;AAAA,QACF;AAAA;AAAA;AAAA;AAAA,QAKA,UAAU;AACR,eAAK,wBAAwB;AAG7B,cAAI,KAAK,oBAAoB;AAC3B,gBAAI,KAAK,mBAAmB,mBAAmB;AAC7C,mBAAK,mBAAmB,yBAAyB;AACjD,mBAAK,wBAAwB;AAAA,YAC/B;AACA,iBAAK,mBAAmB,QAAQ;AAChC,iBAAK,qBAAqB;AAAA,UAC5B;AAGA,cAAI,KAAK,oBAAoB,KAAK,kBAAkB;AAClD,iBAAK,iBAAiB,oBAAoB,WAAW,KAAK,gBAAgB;AAC1E,iBAAK,mBAAmB;AAAA,UAC1B;AAGA,cAAI,KAAK,SAAS,YAAY;AAC5B,iBAAK,OAAO,IAAI,cAAc,KAAK,SAAS,UAAU;AAAA,UACxD;AAGA,cAAI,KAAK,SAAS,yBAAyB;AACzC,iBAAK,OAAO,IAAI,2BAA2B,KAAK,SAAS,uBAAuB;AAAA,UAClF;AACA,cAAI,KAAK,SAAS,0BAA0B;AAC1C,iBAAK,OAAO,IAAI,4BAA4B,KAAK,SAAS,wBAAwB;AAAA,UACpF;AAGA,cAAI,KAAK,gBAAgB;AACvB,gBAAI,KAAK,SAAS,eAAe;AAC/B,mBAAK,eAAe,oBAAoB,SAAS,KAAK,SAAS,aAAa;AAAA,YAC9E;AACA,gBAAI,KAAK,SAAS,iBAAiB;AACjC,mBAAK,eAAe,oBAAoB,WAAW,KAAK,SAAS,eAAe;AAAA,YAClF;AAAA,UACF;AAGA,cAAI,KAAK,SAAS,oBAAoB;AACpC,qBAAS,oBAAoB,WAAW,KAAK,SAAS,kBAAkB;AAAA,UAC1E;AAGA,cAAI,KAAK,SAAS,eAAe;AAC/B,qBAAS,oBAAoB,SAAS,KAAK,SAAS,aAAa;AAAA,UACnE;AAGA,cAAI,KAAK,SAAS,QAAQ;AACxB,mBAAO,oBAAoB,UAAU,KAAK,SAAS,MAAM;AAAA,UAC3D;AAGA,eAAK,SAAS,QAAQ,eAAa,aAAa,SAAS,CAAC;AAC1D,eAAK,SAAS,MAAM;AAGpB,eAAK,WAAW;AAGhB,cAAI,KAAK,oBAAoB,KAAK,iBAAiB,YAAY;AAC7D,iBAAK,iBAAiB,WAAW,YAAY,KAAK,gBAAgB;AAAA,UACpE;AAEA,eAAK,mBAAmB;AACxB,eAAK,mBAAmB;AACxB,eAAK,oBAAoB;AACzB,eAAK,oBAAoB,CAAC;AAC1B,eAAK,eAAe;AACpB,eAAK,cAAc;AACnB,eAAK,0BAA0B,CAAC;AAChC,eAAK,qBAAqB;AAC1B,eAAK,mBAAmB;AACxB,eAAK,aAAa;AAAA,QACpB;AAAA,QAEA,aAAa,SAAS;AACpB,cAAI,CAAC,KAAK,WAAY;AACtB,eAAK,WAAW,cAAc,WAAW;AAAA,QAC3C;AAAA,MACF;AAAA;AAAA;;;ACvvEA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,kBAAN,MAAsB;AAAA,QAC3B,YAAY,QAAQ;AAClB,eAAK,SAAS;AACd,eAAK,UAAU;AACf,eAAK,UAAU;AACf,eAAK,UAAU;AACf,eAAK,SAAS;AAAA,QAChB;AAAA,QAEA,MAAM,OAAO;AAEX,gBAAM,MAAM,KAAK,OAAO,iBAAiB,KAAK,OAAO,QAAQ;AAC7D,eAAK,UAAU,KAAK,eAAe,GAAG;AAEtC,cAAI,CAAC,KAAK,SAAS;AACjB,kBAAM,IAAI,MAAM,qBAAqB;AAAA,UACvC;AAGA,gBAAM,KAAK,eAAe;AAG1B,eAAK,aAAa;AAGlB,gBAAM,KAAK,iBAAiB;AAAA,QAC9B;AAAA,QAEA,eAAe,KAAK;AAClB,gBAAM,WAAW;AAAA,YACf;AAAA,YACA;AAAA,UACF;AAEA,qBAAW,WAAW,UAAU;AAC9B,kBAAM,QAAQ,IAAI,MAAM,OAAO;AAC/B,gBAAI,SAAS,MAAM,CAAC,GAAG;AACrB,qBAAO,MAAM,CAAC;AAAA,YAChB;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAAA,QAEA,MAAM,iBAAiB;AAErB,cAAI,OAAO,MAAM,OAAO,GAAG,QAAQ;AACjC,mBAAO,QAAQ,QAAQ;AAAA,UACzB;AAEA,iBAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEtC,gBAAI,OAAO,yBAAyB;AAClC,oBAAM,mBAAmB,OAAO;AAChC,qBAAO,0BAA0B,MAAM;AACrC,iCAAiB;AACjB,wBAAQ;AAAA,cACV;AACA;AAAA,YACF;AAGA,kBAAM,MAAM,SAAS,cAAc,QAAQ;AAC3C,gBAAI,MAAM;AAEV,mBAAO,0BAA0B,MAAM;AACrC,sBAAQ;AAAA,YACV;AAEA,gBAAI,UAAU,MAAM,OAAO,IAAI,MAAM,4BAA4B,CAAC;AAElE,kBAAM,iBAAiB,SAAS,qBAAqB,QAAQ,EAAE,CAAC;AAChE,2BAAe,WAAW,aAAa,KAAK,cAAc;AAAA,UAC5D,CAAC;AAAA,QACH;AAAA,QAEA,eAAe;AAEb,eAAK,OAAO,QAAQ,MAAM,UAAU;AAGpC,eAAK,SAAS,SAAS,cAAc,KAAK;AAC1C,eAAK,OAAO,KAAK,kBAAkB,YAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC;AACzE,eAAK,OAAO,MAAM,QAAQ;AAC1B,eAAK,OAAO,MAAM,YAAY;AAE9B,eAAK,OAAO,QAAQ,WAAW,aAAa,KAAK,QAAQ,KAAK,OAAO,OAAO;AAAA,QAC9E;AAAA,QAEA,MAAM,mBAAmB;AACvB,iBAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,iBAAK,UAAU,IAAI,OAAO,GAAG,OAAO,KAAK,OAAO,IAAI;AAAA,cAClD,SAAS,KAAK;AAAA,cACd,OAAO;AAAA,cACP,QAAQ;AAAA,cACR,YAAY;AAAA,gBACV,UAAU;AAAA;AAAA,gBACV,WAAW;AAAA;AAAA,gBACX,IAAI;AAAA;AAAA,gBACJ,gBAAgB;AAAA,gBAChB,KAAK;AAAA,gBACL,UAAU;AAAA,gBACV,gBAAgB;AAAA,gBAChB,UAAU,KAAK,OAAO,QAAQ,WAAW,IAAI;AAAA,gBAC7C,MAAM,KAAK,OAAO,QAAQ,QAAQ,IAAI;AAAA,gBACtC,OAAO,KAAK,OAAO,QAAQ,aAAa;AAAA,cAC1C;AAAA,cACA,QAAQ;AAAA,gBACN,SAAS,CAAC,UAAU;AAClB,uBAAK,UAAU;AACf,uBAAK,aAAa;AAElB,sBAAI,KAAK,OAAO,WAAW;AACzB,yBAAK,OAAO,UAAU,UAAU,IAAI,0BAA0B;AAAA,kBAChE;AACA,0BAAQ;AAAA,gBACV;AAAA,gBACA,eAAe,CAAC,UAAU,KAAK,kBAAkB,KAAK;AAAA,gBACtD,SAAS,CAAC,UAAU,KAAK,YAAY,KAAK;AAAA,cAC5C;AAAA,YACF,CAAC;AAAA,UACH,CAAC;AAAA,QACH;AAAA,QAEA,eAAe;AAEb,eAAK,qBAAqB,YAAY,MAAM;AAC1C,gBAAI,KAAK,WAAW,KAAK,SAAS;AAChC,oBAAM,cAAc,KAAK,QAAQ,eAAe;AAChD,oBAAM,WAAW,KAAK,QAAQ,YAAY;AAE1C,mBAAK,OAAO,MAAM,cAAc;AAChC,mBAAK,OAAO,MAAM,WAAW;AAE7B,mBAAK,OAAO,KAAK,cAAc,WAAW;AAAA,YAC5C;AAAA,UACF,GAAG,GAAG;AAGN,cAAI,KAAK,QAAQ,aAAa;AAC5B,iBAAK,OAAO,MAAM,WAAW,KAAK,QAAQ,YAAY;AACtD,iBAAK,OAAO,KAAK,gBAAgB;AAAA,UACnC;AAAA,QACF;AAAA,QAEA,kBAAkB,OAAO;AACvB,gBAAM,SAAS,OAAO,GAAG;AAEzB,kBAAQ,MAAM,MAAM;AAAA,YAClB,KAAK,OAAO;AACV,mBAAK,OAAO,MAAM,UAAU;AAC5B,mBAAK,OAAO,MAAM,SAAS;AAC3B,mBAAK,OAAO,MAAM,QAAQ;AAC1B,mBAAK,OAAO,MAAM,YAAY;AAC9B,mBAAK,OAAO,KAAK,MAAM;AACvB,mBAAK,OAAO,KAAK,SAAS;AAE1B,kBAAI,KAAK,OAAO,QAAQ,QAAQ;AAC9B,qBAAK,OAAO,QAAQ,OAAO,KAAK,KAAK,MAAM;AAAA,cAC7C;AACA;AAAA,YAEF,KAAK,OAAO;AACV,mBAAK,OAAO,MAAM,UAAU;AAC5B,mBAAK,OAAO,MAAM,SAAS;AAC3B,mBAAK,OAAO,KAAK,OAAO;AAExB,kBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,qBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,cAC9C;AACA;AAAA,YAEF,KAAK,OAAO;AACV,mBAAK,OAAO,MAAM,UAAU;AAC5B,mBAAK,OAAO,MAAM,SAAS;AAC3B,mBAAK,OAAO,MAAM,QAAQ;AAC1B,mBAAK,OAAO,KAAK,OAAO;AAExB,kBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,qBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,cAC9C;AAEA,kBAAI,KAAK,OAAO,QAAQ,MAAM;AAC5B,qBAAK,QAAQ,OAAO,CAAC;AACrB,qBAAK,QAAQ,UAAU;AAAA,cACzB;AACA;AAAA,YAEF,KAAK,OAAO;AACV,mBAAK,OAAO,MAAM,YAAY;AAC9B,mBAAK,OAAO,KAAK,SAAS;AAC1B;AAAA,YAEF,KAAK,OAAO;AACV,mBAAK,OAAO,KAAK,gBAAgB;AACjC;AAAA,UACJ;AAAA,QACF;AAAA,QAEA,YAAY,OAAO;AACjB,gBAAM,SAAS;AAAA,YACb,GAAG;AAAA,YACH,GAAG;AAAA,YACH,KAAK;AAAA,YACL,KAAK;AAAA,YACL,KAAK;AAAA,UACP;AAEA,gBAAM,QAAQ,IAAI,MAAM,OAAO,MAAM,IAAI,KAAK,sBAAsB;AACpE,eAAK,OAAO,YAAY,KAAK;AAAA,QAC/B;AAAA,QAEA,OAAO;AACL,cAAI,KAAK,WAAW,KAAK,SAAS;AAEhC,kBAAM,UAAU,OAAO;AACvB,kBAAM,UAAU,OAAO;AAEvB,iBAAK,QAAQ,UAAU;AAGvB,mBAAO,SAAS,SAAS,OAAO;AAAA,UAClC;AAAA,QACF;AAAA,QAEA,QAAQ;AACN,cAAI,KAAK,WAAW,KAAK,SAAS;AAChC,iBAAK,QAAQ,WAAW;AAAA,UAC1B;AAAA,QACF;AAAA,QAEA,KAAK,MAAM;AACT,cAAI,KAAK,WAAW,KAAK,SAAS;AAChC,iBAAK,QAAQ,OAAO,MAAM,IAAI;AAAA,UAChC;AAAA,QACF;AAAA,QAEA,UAAU,QAAQ;AAChB,cAAI,KAAK,WAAW,KAAK,SAAS;AAChC,iBAAK,QAAQ,UAAU,SAAS,GAAG;AACnC,iBAAK,OAAO,MAAM,SAAS;AAAA,UAC7B;AAAA,QACF;AAAA,QAEA,SAAS,OAAO;AACd,cAAI,KAAK,WAAW,KAAK,SAAS;AAChC,gBAAI,OAAO;AACT,mBAAK,QAAQ,KAAK;AAAA,YACpB,OAAO;AACL,mBAAK,QAAQ,OAAO;AAAA,YACtB;AACA,iBAAK,OAAO,MAAM,QAAQ;AAAA,UAC5B;AAAA,QACF;AAAA,QAEA,iBAAiB,OAAO;AACtB,cAAI,KAAK,WAAW,KAAK,SAAS;AAChC,iBAAK,QAAQ,gBAAgB,KAAK;AAClC,iBAAK,OAAO,MAAM,gBAAgB;AAAA,UACpC;AAAA,QACF;AAAA,QAEA,UAAU;AACR,cAAI,KAAK,oBAAoB;AAC3B,0BAAc,KAAK,kBAAkB;AAAA,UACvC;AAEA,cAAI,KAAK,WAAW,KAAK,QAAQ,SAAS;AACxC,iBAAK,QAAQ,QAAQ;AAAA,UACvB;AAEA,cAAI,KAAK,UAAU,KAAK,OAAO,YAAY;AACzC,iBAAK,OAAO,WAAW,YAAY,KAAK,MAAM;AAAA,UAChD;AAGA,cAAI,KAAK,OAAO,SAAS;AACvB,iBAAK,OAAO,QAAQ,MAAM,UAAU;AAAA,UACtC;AAAA,QACF;AAAA,MACF;AAAA;AAAA;;;AC5RA;AAAA;AAAA;AAAA;AAAA,MAIa;AAJb;AAAA;AAIO,MAAM,gBAAN,MAAoB;AAAA,QACzB,YAAY,QAAQ;AAClB,eAAK,SAAS;AACd,eAAK,QAAQ;AACb,eAAK,UAAU;AACf,eAAK,UAAU;AACf,eAAK,SAAS;AAAA,QAChB;AAAA,QAEA,MAAM,OAAO;AAEX,gBAAM,MAAM,KAAK,OAAO,iBAAiB,KAAK,OAAO,QAAQ;AAC7D,eAAK,UAAU,KAAK,eAAe,GAAG;AAEtC,cAAI,CAAC,KAAK,SAAS;AACjB,kBAAM,IAAI,MAAM,mBAAmB;AAAA,UACrC;AAGA,gBAAM,KAAK,aAAa;AAGxB,eAAK,aAAa;AAGlB,gBAAM,KAAK,iBAAiB;AAAA,QAC9B;AAAA,QAEA,eAAe,KAAK;AAClB,gBAAM,WAAW;AAAA,YACf;AAAA,YACA;AAAA,YACA;AAAA,UACF;AAEA,qBAAW,WAAW,UAAU;AAC9B,kBAAM,QAAQ,IAAI,MAAM,OAAO;AAC/B,gBAAI,SAAS,MAAM,CAAC,GAAG;AACrB,qBAAO,MAAM,CAAC;AAAA,YAChB;AAAA,UACF;AAEA,iBAAO;AAAA,QACT;AAAA,QAEA,MAAM,eAAe;AAEnB,cAAI,OAAO,SAAS,OAAO,MAAM,QAAQ;AACvC,mBAAO,QAAQ,QAAQ;AAAA,UACzB;AAEA,iBAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,kBAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,mBAAO,MAAM;AACb,mBAAO,SAAS,MAAM,QAAQ;AAC9B,mBAAO,UAAU,MAAM,OAAO,IAAI,MAAM,0BAA0B,CAAC;AACnE,qBAAS,KAAK,YAAY,MAAM;AAAA,UAClC,CAAC;AAAA,QACH;AAAA,QAEA,eAAe;AAEb,eAAK,OAAO,QAAQ,MAAM,UAAU;AAGpC,eAAK,SAAS,SAAS,cAAc,KAAK;AAC1C,eAAK,OAAO,KAAK,gBAAgB,YAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC;AACvE,eAAK,OAAO,MAAM,QAAQ;AAC1B,eAAK,OAAO,MAAM,YAAY;AAE9B,eAAK,OAAO,QAAQ,WAAW,aAAa,KAAK,QAAQ,KAAK,OAAO,OAAO;AAAA,QAC9E;AAAA,QAEA,MAAM,mBAAmB;AACvB,gBAAM,UAAU;AAAA,YACd,IAAI,KAAK;AAAA,YACT,OAAO;AAAA,YACP,QAAQ;AAAA,YACR,UAAU;AAAA;AAAA,YACV,UAAU,KAAK,OAAO,QAAQ;AAAA,YAC9B,OAAO,KAAK,OAAO,QAAQ;AAAA,YAC3B,MAAM,KAAK,OAAO,QAAQ;AAAA,YAC1B,UAAU;AAAA,UACZ;AAEA,cAAI,KAAK,OAAO,QAAQ,YAAY,GAAG;AACrC,oBAAQ,YAAY,KAAK,OAAO,QAAQ;AAAA,UAC1C;AAEA,eAAK,QAAQ,IAAI,OAAO,MAAM,OAAO,KAAK,OAAO,IAAI,OAAO;AAG5D,gBAAM,KAAK,MAAM,MAAM;AACvB,eAAK,UAAU;AAGf,gBAAM,cAAc,KAAK,OAAO,cAAc,QAAQ;AACtD,cAAI,aAAa;AACf,wBAAY,MAAM,QAAQ;AAC1B,wBAAY,MAAM,SAAS;AAC3B,wBAAY,aAAa,SAAS,MAAM;AACxC,wBAAY,aAAa,UAAU,MAAM;AAAA,UAC3C;AAGA,cAAI,KAAK,OAAO,WAAW;AACzB,iBAAK,OAAO,UAAU,UAAU,IAAI,0BAA0B;AAAA,UAChE;AAEA,eAAK,aAAa;AAGlB,cAAI;AACF,kBAAM,WAAW,MAAM,KAAK,MAAM,YAAY;AAC9C,iBAAK,OAAO,MAAM,WAAW;AAC7B,iBAAK,OAAO,KAAK,gBAAgB;AAAA,UACnC,SAAS,OAAO;AACd,iBAAK,OAAO,IAAI,2BAA2B,OAAO,MAAM;AAAA,UAC1D;AAAA,QACF;AAAA,QAEA,eAAe;AACb,eAAK,MAAM,GAAG,QAAQ,MAAM;AAC1B,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,MAAM;AAEvB,gBAAI,KAAK,OAAO,QAAQ,QAAQ;AAC9B,mBAAK,OAAO,QAAQ,OAAO,KAAK,KAAK,MAAM;AAAA,YAC7C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,GAAG,SAAS,MAAM;AAC3B,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,GAAG,SAAS,MAAM;AAC3B,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,GAAG,cAAc,CAAC,SAAS;AACpC,iBAAK,OAAO,MAAM,cAAc,KAAK;AACrC,iBAAK,OAAO,MAAM,WAAW,KAAK;AAClC,iBAAK,OAAO,KAAK,cAAc,KAAK,OAAO;AAE3C,gBAAI,KAAK,OAAO,QAAQ,cAAc;AACpC,mBAAK,OAAO,QAAQ,aAAa,KAAK,KAAK,QAAQ,KAAK,OAAO;AAAA,YACjE;AAAA,UACF,CAAC;AAED,eAAK,MAAM,GAAG,gBAAgB,CAAC,SAAS;AACtC,iBAAK,OAAO,MAAM,SAAS,KAAK;AAChC,iBAAK,OAAO,KAAK,gBAAgB,KAAK,MAAM;AAAA,UAC9C,CAAC;AAED,eAAK,MAAM,GAAG,eAAe,MAAM;AACjC,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,GAAG,aAAa,MAAM;AAC/B,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,GAAG,WAAW,MAAM;AAC7B,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,GAAG,UAAU,MAAM;AAC5B,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,KAAK,QAAQ;AAAA,UAC3B,CAAC;AAED,eAAK,MAAM,GAAG,sBAAsB,CAAC,SAAS;AAC5C,iBAAK,OAAO,MAAM,gBAAgB,KAAK;AACvC,iBAAK,OAAO,KAAK,cAAc,KAAK,YAAY;AAAA,UAClD,CAAC;AAED,eAAK,MAAM,GAAG,SAAS,CAAC,UAAU;AAChC,iBAAK,OAAO,YAAY,IAAI,MAAM,gBAAgB,aAAM,QAAS,CAAC;AAAA,UACpE,CAAC;AAAA,QACH;AAAA,QAEA,OAAO;AACL,cAAI,KAAK,WAAW,KAAK,OAAO;AAE9B,kBAAM,UAAU,OAAO;AACvB,kBAAM,UAAU,OAAO;AAEvB,iBAAK,MAAM,KAAK,EAAE,MAAM,WAAS;AAC/B,mBAAK,OAAO,IAAI,eAAe,OAAO,MAAM;AAAA,YAC9C,CAAC;AAGD,mBAAO,SAAS,SAAS,OAAO;AAAA,UAClC;AAAA,QACF;AAAA,QAEA,QAAQ;AACN,cAAI,KAAK,WAAW,KAAK,OAAO;AAC9B,iBAAK,MAAM,MAAM,EAAE,MAAM,WAAS;AAChC,mBAAK,OAAO,IAAI,gBAAgB,OAAO,MAAM;AAAA,YAC/C,CAAC;AAAA,UACH;AAAA,QACF;AAAA,QAEA,KAAK,MAAM;AACT,cAAI,KAAK,WAAW,KAAK,OAAO;AAC9B,iBAAK,MAAM,eAAe,IAAI,EAAE,MAAM,WAAS;AAC7C,mBAAK,OAAO,IAAI,eAAe,OAAO,MAAM;AAAA,YAC9C,CAAC;AAAA,UACH;AAAA,QACF;AAAA,QAEA,UAAU,QAAQ;AAChB,cAAI,KAAK,WAAW,KAAK,OAAO;AAC9B,iBAAK,MAAM,UAAU,MAAM,EAAE,MAAM,WAAS;AAC1C,mBAAK,OAAO,IAAI,iBAAiB,OAAO,MAAM;AAAA,YAChD,CAAC;AACD,iBAAK,OAAO,MAAM,SAAS;AAAA,UAC7B;AAAA,QACF;AAAA,QAEA,SAAS,OAAO;AACd,cAAI,KAAK,WAAW,KAAK,OAAO;AAC9B,gBAAI,OAAO;AACT,mBAAK,MAAM,UAAU,CAAC;AAAA,YACxB,OAAO;AACL,mBAAK,MAAM,UAAU,KAAK,OAAO,MAAM,MAAM;AAAA,YAC/C;AACA,iBAAK,OAAO,MAAM,QAAQ;AAAA,UAC5B;AAAA,QACF;AAAA,QAEA,iBAAiB,OAAO;AACtB,cAAI,KAAK,WAAW,KAAK,OAAO;AAC9B,iBAAK,MAAM,gBAAgB,KAAK,EAAE,MAAM,WAAS;AAC/C,mBAAK,OAAO,IAAI,wBAAwB,OAAO,MAAM;AAAA,YACvD,CAAC;AACD,iBAAK,OAAO,MAAM,gBAAgB;AAAA,UACpC;AAAA,QACF;AAAA,QAEA,UAAU;AACR,cAAI,KAAK,SAAS,KAAK,MAAM,SAAS;AACpC,iBAAK,MAAM,QAAQ;AAAA,UACrB;AAEA,cAAI,KAAK,UAAU,KAAK,OAAO,YAAY;AACzC,iBAAK,OAAO,WAAW,YAAY,KAAK,MAAM;AAAA,UAChD;AAGA,cAAI,KAAK,OAAO,SAAS;AACvB,iBAAK,OAAO,QAAQ,MAAM,UAAU;AAAA,UACtC;AAAA,QACF;AAAA,MACF;AAAA;AAAA;;;ACrRA;AAAA;AAAA;AAAA;AAAA,MAKa;AALb;AAAA;AAKO,MAAM,cAAN,MAAkB;AAAA,QACvB,YAAY,QAAQ;AAClB,eAAK,SAAS;AACd,eAAK,QAAQ,OAAO;AACpB,eAAK,MAAM;AACX,eAAK,mBAAmB;AACxB,eAAK,cAAc;AAAA,QACrB;AAAA,QAEA,MAAM,OAAO;AAEX,cAAI,KAAK,gBAAgB,GAAG;AAC1B,iBAAK,OAAO,IAAI,0BAA0B;AAC1C,kBAAM,KAAK,WAAW;AAAA,UACxB,OAAO;AACL,iBAAK,OAAO,IAAI,8BAA8B;AAC9C,kBAAM,KAAK,UAAU;AAAA,UACvB;AAAA,QACF;AAAA,QAEA,kBAAkB;AAGhB,gBAAM,WAAW,iCAAiC,KAAK,UAAU,SAAS;AAC1E,gBAAM,QAAQ,mBAAmB,KAAK,UAAU,SAAS,KAAK,CAAC,OAAO;AAEtE,cAAI,CAAC,YAAY,CAAC,OAAO;AAEvB,mBAAO;AAAA,UACT;AAEA,gBAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,iBAAO,MAAM,YAAY,+BAA+B,MAAM;AAAA,QAChE;AAAA,QAEA,MAAM,aAAa;AAEjB,gBAAMC,kBAAiB,MAAM,6EAA8B;AAC3D,gBAAM,WAAW,IAAIA,eAAc,KAAK,MAAM;AAC9C,gBAAM,SAAS,KAAK;AAGpB,iBAAO,oBAAoB,OAAO,eAAe,QAAQ,CAAC,EAAE,QAAQ,YAAU;AAC5E,gBAAI,WAAW,iBAAiB,OAAO,SAAS,MAAM,MAAM,YAAY;AACtE,mBAAK,MAAM,IAAI,SAAS,MAAM,EAAE,KAAK,QAAQ;AAAA,YAC/C;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QAEA,MAAM,YAAY;AAEhB,eAAK,MAAM,WAAW;AACtB,eAAK,MAAM,gBAAgB,UAAU;AAGrC,cAAI,CAAC,OAAO,KAAK;AACf,kBAAM,KAAK,UAAU;AAAA,UACvB;AAEA,cAAI,CAAC,OAAO,IAAI,YAAY,GAAG;AAC7B,kBAAM,IAAI,MAAM,sCAAsC;AAAA,UACxD;AAGA,eAAK,MAAM,IAAI,OAAO,IAAI;AAAA,YACxB,OAAO,KAAK,OAAO,QAAQ;AAAA;AAAA,YAE3B,eAAe,CAAC,KAAK,OAAO,QAAQ;AAAA,YACpC,cAAc;AAAA,YACd,gBAAgB;AAAA,YAChB,kBAAkB;AAAA,YAClB,iBAAiB;AAAA,YACjB,oBAAoB;AAAA,YACpB,eAAe,KAAK,MAAO;AAAA,YAC3B,eAAe;AAAA;AAAA,YAEf,wBAAwB;AAAA,YACxB,yBAAyB;AAAA,YACzB,2BAA2B;AAAA,YAC3B,gCAAgC;AAAA,YAChC,qBAAqB;AAAA,YACrB,sBAAsB;AAAA,YACtB,wBAAwB;AAAA,YACxB,6BAA6B;AAAA,YAC7B,oBAAoB;AAAA,YACpB,qBAAqB;AAAA,YACrB,uBAAuB;AAAA,YACvB,4BAA4B;AAAA,UAC9B,CAAC;AAGD,eAAK,IAAI,YAAY,KAAK,KAAK;AAG/B,cAAI,MAAM,KAAK,OAAO;AAEtB,cAAI,CAAC,KAAK;AACR,kBAAM,gBAAgB,KAAK,OAAO,QAAQ,cAAc,QAAQ;AAChE,gBAAI,eAAe;AAEjB,oBAAM,cAAc,aAAa,KAAK;AAAA,YACxC,OAAO;AAEL,oBAAM,KAAK,OAAO,QAAQ,aAAa,KAAK,KAAK,KAAK,OAAO,QAAQ;AAAA,YACvE;AAAA,UACF;AAEA,eAAK,OAAO,IAAI,uBAAuB,aAAO,KAAK;AAEnD,cAAI,CAAC,KAAK;AACR,kBAAM,IAAI,MAAM,qBAAqB;AAAA,UACvC;AAEA,cAAI,KAAK,OAAO,QAAQ,WAAW;AAEjC,iBAAK,cAAc;AAAA,UACrB,OAAO;AACL,iBAAK,IAAI,WAAW,GAAG;AACvB,iBAAK,mBAAmB;AAAA,UAC1B;AAGA,eAAK,gBAAgB;AACrB,eAAK,kBAAkB;AAAA,QACzB;AAAA,QAEA,MAAM,YAAY;AAChB,iBAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,kBAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,mBAAO,MAAM;AACb,mBAAO,SAAS,MAAM,QAAQ;AAC9B,mBAAO,UAAU,MAAM,OAAO,IAAI,MAAM,uBAAuB,CAAC;AAChE,qBAAS,KAAK,YAAY,MAAM;AAAA,UAClC,CAAC;AAAA,QACH;AAAA,QAEA,kBAAkB;AAChB,eAAK,IAAI,GAAG,OAAO,IAAI,OAAO,iBAAiB,CAAC,OAAO,SAAS;AAC9D,iBAAK,OAAO,IAAI,gCAAgC,KAAK,OAAO,SAAS,iBAAiB;AACtF,iBAAK,OAAO,KAAK,qBAAqB,IAAI;AAG1C,gBAAI,KAAK,OAAO,WAAW;AACzB,mBAAK,OAAO,UAAU,UAAU,OAAO,0BAA0B;AAAA,YACnE;AAAA,UACF,CAAC;AAED,eAAK,IAAI,GAAG,OAAO,IAAI,OAAO,gBAAgB,CAAC,OAAO,SAAS;AAC7D,iBAAK,OAAO,IAAI,2BAA2B,KAAK,KAAK;AACrD,iBAAK,OAAO,KAAK,oBAAoB,IAAI;AAAA,UAC3C,CAAC;AAED,eAAK,IAAI,GAAG,OAAO,IAAI,OAAO,OAAO,CAAC,OAAO,SAAS;AACpD,iBAAK,eAAe,IAAI;AAAA,UAC1B,CAAC;AAED,eAAK,IAAI,GAAG,OAAO,IAAI,OAAO,eAAe,MAAM;AACjD,iBAAK,OAAO,MAAM,YAAY;AAAA,UAChC,CAAC;AAAA,QACH;AAAA,QAEA,oBAAoB;AAElB,eAAK,MAAM,iBAAiB,kBAAkB,MAAM;AAClD,iBAAK,OAAO,MAAM,WAAW,KAAK,MAAM;AACxC,iBAAK,OAAO,KAAK,gBAAgB;AAAA,UACnC,CAAC;AAED,eAAK,MAAM,iBAAiB,QAAQ,MAAM;AACxC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,MAAM;AAEvB,gBAAI,KAAK,OAAO,QAAQ,QAAQ;AAC9B,mBAAK,OAAO,QAAQ,OAAO,KAAK,KAAK,MAAM;AAAA,YAC7C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,MAAM;AACzC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,MAAM;AACzC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAEA,gBAAI,KAAK,OAAO,QAAQ,MAAM;AAC5B,mBAAK,OAAO,KAAK,CAAC;AAClB,mBAAK,OAAO,KAAK;AAAA,YACnB;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,cAAc,MAAM;AAC9C,iBAAK,OAAO,MAAM,cAAc,KAAK,MAAM;AAC3C,iBAAK,OAAO,KAAK,cAAc,KAAK,MAAM,WAAW;AAErD,gBAAI,KAAK,OAAO,QAAQ,cAAc;AACpC,mBAAK,OAAO,QAAQ,aAAa,KAAK,KAAK,QAAQ,KAAK,MAAM,WAAW;AAAA,YAC3E;AAAA,UACF,CAAC;AAED,eAAK,MAAM,iBAAiB,gBAAgB,MAAM;AAChD,iBAAK,OAAO,MAAM,SAAS,KAAK,MAAM;AACtC,iBAAK,OAAO,MAAM,QAAQ,KAAK,MAAM;AACrC,iBAAK,OAAO,KAAK,gBAAgB,KAAK,MAAM,MAAM;AAAA,UACpD,CAAC;AAED,eAAK,MAAM,iBAAiB,WAAW,MAAM;AAC3C,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,iBAAiB,WAAW,MAAM;AAC3C,iBAAK,OAAO,MAAM,YAAY;AAC9B,iBAAK,OAAO,KAAK,SAAS;AAAA,UAC5B,CAAC;AAED,eAAK,MAAM,iBAAiB,SAAS,MAAM;AACzC,iBAAK,OAAO,YAAY,KAAK,MAAM,KAAK;AAAA,UAC1C,CAAC;AAAA,QACH;AAAA,QAEA,eAAe,MAAM;AAEnB,eAAK,OAAO,IAAI,qBAAqB,YAAK,MAAI,eAAc,YAAK,SAAO,aAAY,YAAK,QAAS,MAAM;AACxG,cAAI,KAAK,UAAU;AACjB,iBAAK,OAAO,IAAI,kBAAkB,YAAK,SAAS,MAAI,WAAU,YAAK,SAAS,MAAO,MAAM;AAAA,UAC3F;AAEA,cAAI,KAAK,OAAO;AACd,oBAAQ,KAAK,MAAM;AAAA,cACjB,KAAK,OAAO,IAAI,WAAW;AACzB,qBAAK,OAAO,IAAI,6CAA6C,OAAO;AACpE,qBAAK,OAAO,IAAI,0BAA0B,YAAK,UAAW,OAAO;AACjE,2BAAW,MAAM;AACf,uBAAK,IAAI,UAAU;AAAA,gBACrB,GAAG,GAAI;AACP;AAAA,cAEF,KAAK,OAAO,IAAI,WAAW;AACzB,qBAAK,OAAO,IAAI,2CAA2C,OAAO;AAClE,qBAAK,IAAI,kBAAkB;AAC3B;AAAA,cAEF;AACE,qBAAK,OAAO,IAAI,+BAA+B,OAAO;AACtD,qBAAK,OAAO,YAAY,IAAI,MAAM,cAAc,YAAK,MAAI,OAAM,YAAK,QAAS,CAAC;AAC9E,qBAAK,IAAI,QAAQ;AACjB;AAAA,YACJ;AAAA,UACF,OAAO;AACL,iBAAK,OAAO,IAAI,0BAA0B,KAAK,SAAS,MAAM;AAAA,UAChE;AAAA,QACF;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,eAAe;AACb,cAAI,CAAC,KAAK,OAAO,QAAQ,WAAW;AAClC;AAAA,UACF;AAIA,cAAI,CAAC,KAAK,KAAK;AACb;AAAA,UACF;AAEA,cAAI,KAAK,kBAAkB;AACzB;AAAA,UACF;AAEA,gBAAM,MAAM,KAAK,eAAe,KAAK,OAAO,kBAAkB,KAAK,OAAO;AAC1E,cAAI,CAAC,KAAK;AACR;AAAA,UACF;AAEA,cAAI;AACF,iBAAK,IAAI,WAAW,GAAG;AACvB,iBAAK,mBAAmB;AAGxB,iBAAK,IAAI,UAAU;AAAA,UACrB,SAAS,GAAG;AAAA,UAEZ;AAAA,QACF;AAAA,QAEA,OAAO;AAEL,gBAAM,UAAU,OAAO;AACvB,gBAAM,UAAU,OAAO;AAGvB,cAAI,KAAK,OAAO,QAAQ,aAAa,KAAK,OAAO,CAAC,KAAK,kBAAkB;AACvE,kBAAM,MAAM,KAAK,eAAe,KAAK,OAAO;AAC5C,gBAAI,KAAK;AACP,kBAAI;AACF,qBAAK,IAAI,WAAW,GAAG;AACvB,qBAAK,IAAI,UAAU;AACnB,qBAAK,mBAAmB;AAAA,cAC1B,SAAS,GAAG;AAAA,cAEZ;AAAA,YACF;AAAA,UACF;AAEA,gBAAM,UAAU,KAAK,MAAM,KAAK;AAGhC,iBAAO,SAAS,SAAS,OAAO;AAEhC,cAAI,YAAY,QAAW;AACzB,oBAAQ,MAAM,WAAS;AACrB,mBAAK,OAAO,IAAI,gBAAgB,OAAO,MAAM;AAAA,YAC/C,CAAC;AAAA,UACH;AAAA,QACF;AAAA,QAEA,QAAQ;AACN,eAAK,MAAM,MAAM;AAAA,QACnB;AAAA,QAEA,KAAK,MAAM;AACT,eAAK,MAAM,cAAc;AAAA,QAC3B;AAAA,QAEA,UAAU,QAAQ;AAChB,eAAK,MAAM,SAAS;AAAA,QACtB;AAAA,QAEA,SAAS,OAAO;AACd,eAAK,MAAM,QAAQ;AAAA,QACrB;AAAA,QAEA,iBAAiB,OAAO;AACtB,eAAK,MAAM,eAAe;AAAA,QAC5B;AAAA,QAEA,cAAc,YAAY;AACxB,cAAI,KAAK,KAAK;AACZ,iBAAK,IAAI,eAAe;AAAA,UAC1B;AAAA,QACF;AAAA,QAEA,eAAe;AACb,cAAI,KAAK,OAAO,KAAK,IAAI,QAAQ;AAC/B,mBAAO,KAAK,IAAI,OAAO,IAAI,CAAC,OAAO,UAAU;AAC3C,oBAAM,SAAS,OAAO,MAAM,MAAM,KAAK;AACvC,oBAAM,UAAU,OAAO,MAAM,OAAO,KAAK;AACzC,oBAAM,KAAK,UAAU,IAAI,KAAK,MAAM,UAAU,GAAI,IAAI;AAItD,oBAAM,OAAO,SAAS,IAAI,GAAG,eAAM,OAAO,KAAK,IAAI,GAAG,WAAE,SAAQ;AAEhE,qBAAO;AAAA,gBACL;AAAA,gBACA,QAAQ,MAAM;AAAA,gBACd,OAAO,MAAM;AAAA,gBACb,SAAS,MAAM;AAAA,gBACf;AAAA,cACF;AAAA,YACF,CAAC;AAAA,UACH;AACA,iBAAO,CAAC;AAAA,QACV;AAAA,QAEA,oBAAoB;AAClB,cAAI,KAAK,KAAK;AACZ,mBAAO,KAAK,IAAI;AAAA,UAClB;AACA,iBAAO;AAAA,QACT;AAAA,QAEA,UAAU;AACR,cAAI,KAAK,KAAK;AACZ,iBAAK,IAAI,QAAQ;AACjB,iBAAK,MAAM;AAAA,UACb;AAAA,QACF;AAAA,MACF;AAAA;AAAA;;;ACjZA;AAAA;AAAA;AAAA;AAAA;AAAA,MAKa,oBA0VN;AA/VP;AAAA;AAKO,MAAM,qBAAN,MAAyB;AAAA,QAC9B,YAAY,QAAQ;AAClB,eAAK,SAAS;AACd,eAAK,SAAS;AACd,eAAK,WAAW;AAChB,eAAK,UAAU;AACf,eAAK,SAAS;AACd,eAAK,WAAW;AAAA,QAClB;AAAA,QAEA,MAAM,OAAO;AAff;AAiBI,eAAK,WAAW,KAAK,OAAO,iBAAiB,KAAK,OAAO,QAAQ,SAAO,UAAK,OAAO,QAAQ,cAAc,QAAQ,MAA1C,mBAA6C;AAErH,cAAI,CAAC,KAAK,YAAY,CAAC,KAAK,qBAAqB,KAAK,QAAQ,GAAG;AAC/D,kBAAM,IAAI,MAAM,wBAAwB;AAAA,UAC1C;AAGA,gBAAM,KAAK,kBAAkB;AAG7B,eAAK,aAAa;AAGlB,gBAAM,KAAK,iBAAiB;AAAA,QAC9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAOA,qBAAqB,KAAK;AACxB,iBAAO,IAAI,SAAS,gBAAgB,KAAK,IAAI,SAAS,oBAAoB;AAAA,QAC5E;AAAA;AAAA;AAAA;AAAA,QAKA,aAAa;AACX,iBAAO,KAAK,YAAY,KAAK,SAAS,SAAS,QAAQ;AAAA,QACzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QASA,cAAc;AAEZ,gBAAM,aAAa,mBAAmB,KAAK,QAAQ;AAGnD,gBAAM,SAAS,IAAI,gBAAgB;AAAA,YACjC,KAAK,KAAK;AAAA,YACV,WAAW,KAAK,OAAO,QAAQ,WAAW,SAAS;AAAA,YACnD,cAAc;AAAA,YACd,eAAe;AAAA,YACf,WAAW;AAAA,YACX,cAAc;AAAA,YACd,aAAa;AAAA,YACb,QAAQ;AAAA;AAAA,YACR,OAAO;AAAA,UACT,CAAC;AAED,iBAAO,oCAAoC,cAAO,SAAS;AAAA,QAC7D;AAAA,QAEA,MAAM,oBAAoB;AAExB,cAAI,OAAO,MAAM,OAAO,GAAG,QAAQ;AACjC,mBAAO,QAAQ,QAAQ;AAAA,UACzB;AAEA,iBAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACtC,kBAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,mBAAO,MAAM;AACb,mBAAO,SAAS,MAAM;AAEpB,yBAAW,MAAM;AACf,oBAAI,OAAO,MAAM,OAAO,GAAG,QAAQ;AACjC,0BAAQ;AAAA,gBACV,OAAO;AACL,yBAAO,IAAI,MAAM,qCAAqC,CAAC;AAAA,gBACzD;AAAA,cACF,GAAG,GAAG;AAAA,YACR;AACA,mBAAO,UAAU,MAAM,OAAO,IAAI,MAAM,sCAAsC,CAAC;AAC/E,qBAAS,KAAK,YAAY,MAAM;AAAA,UAClC,CAAC;AAAA,QACH;AAAA,QAEA,eAAe;AAEb,eAAK,OAAO,QAAQ,MAAM,UAAU;AACpC,eAAK,OAAO,QAAQ,gBAAgB,QAAQ;AAG5C,cAAI,KAAK,OAAO,cAAc;AAC5B,iBAAK,OAAO,aAAa,UAAU,OAAO,sBAAsB;AAChE,iBAAK,OAAO,aAAa,MAAM,eAAe,uBAAuB;AAAA,UACvE;AAGA,eAAK,WAAW,qBAAqB,YAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC;AAG3E,eAAK,SAAS,SAAS,cAAc,QAAQ;AAC7C,eAAK,OAAO,KAAK,KAAK;AACtB,eAAK,OAAO,YAAY;AACxB,eAAK,OAAO,cAAc;AAC1B,eAAK,OAAO,QAAQ;AACpB,eAAK,OAAO,MAAM,KAAK,YAAY;AACnC,eAAK,OAAO,MAAM,QAAQ;AAC1B,eAAK,OAAO,MAAM,UAAU;AAI5B,cAAI,KAAK,WAAW,GAAG;AACrB,iBAAK,OAAO,UAAU,IAAI,4BAA4B,4BAA4B;AAAA,UACpF,OAAO;AACL,iBAAK,OAAO,UAAU,IAAI,0BAA0B;AAAA,UACtD;AACA,eAAK,OAAO,MAAM,YAAY;AAE9B,eAAK,OAAO,QAAQ,WAAW,aAAa,KAAK,QAAQ,KAAK,OAAO,OAAO;AAAA,QAC9E;AAAA,QAEA,MAAM,mBAAmB;AACvB,iBAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AAEtC,iBAAK,OAAO,iBAAiB,QAAQ,MAAM;AACzC,kBAAI;AACF,qBAAK,SAAS,OAAO,GAAG,OAAO,KAAK,MAAM;AAE1C,qBAAK,OAAO,KAAK,OAAO,GAAG,OAAO,OAAO,OAAO,MAAM;AACpD,uBAAK,UAAU;AACf,uBAAK,aAAa;AAGlB,sBAAI,KAAK,OAAO,WAAW;AACzB,yBAAK,OAAO,UAAU,UAAU,IAAI,0BAA0B;AAAA,kBAChE;AAGA,uBAAK,OAAO,gBAAgB,CAAC,UAAU;AACrC,wBAAI,OAAO;AACT,2BAAK,OAAO,MAAM,WAAW,MAAM,WAAW;AAC9C,2BAAK,OAAO,KAAK,gBAAgB;AAAA,oBACnC;AAAA,kBACF,CAAC;AAED,0BAAQ;AAAA,gBACV,CAAC;AAED,qBAAK,OAAO,KAAK,OAAO,GAAG,OAAO,OAAO,OAAO,CAAC,UAAU;AACzD,uBAAK,OAAO,YAAY,IAAI,MAAM,qBAAqB,aAAM,WAAW,gBAAiB,CAAC;AAAA,gBAC5F,CAAC;AAAA,cACH,SAAS,OAAO;AACd,uBAAO,KAAK;AAAA,cACd;AAAA,YACF,CAAC;AAGD,uBAAW,MAAM;AACf,kBAAI,CAAC,KAAK,SAAS;AACjB,uBAAO,IAAI,MAAM,0CAA0C,CAAC;AAAA,cAC9D;AAAA,YACF,GAAG,GAAK;AAAA,UACV,CAAC;AAAA,QACH;AAAA,QAEA,eAAe;AACb,cAAI,CAAC,KAAK,OAAQ;AAElB,gBAAM,SAAS,OAAO,GAAG,OAAO;AAEhC,eAAK,OAAO,KAAK,OAAO,MAAM,MAAM;AAClC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,MAAM;AAEvB,gBAAI,KAAK,OAAO,QAAQ,QAAQ;AAC9B,mBAAK,OAAO,QAAQ,OAAO,KAAK,KAAK,MAAM;AAAA,YAC7C;AAAA,UACF,CAAC;AAED,eAAK,OAAO,KAAK,OAAO,OAAO,MAAM;AACnC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAAA,UACF,CAAC;AAED,eAAK,OAAO,KAAK,OAAO,QAAQ,MAAM;AACpC,iBAAK,OAAO,MAAM,UAAU;AAC5B,iBAAK,OAAO,MAAM,SAAS;AAC3B,iBAAK,OAAO,MAAM,QAAQ;AAC1B,iBAAK,OAAO,KAAK,OAAO;AAExB,gBAAI,KAAK,OAAO,QAAQ,SAAS;AAC/B,mBAAK,OAAO,QAAQ,QAAQ,KAAK,KAAK,MAAM;AAAA,YAC9C;AAEA,gBAAI,KAAK,OAAO,QAAQ,MAAM;AAC5B,mBAAK,KAAK,CAAC;AACX,mBAAK,KAAK;AAAA,YACZ;AAAA,UACF,CAAC;AAED,eAAK,OAAO,KAAK,OAAO,eAAe,CAAC,SAAS;AAE/C,kBAAM,cAAc,KAAK,kBAAkB;AAC3C,iBAAK,OAAO,MAAM,cAAc;AAChC,iBAAK,OAAO,KAAK,cAAc,WAAW;AAE1C,gBAAI,KAAK,OAAO,QAAQ,cAAc;AACpC,mBAAK,OAAO,QAAQ,aAAa,KAAK,KAAK,QAAQ,WAAW;AAAA,YAChE;AAAA,UACF,CAAC;AAED,eAAK,OAAO,KAAK,OAAO,MAAM,CAAC,SAAS;AACtC,iBAAK,OAAO,MAAM,cAAc,KAAK,kBAAkB;AACvD,iBAAK,OAAO,KAAK,QAAQ;AAAA,UAC3B,CAAC;AAED,eAAK,OAAO,KAAK,OAAO,eAAe,CAAC,SAAS;AAE/C,gBAAI,KAAK,OAAO,MAAM,UAAU;AAC9B,oBAAM,WAAW,KAAK,iBAAiB,KAAK,OAAO,MAAM;AACzD,mBAAK,OAAO,KAAK,YAAY,QAAQ;AAAA,YACvC;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QAEA,OAAO;AACL,cAAI,KAAK,WAAW,KAAK,QAAQ;AAE/B,kBAAM,UAAU,OAAO;AACvB,kBAAM,UAAU,OAAO;AAEvB,iBAAK,OAAO,KAAK;AAGjB,mBAAO,SAAS,SAAS,OAAO;AAAA,UAClC;AAAA,QACF;AAAA,QAEA,QAAQ;AACN,cAAI,KAAK,WAAW,KAAK,QAAQ;AAC/B,iBAAK,OAAO,MAAM;AAAA,UACpB;AAAA,QACF;AAAA,QAEA,KAAK,MAAM;AACT,cAAI,KAAK,WAAW,KAAK,QAAQ;AAE/B,iBAAK,OAAO,OAAO,OAAO,GAAI;AAC9B,iBAAK,OAAO,MAAM,cAAc;AAAA,UAClC;AAAA,QACF;AAAA,QAEA,UAAU,QAAQ;AAChB,cAAI,KAAK,WAAW,KAAK,QAAQ;AAE/B,iBAAK,OAAO,UAAU,SAAS,GAAG;AAClC,iBAAK,OAAO,MAAM,SAAS;AAAA,UAC7B;AAAA,QACF;AAAA,QAEA,SAAS,OAAO;AACd,cAAI,KAAK,WAAW,KAAK,QAAQ;AAE/B,gBAAI,OAAO;AAET,mBAAK,OAAO,UAAU,CAAC,QAAQ;AAC7B,qBAAK,kBAAkB;AACvB,qBAAK,OAAO,UAAU,CAAC;AAAA,cACzB,CAAC;AAAA,YACH,OAAO;AACL,mBAAK,OAAO,UAAU,KAAK,mBAAmB,GAAG;AAAA,YACnD;AACA,iBAAK,OAAO,MAAM,QAAQ;AAAA,UAC5B;AAAA,QACF;AAAA,QAEA,iBAAiB,OAAO;AAEtB,eAAK,OAAO,IAAI,sDAAsD,MAAM;AAAA,QAC9E;AAAA;AAAA;AAAA;AAAA;AAAA,QAMA,kBAAkB;AAChB,iBAAO,IAAI,QAAQ,CAAC,YAAY;AAC9B,gBAAI,KAAK,WAAW,KAAK,QAAQ;AAC/B,mBAAK,OAAO,gBAAgB,CAAC,UAAU;AACrC,wBAAQ,KAAK;AAAA,cACf,CAAC;AAAA,YACH,OAAO;AACL,sBAAQ,IAAI;AAAA,YACd;AAAA,UACF,CAAC;AAAA,QACH;AAAA,QAEA,UAAU;AAER,cAAI,KAAK,QAAQ;AACf,kBAAM,SAAS,OAAO,GAAG,OAAO;AAChC,gBAAI;AACF,mBAAK,OAAO,OAAO,OAAO,KAAK;AAC/B,mBAAK,OAAO,OAAO,OAAO,IAAI;AAC9B,mBAAK,OAAO,OAAO,OAAO,KAAK;AAC/B,mBAAK,OAAO,OAAO,OAAO,MAAM;AAChC,mBAAK,OAAO,OAAO,OAAO,aAAa;AACvC,mBAAK,OAAO,OAAO,OAAO,IAAI;AAC9B,mBAAK,OAAO,OAAO,OAAO,aAAa;AACvC,mBAAK,OAAO,OAAO,OAAO,KAAK;AAAA,YACjC,SAAS,GAAG;AAAA,YAEZ;AAAA,UACF;AAEA,cAAI,KAAK,UAAU,KAAK,OAAO,YAAY;AACzC,iBAAK,OAAO,WAAW,YAAY,KAAK,MAAM;AAAA,UAChD;AAGA,cAAI,KAAK,OAAO,SAAS;AACvB,iBAAK,OAAO,QAAQ,MAAM,UAAU;AAAA,UACtC;AAEA,eAAK,SAAS;AACd,eAAK,UAAU;AAAA,QACjB;AAAA,MACF;AAEA,MAAO,6BAAQ;AAAA;AAAA;;;AC3VR,MAAM,eAAN,MAAmB;AAAA,IACxB,cAAc;AACZ,WAAK,SAAS,CAAC;AAAA,IACjB;AAAA,IAEA,GAAG,OAAO,UAAU;AAClB,UAAI,CAAC,KAAK,OAAO,KAAK,GAAG;AACvB,aAAK,OAAO,KAAK,IAAI,CAAC;AAAA,MACxB;AACA,WAAK,OAAO,KAAK,EAAE,KAAK,QAAQ;AAChC,aAAO;AAAA,IACT;AAAA,IAEA,KAAK,OAAO,UAAU;AACpB,YAAM,eAAe,IAAI,SAAS;AAChC,iBAAS,GAAG,IAAI;AAChB,aAAK,IAAI,OAAO,YAAY;AAAA,MAC9B;AACA,aAAO,KAAK,GAAG,OAAO,YAAY;AAAA,IACpC;AAAA,IAEA,IAAI,OAAO,UAAU;AACnB,UAAI,CAAC,KAAK,OAAO,KAAK,EAAG,QAAO;AAEhC,UAAI,CAAC,UAAU;AACb,eAAO,KAAK,OAAO,KAAK;AAAA,MAC1B,OAAO;AACL,aAAK,OAAO,KAAK,IAAI,KAAK,OAAO,KAAK,EAAE,OAAO,OAAK,MAAM,QAAQ;AAAA,MACpE;AAEA,aAAO;AAAA,IACT;AAAA,IAEA,KAAK,UAAU,MAAM;AACnB,UAAI,CAAC,KAAK,OAAO,KAAK,EAAG,QAAO;AAEhC,WAAK,OAAO,KAAK,EAAE,QAAQ,cAAY;AACrC,iBAAS,GAAG,IAAI;AAAA,MAClB,CAAC;AAED,aAAO;AAAA,IACT;AAAA,IAEA,qBAAqB;AACnB,WAAK,SAAS,CAAC;AACf,aAAO;AAAA,IACT;AAAA,EACF;;;AC7CA;;;ACFA;AACA;AACA;AACA;AACA;;;ACEO,WAAS,SAAS,MAAM,OAAO,KAAK;AACvC,QAAI;AACJ,WAAO,SAAS,oBAAoB,MAAM;AACtC,YAAM,QAAQ,MAAM;AAChB,qBAAa,OAAO;AACpB,aAAK,GAAG,IAAI;AAAA,MAChB;AACA,mBAAa,OAAO;AACpB,gBAAU,WAAW,OAAO,IAAI;AAAA,IACpC;AAAA,EACJ;AAwBO,WAAS,SAAS,aAAa,KAAK;AACvC,WAAO,OAAO,aAAa;AAAA,EAC/B;AAOO,WAAS,eAAe,UAAU,UAAU,KAAK;AACpD,QAAI,SAAS;AAEb,UAAM,UAAU,MAAM;AAClB,UAAI,CAAC,QAAQ;AACT,iBAAS;AACT,iBAAS;AAAA,MACb;AAAA,IACJ;AAEA,0BAAsB,OAAO;AAC7B,eAAW,SAAS,OAAO;AAAA,EAC/B;;;AClDA,iBAAsB,kBAAkB,OAAO,MAAM,UAAU,CAAC,GAAG;AAC/D,QAAI,CAAC,SAAS,MAAM,YAAY,SAAS;AACrC,aAAO;AAAA,IACX;AAEA,UAAM;AAAA,MACF,eAAe;AAAA,MACf,UAAU;AAAA,MACV;AAAA,MACA;AAAA,IACJ,IAAI;AAGJ,UAAM,aAAa,CAAC,MAAM;AAC1B,UAAM,eAAe,MAAM;AAC3B,UAAM,gBAAgB,MAAM;AAG5B,QAAI,cAAc;AACd,YAAM,QAAQ;AAAA,IAClB;AAEA,WAAO,IAAI,QAAQ,CAAC,YAAY;AAC5B,YAAM,eAAe,MAAM;AACvB,YAAI;AAEA,cAAI,QAAQ,MAAM,cAAc;AAChC,cAAI,SAAS,MAAM,eAAe;AAGlC,cAAI,YAAY,QAAQ,UAAU;AAC9B,kBAAM,QAAQ,WAAW;AACzB,oBAAQ;AACR,qBAAS,KAAK,MAAM,SAAS,KAAK;AAAA,UACtC;AACA,cAAI,aAAa,SAAS,WAAW;AACjC,kBAAM,QAAQ,YAAY;AAC1B,qBAAS;AACT,oBAAQ,KAAK,MAAM,QAAQ,KAAK;AAAA,UACpC;AAGA,gBAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,iBAAO,QAAQ;AACf,iBAAO,SAAS;AAEhB,gBAAM,MAAM,OAAO,WAAW,IAAI;AAClC,cAAI,UAAU,OAAO,GAAG,GAAG,OAAO,MAAM;AAExC,gBAAM,UAAU,OAAO,UAAU,cAAc,OAAO;AAGtD,cAAI,cAAc;AACd,kBAAM,cAAc;AACpB,kBAAM,QAAQ;AACd,gBAAI,cAAc,CAAC,MAAM,QAAQ;AAC7B,oBAAM,KAAK,EAAE,MAAM,MAAM;AAAA,cAAC,CAAC;AAAA,YAC/B;AAAA,UACJ;AAEA,kBAAQ,OAAO;AAAA,QACnB,SAAS,OAAO;AAEZ,cAAI,cAAc;AACd,kBAAM,cAAc;AACpB,kBAAM,QAAQ;AACd,gBAAI,cAAc,CAAC,MAAM,QAAQ;AAC7B,oBAAM,KAAK,EAAE,MAAM,MAAM;AAAA,cAAC,CAAC;AAAA,YAC/B;AAAA,UACJ;AACA,kBAAQ,IAAI;AAAA,QAChB;AAAA,MACJ;AAEA,YAAM,WAAW,MAAM;AACnB,cAAM,oBAAoB,UAAU,QAAQ;AAE5C,8BAAsB,MAAM;AACxB,gCAAsB,YAAY;AAAA,QACtC,CAAC;AAAA,MACL;AAGA,YAAM,WAAW,KAAK,IAAI,MAAM,cAAc,IAAI;AAElD,UAAI,WAAW,OAAO,MAAM,cAAc,GAAG;AAEzC,qBAAa;AAAA,MACjB,WAAW,MAAM,cAAc,GAAG;AAE9B,cAAM,iBAAiB,UAAU,QAAQ;AACzC,cAAM,cAAc;AAAA,MACxB,OAAO;AAEH,cAAM,mBAAmB,MAAM;AAC3B,gBAAM,oBAAoB,kBAAkB,gBAAgB;AAC5D,gBAAM,iBAAiB,UAAU,QAAQ;AACzC,gBAAM,cAAc;AAAA,QACxB;AACA,cAAM,iBAAiB,kBAAkB,gBAAgB;AAAA,MAC7D;AAAA,IACJ,CAAC;AAAA,EACL;;;AFzGO,MAAM,aAAN,MAAiB;AAAA,IACpB,YAAY,QAAQ;AAChB,WAAK,SAAS;AACd,WAAK,UAAU;AACf,WAAK,WAAW,CAAC;AACjB,WAAK,cAAc;AACnB,WAAK,qBAAqB;AAC1B,WAAK,mBAAmB;AACxB,WAAK,WAAW;AAChB,WAAK,iBAAiB;AAEtB,WAAK,KAAK;AAAA,IACd;AAAA,IAEA,OAAO;AACH,WAAK,cAAc;AACnB,WAAK,eAAe;AAGpB,WAAK,eAAe;AACpB,WAAK,eAAe;AACpB,WAAK,aAAa;AAClB,WAAK,cAAc;AACnB,WAAK,uBAAuB;AAAA,IAChC;AAAA;AAAA,IAGA,gBAAgB;AACZ,aACK,kBAAkB,UAClB,UAAU,iBAAiB,KAC3B,UAAU,mBAAmB;AAAA,IAEtC;AAAA;AAAA,IAGA,aAAa,MAAM,QAAQ,YAAY,OAAO;AAC1C,YAAM,SAAS,SAAS;AACxB,YAAM,iBAAiB,KAAK,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,sBAAqB;AACtG,YAAM,eAAe,KAAK,OAAO,MAAM;AAGvC,UAAI,gBAAgB,KAAK,kBAAkB,KAAK,OAAO,WAAW;AAC9D,cAAM,0BAA0B,MAAM;AAClC,gBAAM,aAAa,OAAO,sBAAsB;AAChD,gBAAM,WAAW,KAAK,sBAAsB;AAC5C,gBAAM,gBAAgB,KAAK,OAAO,UAAU,sBAAsB;AAClE,gBAAM,iBAAiB,OAAO;AAG9B,gBAAM,gBAAgB,WAAW,OAAO,WAAW,QAAQ,IAAI,cAAc;AAC7E,gBAAM,YAAY,WAAW,MAAM,cAAc;AACjD,gBAAM,eAAe,WAAW,SAAS,cAAc;AAEvD,gBAAM,aAAa,WAAW,MAAM,cAAc;AAClD,gBAAM,aAAa,cAAc,SAAS,WAAW;AAGrD,cAAI,cAAc,SAAS,SAAS,MAAM,aAAa,YAAY;AAC/D,iBAAK,MAAM,SAAS,GAAG,qBAAc,SAAS,YAAY,GAAC;AAC3D,iBAAK,MAAM,MAAM;AACjB,iBAAK,UAAU,OAAO,mBAAmB;AAAA,UAC7C,OAAO;AAEH,iBAAK,MAAM,MAAM,GAAG,sBAAe,GAAC;AACpC,iBAAK,MAAM,SAAS;AACpB,iBAAK,UAAU,IAAI,mBAAmB;AAAA,UAC1C;AAGA,cAAI,gBAAgB;AAEhB,kBAAM,cAAc,WAAW,QAAQ,cAAc;AACrD,iBAAK,MAAM,QAAQ,GAAG,qBAAc,QAAQ,aAAW;AACvD,iBAAK,MAAM,OAAO;AAClB,iBAAK,MAAM,YAAY;AAAA,UAC3B,OAAO;AAEH,iBAAK,MAAM,OAAO,GAAG,sBAAa;AAClC,iBAAK,MAAM,QAAQ;AACnB,iBAAK,MAAM,YAAY;AAAA,UAC3B;AAAA,QACJ;AAEA,YAAI,WAAW;AACX,kCAAwB;AAAA,QAC5B,OAAO;AACH,gCAAsB,uBAAuB;AAAA,QACjD;AACA;AAAA,MACJ;AAEA,UAAI,QAAQ;AAER,cAAM,eAAe,KAAK,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,eAAc;AAE7F,cAAM,sBAAsB,MAAM;AAE9B,gBAAM,kBAAkB,OAAO;AAC/B,cAAI,CAAC,gBAAiB;AAEtB,gBAAM,aAAa,OAAO,sBAAsB;AAChD,gBAAM,aAAa,gBAAgB,sBAAsB;AACzD,gBAAM,WAAW,KAAK,sBAAsB;AAC5C,gBAAM,gBAAgB,OAAO;AAC7B,gBAAM,iBAAiB,OAAO;AAG9B,cAAI,cAAc;AAEd,kBAAM,gBAAgB,WAAW,OAAO,WAAW,QAAQ,IAAI,WAAW;AAG1E,iBAAK,MAAM,OAAO,GAAG,sBAAa;AAClC,iBAAK,MAAM,QAAQ;AACnB,iBAAK,MAAM,YAAY;AACvB;AAAA,UACJ;AAGA,cAAI,SAAS,QAAQ,eAAe;AAChC,iBAAK,MAAM,OAAO;AAClB,iBAAK,MAAM,QAAQ;AACnB,iBAAK,MAAM,YAAY;AAAA,UAC3B;AAEA,cAAI,SAAS,OAAO,GAAG;AACnB,iBAAK,MAAM,OAAO;AAClB,iBAAK,MAAM,QAAQ;AACnB,iBAAK,MAAM,YAAY;AAAA,UAC3B;AAGA,cAAI,SAAS,MAAM,IAAI;AACnB,iBAAK,MAAM,MAAM;AAGjB,iBAAK,MAAM,SAAS;AAAA,UACxB;AAEA,cAAI,SAAS,SAAS,iBAAiB,IAAI;AACvC,iBAAK,MAAM,SAAS;AACpB,iBAAK,MAAM,MAAM;AAAA,UACrB;AAAA,QACJ;AAEA,YAAI,WAAW;AACX,8BAAoB;AAAA,QACxB,OAAO;AACH,gCAAsB,mBAAmB;AAAA,QAC7C;AACA;AAAA,MACJ;AAMA,YAAM,gBAAgB,MAAM;AACxB,cAAM,aAAa,OAAO,sBAAsB;AAChD,cAAM,WAAW,KAAK,sBAAsB;AAC5C,cAAM,gBAAgB,OAAO;AAC7B,cAAM,iBAAiB,OAAO;AAG9B,cAAM,kBAAkB,OAAO;AAC/B,YAAI,CAAC,gBAAiB;AAEtB,cAAM,aAAa,gBAAgB,sBAAsB;AAGzD,cAAM,gBAAgB,WAAW,OAAO,WAAW,QAAQ,IAAI,WAAW;AAC1E,cAAM,eAAe,WAAW,SAAS,WAAW;AACpD,cAAM,YAAY,WAAW,MAAM,WAAW;AAE9C,cAAM,aAAa,WAAW;AAC9B,cAAM,aAAa,iBAAiB,WAAW;AAG/C,YAAI,UAAU,YAAY,SAAS,SAAS;AAC5C,YAAI,aAAa;AAGjB,YAAI,aAAa,SAAS,SAAS,MAAM,aAAa,YAAY;AAC9D,oBAAU;AAIV,gBAAM,eAAe,WAAW,SAAS,WAAW;AACpD,uBAAa,eAAe,eAAe;AAC3C,eAAK,UAAU,IAAI,mBAAmB;AAAA,QAC1C,OAAO;AACH,eAAK,UAAU,OAAO,mBAAmB;AAAA,QAC7C;AAGA,YAAI,WAAW;AACf,YAAI,YAAY;AAChB,YAAI,aAAa;AAGjB,YAAI,gBAAgB;AAChB,qBAAW;AACX,sBAAY;AACZ,uBAAa;AAAA,QACjB,OAAO;AAEH,qBAAW,gBAAgB,SAAS,QAAQ;AAG5C,gBAAM,mBAAmB,WAAW,OAAO,WAAW,QAAQ,IAAI,SAAS,QAAQ;AACnF,cAAI,mBAAmB,IAAI;AAEvB,uBAAW;AACX,yBAAa;AAAA,UACjB,WAAW,mBAAmB,SAAS,QAAQ,gBAAgB,IAAI;AAE/D,uBAAW;AACX,wBAAY;AACZ,yBAAa;AAAA,UACjB,OAAO;AAEH,uBAAW;AACX,yBAAa;AAAA,UACjB;AAAA,QACJ;AAGA,YAAI,YAAY,MAAM;AAClB,eAAK,MAAM,MAAM,GAAG,gBAAO;AAC3B,eAAK,MAAM,SAAS;AAAA,QACxB,WAAW,eAAe,MAAM;AAC5B,eAAK,MAAM,MAAM;AACjB,eAAK,MAAM,SAAS,GAAG,mBAAU;AAAA,QACrC;AAEA,YAAI,aAAa,QAAQ;AACrB,eAAK,MAAM,OAAO,GAAG,iBAAQ;AAC7B,eAAK,MAAM,QAAQ;AAAA,QACvB,OAAO;AACH,eAAK,MAAM,OAAO;AAClB,eAAK,MAAM,QAAQ,GAAG,kBAAS;AAAA,QACnC;AAEA,aAAK,MAAM,YAAY;AAAA,MAC3B;AAEA,UAAI,WAAW;AAEX,sBAAc;AAAA,MAClB,OAAO;AAEH,8BAAsB,MAAM;AACxB,qBAAW,eAAe,EAAE;AAAA,QAChC,CAAC;AAAA,MACL;AAAA,IACJ;AAAA;AAAA,IAGA,kBAAkB,MAAM,QAAQ;AAE5B,UAAI,CAAC,KAAK,IAAI;AACV,aAAK,KAAK,eAAe,YAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,GAAG,CAAC;AAAA,MACnE;AAGA,aAAO,aAAa,iBAAiB,KAAK,EAAE;AAC5C,aAAO,aAAa,iBAAiB,MAAM;AAK3C,YAAM,eAAe,KAAK,OAAO,MAAM;AACvC,UAAI,cAAc;AAEd,aAAK,OAAO,UAAU,YAAY,IAAI;AAEtC,aAAK,QAAQ,gBAAgB,OAAO,aAAa,YAAY,KAAK;AAAA,MACtE,OAAO;AAEH,eAAO,sBAAsB,YAAY,IAAI;AAAA,MACjD;AAAA,IACJ;AAAA;AAAA,IAGA,uBAAuB,MAAM,QAAQ,4BAA4B,OAAO;AAEpE,UAAI,KAAK,YAAY,KAAK,aAAa,QAAQ,KAAK,gBAAgB;AAEhE,YAAI,KAAK,eAAe,oBAAoB;AACxC,eAAK,eAAe,oBAAoB,QAAQ,KAAK,eAAe,kBAAkB;AACtF,iBAAO,KAAK,eAAe;AAAA,QAC/B;AACA,YAAI,KAAK,eAAe,yBAAyB;AAC7C,eAAK,eAAe,oBAAoB,aAAa,KAAK,eAAe,uBAAuB;AAChG,iBAAO,KAAK,eAAe;AAAA,QAC/B;AAGA,YAAI,KAAK,YAAY,SAAS,SAAS,KAAK,QAAQ,GAAG;AACnD,eAAK,SAAS,OAAO;AAAA,QACzB,WAAW,KAAK,YAAY,KAAK,SAAS,YAAY;AAClD,eAAK,SAAS,WAAW,YAAY,KAAK,QAAQ;AAAA,QACtD;AACA,YAAI,KAAK,gBAAgB;AACrB,eAAK,eAAe,aAAa,iBAAiB,OAAO;AAAA,QAC7D;AAAA,MACJ;AAGA,WAAK,WAAW;AAChB,WAAK,iBAAiB;AAGtB,WAAK,aAAa,MAAM,MAAM;AAG9B,UAAI,QAAQ;AACR,eAAO,aAAa,iBAAiB,MAAM;AAAA,MAC/C;AAIA,UAAI,mBAAmB;AACvB,UAAI,oBAAoB;AAExB,YAAM,wBAAwB,MAAM;AAChC,2BAAmB;AAEnB,4BAAoB;AACpB,mBAAW,MAAM;AACb,6BAAmB;AACnB,8BAAoB;AAAA,QACxB,GAAG,GAAG;AAAA,MACV;AACA,aAAO,iBAAiB,aAAa,qBAAqB;AAC1D,aAAO,0BAA0B;AAEjC,YAAM,mBAAmB,CAAC,MAAM;AAE5B,YAAI,CAAC,qBAAqB,kBAAkB;AACxC;AAAA,QACJ;AAGA,YAAI,KAAK,aAAa,MAAM;AACxB;AAAA,QACJ;AAGA,cAAM,gBAAgB,EAAE;AAGxB,8BAAsB,MAAM;AACxB,qBAAW,MAAM;AA9WjC;AAgXoB,gBAAI,CAAC,qBAAqB,KAAK,aAAa,MAAM;AAC9C;AAAA,YACJ;AAEA,kBAAM,gBAAgB,SAAS;AAG/B,gBAAI,KAAK,SAAS,aAAa,GAAG;AAC9B;AAAA,YACJ;AAGA,kBAAM,sBAAsB,KAAK,OAAO;AACxC,kBAAM,oBAAmB,UAAK,OAAO,sBAAZ,mBAA+B;AACxD,gBAAK,uBAAuB,oBAAoB,SAAS,aAAa,KACjE,oBAAoB,iBAAiB,SAAS,aAAa,GAAI;AAChE;AAAA,YACJ;AAGA,kBAAM,oBAAoB,KAAK,QAAQ,iBAAiB,QAAQ;AAChE,kBAAM,yBAAyB,MAAM,KAAK,iBAAiB,EAAE,SAAS,aAAa,KAAK,kBAAkB;AAG1G,kBAAM,+BAA+B,iBAAiB,MAAM,KAAK,iBAAiB,EAAE,SAAS,aAAa,KAAK,kBAAkB;AAGjI,gBAAI,0BAA0B,8BAA8B;AAExD,kBAAI,KAAK,aAAa,MAAM;AACxB;AAAA,cACJ;AAGA,kBAAI,QAAQ,SAAS,SAAS,IAAI,GAAG;AACjC,qBAAK,OAAO;AAAA,cAChB,WAAW,QAAQ,KAAK,YAAY;AAChC,qBAAK,WAAW,YAAY,IAAI;AAAA,cACpC;AACA,kBAAI,QAAQ;AACR,uBAAO,aAAa,iBAAiB,OAAO;AAAA,cAChD;AAEA,kBAAI,KAAK,aAAa,MAAM;AACxB,qBAAK,WAAW;AAChB,qBAAK,iBAAiB;AAAA,cAC1B;AACA,qBAAO,oBAAoB,QAAQ,gBAAgB;AACnD,qBAAO,oBAAoB,aAAa,qBAAqB;AAC7D,qBAAO,OAAO;AACd,qBAAO,OAAO;AAAA,YAClB;AAAA,UACJ,GAAG,EAAE;AAAA,QACT,CAAC;AAAA,MACL;AACA,aAAO,iBAAiB,QAAQ,gBAAgB;AAChD,aAAO,qBAAqB;AAE5B,YAAM,yBAAyB,MAAM;AACjC,aAAK,wBAAwB,MAAM,MAAM;AAAA,MAC7C;AAGA,UAAI,uBAAuB;AAC3B,UAAI,wBAAwB;AAE5B,iBAAW,MAAM;AACb,+BAAuB,CAAC,MAAM;AAE1B,cAAI,6BAA6B,KAAK,SAAS,EAAE,MAAM,GAAG;AACtD;AAAA,UACJ;AAIA,cAAI,KAAK,aAAa,QAAQ,CAAC,KAAK,SAAS,EAAE,MAAM,KAAK,CAAC,OAAO,SAAS,EAAE,MAAM,GAAG;AAClF,mCAAuB;AACvB,gBAAI,sBAAsB;AACtB,uBAAS,oBAAoB,SAAS,oBAAoB;AAAA,YAC9D;AACA,gBAAI,uBAAuB;AACvB,uBAAS,oBAAoB,WAAW,qBAAqB;AAAA,YACjE;AAAA,UACJ;AAAA,QACJ;AAEA,gCAAwB,CAAC,MAAM;AAC3B,cAAI,EAAE,QAAQ,YAAY,KAAK,aAAa,MAAM;AAC9C,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAElB,iBAAK,wBAAwB,MAAM,QAAQ,IAAI;AAC/C,gBAAI,sBAAsB;AACtB,uBAAS,oBAAoB,SAAS,oBAAoB;AAAA,YAC9D;AACA,gBAAI,uBAAuB;AACvB,uBAAS,oBAAoB,WAAW,qBAAqB;AAAA,YACjE;AAAA,UACJ;AAAA,QACJ;AAEA,iBAAS,iBAAiB,SAAS,oBAAoB;AACvD,iBAAS,iBAAiB,WAAW,qBAAqB;AAAA,MAC9D,GAAG,GAAG;AAAA,IACV;AAAA;AAAA,IAGA,wBAAwB,MAAM,QAAQ,cAAc,MAAM;AACtD,UAAI,MAAM;AAEN,YAAI,SAAS,SAAS,IAAI,GAAG;AACzB,eAAK,OAAO;AAAA,QAChB,WAAW,KAAK,YAAY;AAExB,eAAK,WAAW,YAAY,IAAI;AAAA,QACpC;AAAA,MACJ;AACA,UAAI,QAAQ;AACR,eAAO,aAAa,iBAAiB,OAAO;AAI5C,YAAI,QAAQ,KAAK,IAAI;AACjB,iBAAO,gBAAgB,eAAe;AAAA,QAC1C;AAEA,YAAI,aAAa;AAGb,gCAAsB,MAAM;AACxB,uBAAW,MAAM;AACb,kBAAI,UAAU,SAAS,SAAS,MAAM,GAAG;AACrC,uBAAO,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cACxC;AAAA,YACJ,GAAG,CAAC;AAAA,UACR,CAAC;AAAA,QACL;AAAA,MACJ;AAEA,UAAI,KAAK,aAAa,MAAM;AACxB,aAAK,WAAW;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAAA,IACJ;AAAA;AAAA,IAGA,gBAAgB;AACZ,UAAI,KAAK,YAAY,KAAK,gBAAgB;AAEtC,YAAI,KAAK,YAAY,SAAS,SAAS,KAAK,QAAQ,GAAG;AACnD,eAAK,SAAS,OAAO;AAAA,QACzB,WAAW,KAAK,YAAY,KAAK,SAAS,YAAY;AAClD,eAAK,SAAS,WAAW,YAAY,KAAK,QAAQ;AAAA,QACtD;AACA,YAAI,KAAK,gBAAgB;AACrB,eAAK,eAAe,aAAa,iBAAiB,OAAO;AAAA,QAC7D;AAEA,aAAK,WAAW;AAChB,aAAK,iBAAiB;AAAA,MAC1B;AAAA,IACJ;AAAA;AAAA,IAGA,6BAA6B,MAAM,QAAQ;AACvC,YAAM,YAAY,MAAM,KAAK,KAAK,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY,CAAC;AAEnG,UAAI,UAAU,WAAW,EAAG;AAE5B,YAAM,gBAAgB,CAAC,MAAM;AACzB,cAAM,eAAe,UAAU,QAAQ,SAAS,aAAa;AAE7D,gBAAQ,EAAE,KAAK;AAAA,UACX,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,kBAAM,aAAa,eAAe,KAAK,UAAU;AACjD,sBAAU,SAAS,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AACnD,sBAAU,SAAS,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAC5E;AAAA,UAEJ,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,kBAAM,aAAa,eAAe,IAAI,UAAU,UAAU,UAAU;AACpE,sBAAU,SAAS,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AACnD,sBAAU,SAAS,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAC5E;AAAA,UAEJ,KAAK;AAAA,UACL,KAAK;AAED,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB;AAAA,UAEJ,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,sBAAU,CAAC,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AAC3C,sBAAU,CAAC,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AACpE;AAAA,UAEJ,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,sBAAU,UAAU,SAAS,CAAC,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AAC9D,sBAAU,UAAU,SAAS,CAAC,EAAE,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AACvF;AAAA,UAEJ,KAAK;AAAA,UACL,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,gBAAI,SAAS,iBAAiB,UAAU,SAAS,SAAS,aAAa,GAAG;AACtE,uBAAS,cAAc,MAAM;AAE7B,2BAAa,QAAQ,EAAE,OAAO,EAAE,CAAC;AAAA,YACrC;AACA;AAAA,UAEJ,KAAK;AACD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAElB,iBAAK,wBAAwB,MAAM,QAAQ,IAAI;AAC/C;AAAA,QACR;AAAA,MACJ;AAEA,WAAK,iBAAiB,WAAW,aAAa;AAAA,IAClD;AAAA,IAEA,gBAAgB;AACZ,WAAK,UAAU,SAAS,cAAc,OAAO;AAAA,QACzC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,cAAc,IAAI;AAAA,QAC3C;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IAEA,iBAAiB;AAnmBrB;AAqmBQ,YAAM,sBAAsB,SAAS,cAAc,OAAO;AAAA,QACtD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,UAAI,KAAK,OAAO,QAAQ,aAAa;AACjC,aAAK,kBAAkB;AACvB,4BAAoB,YAAY,KAAK,SAAS,QAAQ;AAAA,MAC1D;AAGA,UAAI,KAAK,OAAO,QAAQ,eAAe,KAAK,OAAO,QAAQ,UAAU;AACjE,4BAAoB,YAAY,KAAK,kBAAkB,CAAC;AAAA,MAC5D;AAEA,WAAK,QAAQ,YAAY,mBAAmB;AAG5C,YAAM,kBAAkB,SAAS,cAAc,OAAO;AAAA,QAClD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,cAAc,SAAS,cAAc,OAAO;AAAA,QAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,UAAI,KAAK,OAAO,iBAAiB;AAC7B,oBAAY,YAAY,KAAK,qBAAqB,CAAC;AAAA,MACvD;AAGA,UAAI,KAAK,OAAO,QAAQ,iBAAiB;AACrC,oBAAY,YAAY,KAAK,sBAAsB,CAAC;AAAA,MACxD;AAGA,kBAAY,YAAY,KAAK,oBAAoB,CAAC;AAGlD,UAAI,KAAK,OAAO,iBAAiB;AAC7B,oBAAY,YAAY,KAAK,iBAAiB,CAAC;AAAA,MACnD;AAGA,UAAI,CAAC,KAAK,OAAO,iBAAiB;AAC9B,oBAAY,YAAY,KAAK,mBAAmB,CAAC;AAAA,MACrD;AAGA,UAAI,CAAC,KAAK,OAAO,iBAAiB;AAC9B,oBAAY,YAAY,KAAK,oBAAoB,CAAC;AAAA,MACtD;AAGA,UAAI,KAAK,OAAO,QAAQ,eAAe;AAGnC,YAAI,KAAK,cAAc,GAAG;AACtB,sBAAY,YAAY,KAAK,iBAAiB,CAAC;AAAA,QACnD,OAAO;AACH,sBAAY,YAAY,KAAK,oBAAoB,CAAC;AAAA,QACtD;AAAA,MACJ;AAGA,WAAK,eAAe,SAAS,cAAc,OAAO;AAAA,QAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,cAAc,KAAK,iBAAiB;AAC1C,YAAM,cAAc,KAAK,iBAAiB;AAC1C,YAAM,mBAAmB,KAAK,iBAAiB;AAC/C,YAAM,sBAAsB,KAAK,oBAAoB;AAYrD,UAAI,KAAK,OAAO,QAAQ,kBAAkB,aAAa;AACnD,cAAM,MAAM,KAAK,qBAAqB;AACtC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,QAAQ,kBAAkB,aAAa;AACnD,cAAM,MAAM,KAAK,qBAAqB;AACtC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,QAAQ,sBAAsB,aAAa;AACvD,cAAM,MAAM,KAAK,yBAAyB;AAC1C,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAMA,YAAM,MAAM,KAAK,OAAO,mBACjB,gBAAK,OAAO,YAAZ,mBAAqB,iBAArB,4BAAoC,aACpC,UAAK,OAAO,YAAZ,mBAAqB,iBACrB,UAAK,OAAO,YAAZ,mBAAqB,UACrB,4BAAK,OAAO,YAAZ,mBAAqB,kBAArB,4BAAqC,cAArC,mBAAgD,iBAAhD,4BAA+D,aAC/D,sBAAK,OAAO,YAAZ,mBAAqB,kBAArB,4BAAqC,cAArC,mBAAgD,QAChD;AACP,YAAM,cAAc,OAAO,QAAQ,YAAY,IAAI,SAAS,OAAO;AACnE,YAAM,mBAAiB,gBAAK,OAAO,YAAZ,mBAAqB,YAArB,mBAA8B,mBAAkB;AACvE,YAAM,yBACD,CAAC,CAAC,KAAK,OAAO,QAAQ,mBAAmB,eACtC,CAAC,CAAC,KAAK,OAAO,QAAQ,wBAAwB,eAAe;AACrE,UAAI,KAAK,OAAO,QAAQ,eAAe,CAAC,wBAAwB;AAC5D,cAAM,MAAM,KAAK,kBAAkB;AACnC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,QAAQ,0BAA0B,qBAAqB;AACnE,cAAM,MAAM,KAAK,6BAA6B;AAC9C,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,QAAQ,oBAAoB,aAAa;AACrD,cAAM,MAAM,KAAK,uBAAuB;AACxC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,mBAAmB,KAAK,OAAO,QAAQ,yBAAyB,OAAO;AACnF,cAAM,MAAM,KAAK,2BAA2B;AAC5C,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,YAAM,kBAAkB,KAAK,gBAAgB;AAC7C,YAAM,0BAA0B,KAAK,OAAO,QAAQ,uBAAuB,SAAS;AACpF,YAAM,0BAA0B,KAAK,OAAO,QAAQ,2BAA2B;AAC/E,UAAI,yBAAyB;AAEzB,YAAI,CAAC,OAAO,MAAM,EAAE,SAAS,uBAAuB,GAAG;AACnD,gBAAM,SAAS,KAAK,yBAAyB;AAC7C,iBAAO,QAAQ,mBAAmB;AAClC,iBAAO,QAAQ,yBAAyB;AACxC,eAAK,aAAa,YAAY,MAAM;AAAA,QACxC;AAGA,YAAI,CAAC,QAAQ,MAAM,EAAE,SAAS,uBAAuB,GAAG;AACpD,gBAAM,cAAc,KAAK,mCAAmC;AAC5D,sBAAY,QAAQ,mBAAmB;AACvC,sBAAY,QAAQ,yBAAyB;AAC7C,eAAK,aAAa,YAAY,WAAW;AAAA,QAC7C;AAAA,MACJ;AAGA,UAAI,KAAK,OAAO,QAAQ,iBAAiB,kBAAkB;AACvD,cAAM,MAAM,KAAK,oBAAoB;AACrC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,UAAI,KAAK,OAAO,QAAQ,aAAa,6BAA6B,UAAU;AACxE,cAAM,MAAM,KAAK,gBAAgB;AACjC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAIA,YAAM,gBAAgB,KAAK,OAAO,QAAQ,QAAQ,YAAY,MAAM;AACpE,UAAI,KAAK,OAAO,QAAQ,oBAAoB,CAAC,eAAe;AACxD,cAAM,MAAM,KAAK,uBAAuB;AACxC,YAAI,QAAQ,mBAAmB;AAC/B,YAAI,QAAQ,yBAAyB;AACrC,aAAK,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,WAAK,qBAAqB,KAAK,yBAAyB;AACxD,WAAK,mBAAmB,MAAM,UAAU;AACxC,WAAK,aAAa,YAAY,KAAK,kBAAkB;AAErD,sBAAgB,YAAY,WAAW;AACvC,sBAAgB,YAAY,KAAK,YAAY;AAC7C,WAAK,QAAQ,YAAY,eAAe;AAGxC,WAAK,qBAAqB,eAAe;AAAA,IAC7C;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,qBAAqB,WAAW;AAC5B,YAAM,UAAU,UAAU,iBAAiB,QAAQ;AACnD,cAAQ,QAAQ,YAAU;AAEtB,YAAI,OAAO,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU,GAAG;AACrE;AAAA,QACJ;AAGA,YAAI,OAAO,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc,GAAG;AACzE;AAAA,QACJ;AAGA,YAAI,OAAO,aAAa,MAAM,MAAM,cAChC,OAAO,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,iBAAgB,KAC5E,OAAO,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,aAAY,KACxE,OAAO,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,4BAA2B,KACvF,OAAO,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,+BAA8B,KAC1F,OAAO,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,uBAAsB,GAAG;AACrF;AAAA,QACJ;AAEA,cAAM,YAAY,OAAO,aAAa,YAAY;AAClD,YAAI,WAAW;AAEX,mBAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAAA,QAC7E;AAAA,MACJ,CAAC;AAAA,IACL;AAAA;AAAA,IAGA,mBAAmB;AAn2BvB;AAq2BQ,YAAM,aAAa,KAAK,OAAO,QAAQ;AACvC,eAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AACxC,YAAI,WAAW,CAAC,EAAE,SAAS,WAAY,QAAO;AAAA,MAC9C;AAGJ,YAAM,WAAW,MAAM,KAAK,KAAK,OAAO,QAAQ,iBAAiB,wBAAwB,CAAC;AAC1F,UAAI,SAAS,SAAS,EAAG,QAAO;AAGhC,YAAM,WAAU,gBAAK,OAAO,oBAAZ,mBAA6B,oBAA7B;AAChB,WAAI,mCAAS,WAAU,MAAM,QAAQ,QAAQ,MAAM,GAAG;AAClD,eAAO,QAAQ,OAAO,KAAK,QAAK,uBAAG,UAAS,UAAU;AAAA,MAC1D;AAEA,aAAO;AAAA,IACX;AAAA,IAEA,mBAAmB;AAv3BvB;AAy3BQ,YAAM,aAAa,KAAK,OAAO,QAAQ;AACvC,eAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AACxC,YAAI,WAAW,CAAC,EAAE,SAAS,cAAc,WAAW,CAAC,EAAE,SAAS,YAAa,QAAO;AAAA,MACxF;AAGA,YAAM,WAAW,MAAM,KAAK,KAAK,OAAO,QAAQ,iBAAiB,OAAO,CAAC;AACzE,UAAI,SAAS,KAAK,QAAO,GAAG,aAAa,MAAM,MAAM,cAAc,GAAG,aAAa,MAAM,MAAM,WAAY,GAAG;AACtG,eAAO;AAAA,MACX;AAGJ,YAAM,WAAU,gBAAK,OAAO,oBAAZ,mBAA6B,oBAA7B;AAChB,WAAI,mCAAS,WAAU,MAAM,QAAQ,QAAQ,MAAM,GAAG;AAClD,eAAO,QAAQ,OAAO,KAAK,QAAK,uBAAG,UAAS,eAAc,uBAAG,UAAS,WAAW;AAAA,MACrF;AAEA,aAAO;AAAA,IACX;AAAA,IAEA,mBAAmB;AAEf,UAAI,KAAK,OAAO,YAAY,KAAK,OAAO,SAAS,cAAc;AAC3D,cAAM,YAAY,KAAK,OAAO,SAAS,aAAa;AACpD,eAAO,aAAa,UAAU,SAAS;AAAA,MAC3C;AACA,aAAO;AAAA,IACX;AAAA,IAEA,sBAAsB;AAElB,UAAI,KAAK,OAAO,uBAAuB,KAAK,OAAO,oBAAoB,SAAS,GAAG;AAC/E,eAAO;AAAA,MACX;AAGA,YAAM,aAAa,MAAM,KAAK,KAAK,OAAO,QAAQ,cAAc,CAAC,CAAC;AAClE,aAAO,WAAW,KAAK,WAAS,MAAM,SAAS,cAAc;AAAA,IACjE;AAAA,IAEA,kBAAkB;AAEd,YAAM,kBAAkB,KAAK,OAAO,mBAAmB,KAAK,OAAO,gBAAgB,SAAS;AAC5F,YAAM,qBAAqB,KAAK,OAAO,uBAAuB,OAAO,KAAK,KAAK,OAAO,mBAAmB,EAAE,SAAS;AACpH,aAAO,mBAAmB;AAAA,IAC9B;AAAA,IAEA,oBAAoB;AAChB,YAAM,oBAAoB,SAAS,cAAc,OAAO;AAAA,QACpD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,UACtC,iBAAiB;AAAA,UACjB,iBAAiB;AAAA,UACjB,iBAAiB;AAAA,UACjB,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AAGD,WAAK,SAAS,WAAW,SAAS,cAAc,OAAO;AAAA,QACnD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,WAAK,SAAS,SAAS,SAAS,cAAc,OAAO;AAAA,QACjD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,WAAK,SAAS,iBAAiB,SAAS,cAAc,OAAO;AAAA,QACzD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,WAAK,SAAS,kBAAkB,SAAS,cAAc,OAAO;AAAA,QAC1D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,WAAK,SAAS,kBAAkB,SAAS,cAAc,OAAO;AAAA,QAC1D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,eAAe;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,WAAK,SAAS,gBAAgB,YAAY,KAAK,SAAS,eAAe;AAGvE,WAAK,SAAS,sBAAsB,SAAS,cAAc,OAAO;AAAA,QAC9D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AACD,WAAK,SAAS,gBAAgB,YAAY,KAAK,SAAS,mBAAmB;AAE3E,wBAAkB,YAAY,KAAK,SAAS,QAAQ;AACpD,wBAAkB,YAAY,KAAK,SAAS,MAAM;AAClD,WAAK,SAAS,OAAO,YAAY,KAAK,SAAS,cAAc;AAC7D,wBAAkB,YAAY,KAAK,SAAS,eAAe;AAE3D,WAAK,SAAS,WAAW;AAGzB,WAAK,qBAAqB;AAG1B,WAAK,uBAAuB;AAAA,IAChC;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACnB,WAAK,wBAAwB,oBAAI,IAAI;AACrC,WAAK,eAAe;AACpB,WAAK,qBAAqB;AAC1B,WAAK,0BAA0B;AAC/B,WAAK,mBAAmB;AACxB,WAAK,oBAAoB;AACzB,WAAK,0BAA0B;AAI/B,YAAM,UAAU,KAAK,OAAO,WAAW,KAAK,OAAO,QAAQ,YAAY;AAEvE,UAAI,CAAC,SAAS;AACV;AAAA,MACJ;AAAA,IAIJ;AAAA;AAAA;AAAA;AAAA,IAKA,gCAAgC;AAjgCpC;AAkgCQ,UAAI,KAAK,wBAAyB;AAClC,UAAI,GAAC,gBAAK,WAAL,mBAAa,UAAb,mBAAoB,oBAAoB;AAE7C,YAAM,WAAW,KAAK,OAAO;AAC7B,YAAM,gBAAgB,YAAY,SAAS,SAAS,SAAS,MAAM,YAAY;AAC/E,YAAM,kBAAkB,iBACpB,SAAS,UAAU,KAAK,OAAO,WAC/B,CAAC,SAAS,OACV,OAAO,SAAS,SAAS;AAE7B,WAAK,mBAAmB,mBAAmB;AAC3C,UAAI,CAAC,KAAK,iBAAkB;AAE5B,YAAM,YAAY,SAAS,SAAS,KAAK,OAAO;AAChD,UAAI,WAAW;AACf,UAAI,UAAU,KAAK;AACf,mBAAW,UAAU;AAAA,MACzB,OAAO;AACH,cAAM,SAAS,UAAU,cAAc,QAAQ;AAC/C,YAAI,QAAQ;AACR,qBAAW,OAAO;AAAA,QACtB;AAAA,MACJ;AAEA,UAAI,CAAC,UAAU;AACX,aAAK,OAAO,IAAI,qCAAqC,MAAM;AAC3D,aAAK,mBAAmB;AACxB;AAAA,MACJ;AAGA,WAAK,eAAe,SAAS,cAAc,OAAO;AAClD,WAAK,aAAa,QAAQ;AAC1B,WAAK,aAAa,UAAU;AAC5B,WAAK,aAAa,cAAc;AAChC,WAAK,aAAa,MAAM,WAAW;AACnC,WAAK,aAAa,MAAM,aAAa;AACrC,WAAK,aAAa,MAAM,QAAQ;AAChC,WAAK,aAAa,MAAM,SAAS;AACjC,WAAK,aAAa,MAAM,MAAM;AAE9B,UAAI,UAAU,aAAa;AACvB,aAAK,aAAa,cAAc,UAAU;AAAA,MAC9C;AAEA,WAAK,aAAa,iBAAiB,SAAS,CAAC,MAAM;AAC/C,aAAK,OAAO,IAAI,iCAAiC,GAAG,MAAM;AAC1D,aAAK,mBAAmB;AAAA,MAC5B,CAAC;AAED,WAAK,aAAa,iBAAiB,kBAAkB,MAAM;AACvD,aAAK,oBAAoB;AAAA,MAC7B,GAAG,EAAE,MAAM,KAAK,CAAC;AAEjB,UAAI,KAAK,OAAO,WAAW;AACvB,aAAK,OAAO,UAAU,YAAY,KAAK,YAAY;AAAA,MACvD;AAEA,WAAK,aAAa,MAAM;AACxB,WAAK,oBAAoB;AACzB,WAAK,0BAA0B;AAAA,IACnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,MAAM,yBAAyB,MAAM;AACjC,UAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,cAAc;AAC9C,eAAO;AAAA,MACX;AAGA,UAAI,CAAC,KAAK,mBAAmB;AACzB,YAAI,KAAK,aAAa,aAAa,GAAG;AAElC,gBAAM,IAAI,QAAQ,CAAC,SAAS,WAAW;AACnC,kBAAM,UAAU,WAAW,MAAM;AAC7B,qBAAO,IAAI,MAAM,iCAAiC,CAAC;AAAA,YACvD,GAAG,GAAK;AAER,kBAAM,UAAU,MAAM;AAClB,2BAAa,OAAO;AACpB,mBAAK,aAAa,oBAAoB,cAAc,UAAU;AAC9D,mBAAK,aAAa,oBAAoB,WAAW,UAAU;AAC3D,mBAAK,aAAa,oBAAoB,SAAS,OAAO;AAAA,YAC1D;AAEA,kBAAM,aAAa,MAAM;AACrB,kBAAI,KAAK,aAAa,cAAc,GAAG;AACnC,wBAAQ;AACR,qBAAK,oBAAoB;AACzB,wBAAQ;AAAA,cACZ;AAAA,YACJ;AAEA,kBAAM,UAAU,MAAM;AAClB,sBAAQ;AACR,qBAAO,IAAI,MAAM,8BAA8B,CAAC;AAAA,YACpD;AAGA,gBAAI,KAAK,aAAa,cAAc,GAAG;AACnC,mBAAK,aAAa,iBAAiB,cAAc,UAAU;AAAA,YAC/D;AACA,iBAAK,aAAa,iBAAiB,WAAW,UAAU;AACxD,iBAAK,aAAa,iBAAiB,SAAS,OAAO;AAGnD,gBAAI,KAAK,aAAa,cAAc,GAAG;AACnC,yBAAW;AAAA,YACf;AAAA,UACJ,CAAC,EAAE,MAAM,MAAM;AACX,iBAAK,mBAAmB;AACxB,mBAAO;AAAA,UACX,CAAC;AAAA,QACL,OAAO;AACH,eAAK,oBAAoB;AAAA,QAC7B;AAAA,MACJ;AAGA,YAAM,WAAW,KAAK,MAAM,IAAI;AAChC,UAAI,KAAK,sBAAsB,IAAI,QAAQ,GAAG;AAC1C,eAAO,KAAK,sBAAsB,IAAI,QAAQ;AAAA,MAClD;AAIA,YAAM,UAAU,MAAM,kBAAkB,KAAK,cAAc,MAAM;AAAA,QAC7D,cAAc;AAAA,QACd,SAAS;AAAA,QACT,UAAU;AAAA,QACV,WAAW;AAAA,MACf,CAAC;AAED,UAAI,SAAS;AAET,YAAI,KAAK,sBAAsB,QAAQ,IAAI;AAEvC,gBAAM,WAAW,KAAK,sBAAsB,KAAK,EAAE,KAAK,EAAE;AAC1D,eAAK,sBAAsB,OAAO,QAAQ;AAAA,QAC9C;AACA,aAAK,sBAAsB,IAAI,UAAU,OAAO;AAAA,MACpD;AAEA,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,MAAM,uBAAuB,MAAM;AAC/B,UAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,SAAS,iBAAiB;AAC1D;AAAA,MACJ;AAGA,UAAI,KAAK,yBAAyB;AAC9B,qBAAa,KAAK,uBAAuB;AAAA,MAC7C;AAGA,WAAK,0BAA0B,WAAW,YAAY;AAClD,YAAI;AACA,gBAAM,YAAY,MAAM,KAAK,yBAAyB,IAAI;AAC1D,cAAI,aAAa,KAAK,SAAS,iBAAiB;AAE5C,iBAAK,SAAS,gBAAgB,MAAM,kBAAkB,QAAQ,kBAAS;AACvE,iBAAK,SAAS,gBAAgB,MAAM,UAAU;AAC9C,iBAAK,SAAS,gBAAgB,MAAM,mBAAmB;AACvD,iBAAK,SAAS,gBAAgB,MAAM,qBAAqB;AAAA,UAC7D,OAAO;AAEH,gBAAI,KAAK,SAAS,iBAAiB;AAC/B,mBAAK,SAAS,gBAAgB,MAAM,UAAU;AAAA,YAClD;AAAA,UACJ;AACA,eAAK,qBAAqB;AAAA,QAC9B,SAAS,OAAO;AACZ,eAAK,OAAO,IAAI,oCAAoC,OAAO,MAAM;AACjE,cAAI,KAAK,SAAS,iBAAiB;AAC/B,iBAAK,SAAS,gBAAgB,MAAM,UAAU;AAAA,UAClD;AAAA,QACJ;AAAA,MACJ,GAAG,GAAG;AAAA,IACV;AAAA,IAEA,yBAAyB;AACrB,YAAM,WAAW,KAAK,SAAS;AAE/B,YAAM,iBAAiB,CAAC,YAAY;AAChC,cAAM,OAAO,SAAS,sBAAsB;AAE5C,cAAM,UAAU,KAAK,QAAQ,IAAI,KAAK,IAAI,GAAG,KAAK,IAAI,IAAI,UAAU,KAAK,QAAQ,KAAK,KAAK,CAAC,IAAI;AAChG,cAAM,WAAW,KAAK,OAAO,MAAM,YAAY;AAC/C,cAAM,OAAO,UAAU;AACvB,eAAO,EAAC,SAAS,KAAI;AAAA,MACzB;AAGA,eAAS,iBAAiB,aAAa,CAAC,MAAM;AAC1C,aAAK,qBAAqB;AAC1B,cAAM,EAAC,KAAI,IAAI,eAAe,EAAE,OAAO;AACvC,aAAK,OAAO,KAAK,IAAI;AAAA,MACzB,CAAC;AAED,eAAS,iBAAiB,aAAa,CAAC,MAAM;AAC1C,YAAI,KAAK,oBAAoB;AACzB,gBAAM,EAAC,KAAI,IAAI,eAAe,EAAE,OAAO;AACvC,eAAK,OAAO,KAAK,IAAI;AAAA,QACzB;AAAA,MACJ,CAAC;AAED,eAAS,iBAAiB,WAAW,MAAM;AACvC,aAAK,qBAAqB;AAAA,MAC9B,CAAC;AAGD,eAAS,iBAAiB,aAAa,CAAC,MAAM;AA/tCtD;AAguCY,YAAI,CAAC,KAAK,oBAAoB;AAC1B,gBAAM,EAAC,KAAI,IAAI,eAAe,EAAE,OAAO;AACvC,gBAAM,OAAO,SAAS,sBAAsB;AAC5C,gBAAM,OAAO,EAAE,UAAU,KAAK;AAG9B,eAAK,SAAS,oBAAoB,cAAc,UAAU,WAAW,IAAI;AAGzE,eAAK,SAAS,gBAAgB,MAAM,OAAO,GAAG,aAAI;AAClD,eAAK,SAAS,gBAAgB,MAAM,UAAU;AAI9C,cAAI,GAAC,gBAAK,WAAL,mBAAa,UAAb,mBAAoB,qBAAoB;AACzC,gBAAI,KAAK,SAAS,iBAAiB;AAC/B,mBAAK,SAAS,gBAAgB,MAAM,UAAU;AAAA,YAClD;AACA;AAAA,UACJ;AAEA,eAAK,8BAA8B;AACnC,cAAI,KAAK,kBAAkB;AACvB,iBAAK,uBAAuB,IAAI;AAAA,UACpC,WAAW,KAAK,SAAS,iBAAiB;AACtC,iBAAK,SAAS,gBAAgB,MAAM,UAAU;AAAA,UAClD;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,eAAS,iBAAiB,cAAc,MAAM;AAC1C,aAAK,SAAS,gBAAgB,MAAM,UAAU;AAC9C,YAAI,KAAK,yBAAyB;AAC9B,uBAAa,KAAK,uBAAuB;AAAA,QAC7C;AAAA,MACJ,CAAC;AAGD,eAAS,iBAAiB,WAAW,CAAC,MAAM;AACxC,YAAI,EAAE,QAAQ,aAAa;AACvB,YAAE,eAAe;AACjB,eAAK,OAAO,aAAa,CAAC;AAAA,QAC9B,WAAW,EAAE,QAAQ,cAAc;AAC/B,YAAE,eAAe;AACjB,eAAK,OAAO,YAAY,CAAC;AAAA,QAC7B;AAAA,MACJ,CAAC;AAGD,eAAS,iBAAiB,cAAc,CAAC,MAAM;AAC3C,aAAK,qBAAqB;AAC1B,cAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,cAAM,EAAC,KAAI,IAAI,eAAe,MAAM,OAAO;AAC3C,aAAK,OAAO,KAAK,IAAI;AAAA,MACzB,CAAC;AAED,eAAS,iBAAiB,aAAa,CAAC,MAAM;AAC1C,YAAI,KAAK,oBAAoB;AACzB,YAAE,eAAe;AACjB,gBAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,gBAAM,EAAC,KAAI,IAAI,eAAe,MAAM,OAAO;AAC3C,eAAK,OAAO,KAAK,IAAI;AAAA,QACzB;AAAA,MACJ,CAAC;AAED,eAAS,iBAAiB,YAAY,MAAM;AACxC,aAAK,qBAAqB;AAAA,MAC9B,CAAC;AAAA,IACL;AAAA,IAEA,wBAAwB;AACpB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,aAAa;AAAA,QACtC;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,MAAM,CAAC;AAE5C,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,OAAO;AAAA,MACvB,CAAC;AAED,WAAK,SAAS,YAAY;AAC1B,aAAO;AAAA,IACX;AAAA,IAEA,sBAAsB;AAClB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,gBAAgB;AAAA,QACzC;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,SAAS,CAAC;AAE/C,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,KAAK,CAAC;AAClB,aAAK,OAAO,KAAK;AAAA,MACrB,CAAC;AAED,aAAO;AAAA,IACX;AAAA,IAEA,uBAAuB;AACnB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,QAC1C;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,cAAc,CAAC;AAEpD,aAAO,iBAAiB,SAAS,MAAM;AACnC,YAAI,KAAK,OAAO,iBAAiB;AAC7B,eAAK,OAAO,gBAAgB,SAAS;AAAA,QACzC;AAAA,MACJ,CAAC;AAGD,YAAM,cAAc,MAAM;AACtB,YAAI,KAAK,OAAO,iBAAiB;AAC7B,iBAAO,WAAW,CAAC,KAAK,OAAO,gBAAgB,YAAY,KAAK,CAAC,KAAK,OAAO,gBAAgB,QAAQ;AAAA,QACzG;AAAA,MACJ;AACA,WAAK,OAAO,GAAG,uBAAuB,WAAW;AACjD,kBAAY;AAEZ,WAAK,SAAS,WAAW;AACzB,aAAO;AAAA,IACX;AAAA,IAEA,mBAAmB;AACf,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,aAAa;AAAA,QACtC;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,UAAU,CAAC;AAEhD,aAAO,iBAAiB,SAAS,MAAM;AACnC,YAAI,KAAK,OAAO,iBAAiB;AAC7B,eAAK,OAAO,gBAAgB,KAAK;AAAA,QACrC;AAAA,MACJ,CAAC;AAGD,YAAM,cAAc,MAAM;AACtB,YAAI,KAAK,OAAO,iBAAiB;AAC7B,iBAAO,WAAW,CAAC,KAAK,OAAO,gBAAgB,QAAQ,KAAK,CAAC,KAAK,OAAO,gBAAgB,QAAQ;AAAA,QACrG;AAAA,MACJ;AACA,WAAK,OAAO,GAAG,uBAAuB,WAAW;AACjD,kBAAY;AAEZ,WAAK,SAAS,OAAO;AACrB,aAAO;AAAA,IACX;AAAA,IAEA,6BAA6B;AAEzB,YAAM,UAAU,KAAK,OAAO,kBAAkB,GAAG,YAAK,OAAO,gBAAgB,UAAQ,YAAW;AAEhG,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,UACtC,iBAAiB;AAAA,UACjB,gBAAgB;AAAA,UAChB,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,UAAU,CAAC;AAEhD,aAAO,iBAAiB,SAAS,MAAM;AACnC,YAAI,KAAK,OAAO,iBAAiB;AAC7B,eAAK,OAAO,gBAAgB,YAAY;AAAA,QAC5C;AAAA,MACJ,CAAC;AAED,WAAK,SAAS,iBAAiB;AAC/B,aAAO;AAAA,IACX;AAAA,IAEA,qBAAqB;AACjB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,wBAAwB,EAAE,SAAS,GAAG,CAAC;AAAA,QAChE;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,QAAQ,CAAC;AAE9C,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,aAAa,EAAE;AAAA,MAC/B,CAAC;AAED,aAAO;AAAA,IACX;AAAA,IAEA,sBAAsB;AAClB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,yBAAyB,EAAE,SAAS,GAAG,CAAC;AAAA,QACjE;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,SAAS,CAAC;AAE/C,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,YAAY,EAAE;AAAA,MAC9B,CAAC;AAED,aAAO;AAAA,IACX;AAAA,IAEA,mBAAmB;AAEf,YAAM,aAAa,SAAS,cAAc,UAAU;AAAA,QAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,aAAa;AAAA,QACtC;AAAA,MACJ,CAAC;AAED,iBAAW,YAAY,kBAAkB,YAAY,CAAC;AAGtD,iBAAW,iBAAiB,SAAS,MAAM;AACvC,aAAK,OAAO,WAAW;AAAA,MAC3B,CAAC;AAED,WAAK,SAAS,OAAO;AAErB,aAAO;AAAA,IACX;AAAA,IAEA,sBAAsB;AAElB,YAAM,aAAa,SAAS,cAAc,UAAU;AAAA,QAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,eAAe;AAAA,UACpC,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,iBAAW,YAAY,kBAAkB,YAAY,CAAC;AAGtD,iBAAW,iBAAiB,eAAe,CAAC,MAAM;AAC9C,UAAE,eAAe;AACjB,aAAK,OAAO,WAAW;AAAA,MAC3B,CAAC;AAED,iBAAW,iBAAiB,SAAS,MAAM;AACvC,aAAK,iBAAiB,UAAU;AAAA,MACpC,CAAC;AAED,WAAK,SAAS,OAAO;AAErB,aAAO;AAAA,IACX;AAAA,IAEA,iBAAiB,QAAQ;AAErB,YAAM,iBAAiB,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AAC/F,UAAI,gBAAgB;AAChB,uBAAe,OAAO;AACtB,eAAO,aAAa,iBAAiB,OAAO;AAC5C;AAAA,MACJ;AAGA,YAAM,aAAa,SAAS,cAAc,OAAO;AAAA,QAC7C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,iBAAgB,YAAK,OAAO,QAAQ,aAAW;AAAA,MAChG,CAAC;AAED,YAAM,eAAe,SAAS,cAAc,OAAO;AAAA,QAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,eAAe;AAAA,UACpC,iBAAiB;AAAA,UACjB,iBAAiB;AAAA,UACjB,iBAAiB,OAAO,KAAK,MAAM,KAAK,OAAO,MAAM,SAAS,GAAG,CAAC;AAAA,UAClE,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AAED,YAAM,cAAc,SAAS,cAAc,OAAO;AAAA,QAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAED,YAAM,aAAa,SAAS,cAAc,OAAO;AAAA,QAC7C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,uBAAuB,KAAK,OAAO,MAAM,SAAS;AACxD,iBAAW,MAAM,SAAS,GAAG,6BAAoB;AAEjD,YAAM,eAAe,SAAS,cAAc,OAAO;AAAA,QAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAED,kBAAY,YAAY,UAAU;AAClC,iBAAW,YAAY,YAAY;AACnC,mBAAa,YAAY,WAAW;AACpC,iBAAW,YAAY,YAAY;AAGnC,YAAM,eAAe,CAAC,YAAY;AAC9B,cAAM,OAAO,YAAY,sBAAsB;AAC/C,cAAM,UAAU,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,KAAM,UAAU,KAAK,OAAO,KAAK,MAAO,CAAC;AACjF,aAAK,OAAO,UAAU,OAAO;AAAA,MACjC;AAGA,mBAAa,iBAAiB,aAAa,CAAC,MAAM;AAC9C,UAAE,gBAAgB;AAClB,UAAE,eAAe;AACjB,aAAK,mBAAmB;AACxB,qBAAa,EAAE,OAAO;AAAA,MAC1B,CAAC;AAED,eAAS,iBAAiB,aAAa,CAAC,MAAM;AAC1C,YAAI,KAAK,kBAAkB;AACvB,uBAAa,EAAE,OAAO;AAAA,QAC1B;AAAA,MACJ,CAAC;AAED,eAAS,iBAAiB,WAAW,MAAM;AACvC,aAAK,mBAAmB;AAAA,MAC5B,CAAC;AAGD,mBAAa,iBAAiB,cAAc,CAAC,MAAM;AAC/C,UAAE,gBAAgB;AAClB,UAAE,eAAe;AACjB,aAAK,mBAAmB;AACxB,cAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,qBAAa,MAAM,OAAO;AAAA,MAC9B,GAAG,EAAE,SAAS,MAAM,CAAC;AAErB,mBAAa,iBAAiB,aAAa,CAAC,MAAM;AAC9C,YAAI,KAAK,kBAAkB;AACvB,YAAE,eAAe;AACjB,gBAAM,QAAQ,EAAE,QAAQ,CAAC;AACzB,uBAAa,MAAM,OAAO;AAAA,QAC9B;AAAA,MACJ,GAAG,EAAE,SAAS,MAAM,CAAC;AAErB,mBAAa,iBAAiB,YAAY,CAAC,MAAM;AAC7C,UAAE,gBAAgB;AAClB,UAAE,eAAe;AACjB,aAAK,mBAAmB;AAAA,MAC5B,GAAG,EAAE,SAAS,MAAM,CAAC;AAErB,mBAAa,iBAAiB,eAAe,MAAM;AAC/C,aAAK,mBAAmB;AAAA,MAC5B,CAAC;AAGD,mBAAa,iBAAiB,WAAW,CAAC,MAAM;AAC5C,YAAI,EAAE,QAAQ,WAAW;AACrB,YAAE,eAAe;AACjB,eAAK,OAAO,UAAU,KAAK,IAAI,GAAG,KAAK,OAAO,MAAM,SAAS,GAAG,CAAC;AAAA,QACrE,WAAW,EAAE,QAAQ,aAAa;AAC9B,YAAE,eAAe;AACjB,eAAK,OAAO,UAAU,KAAK,IAAI,GAAG,KAAK,OAAO,MAAM,SAAS,GAAG,CAAC;AAAA,QACrE,WAAW,EAAE,QAAQ,UAAU;AAC3B,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,eAAK,wBAAwB,YAAY,QAAQ,IAAI;AAAA,QACzD;AAAA,MACJ,CAAC;AAGD,iBAAW,iBAAiB,SAAS,CAAC,MAAM;AACxC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAGD,iBAAW,iBAAiB,cAAc,CAAC,MAAM;AAC7C,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,iBAAW,iBAAiB,aAAa,CAAC,MAAM;AAC5C,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,iBAAW,iBAAiB,YAAY,CAAC,MAAM;AAC3C,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAGD,iBAAW,MAAM,aAAa;AAC9B,iBAAW,MAAM,UAAU;AAG3B,WAAK,kBAAkB,YAAY,MAAM;AAGzC,WAAK,aAAa,YAAY,QAAQ,IAAI;AAG1C,4BAAsB,MAAM;AACxB,mBAAW,MAAM,aAAa;AAAA,MAClC,CAAC;AAED,WAAK,SAAS,eAAe;AAC7B,WAAK,SAAS,aAAa;AAG3B,mBAAa,cAAc,EAAE,OAAO,GAAG,CAAC;AAGxC,WAAK,uBAAuB,YAAY,QAAQ,IAAI;AAAA,IACxD;AAAA,IAEA,oBAAoB;AAChB,YAAM,YAAY,SAAS,cAAc,OAAO;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,cAAc;AAAA,QACvC;AAAA,MACJ,CAAC;AAGD,WAAK,SAAS,qBAAqB,SAAS,cAAc,QAAQ;AAAA,QAC9D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,oBAAoB,SAAS,cAAc,QAAQ;AAAA,QACrD,aAAa;AAAA,QACb,YAAY;AAAA,UACR,eAAe;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,YAAM,wBAAwB,SAAS,cAAc,QAAQ;AAAA,QACzD,WAAW;AAAA,QACX,aAAa,KAAK,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC;AAAA,MACpD,CAAC;AAED,WAAK,SAAS,mBAAmB,YAAY,iBAAiB;AAC9D,WAAK,SAAS,mBAAmB,YAAY,qBAAqB;AAClE,WAAK,SAAS,oBAAoB;AAClC,WAAK,SAAS,wBAAwB;AAEtC,YAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,QAC7C,aAAa;AAAA,QACb,YAAY;AAAA,UACR,eAAe;AAAA,QACnB;AAAA,MACJ,CAAC;AAGD,WAAK,SAAS,kBAAkB,SAAS,cAAc,QAAQ;AAAA,QAC3D,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,iBAAiB,SAAS,cAAc,QAAQ;AAAA,QAClD,aAAa;AAAA,QACb,YAAY;AAAA,UACR,eAAe;AAAA,QACnB;AAAA,MACJ,CAAC;AACD,YAAM,qBAAqB,SAAS,cAAc,QAAQ;AAAA,QACtD,WAAW;AAAA,QACX,aAAa,KAAK,EAAE,qBAAqB,IAAI,KAAK,EAAE,gBAAgB,EAAE,OAAO,EAAE,CAAC;AAAA,MACpF,CAAC;AAED,WAAK,SAAS,gBAAgB,YAAY,cAAc;AACxD,WAAK,SAAS,gBAAgB,YAAY,kBAAkB;AAC5D,WAAK,SAAS,iBAAiB;AAC/B,WAAK,SAAS,qBAAqB;AAEnC,gBAAU,YAAY,KAAK,SAAS,kBAAkB;AACtD,gBAAU,YAAY,SAAS;AAC/B,gBAAU,YAAY,KAAK,SAAS,eAAe;AAEnD,aAAO;AAAA,IACX;AAAA,IAEA,uBAAuB;AACnB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,UACtC,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,UAAU,CAAC;AAEhD,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,iBAAiB,MAAM;AAAA,MAChC,CAAC;AAED,WAAK,SAAS,WAAW;AACzB,aAAO;AAAA,IACX;AAAA,IAEA,iBAAiB,QAAQ;AAErB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAC/F,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAE5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,mBAAkB,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC9F,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,QAC1C;AAAA,MACJ,CAAC;AAGD,YAAM,gBAAgB,MAAM,KAAK,KAAK,OAAO,QAAQ,UAAU,EAAE;AAAA,QAC7D,WAAS,MAAM,SAAS;AAAA,MAC5B;AAEA,UAAI,cAAc,WAAW,GAAG;AAE5B,cAAM,iBAAiB,SAAS,cAAc,OAAO;AAAA,UACjD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,EAAE,mBAAmB;AAAA,UACvC,YAAY;AAAA,YACR,QAAQ;AAAA,UACZ;AAAA,UACA,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,QAC7C,CAAC;AACD,aAAK,YAAY,cAAc;AAAA,MACnC,OAAO;AACH,cAAM,eAAe,cAAc,CAAC;AAGpC,YAAI,aAAa,SAAS,YAAY;AAClC,uBAAa,OAAO;AAAA,QACxB;AAEA,YAAI,CAAC,aAAa,QAAQ,aAAa,KAAK,WAAW,GAAG;AAEtD,gBAAM,cAAc,SAAS,cAAc,OAAO;AAAA,YAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,KAAK,EAAE,wBAAwB;AAAA,YAC5C,YAAY;AAAA,cACR,QAAQ;AAAA,YACZ;AAAA,YACA,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,UAC7C,CAAC;AACD,eAAK,YAAY,WAAW;AAG5B,gBAAM,cAAc,MAAM;AAEtB,iBAAK,OAAO;AACZ,iBAAK,iBAAiB,MAAM;AAAA,UAChC;AAEA,uBAAa,iBAAiB,QAAQ,aAAa,EAAC,MAAM,KAAI,CAAC;AAG/D,qBAAW,MAAM;AACb,gBAAI,aAAa,QAAQ,aAAa,KAAK,SAAS,KAAK,SAAS,SAAS,IAAI,GAAG;AAC9E,mBAAK,OAAO;AACZ,mBAAK,iBAAiB,MAAM;AAAA,YAChC;AAAA,UACJ,GAAG,GAAG;AAAA,QACV,OAAO;AAEH,gBAAM,OAAO,aAAa;AAC1B,mBAAS,IAAI,GAAG,IAAI,KAAK,QAAQ,KAAK;AAClC,kBAAM,MAAM,KAAK,CAAC;AAClB,kBAAM,OAAO,SAAS,cAAc,UAAU;AAAA,cAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,YAAY;AAAA,gBACR,QAAQ;AAAA,gBACR,QAAQ;AAAA,gBACR,YAAY;AAAA,cAChB;AAAA,YACJ,CAAC;AAED,kBAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,cAC7C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,aAAa,UAAU,WAAW,IAAI,SAAS;AAAA,cAC/C,YAAY;AAAA,gBACR,cAAc,UAAU,eAAe,IAAI,SAAS;AAAA,cACxD;AAAA,YACJ,CAAC;AAED,kBAAM,aAAa,SAAS,cAAc,QAAQ;AAAA,cAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,aAAa,IAAI;AAAA,YACrB,CAAC;AAED,iBAAK,YAAY,SAAS;AAC1B,iBAAK,YAAY,SAAS,eAAe,GAAG,CAAC;AAC7C,iBAAK,YAAY,UAAU;AAE3B,iBAAK,iBAAiB,SAAS,MAAM;AACjC,mBAAK,OAAO,KAAK,IAAI,SAAS;AAC9B,mBAAK,wBAAwB,MAAM,MAAM;AAAA,YAC7C,CAAC;AAED,iBAAK,YAAY,IAAI;AAAA,UACzB;AAGA,eAAK,6BAA6B,MAAM,MAAM;AAG9C,qBAAW,MAAM;AACb,kBAAM,YAAY,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY;AACpF,gBAAI,WAAW;AACX,wBAAU,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC3C;AAAA,UACJ,GAAG,CAAC;AAAA,QACR;AAAA,MACJ;AAIA,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,UAAU;AAGrB,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,4BAAsB,MAAM;AACxB,aAAK,MAAM,aAAa;AAAA,MAC5B,CAAC;AAGD,WAAK,uBAAuB,MAAM,MAAM;AAAA,IAC5C;AAAA,IAEA,sBAAsB;AAClB,YAAM,YAAY,KAAK,EAAE,gBAAgB;AACzC,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,IAAI,CAAC;AAC1C,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAGzE,YAAM,cAAc,SAAS,cAAc,QAAQ;AAAA,QAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,aAAa;AAAA,MACjB,CAAC;AACD,aAAO,YAAY,WAAW;AAE9B,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,gBAAgB,MAAM;AAAA,MAC/B,CAAC;AAED,WAAK,SAAS,UAAU;AACxB,WAAK,SAAS,cAAc;AAG5B,iBAAW,MAAM,KAAK,uBAAuB,GAAG,GAAG;AAEnD,aAAO;AAAA,IACX;AAAA,IAEA,gBAAgB,QAAQ;AAEpB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,gBAAe;AAC9F,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAE5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,kBAAiB,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7F,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,gBAAgB;AAAA,QACzC;AAAA,MACJ,CAAC;AAGD,UAAI,KAAK,OAAO,YAAY,KAAK,OAAO,SAAS,cAAc;AAC3D,cAAM,YAAY,KAAK,OAAO,SAAS,aAAa;AACpD,cAAM,iBAAiB,KAAK,OAAO,SAAS,oBAAoB,KAAK,OAAO,SAAS,kBAAkB,IAAI;AAC3G,cAAM,QAAQ,KAAK,OAAO,SAAS,QAAQ;AAE3C,YAAI,UAAU,WAAW,GAAG;AAExB,gBAAM,gBAAgB,SAAS,cAAc,OAAO;AAAA,YAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,aAAa,KAAK,EAAE,oBAAoB;AAAA,YACxC,YAAY;AAAA,cACR,QAAQ;AAAA,YACZ;AAAA,YACA,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,UAC7C,CAAC;AACD,eAAK,YAAY,aAAa;AAAA,QAClC,OAAO;AACH,cAAI,aAAa;AAGjB,cAAI,OAAO;AACP,kBAAM,WAAW,SAAS,cAAc,UAAU;AAAA,cAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,aAAa,KAAK,EAAE,aAAa;AAAA,cACjC,YAAY;AAAA,gBACR,QAAQ;AAAA,gBACR,QAAQ;AAAA,gBACR,YAAY;AAAA,cAChB;AAAA,YACJ,CAAC;AAGD,kBAAM,SAAS,KAAK,OAAO,SAAS,OAAO,KAAK,OAAO,SAAS,IAAI,iBAAiB;AACrF,gBAAI,QAAQ;AACR,uBAAS,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AAC5E,uBAAS,YAAY,kBAAkB,OAAO,CAAC;AAC/C,2BAAa;AAAA,YACjB;AAEA,qBAAS,iBAAiB,SAAS,MAAM;AACrC,kBAAI,KAAK,OAAO,SAAS,eAAe;AACpC,qBAAK,OAAO,SAAS,cAAc,EAAE;AAAA,cACzC;AACA,mBAAK,wBAAwB,MAAM,MAAM;AAAA,YAC7C,CAAC;AAED,iBAAK,YAAY,QAAQ;AAAA,UAC7B;AAGA,oBAAU,QAAQ,aAAW;AACzB,kBAAM,OAAO,SAAS,cAAc,UAAU;AAAA,cAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,cAC7C,aAAa,QAAQ,QAAQ,GAAG,eAAQ,QAAM;AAAA,cAC9C,YAAY;AAAA,gBACR,QAAQ;AAAA,gBACR,QAAQ;AAAA,gBACR,YAAY;AAAA,cAChB;AAAA,YACJ,CAAC;AAGD,gBAAI,QAAQ,UAAU,gBAAgB;AAClC,mBAAK,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACxE,mBAAK,YAAY,kBAAkB,OAAO,CAAC;AAC3C,2BAAa;AAAA,YACjB;AAEA,iBAAK,iBAAiB,SAAS,MAAM;AACjC,kBAAI,KAAK,OAAO,SAAS,eAAe;AACpC,qBAAK,OAAO,SAAS,cAAc,QAAQ,KAAK;AAAA,cACpD;AACA,mBAAK,wBAAwB,MAAM,MAAM;AAAA,YAC7C,CAAC;AAED,iBAAK,YAAY,IAAI;AAAA,UACzB,CAAC;AAGD,eAAK,6BAA6B,MAAM,MAAM;AAG9C,qBAAW,MAAM;AACb,kBAAM,cAAc,cAAc,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY;AACpG,gBAAI,aAAa;AACb,0BAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC7C;AAAA,UACJ,GAAG,CAAC;AAAA,QACR;AAAA,MACJ,OAAO;AAEH,cAAM,gBAAgB,SAAS,cAAc,OAAO;AAAA,UAChD,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,EAAE,kBAAkB;AAAA,UACtC,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,QAC7C,CAAC;AACD,aAAK,YAAY,aAAa;AAAA,MAClC;AAIA,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,UAAU;AAGrB,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,4BAAsB,MAAM;AACxB,aAAK,MAAM,aAAa;AAAA,MAC5B,CAAC;AAGD,WAAK,uBAAuB,MAAM,MAAM;AAAA,IAC5C;AAAA,IAEA,2BAA2B;AACvB,YAAM,YAAY,KAAK,EAAE,uBAAuB;AAChD,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAGD,YAAM,WAAW,SAAS,cAAc,QAAQ;AAAA,QAC5C,aAAa;AAAA,QACb,OAAO;AAAA,UACH,UAAU;AAAA,UACV,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AACD,aAAO,YAAY,QAAQ;AAC3B,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAEzE,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,qBAAqB,MAAM;AAAA,MACpC,CAAC;AAED,WAAK,SAAS,eAAe;AAC7B,aAAO;AAAA,IACX;AAAA,IAEA,qBAAqB,QAAQ;AAEzB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,sBAAqB;AACpG,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAE5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,wBAAuB,YAAK,OAAO,QAAQ,aAAW,UAAS,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC3I,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,uBAAuB;AAAA,QAChD;AAAA,MACJ,CAAC;AAGD,WAAK,iBAAiB,SAAS,CAAC,MAAM;AAClC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAGD,UAAI,CAAC,KAAK,OAAO,kBAAkB,KAAK,OAAO,eAAe,OAAO,WAAW,GAAG;AAE/E,cAAM,eAAe,SAAS,cAAc,OAAO;AAAA,UAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,EAAE,mBAAmB;AAAA,UACvC,YAAY;AAAA,YACR,QAAQ;AAAA,UACZ;AAAA,UACA,OAAO,EAAC,SAAS,OAAO,QAAQ,WAAW,SAAS,YAAW;AAAA,QACnE,CAAC;AACD,aAAK,YAAY,YAAY;AAI7B,aAAK,MAAM,aAAa;AACxB,aAAK,MAAM,UAAU;AAGrB,aAAK,kBAAkB,MAAM,MAAM;AAGnC,aAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,8BAAsB,MAAM;AACxB,eAAK,MAAM,aAAa;AAAA,QAC5B,CAAC;AAGD,aAAK,uBAAuB,MAAM,QAAQ,IAAI;AAC9C;AAAA,MACJ;AAGA,YAAM,gBAAgB,KAAK;AAAA,QACvB,KAAK,EAAE,sBAAsB;AAAA,QAC7B;AAAA,QACA;AAAA,UACI,EAAC,OAAO,KAAK,EAAE,iBAAiB,GAAG,OAAO,QAAO;AAAA,UACjD,EAAC,OAAO,KAAK,EAAE,kBAAkB,GAAG,OAAO,OAAM;AAAA,UACjD,EAAC,OAAO,KAAK,EAAE,iBAAiB,GAAG,OAAO,OAAM;AAAA,UAChD,EAAC,OAAO,KAAK,EAAE,kBAAkB,GAAG,OAAO,OAAM;AAAA,QACrD;AAAA,MACJ;AACA,WAAK,YAAY,aAAa;AAG9B,YAAM,kBAAkB,KAAK;AAAA,QACzB,KAAK,EAAE,kBAAkB;AAAA,QACzB;AAAA,QACA;AAAA,UACI,EAAC,OAAO,KAAK,EAAE,wBAAwB,GAAG,OAAO,aAAY;AAAA,UAC7D,EAAC,OAAO,KAAK,EAAE,oBAAoB,GAAG,OAAO,QAAO;AAAA,UACpD,EAAC,OAAO,KAAK,EAAE,wBAAwB,GAAG,OAAO,YAAW;AAAA,QAChE;AAAA,MACJ;AACA,WAAK,YAAY,eAAe;AAGhC,YAAM,aAAa,KAAK,mBAAmB,KAAK,EAAE,uBAAuB,GAAG,eAAe;AAC3F,WAAK,YAAY,UAAU;AAG3B,YAAM,eAAe,KAAK,mBAAmB,KAAK,EAAE,wBAAwB,GAAG,yBAAyB;AACxG,WAAK,YAAY,YAAY;AAG7B,YAAM,eAAe,KAAK,qBAAqB,KAAK,EAAE,qBAAqB,GAAG,iBAAiB;AAC/F,WAAK,YAAY,YAAY;AAG7B,WAAK,MAAM,WAAW;AAItB,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,UAAU;AAGrB,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,4BAAsB,MAAM;AACxB,aAAK,MAAM,aAAa;AAAA,MAC5B,CAAC;AAGD,WAAK,uBAAuB,MAAM,QAAQ,IAAI;AAG9C,wBAAkB,MAAM,IAAI,YAAK,OAAO,QAAQ,aAAW,gBAAe;AAAA,IAC9E;AAAA,IAEA,mBAAmB,OAAO,UAAU,SAAS;AACzC,YAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,QACxC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,KAAI,iBAAQ,KAAI,YAAK,IAAI;AAE7E,YAAM,UAAU,SAAS,cAAc,SAAS;AAAA,QAC5C,aAAa;AAAA,QACb,YAAY;AAAA,UACR,OAAO;AAAA,QACX;AAAA,QACA,OAAO;AAAA,UACH,SAAS;AAAA,UACT,UAAU;AAAA,UACV,cAAc;AAAA,UACd,OAAO;AAAA,QACX;AAAA,MACJ,CAAC;AACD,YAAM,YAAY,OAAO;AAEzB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,MAAM;AAAA,QACV;AAAA,QACA,OAAO;AAAA,UACH,OAAO;AAAA,UACP,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,OAAO;AAAA,UACP,UAAU;AAAA,QACd;AAAA,MACJ,CAAC;AAED,YAAM,eAAe,KAAK,OAAO,QAAQ,QAAQ;AACjD,cAAQ,QAAQ,SAAO;AACnB,cAAM,SAAS,SAAS,cAAc,UAAU;AAAA,UAC5C,aAAa,IAAI;AAAA,UACjB,YAAY,EAAC,OAAO,IAAI,MAAK;AAAA,QACjC,CAAC;AACD,YAAI,IAAI,UAAU,cAAc;AAC5B,iBAAO,WAAW;AAAA,QACtB;AACA,eAAO,YAAY,MAAM;AAAA,MAC7B,CAAC;AAGD,aAAO,iBAAiB,aAAa,CAAC,MAAM;AACxC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,aAAO,iBAAiB,SAAS,CAAC,MAAM;AACpC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,aAAO,iBAAiB,UAAU,CAAC,MAAM;AACrC,UAAE,gBAAgB;AAClB,aAAK,OAAO,QAAQ,QAAQ,IAAI,EAAE,OAAO;AACzC,YAAI,KAAK,OAAO,gBAAgB;AAC5B,eAAK,OAAO,eAAe;AAAA,YACvB,SAAS,QAAQ,YAAY,EAAE,EAAE,OAAO,CAAC,EAAE,YAAY,IAAI,SAAS,QAAQ,YAAY,EAAE,EAAE,MAAM,CAAC;AAAA,YACnG,EAAE,OAAO;AAAA,UACb;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,YAAM,YAAY,MAAM;AACxB,aAAO;AAAA,IACX;AAAA,IAEA,mBAAmB,OAAO,UAAU;AAChC,YAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,QACxC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,KAAI,iBAAQ,KAAI,YAAK,IAAI;AAE7E,YAAM,UAAU,SAAS,cAAc,SAAS;AAAA,QAC5C,aAAa;AAAA,QACb,YAAY;AAAA,UACR,OAAO;AAAA,QACX;AAAA,QACA,OAAO;AAAA,UACH,SAAS;AAAA,UACT,UAAU;AAAA,UACV,cAAc;AAAA,UACd,OAAO;AAAA,QACX;AAAA,MACJ,CAAC;AACD,YAAM,YAAY,OAAO;AAEzB,YAAM,QAAQ,SAAS,cAAc,SAAS;AAAA,QAC1C,YAAY;AAAA,UACR,MAAM;AAAA,UACN,MAAM;AAAA,UACN,OAAO,KAAK,OAAO,QAAQ,QAAQ;AAAA,QACvC;AAAA,QACA,OAAO;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,UACR,SAAS;AAAA,UACT,YAAY;AAAA,UACZ,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AAGD,YAAM,iBAAiB,aAAa,CAAC,MAAM;AACvC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,YAAM,iBAAiB,SAAS,CAAC,MAAM;AACnC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,YAAM,iBAAiB,UAAU,CAAC,MAAM;AACpC,UAAE,gBAAgB;AAClB,aAAK,OAAO,QAAQ,QAAQ,IAAI,EAAE,OAAO;AACzC,YAAI,KAAK,OAAO,gBAAgB;AAC5B,eAAK,OAAO,eAAe;AAAA,YACvB,SAAS,QAAQ,YAAY,EAAE,EAAE,OAAO,CAAC,EAAE,YAAY,IAAI,SAAS,QAAQ,YAAY,EAAE,EAAE,MAAM,CAAC;AAAA,YACnG,EAAE,OAAO;AAAA,UACb;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,YAAM,YAAY,KAAK;AACvB,aAAO;AAAA,IACX;AAAA,IAEA,qBAAqB,OAAO,UAAU;AAClC,YAAM,QAAQ,SAAS,cAAc,OAAO;AAAA,QACxC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,MACjD,CAAC;AAGD,YAAM,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW,KAAI,iBAAQ,KAAI,YAAK,IAAI;AAE7E,YAAM,iBAAiB,SAAS,cAAc,OAAO;AAAA,QACjD,OAAO;AAAA,UACH,SAAS;AAAA,UACT,gBAAgB;AAAA,UAChB,cAAc;AAAA,QAClB;AAAA,MACJ,CAAC;AAED,YAAM,UAAU,SAAS,cAAc,SAAS;AAAA,QAC5C,aAAa;AAAA,QACb,YAAY;AAAA,UACR,OAAO;AAAA,QACX;AAAA,QACA,OAAO;AAAA,UACH,UAAU;AAAA,UACV,OAAO;AAAA,QACX;AAAA,MACJ,CAAC;AAED,YAAM,UAAU,SAAS,cAAc,QAAQ;AAAA,QAC3C,aAAa,KAAK,MAAM,KAAK,OAAO,QAAQ,QAAQ,IAAI,GAAG,IAAI;AAAA,QAC/D,OAAO;AAAA,UACH,UAAU;AAAA,UACV,OAAO;AAAA,QACX;AAAA,MACJ,CAAC;AAED,qBAAe,YAAY,OAAO;AAClC,qBAAe,YAAY,OAAO;AAClC,YAAM,YAAY,cAAc;AAEhC,YAAM,QAAQ,SAAS,cAAc,SAAS;AAAA,QAC1C,YAAY;AAAA,UACR,MAAM;AAAA,UACN,MAAM;AAAA,UACN,KAAK;AAAA,UACL,KAAK;AAAA,UACL,MAAM;AAAA,UACN,OAAO,OAAO,KAAK,OAAO,QAAQ,QAAQ,CAAC;AAAA,QAC/C;AAAA,QACA,OAAO;AAAA,UACH,OAAO;AAAA,UACP,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AAGD,YAAM,iBAAiB,aAAa,CAAC,MAAM;AACvC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,YAAM,iBAAiB,SAAS,CAAC,MAAM;AACnC,UAAE,gBAAgB;AAAA,MACtB,CAAC;AAED,YAAM,iBAAiB,SAAS,CAAC,MAAM;AACnC,UAAE,gBAAgB;AAClB,cAAM,QAAQ,WAAW,EAAE,OAAO,KAAK;AACvC,gBAAQ,cAAc,KAAK,MAAM,QAAQ,GAAG,IAAI;AAChD,aAAK,OAAO,QAAQ,QAAQ,IAAI;AAChC,YAAI,KAAK,OAAO,gBAAgB;AAC5B,eAAK,OAAO,eAAe;AAAA,YACvB,SAAS,QAAQ,YAAY,EAAE,EAAE,OAAO,CAAC,EAAE,YAAY,IAAI,SAAS,QAAQ,YAAY,EAAE,EAAE,MAAM,CAAC;AAAA,YACnG;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,YAAM,YAAY,KAAK;AACvB,aAAO;AAAA,IACX;AAAA,IAEA,oBAAoB;AAChB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,cAAc;AAAA,UACnC,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,OAAO,CAAC;AAE7C,YAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,QAC7C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,aAAa;AAAA,MACjB,CAAC;AACD,aAAO,YAAY,SAAS;AAE5B,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,cAAc,MAAM;AAAA,MAC7B,CAAC;AAED,WAAK,SAAS,QAAQ;AACtB,WAAK,SAAS,YAAY;AAC1B,aAAO;AAAA,IACX;AAAA,IAEA,iBAAiB,OAAO;AAEpB,UAAI,UAAU,GAAG;AACb,eAAO,KAAK,EAAE,eAAe;AAAA,MACjC;AAGA,YAAM,WAAW,MAAM,eAAe,KAAK,YAAY,GAAG;AAAA,QACtD,uBAAuB;AAAA,QACvB,uBAAuB;AAAA,MAC3B,CAAC;AAED,aAAO,GAAG,iBAAQ;AAAA,IACtB;AAAA,IAEA,cAAc,QAAQ;AAElB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,cAAa;AAC5F,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAE5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,gBAAe,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC3F,YAAY;AAAA,UACR,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AAED,YAAM,SAAS,CAAC,MAAM,KAAK,MAAM,GAAG,MAAM,KAAK,MAAM,CAAC;AACtD,UAAI,aAAa;AAEjB,aAAO,QAAQ,WAAS;AACpB,cAAM,OAAO,SAAS,cAAc,UAAU;AAAA,UAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,iBAAiB,KAAK;AAAA,UACxC,YAAY;AAAA,YACR,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,YAAY;AAAA,UAChB;AAAA,QACJ,CAAC;AAED,YAAI,UAAU,KAAK,OAAO,MAAM,eAAe;AAC3C,eAAK,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACxE,eAAK,YAAY,kBAAkB,OAAO,CAAC;AAC3C,uBAAa;AAAA,QACjB;AAEA,aAAK,iBAAiB,SAAS,MAAM;AACjC,eAAK,OAAO,iBAAiB,KAAK;AAClC,eAAK,wBAAwB,MAAM,MAAM;AAAA,QAC7C,CAAC;AAED,aAAK,YAAY,IAAI;AAAA,MACzB,CAAC;AAID,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,UAAU;AAGrB,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,4BAAsB,MAAM;AACxB,aAAK,MAAM,aAAa;AAAA,MAC5B,CAAC;AAGD,WAAK,6BAA6B,MAAM,MAAM;AAG9C,WAAK,uBAAuB,MAAM,MAAM;AAGxC,iBAAW,MAAM;AACb,cAAM,cAAc,cAAc,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY;AACpG,YAAI,aAAa;AACb,sBAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAC7C;AAAA,MACJ,GAAG,CAAC;AAAA,IACR;AAAA,IAEA,uBAAuB;AACnB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,UACtC,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,aAAa,CAAC;AAEnD,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,iBAAiB,MAAM;AAAA,MAChC,CAAC;AAED,WAAK,SAAS,WAAW;AACzB,aAAO;AAAA,IACX;AAAA,IAEA,iBAAiB,QAAQ;AAErB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAC/F,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAE5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,mBAAkB,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC9F,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,QAC1C;AAAA,MACJ,CAAC;AAGD,UAAI,CAAC,KAAK,OAAO,kBAAkB,KAAK,OAAO,eAAe,OAAO,WAAW,GAAG;AAE/E,cAAM,eAAe,SAAS,cAAc,OAAO;AAAA,UAC/C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,EAAE,mBAAmB;AAAA,UACvC,YAAY;AAAA,YACR,QAAQ;AAAA,UACZ;AAAA,UACA,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,QAC7C,CAAC;AACD,aAAK,YAAY,YAAY;AAG7B,aAAK,kBAAkB,MAAM,MAAM;AAGnC,aAAK,uBAAuB,MAAM,MAAM;AACxC;AAAA,MACJ;AAEA,UAAI,aAAa;AAGjB,YAAM,UAAU,SAAS,cAAc,UAAU;AAAA,QAC7C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,aAAa,KAAK,EAAE,cAAc;AAAA,QAClC,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,QAAQ;AAAA,UACR,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AAED,UAAI,CAAC,KAAK,OAAO,MAAM,iBAAiB;AACpC,gBAAQ,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AAC3E,gBAAQ,YAAY,kBAAkB,OAAO,CAAC;AAC9C,qBAAa;AAAA,MACjB;AAEA,cAAQ,iBAAiB,SAAS,MAAM;AACpC,aAAK,OAAO,gBAAgB;AAC5B,aAAK,qBAAqB;AAC1B,aAAK,wBAAwB,MAAM,MAAM;AAAA,MAC7C,CAAC;AAED,WAAK,YAAY,OAAO;AAGxB,YAAM,SAAS,KAAK,OAAO,eAAe,mBAAmB;AAC7D,aAAO,QAAQ,WAAS;AACpB,cAAM,OAAO,SAAS,cAAc,UAAU;AAAA,UAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,MAAM;AAAA,UACnB,YAAY;AAAA,YACR,QAAQ;AAAA,YACR,QAAQ;AAAA,YACR,QAAQ,MAAM;AAAA,YACd,YAAY;AAAA,UAChB;AAAA,QACJ,CAAC;AAGD,YAAI,KAAK,OAAO,MAAM,mBAClB,KAAK,OAAO,eAAe,iBAAiB,KAAK,OAAO,eAAe,OAAO,MAAM,KAAK,GAAG;AAC5F,eAAK,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACxE,eAAK,YAAY,kBAAkB,OAAO,CAAC;AAC3C,uBAAa;AAAA,QACjB;AAEA,aAAK,iBAAiB,SAAS,MAAM;AACjC,eAAK,OAAO,eAAe,YAAY,MAAM,KAAK;AAClD,eAAK,qBAAqB;AAC1B,eAAK,wBAAwB,MAAM,MAAM;AAAA,QAC7C,CAAC;AAED,aAAK,YAAY,IAAI;AAAA,MACzB,CAAC;AAGD,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,6BAA6B,MAAM,MAAM;AAG9C,WAAK,uBAAuB,MAAM,MAAM;AAGxC,iBAAW,MAAM;AACb,cAAM,cAAc,cAAc,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY;AACpG,YAAI,aAAa;AACb,sBAAY,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAC7C;AAAA,MACJ,GAAG,CAAC;AAAA,IACR;AAAA,IAEA,uBAAuB;AACnB,UAAI,CAAC,KAAK,SAAS,SAAU;AAE7B,YAAM,OAAO,KAAK,SAAS,SAAS,cAAc,cAAc;AAChE,YAAM,YAAY,KAAK,OAAO,MAAM;AAEpC,WAAK,YAAY,YACb,kBAAkB,UAAU,EAAE,YAC9B,kBAAkB,aAAa,EAAE;AAAA,IAEzC;AAAA,IAEA,yBAAyB;AACrB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,mBAAmB;AAAA,UACxC,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,YAAY,CAAC;AAElD,aAAO,iBAAiB,SAAS,YAAY;AACzC,cAAM,KAAK,OAAO,iBAAiB;AAC/B,aAAK,uBAAuB;AAAA,MACpC,CAAC;AAED,WAAK,SAAS,aAAa;AAC3B,aAAO;AAAA,IACX;AAAA,IAEA,yBAAyB;AACrB,UAAI,CAAC,KAAK,SAAS,WAAY;AAE/B,YAAM,YAAY,KAAK,OAAO,qBAAqB,KAAK,OAAO,kBAAkB;AACjF,WAAK,SAAS,WAAW,aAAa,iBAAiB,YAAY,SAAS,OAAO;AAAA,IACvF;AAAA,IAEA,+BAA+B;AAC3B,YAAM,YAAY,KAAK,EAAE,yBAAyB;AAClD,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,QAAQ;AAAA,UACR,gBAAgB;AAAA,QACpB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,kBAAkB,CAAC;AACxD,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAEzE,aAAO,iBAAiB,SAAS,YAAY;AACzC,cAAM,KAAK,OAAO,uBAAuB;AACzC,aAAK,6BAA6B;AAAA,MACtC,CAAC;AAED,WAAK,SAAS,mBAAmB;AACjC,aAAO;AAAA,IACX;AAAA,IAEA,+BAA+B;AAC3B,UAAI,CAAC,KAAK,SAAS,iBAAkB;AAErC,YAAM,OAAO,KAAK,SAAS,iBAAiB,cAAc,cAAc;AACxE,YAAM,YAAY,KAAK,OAAO,MAAM;AAEpC,WAAK,YAAY,YACb,kBAAkB,oBAAoB,EAAE,YACxC,kBAAkB,kBAAkB,EAAE;AAE1C,WAAK,SAAS,iBAAiB,aAAa,gBAAgB,YAAY,SAAS,OAAO;AAAA,IAG5F;AAAA,IAEA,2BAA2B;AACvB,YAAM,YAAY,KAAK,EAAE,qBAAqB;AAC9C,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,iBAAiB,CAAC;AACvD,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAEzE,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,mBAAmB;AAC/B,aAAK,yBAAyB;AAAA,MAClC,CAAC;AAED,WAAK,SAAS,eAAe;AAC7B,aAAO;AAAA,IACX;AAAA,IAEA,2BAA2B;AACvB,UAAI,CAAC,KAAK,SAAS,aAAc;AAEjC,YAAM,OAAO,KAAK,SAAS,aAAa,cAAc,cAAc;AACpE,YAAM,YAAY,KAAK,OAAO,MAAM;AAEpC,WAAK,YAAY,YACb,kBAAkB,mBAAmB,EAAE,YACvC,kBAAkB,iBAAiB,EAAE;AAEzC,WAAK,SAAS,aAAa,aAAa,iBAAiB,YAAY,SAAS,OAAO;AACrF,WAAK,SAAS,aAAa;AAAA,QAAa;AAAA,QACpC,YAAY,KAAK,EAAE,mBAAmB,IAAI,KAAK,EAAE,mBAAmB;AAAA,MACxE;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,qCAAqC;AACjC,YAAM,YAAY,KAAK,EAAE,6BAA6B;AACtD,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,gBAAgB;AAAA,QACpB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,cAAc,CAAC;AACpD,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAEzE,aAAO,iBAAiB,SAAS,MAAM;AACnC,YAAI,KAAK,OAAO,qBAAqB;AACjC,eAAK,OAAO,oBAAoB,iBAAiB;AAAA,QACrD;AAAA,MACJ,CAAC;AAED,WAAK,SAAS,uBAAuB;AACrC,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,qCAAqC;AACjC,YAAM,MAAM,KAAK,SAAS;AAC1B,UAAI,CAAC,IAAK;AAEV,YAAM,YAAY,KAAK,OAAO,MAAM;AACpC,YAAM,WAAW,YAAY,KAAK,EAAE,6BAA6B,IAAI,KAAK,EAAE,6BAA6B;AACzG,YAAM,WAAW,YAAY,mBAAmB;AAEhD,UAAI,cAAc,cAAc,EAAE,YAAY,kBAAkB,QAAQ,EAAE;AAC1E,UAAI,aAAa,gBAAgB,OAAO,SAAS,CAAC;AAClD,UAAI,aAAa,cAAc,QAAQ;AAEvC,YAAM,UAAU,IAAI,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,WAAU;AAC/E,UAAI,QAAS,SAAQ,cAAc;AAAA,IACvC;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,6BAA6B;AAh1FjC;AAi1FQ,YAAM,sBAAsB,KAAK,oBAAoB;AACrD,YAAM,kBAAkB,KAAK,gBAAgB;AAG7C,UAAI,qBAAqB;AAErB,YAAI,CAAC,KAAK,SAAS,oBAAoB,KAAK,OAAO,QAAQ,2BAA2B,OAAO;AACzF,gBAAM,MAAM,KAAK,6BAA6B;AAC9C,cAAI,QAAQ,mBAAmB;AAC/B,cAAI,QAAQ,yBAAyB;AAErC,gBAAM,gBAAgB,KAAK,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,cAAa;AACtG,gBAAM,cAAc,KAAK,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,mBAAkB;AACzG,gBAAM,eAAe,iBAAiB,eAAe;AACrD,cAAI,cAAc;AACd,iBAAK,aAAa,aAAa,KAAK,YAAY;AAAA,UACpD,OAAO;AACH,iBAAK,aAAa,YAAY,GAAG;AAAA,UACrC;AAEA,eAAK,kBAAkB;AAAA,QAC3B;AAEA,YAAI,KAAK,SAAS,kBAAkB;AAChC,eAAK,SAAS,iBAAiB,MAAM,UAAU;AAAA,QACnD;AAAA,MACJ,OAAO;AAEH,YAAI,KAAK,SAAS,kBAAkB;AAChC,eAAK,SAAS,iBAAiB,MAAM,UAAU;AAAA,QACnD;AAAA,MACJ;AAGA,YAAM,mBAAmB,mBAAmB,KAAK,OAAO,QAAQ,uBAAuB;AACvF,YAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,YAAM,cAAc,KAAK,OAAO,QAAQ,2BAA2B;AACnE,YAAM,UAAU,CAAC,OAAO,MAAM,EAAE,SAAS,WAAW;AACpD,YAAM,WAAW,CAAC,QAAQ,MAAM,EAAE,SAAS,WAAW;AAEtD,UAAI,kBAAkB;AAElB,cAAM,aAAa,KAAK,aAAa,cAAc,IAAI,oBAAW,WAAU;AAC5E,cAAM,gBAAgB,KAAK,aAAa,cAAc,IAAI,oBAAW,cAAa;AAClF,cAAM,kBAAkB,cAAc,iBAAiB;AACvD,YAAI,qBAAqB;AAGzB,YAAI,WAAW,CAAC,KAAK,SAAS,cAAc;AACxC,gBAAM,MAAM,KAAK,yBAAyB;AAC1C,cAAI,QAAQ,mBAAmB;AAC/B,cAAI,QAAQ,yBAAyB;AACrC,cAAI,iBAAiB;AACjB,iBAAK,aAAa,aAAa,KAAK,eAAe;AAAA,UACvD,OAAO;AACH,iBAAK,aAAa,YAAY,GAAG;AAAA,UACrC;AACA,+BAAqB;AAAA,QACzB;AAGA,YAAI,YAAY,CAAC,KAAK,SAAS,sBAAsB;AACjD,gBAAM,MAAM,KAAK,mCAAmC;AACpD,cAAI,QAAQ,mBAAmB;AAC/B,cAAI,QAAQ,yBAAyB;AAErC,gBAAM,YAAW,UAAK,SAAS,iBAAd,mBAA4B;AAC7C,cAAI,UAAU;AACV,iBAAK,aAAa,aAAa,KAAK,QAAQ;AAAA,UAChD,WAAW,iBAAiB;AACxB,iBAAK,aAAa,aAAa,KAAK,eAAe;AAAA,UACvD,OAAO;AACH,iBAAK,aAAa,YAAY,GAAG;AAAA,UACrC;AACA,+BAAqB;AAAA,QACzB;AAEA,YAAI,oBAAoB;AACpB,eAAK,kBAAkB;AAAA,QAC3B;AAGA,YAAI,KAAK,SAAS,cAAc;AAC5B,eAAK,SAAS,aAAa,MAAM,UAAU,UAAU,KAAK;AAAA,QAC9D;AACA,YAAI,KAAK,SAAS,sBAAsB;AACpC,eAAK,SAAS,qBAAqB,MAAM,UAAU,WAAW,KAAK;AAAA,QACvE;AAAA,MACJ,OAAO;AAEH,YAAI,KAAK,SAAS,aAAc,MAAK,SAAS,aAAa,MAAM,UAAU;AAC3E,YAAI,KAAK,SAAS,qBAAsB,MAAK,SAAS,qBAAqB,MAAM,UAAU;AAAA,MAC/F;AAAA,IACJ;AAAA,IAEA,uBAAuB;AACnB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,QAC1C;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,UAAU,CAAC;AAEhD,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,aAAa;AAAA,MAC7B,CAAC;AAED,aAAO;AAAA,IACX;AAAA,IAEA,kBAAkB;AACd,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,YAAY;AAAA,QACrC;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,KAAK,CAAC;AAE3C,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,UAAU;AAAA,MAC1B,CAAC;AAED,aAAO;AAAA,IACX;AAAA,IAEA,yBAAyB;AACrB,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,mBAAmB;AAAA,QAC5C;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,YAAY,CAAC;AAElD,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,OAAO,iBAAiB;AAAA,MACjC,CAAC;AAED,WAAK,SAAS,aAAa;AAC3B,aAAO;AAAA,IACX;AAAA,IAEA,eAAe;AAEX,WAAK,OAAO,GAAG,QAAQ,MAAM,KAAK,sBAAsB,CAAC;AACzD,WAAK,OAAO,GAAG,SAAS,MAAM,KAAK,sBAAsB,CAAC;AAC1D,WAAK,OAAO,GAAG,cAAc,MAAM,KAAK,eAAe,CAAC;AACxD,WAAK,OAAO,GAAG,kBAAkB,MAAM;AACnC,aAAK,eAAe;AACpB,aAAK,oBAAoB;AACzB,aAAK,uBAAuB;AAE5B,aAAK,yBAAyB;AAAA,MAClC,CAAC;AACD,WAAK,OAAO,GAAG,gBAAgB,MAAM;AAEjC,aAAK,yBAAyB;AAAA,MAClC,CAAC;AACD,WAAK,OAAO,GAAG,gBAAgB,MAAM,KAAK,oBAAoB,CAAC;AAC/D,WAAK,OAAO,GAAG,YAAY,MAAM,KAAK,eAAe,CAAC;AACtD,WAAK,OAAO,GAAG,uBAAuB,MAAM,KAAK,mBAAmB,CAAC;AACrE,WAAK,OAAO,GAAG,oBAAoB,MAAM,KAAK,uBAAuB,CAAC;AACtE,WAAK,OAAO,GAAG,mBAAmB,MAAM,KAAK,qBAAqB,CAAC;AACnE,WAAK,OAAO,GAAG,oBAAoB,MAAM,KAAK,qBAAqB,CAAC;AACpE,WAAK,OAAO,GAAG,2BAA2B,MAAM,KAAK,6BAA6B,CAAC;AACnF,WAAK,OAAO,GAAG,4BAA4B,MAAM,KAAK,6BAA6B,CAAC;AACpF,WAAK,OAAO,GAAG,uBAAuB,MAAM,KAAK,yBAAyB,CAAC;AAC3E,WAAK,OAAO,GAAG,wBAAwB,MAAM,KAAK,yBAAyB,CAAC;AAC5E,WAAK,OAAO,GAAG,iCAAiC,MAAM,KAAK,mCAAmC,CAAC;AAC/F,WAAK,OAAO,GAAG,kCAAkC,MAAM,KAAK,mCAAmC,CAAC;AAChG,WAAK,OAAO,GAAG,iBAAiB,MAAM,KAAK,uBAAuB,CAAC;AACnE,WAAK,OAAO,GAAG,oBAAoB,MAAM,KAAK,uBAAuB,CAAC;AACtE,WAAK,OAAO,GAAG,qBAAqB,MAAM;AACtC,aAAK,oBAAoB;AACzB,aAAK,uBAAuB;AAAA,MAChC,CAAC;AAAA,IACL;AAAA,IAEA,wBAAwB;AACpB,UAAI,CAAC,KAAK,SAAS,UAAW;AAE9B,YAAM,OAAO,KAAK,SAAS,UAAU,cAAc,cAAc;AACjE,YAAM,YAAY,KAAK,OAAO,MAAM;AAEpC,WAAK,YAAY,YACb,kBAAkB,OAAO,EAAE,YAC3B,kBAAkB,MAAM,EAAE;AAE9B,YAAM,eAAe,YAAY,KAAK,EAAE,cAAc,IAAI,KAAK,EAAE,aAAa;AAC9E,WAAK,SAAS,UAAU,aAAa,cAAc,YAAY;AAE/D,eAAS,cAAc,KAAK,SAAS,WAAW,cAAc,KAAK,OAAO,QAAQ,WAAW;AAAA,IACjG;AAAA,IAEA,iBAAiB;AACb,UAAI,CAAC,KAAK,SAAS,OAAQ;AAE3B,YAAM,cAAc,KAAK,OAAO,MAAM,eAAe;AACrD,YAAM,WAAW,KAAK,OAAO,MAAM,YAAY;AAG/C,YAAM,UAAU,WAAW,IAAI,KAAK,IAAI,KAAK,KAAK,IAAI,GAAI,cAAc,WAAY,GAAG,CAAC,IAAI;AAE5F,WAAK,SAAS,OAAO,MAAM,QAAQ,GAAG,gBAAO;AAC7C,WAAK,SAAS,SAAS,aAAa,iBAAiB,OAAO,KAAK,MAAM,OAAO,CAAC,CAAC;AAGhF,YAAM,kBAAkB,UAAU,eAAe,KAAK,OAAO,MAAM,WAAW;AAC9E,YAAM,eAAe,UAAU,eAAe,KAAK,OAAO,MAAM,QAAQ;AACxE,WAAK,SAAS,SAAS;AAAA,QAAa;AAAA,QAChC,GAAG,YAAK,MAAM,OAAO,GAAC,OAAM,wBAAe,KAAI,YAAK,EAAE,SAAS,GAAC,KAAI;AAAA,MAAc;AAEtF,UAAI,KAAK,SAAS,mBAAmB;AACjC,cAAMC,eAAc,KAAK,OAAO,MAAM;AAEtC,aAAK,SAAS,kBAAkB,cAAc,UAAU,WAAWA,YAAW;AAC9E,YAAI,KAAK,SAAS,uBAAuB;AACrC,eAAK,SAAS,sBAAsB,cAAc,UAAU,eAAeA,YAAW;AAAA,QAC1F;AAAA,MACJ;AAAA,IACJ;AAAA,IAEA,iBAAiB;AACb,UAAI,KAAK,SAAS,gBAAgB;AAC9B,cAAM,WAAW,KAAK,OAAO,MAAM;AAEnC,aAAK,SAAS,eAAe,cAAc,UAAU,WAAW,QAAQ;AACxE,YAAI,KAAK,SAAS,oBAAoB;AAClC,eAAK,SAAS,mBAAmB,cAAc,KAAK,EAAE,qBAAqB,IAAI,UAAU,eAAe,QAAQ;AAAA,QACpH;AAAA,MACJ;AAAA,IACJ;AAAA,IAEA,sBAAsB;AAClB,YAAM,UAAU,KAAK,OAAO,MAAM,SAAS;AAG3C,UAAI,KAAK,SAAS,YAAY;AAC1B,aAAK,SAAS,WAAW,MAAM,SAAS,GAAG,gBAAO;AAAA,MACtD;AAGA,UAAI,KAAK,SAAS,cAAc;AAC5B,aAAK,SAAS,aAAa,aAAa,iBAAiB,OAAO,KAAK,MAAM,OAAO,CAAC,CAAC;AAAA,MACxF;AAGA,UAAI,KAAK,SAAS,MAAM;AACpB,cAAM,OAAO,KAAK,SAAS,KAAK,cAAc,cAAc;AAC5D,YAAI,MAAM;AACN,cAAI;AAEJ,cAAI,KAAK,OAAO,MAAM,SAAS,KAAK,OAAO,MAAM,WAAW,GAAG;AAC3D,uBAAW;AAAA,UACf,WAAW,KAAK,OAAO,MAAM,SAAS,KAAK;AACvC,uBAAW;AAAA,UACf,WAAW,KAAK,OAAO,MAAM,SAAS,KAAK;AACvC,uBAAW;AAAA,UACf,OAAO;AACH,uBAAW;AAAA,UACf;AAEA,eAAK,YAAY,kBAAkB,QAAQ,EAAE;AAE7C,gBAAM,mBACF,KAAK,OAAO,MAAM,QAAQ,KAAK,EAAE,eAAe,IAAI,KAAK,EAAE,aAAa;AAC5E,eAAK,SAAS,KAAK,aAAa,cAAc,gBAAgB;AAE9D,mBAAS,cAAc,KAAK,SAAS,MAAM,kBAAkB,KAAK,OAAO,QAAQ,WAAW;AAAA,QAChG;AAAA,MACJ;AAGA,UAAI,KAAK,SAAS,cAAc;AAC5B,aAAK,SAAS,aAAa,aAAa,iBAAiB,OAAO,KAAK,MAAM,OAAO,CAAC,CAAC;AAAA,MACxF;AAAA,IACJ;AAAA,IAEA,iBAAiB;AACb,UAAI,CAAC,KAAK,SAAS,YAAY,CAAC,KAAK,OAAO,QAAQ,YAAY,KAAK,OAAO,QAAQ,SAAS,WAAW,EAAG;AAE3G,YAAM,WAAW,KAAK,OAAO,QAAQ,SAAS,IAAI,KAAK,OAAO,QAAQ,SAAS,SAAS,CAAC;AACzF,YAAM,UAAW,WAAW,KAAK,OAAO,MAAM,WAAY;AAC1D,WAAK,SAAS,SAAS,MAAM,QAAQ,GAAG,gBAAO;AAAA,IACnD;AAAA,IAEA,qBAAqB;AACjB,UAAI,KAAK,SAAS,WAAW;AACzB,aAAK,SAAS,UAAU,cAAc,GAAG,YAAK,OAAO,MAAM,eAAa;AAAA,MAC5E;AAAA,IACJ;AAAA,IAEA,yBAAyB;AACrB,UAAI,CAAC,KAAK,SAAS,WAAY;AAE/B,YAAM,OAAO,KAAK,SAAS,WAAW,cAAc,cAAc;AAClE,YAAM,eAAe,KAAK,OAAO,MAAM;AAEvC,WAAK,YAAY,eACb,kBAAkB,gBAAgB,EAAE,YACpC,kBAAkB,YAAY,EAAE;AAEpC,WAAK,SAAS,WAAW;AAAA,QAAa;AAAA,QAClC,eAAe,KAAK,EAAE,uBAAuB,IAAI,KAAK,EAAE,mBAAmB;AAAA,MAC/E;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,sBAAsB;AAElB,UAAI,CAAC,KAAK,OAAO,QAAQ,cAAe;AAGxC,UAAI,KAAK,SAAS,QAAS;AAG3B,UAAI,CAAC,KAAK,iBAAiB,EAAG;AAG9B,YAAM,gBAAgB,KAAK,oBAAoB;AAG/C,YAAM,cAAc,KAAK,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,SAAQ;AAC/F,YAAM,qBAAqB,KAAK,aAAa,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAC9G,YAAM,eAAe,sBAAsB;AAE3C,UAAI,cAAc;AACd,aAAK,aAAa,aAAa,eAAe,YAAY;AAAA,MAC9D,OAAO;AAEH,aAAK,aAAa,aAAa,eAAe,KAAK,aAAa,UAAU;AAAA,MAC9E;AAEA,WAAK,OAAO,IAAI,oCAAoC,MAAM;AAAA,IAC9D;AAAA,IAEA,yBAAyB;AACrB,UAAI,CAAC,KAAK,SAAS,YAAa;AAChC,UAAI,CAAC,KAAK,OAAO,YAAY,CAAC,KAAK,OAAO,SAAS,aAAc;AAEjE,YAAM,YAAY,KAAK,OAAO,SAAS,aAAa;AACpD,UAAI,UAAU,WAAW,GAAG;AACxB,aAAK,SAAS,YAAY,cAAc;AACxC;AAAA,MACJ;AAGA,UAAI,qBAAqB;AAGzB,UAAI,KAAK,OAAO,SAAS,OAAO,KAAK,OAAO,SAAS,IAAI,iBAAiB,IAAI;AAC1E,6BAAqB;AAAA,MACzB,WAAW,KAAK,OAAO,SAAS,mBAAmB;AAC/C,cAAM,eAAe,KAAK,OAAO,SAAS,kBAAkB;AAC5D,cAAM,iBAAiB,UAAU,KAAK,OAAK,EAAE,UAAU,YAAY;AACnE,YAAI,gBAAgB;AAChB,+BAAqB,eAAe,SAAS,GAAG,sBAAe,QAAM,OAAM;AAAA,QAC/E;AAAA,MACJ;AAEA,WAAK,SAAS,YAAY,cAAc;AAAA,IAC5C;AAAA,IAEA,gBAAgB;AACZ,UAAI,KAAK,OAAO,QAAQ,YAAY,QAAS;AAE7C,YAAM,eAAe,MAAM;AACvB,aAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AAChF,aAAK,OAAO,UAAU,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACzF,aAAK,OAAO,MAAM,kBAAkB;AAEpC,qBAAa,KAAK,WAAW;AAE7B,YAAI,KAAK,OAAO,MAAM,SAAS;AAE3B,gBAAM,QAAQ,KAAK,OAAO,MAAM,aAC1B,KAAK,OAAO,QAAQ,oBAAoB,MACxC,KAAK,OAAO,QAAQ;AAE1B,eAAK,cAAc,WAAW,MAAM;AAChC,iBAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACnF,iBAAK,OAAO,UAAU,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AAC5F,iBAAK,OAAO,MAAM,kBAAkB;AAAA,UACxC,GAAG,KAAK;AAAA,QACZ;AAAA,MACJ;AAGA,WAAK,OAAO,UAAU,iBAAiB,aAAa,YAAY;AAChE,WAAK,OAAO,UAAU,iBAAiB,cAAc,YAAY;AACjE,WAAK,OAAO,UAAU,iBAAiB,aAAa,YAAY;AAChE,WAAK,OAAO,UAAU,iBAAiB,SAAS,YAAY;AAC5D,WAAK,OAAO,UAAU,iBAAiB,OAAO,YAAY;AAG1D,WAAK,QAAQ,iBAAiB,WAAW,YAAY;AAGrD,WAAK,OAAO,GAAG,SAAS,MAAM;AAC1B,qBAAa;AACb,qBAAa,KAAK,WAAW;AAAA,MACjC,CAAC;AAED,WAAK,OAAO,GAAG,QAAQ,MAAM;AACzB,qBAAa;AAAA,MACjB,CAAC;AAGD,WAAK,OAAO,GAAG,mBAAmB,MAAM;AACpC,qBAAa;AAEb,YAAI,KAAK,OAAO,MAAM,YAAY;AAC9B,uBAAa,KAAK,WAAW;AAC7B,eAAK,cAAc,WAAW,MAAM;AAChC,gBAAI,KAAK,OAAO,MAAM,SAAS;AAC3B,mBAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AACnF,mBAAK,OAAO,UAAU,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,oBAAmB;AAC5F,mBAAK,OAAO,MAAM,kBAAkB;AAAA,YACxC;AAAA,UACJ,GAAG,KAAK,OAAO,QAAQ,oBAAoB,CAAC;AAAA,QAChD;AAAA,MACJ,CAAC;AAGD,mBAAa;AAAA,IACjB;AAAA,IAEA,2BAA2B;AACvB,YAAM,YAAY,KAAK,EAAE,oBAAoB;AAC7C,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC5C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,YAAW,YAAK,OAAO,QAAQ,aAAW;AAAA,QACvF,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AAED,aAAO,YAAY,kBAAkB,cAAc,CAAC;AACpD,eAAS,cAAc,QAAQ,WAAW,KAAK,OAAO,QAAQ,WAAW;AAEzE,aAAO,iBAAiB,SAAS,MAAM;AACnC,aAAK,iBAAiB,MAAM;AAAA,MAChC,CAAC;AAED,WAAK,SAAS,eAAe;AAC7B,aAAO;AAAA,IACX;AAAA,IAEA,iBAAiB,QAAQ;AAErB,YAAM,eAAe,SAAS,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,sBAAqB;AACpG,UAAI,cAAc;AACd,qBAAa,OAAO;AACpB,eAAO,aAAa,iBAAiB,OAAO;AAC5C,YAAI,KAAK,aAAa,cAAc;AAChC,eAAK,WAAW;AAChB,eAAK,iBAAiB;AAAA,QAC1B;AACA;AAAA,MACJ;AAEA,YAAM,OAAO,SAAS,cAAc,OAAO;AAAA,QACvC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW,wBAAuB,YAAK,OAAO,QAAQ,aAAW;AAAA,QACnG,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,oBAAoB;AAAA,QAC7C;AAAA,MACJ,CAAC;AAGD,YAAM,kBAAkB,MAAM,KAAK,KAAK,aAAa,iBAAiB,iCAAiC,CAAC;AAExG,UAAI,gBAAgB,WAAW,GAAG;AAE9B,cAAM,cAAc,SAAS,cAAc,OAAO;AAAA,UAC9C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,UAC7C,aAAa,KAAK,EAAE,sBAAsB;AAAA,UAC1C,YAAY;AAAA,YACR,QAAQ;AAAA,UACZ;AAAA,UACA,OAAO,EAAC,SAAS,OAAO,QAAQ,UAAS;AAAA,QAC7C,CAAC;AACD,aAAK,YAAY,WAAW;AAAA,MAChC,OAAO;AAEH,wBAAgB,QAAQ,SAAO;AAC3B,gBAAM,OAAO,SAAS,cAAc,UAAU;AAAA,YAC1C,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,YAC7C,YAAY;AAAA,cACR,QAAQ;AAAA,cACR,QAAQ;AAAA,cACR,YAAY;AAAA,YAChB;AAAA,UACJ,CAAC;AAGD,gBAAM,QAAQ,IAAI,aAAa,YAAY,KAAK,IAAI,aAAa,OAAO,KAAK;AAG7E,gBAAM,OAAO,IAAI,cAAc,cAAc;AAC7C,cAAI,MAAM;AACN,kBAAM,YAAY,KAAK,UAAU,IAAI;AACrC,iBAAK,YAAY,SAAS;AAAA,UAC9B,OAAO;AAEH,kBAAM,aAAa,IAAI,cAAc,MAAM;AAC3C,gBAAI,cAAc,WAAW,eAAe,WAAW,YAAY,UAAU,GAAG;AAC5E,oBAAM,YAAY,WAAW,UAAU,IAAI;AAC3C,wBAAU,UAAU,IAAI,aAAa;AACrC,mBAAK,YAAY,SAAS;AAAA,YAC9B;AAAA,UACJ;AAEA,gBAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,YAC7C,aAAa;AAAA,UACjB,CAAC;AACD,eAAK,YAAY,SAAS;AAG1B,eAAK,iBAAiB,SAAS,CAAC,MAAM;AAGlC,iBAAK,uBAAuB;AAG5B,kBAAM,kBAAkB,IAAI,MAAM;AAClC,gBAAI,MAAM,UAAU;AACpB,gBAAI,MAAM,aAAa;AAGvB,gBAAI,MAAM;AAGV,uBAAW,MAAM;AACb,kBAAI,MAAM,UAAU;AACpB,kBAAI,MAAM,aAAa;AACvB,mBAAK,uBAAuB;AAAA,YAChC,GAAG,GAAG;AAGN,iBAAK,wBAAwB,MAAM,MAAM;AAAA,UAC7C,CAAC;AAED,eAAK,YAAY,IAAI;AAAA,QACzB,CAAC;AAGD,aAAK,6BAA6B,MAAM,MAAM;AAG9C,mBAAW,MAAM;AACb,gBAAM,YAAY,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,aAAY;AACpF,cAAI,aAAa,UAAU,YAAY,UAAU;AAC7C,sBAAU,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UAC3C;AAAA,QACJ,GAAG,CAAC;AAAA,MACR;AAGA,WAAK,MAAM,aAAa;AACxB,WAAK,MAAM,UAAU;AAGrB,WAAK,kBAAkB,MAAM,MAAM;AAGnC,WAAK,aAAa,MAAM,QAAQ,IAAI;AAGpC,4BAAsB,MAAM;AACxB,aAAK,MAAM,aAAa;AAAA,MAC5B,CAAC;AAGD,WAAK,uBAAuB,MAAM,MAAM;AAAA,IAC5C;AAAA,IAEA,yBAAyB;AAErB,YAAM,gBAAgB,MAAM;AAExB,cAAM,YAAY,OAAO,cAAc;AACvC,cAAM,cAAc,OAAO,cAAc,OAAO;AAChD,cAAM,eAAe,KAAK,OAAO,MAAM;AACvC,cAAM,wBAAwB,eAAe;AAE7C,YAAI,CAAC,KAAK,gBAAgB,KAAK,aAAa,SAAS,WAAW,GAAG;AAE/D,cAAI,KAAK,oBAAoB;AACzB,iBAAK,mBAAmB,MAAM,UAAU;AAAA,UAC5C;AACA;AAAA,QACJ;AAGA,cAAM,aAAa,MAAM,KAAK,KAAK,aAAa,QAAQ,EAAE;AAAA,UACtD,SAAO,CAAC,IAAI,UAAU,SAAS,GAAG,YAAK,OAAO,QAAQ,aAAW,iBAAgB;AAAA,QACrF;AAEA,YAAI,WAAW,WAAW,GAAG;AAEzB,cAAI,KAAK,oBAAoB;AACzB,iBAAK,mBAAmB,MAAM,UAAU;AAAA,UAC5C;AACA;AAAA,QACJ;AAKA,cAAM,oBAAoB,CAAC,aAAa,CAAC;AAEzC,YAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,kBAAQ,IAAI,uBAAuB;AAAA,YAC/B;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA,OAAO,OAAO;AAAA,YACd,QAAQ,OAAO;AAAA,UACnB,CAAC;AAAA,QACL;AAGA,YAAI,CAAC,mBAAmB;AACpB,qBAAW,QAAQ,SAAO;AACtB,gBAAI,QAAQ,aAAa;AACzB,gBAAI,MAAM,UAAU;AAAA,UACxB,CAAC;AAED,cAAI,KAAK,oBAAoB;AACzB,iBAAK,mBAAmB,MAAM,UAAU;AAAA,UAC5C;AACA,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,oBAAQ,IAAI,uEAAuE;AAAA,UACvF;AACA;AAAA,QACJ;AAGA,YAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,kBAAQ,IAAI,4CAA4C;AAAA,QAC5D;AAGA,mBAAW,QAAQ,SAAO;AACtB,cAAI,MAAM,UAAU;AAAA,QACxB,CAAC;AAGD,cAAM,iBAAiB,KAAK,aAAa;AACzC,cAAM,sBAAsB;AAC5B,cAAM,iBAAiB,iBAAiB;AAGxC,YAAI,aAAa;AACjB,cAAM,eAAe,WAAW,IAAI,SAAO;AACvC,gBAAM,QAAQ,iBAAiB,GAAG;AAClC,gBAAM,QAAQ,IAAI,cACL,SAAS,MAAM,cAAc,CAAC,IAC9B,SAAS,MAAM,eAAe,CAAC;AAC5C,wBAAc;AACd,iBAAO,EAAC,KAAK,MAAK;AAAA,QACtB,CAAC;AAGD,cAAM,WAAW;AACjB,uBAAe,WAAW,SAAS,KAAK;AAGxC,cAAM,gBAAgB,OAAO,aAAa;AAC1C,cAAM,gBAAgB,aAAa,kBAAkB,iBAAkB,yBAAyB,CAAC;AAGjG,YAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,kBAAQ,IAAI,uBAAuB;AAAA,YAC/B;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,YACA,QAAQ,gBAAgB,kBAAmB,aAAa,iBAAiB,qBAAqB;AAAA,YAC9F,aAAa,WAAW;AAAA,UAC5B,CAAC;AAAA,QACL;AAEA,YAAI,eAAe;AAEf,gBAAMC,iBAAgB,OAAO,aAAa;AAC1C,gBAAM,eAAeA,iBAAgB,2BAA2B;AAEhE,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,oBAAQ,IAAI,SAAS,OAAAA,iBAAgB,WAAW,WAAS,wBAAuB,cAAO,YAAU,MAAK;AAAA,UAC1G;AAGA,gBAAM,gBAAgB,aAAa,KAAK,CAAC,GAAG,MAAM;AAC9C,kBAAM,YAAY,SAAS,EAAE,IAAI,QAAQ,YAAY,KAAK,EAAE,IAAI,QAAQ,oBAAoB,GAAG;AAC/F,kBAAM,YAAY,SAAS,EAAE,IAAI,QAAQ,YAAY,KAAK,EAAE,IAAI,QAAQ,oBAAoB,GAAG;AAC/F,mBAAO,YAAY;AAAA,UACvB,CAAC;AAGD,cAAI,eAAe;AACnB,cAAI,kBAAkB;AAEtB,qBAAW,EAAC,KAAK,MAAK,KAAK,eAAe;AACtC,kBAAM,WAAW,SAAS,IAAI,QAAQ,YAAY,KAAK,IAAI,QAAQ,oBAAoB,GAAG;AAC1F,kBAAM,cAAc,IAAI,aAAa,YAAY,KAAK;AAGtD,gBAAI,aAAa,GAAG;AAChB,kBAAI,QAAQ,aAAa;AACzB,kBAAI,MAAM,UAAU;AACpB;AAAA,YACJ;AAIA,kBAAM,aAAaA,iBAAiB,WAAW,IAAM,eAAe;AAEpE,gBAAI,YAAY;AAEZ,kBAAI,QAAQ,aAAa;AACzB,kBAAI,MAAM,UAAU;AACpB,8BAAgB;AAChB;AACA,kBAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,wBAAQ,IAAI,sBAAsB,oBAAW,eAAc,iBAAQ,MAAK,OAAAA,iBAAgB,WAAW,WAAS,IAAG;AAAA,cACnH;AAAA,YACJ,OAAO;AAEH,kBAAI,QAAQ,aAAa;AACzB,kBAAI,MAAM,UAAU;AAAA,YACxB;AAAA,UACJ;AAGA,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,oBAAQ,IAAI,2BAA2B,CAAC,CAAC,KAAK,kBAAkB;AAAA,UACpE;AAEA,cAAI,CAAC,KAAK,oBAAoB;AAC1B,oBAAQ,MAAM,iCAAiC;AAC/C;AAAA,UACJ;AAEA,cAAI,kBAAkB,GAAG;AACrB,iBAAK,mBAAmB,MAAM,UAAU;AACxC,gBAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,sBAAQ,IAAI,kCAAkC,iBAAiB,eAAe;AAAA,YAClF;AAAA,UACJ,OAAO;AACH,iBAAK,mBAAmB,MAAM,UAAU;AACxC,gBAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,sBAAQ,IAAI,+CAA+C;AAAA,YAC/D;AAAA,UACJ;AAAA,QACJ,OAAO;AAEH,qBAAW,QAAQ,SAAO;AACtB,gBAAI,QAAQ,aAAa;AACzB,gBAAI,MAAM,UAAU;AAAA,UACxB,CAAC;AACD,eAAK,mBAAmB,MAAM,UAAU;AAAA,QAC5C;AAAA,MACJ;AAGA,YAAM,iBAAiB,IAAI,eAAe,MAAM;AAC5C,8BAAsB,aAAa;AAAA,MACvC,CAAC;AACD,qBAAe,QAAQ,KAAK,YAAY;AAGxC,aAAO,iBAAiB,UAAU,MAAM;AACpC,8BAAsB,aAAa;AAAA,MACvC,CAAC;AAGD,WAAK,OAAO,GAAG,oBAAoB,MAAM;AAErC,mBAAW,MAAM;AACb,gCAAsB,aAAa;AAAA,QACvC,GAAG,EAAE;AAAA,MACT,CAAC;AAID,4BAAsB,MAAM;AACxB,sBAAc;AACd,mBAAW,MAAM,cAAc,GAAG,GAAG;AACrC,mBAAW,MAAM,cAAc,GAAG,GAAG;AACrC,mBAAW,MAAM,cAAc,GAAG,GAAG;AAAA,MACzC,CAAC;AAGD,UAAI,SAAS,SAAS,SAAS,MAAM,OAAO;AACxC,iBAAS,MAAM,MAAM,KAAK,MAAM;AAC5B,gCAAsB,aAAa;AAAA,QACvC,CAAC;AAAA,MACL;AAGA,WAAK,yBAAyB;AAAA,IAClC;AAAA,IAEA,OAAO;AACH,WAAK,QAAQ,MAAM,UAAU;AAAA,IACjC;AAAA,IAEA,OAAO;AACH,WAAK,QAAQ,MAAM,UAAU;AAAA,IACjC;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,2BAA2B;AAjpH/B;AAkpHQ,YAAM,WAAW,KAAK,OAAO;AAC7B,UAAI,CAAC,YAAY,CAAC,SAAS,SAAS,SAAS,MAAM,YAAY,SAAS;AACpE;AAAA,MACJ;AAGA,UAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,cAAc;AAC9C,aAAK,qBAAqB;AAAA,MAC9B;AAEA,UAAI,CAAC,KAAK,oBAAoB,CAAC,KAAK,cAAc;AAC9C;AAAA,MACJ;AAEA,YAAM,YAAY,SAAS;AAC3B,YAAM,SAAS,UAAU,SAAO,eAAU,cAAc,QAAQ,MAAhC,mBAAmC;AAEnE,UAAI,UAAU,KAAK,aAAa,QAAQ,QAAQ;AAE5C,aAAK,sBAAsB,MAAM;AACjC,aAAK,oBAAoB;AACzB,aAAK,aAAa,MAAM;AAGxB,YAAI,UAAU,aAAa;AACvB,eAAK,aAAa,cAAc,UAAU;AAAA,QAC9C;AAGA,aAAK,aAAa,iBAAiB,kBAAkB,MAAM;AACvD,eAAK,oBAAoB;AAAA,QAC7B,GAAG,EAAE,MAAM,KAAK,CAAC;AAAA,MACrB,WAAW,UAAU,CAAC,KAAK,qBAAqB,KAAK,aAAa,cAAc,GAAG;AAE/E,aAAK,oBAAoB;AAAA,MAC7B;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,0BAA0B;AACtB,UAAI,KAAK,yBAAyB;AAC9B,qBAAa,KAAK,uBAAuB;AACzC,aAAK,0BAA0B;AAAA,MACnC;AAEA,UAAI,KAAK,gBAAgB,KAAK,aAAa,YAAY;AACnD,aAAK,aAAa,WAAW,YAAY,KAAK,YAAY;AAC1D,aAAK,eAAe;AAAA,MACxB;AAEA,WAAK,sBAAsB,MAAM;AAAA,IACrC;AAAA,IAEA,UAAU;AACN,UAAI,KAAK,aAAa;AAClB,qBAAa,KAAK,WAAW;AAAA,MACjC;AAEA,UAAI,KAAK,wBAAwB;AAC7B,aAAK,uBAAuB,WAAW;AAAA,MAC3C;AAGA,WAAK,wBAAwB;AAE7B,UAAI,KAAK,WAAW,KAAK,QAAQ,YAAY;AACzC,aAAK,QAAQ,WAAW,YAAY,KAAK,OAAO;AAAA,MACpD;AAAA,IACJ;AAAA,EACJ;;;AGrtHA;AACA;AACA;AAGO,MAAM,iBAAN,MAAqB;AAAA,IACxB,YAAY,QAAQ;AAChB,WAAK,SAAS;AACd,WAAK,UAAU;AACf,WAAK,SAAS,CAAC;AACf,WAAK,eAAe;AACpB,WAAK,aAAa;AAGlB,WAAK,UAAU,IAAI,eAAe,QAAQ;AAG1C,WAAK,qBAAqB;AAE1B,WAAK,KAAK;AAAA,IACd;AAAA,IAEA,uBAAuB;AACnB,YAAM,QAAQ,KAAK,QAAQ,sBAAsB;AACjD,UAAI,OAAO;AAEP,YAAI,MAAM,SAAU,MAAK,OAAO,QAAQ,mBAAmB,MAAM;AACjE,YAAI,MAAM,WAAY,MAAK,OAAO,QAAQ,qBAAqB,MAAM;AACrE,YAAI,MAAM,MAAO,MAAK,OAAO,QAAQ,gBAAgB,MAAM;AAC3D,YAAI,MAAM,gBAAiB,MAAK,OAAO,QAAQ,0BAA0B,MAAM;AAC/E,YAAI,MAAM,YAAY,OAAW,MAAK,OAAO,QAAQ,kBAAkB,MAAM;AAAA,MACjF;AAAA,IACJ;AAAA,IAEA,yBAAyB;AACrB,WAAK,QAAQ,uBAAuB;AAAA,QAChC,UAAU,KAAK,OAAO,QAAQ;AAAA,QAC9B,YAAY,KAAK,OAAO,QAAQ;AAAA,QAChC,OAAO,KAAK,OAAO,QAAQ;AAAA,QAC3B,iBAAiB,KAAK,OAAO,QAAQ;AAAA,QACrC,SAAS,KAAK,OAAO,QAAQ;AAAA,MACjC,CAAC;AAAA,IACL;AAAA,IAEA,OAAO;AACH,WAAK,cAAc;AACnB,WAAK,WAAW;AAChB,WAAK,aAAa;AAIlB,UAAI,KAAK,OAAO,QAAQ,mBAAmB,KAAK,OAAO,SAAS,KAAK,CAAC,KAAK,cAAc;AACrF,aAAK,OAAO;AAAA,MAChB;AAAA,IACJ;AAAA,IAEA,gBAAgB;AACZ,WAAK,UAAU,SAAS,cAAc,OAAO;AAAA,QACzC,WAAW,GAAG,YAAK,OAAO,QAAQ,aAAW;AAAA,QAC7C,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc,KAAK,EAAE,iBAAiB;AAAA,QAC1C;AAAA,MACJ,CAAC;AAGD,WAAK,aAAa;AAGlB,YAAM,SAAS,KAAK,OAAO,gBAAgB,KAAK,OAAO;AACvD,aAAO,YAAY,KAAK,OAAO;AAAA,IACnC;AAAA,IAEA,aAAa;AACT,YAAM,aAAa,KAAK,OAAO,QAAQ;AACvC,UAAI,oBAAoB;AAExB,eAAS,IAAI,GAAG,IAAI,WAAW,QAAQ,KAAK;AACxC,cAAM,QAAQ,WAAW,CAAC;AAE1B,YAAI,MAAM,SAAS,eAAe,MAAM,SAAS,YAAY;AAEzD,gBAAM,eAAe,KAAK,OAAO,iBAAiB,KAAK;AACvD,gBAAM,YAAY,gBAAgB,aAAa,aAAa,SAAS;AAErE,eAAK,OAAO,KAAK;AAAA,YACb;AAAA,YACA,UAAU,MAAM;AAAA,YAChB,OAAO,MAAM;AAAA,YACb,MAAM,MAAM;AAAA,YACZ,OAAO;AAAA,YACP;AAAA,UACJ,CAAC;AAKD,cAAI,MAAM,SAAS,WAAW;AAE1B,kBAAM,OAAO;AAAA,UACjB,WAAW,MAAM,SAAS,YAAY;AAElC,kBAAM,OAAO;AAAA,UACjB,OAAO;AAEH,kBAAM,OAAO;AAAA,UACjB;AAEA,cAAI,WAAW;AACX,gCAAoB,KAAK,OAAO,SAAS;AAAA,UAC7C;AAAA,QACJ;AAAA,MACJ;AAIA,UAAI,qBAAqB,GAAG;AACxB,8BAAsB,MAAM;AACxB,eAAK,OAAO,iBAAiB;AAAA,QACjC,CAAC;AAAA,MACL;AAAA,IACJ;AAAA,IAEA,eAAe;AACX,WAAK,OAAO,GAAG,cAAc,MAAM;AAC/B,aAAK,eAAe;AAAA,MACxB,CAAC;AAED,WAAK,OAAO,GAAG,kBAAkB,MAAM;AACnC,aAAK,aAAa;AAAA,MACtB,CAAC;AAGD,WAAK,4BAA4B,SAAS,MAAM;AAC5C,aAAK,yBAAyB;AAAA,MAClC,GAAG,GAAG;AAEN,aAAO,iBAAiB,UAAU,KAAK,yBAAyB;AAGhE,WAAK,OAAO,GAAG,mBAAmB,MAAM;AACpC,uBAAe,MAAM,KAAK,yBAAyB,GAAG,GAAG;AAAA,MAC7D,CAAC;AAED,WAAK,OAAO,GAAG,kBAAkB,MAAM;AACnC,uBAAe,MAAM,KAAK,yBAAyB,GAAG,GAAG;AAAA,MAC7D,CAAC;AAAA,IACL;AAAA,IAEA,OAAO,aAAa,GAAG;AACnB,UAAI,KAAK,OAAO,WAAW,GAAG;AAC1B;AAAA,MACJ;AAGA,UAAI,KAAK,gBAAgB,KAAK,aAAa,OAAO;AAE9C,YAAI,KAAK,kBAAkB;AACvB,eAAK,aAAa,MAAM,oBAAoB,aAAa,KAAK,gBAAgB;AAAA,QAClF;AACA,aAAK,aAAa,MAAM,OAAO;AAAA,MACnC;AAGA,YAAM,gBAAgB,KAAK,OAAO,UAAU;AAE5C,UAAI,iBAAiB,cAAc,OAAO;AAItC,sBAAc,MAAM,OAAO;AAC3B,aAAK,eAAe;AACpB,aAAK,OAAO,MAAM,kBAAkB;AAGpC,YAAI,cAAc,UAAU;AACxB,eAAK,QAAQ,aAAa,QAAQ,cAAc,QAAQ;AAAA,QAC5D;AAGA,YAAI,KAAK,kBAAkB;AACvB,wBAAc,MAAM,oBAAoB,aAAa,KAAK,gBAAgB;AAAA,QAC9E;AAGA,aAAK,mBAAmB,MAAM;AAC1B,eAAK,eAAe;AAAA,QACxB;AACA,sBAAc,MAAM,iBAAiB,aAAa,KAAK,gBAAgB;AAIvE,cAAM,mBAAmB,MAAM;AAC3B,cAAI,cAAc,MAAM,aAAa,GAAG;AAEpC,kBAAM,cAAc,MAAM;AACtB,4BAAc,MAAM,oBAAoB,QAAQ,WAAW;AAC3D,4BAAc,MAAM,oBAAoB,SAAS,WAAW;AAE5D,oCAAsB,MAAM;AACxB,oBAAI,KAAK,gBAAgB,KAAK,aAAa,UAAU,cAAc,OAAO;AACtE,uBAAK,eAAe;AAAA,gBACxB;AAAA,cACJ,CAAC;AAAA,YACL;AACA,0BAAc,MAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACxE,0BAAc,MAAM,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAAA,UAC7E,OAAO;AAEH,kCAAsB,MAAM;AACxB,kBAAI,KAAK,gBAAgB,KAAK,aAAa,UAAU,cAAc,OAAO;AACtE,qBAAK,eAAe;AAAA,cACxB;AAAA,YACJ,CAAC;AAAA,UACL;AAAA,QACJ;AAGA,8BAAsB,MAAM;AACxB,cAAI,KAAK,gBAAgB,KAAK,aAAa,UAAU,cAAc,OAAO;AACtE,6BAAiB;AAAA,UACrB;AAAA,QACJ,CAAC;AAED,aAAK,OAAO,KAAK,mBAAmB,aAAa;AAAA,MACrD;AAAA,IACJ;AAAA,IAEA,UAAU;AACN,UAAI,KAAK,cAAc;AACnB,aAAK,aAAa,MAAM,OAAO;AAC/B,aAAK,eAAe;AAAA,MACxB;AAEA,WAAK,QAAQ,MAAM,UAAU;AAC7B,WAAK,QAAQ,YAAY;AACzB,WAAK,QAAQ,gBAAgB,MAAM;AACnC,WAAK,aAAa;AAClB,WAAK,OAAO,MAAM,kBAAkB;AACpC,WAAK,OAAO,KAAK,kBAAkB;AAAA,IACvC;AAAA,IAEA,iBAAiB;AACb,UAAI,CAAC,KAAK,gBAAgB,CAAC,KAAK,aAAa,OAAO;AAChD;AAAA,MACJ;AAKA,UAAI,KAAK,aAAa,MAAM,SAAS,YAAY;AAC7C,aAAK,aAAa,MAAM,OAAO;AAAA,MACnC;AAGA,UAAI,KAAK,aAAa,MAAM,SAAS,WAAW;AAC5C,aAAK,aAAa,MAAM,OAAO;AAAA,MACnC;AAGA,UAAI,CAAC,KAAK,aAAa,MAAM,YAAY;AAGrC,YAAI,KAAK,aAAa,MAAM,QAAQ,KAAK,aAAa,MAAM,KAAK,SAAS,GAAG;AAGzE,cAAI,KAAK,YAAY;AACjB,iBAAK,QAAQ,YAAY;AACzB,iBAAK,QAAQ,MAAM,UAAU;AAC7B,iBAAK,aAAa;AAAA,UACtB;AAAA,QACJ;AACA;AAAA,MACJ;AAEA,YAAM,aAAa,KAAK,aAAa,MAAM;AAC3C,YAAM,gBAAgB,KAAK,OAAO,QAAQ,QAAQ,YAAY,MAAM;AAEpE,UAAI,WAAW,SAAS,GAAG;AACvB,cAAM,MAAM,WAAW,CAAC;AAGxB,YAAI,KAAK,eAAe,KAAK;AACzB,eAAK,aAAa;AAGlB,cAAI,OAAO,IAAI;AAGf,iBAAO,KAAK,mBAAmB,IAAI;AAGnC,cAAI,eAAe;AAEf,kBAAM,eAAe,KAAK,QAAQ,iBAAiB,IAAI,YAAK,OAAO,QAAQ,aAAW,eAAc;AACpG,yBAAa,QAAQ,QAAM,GAAG,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,kBAAiB,CAAC;AAGnG,kBAAM,QAAQ,OAAO,WAAI,WAAS,KAAI,WAAI;AAC1C,gBAAI,aAAa,KAAK,QAAQ,cAAc,iBAAiB,cAAK,KAAI;AAEtE,gBAAI,CAAC,YAAY;AAEb,2BAAa,SAAS,cAAc,KAAK;AACzC,yBAAW,YAAY,GAAG,YAAK,OAAO,QAAQ,aAAW;AACzD,yBAAW,aAAa,eAAe,KAAK;AAC5C,yBAAW,YAAY,SAAS,aAAa,IAAI;AACjD,mBAAK,QAAQ,YAAY,UAAU;AAAA,YACvC;AAGA,uBAAW,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,kBAAiB;AAG5E,kCAAsB,MAAM;AACxB,kBAAI,YAAY;AACZ,2BAAW,eAAe,EAAE,UAAU,UAAU,OAAO,SAAS,CAAC;AAAA,cACrE;AAAA,YACJ,CAAC;AAAA,UACL,OAAO;AAEH,iBAAK,QAAQ,YAAY,SAAS,aAAa,IAAI;AAAA,UACvD;AAGA,eAAK,QAAQ,MAAM,UAAU;AAG7B,eAAK,yBAAyB;AAE9B,eAAK,OAAO,KAAK,iBAAiB,GAAG;AAAA,QACzC;AAAA,MACJ,WAAW,KAAK,YAAY;AAExB,YAAI,CAAC,eAAe;AAChB,eAAK,QAAQ,YAAY;AACzB,eAAK,QAAQ,MAAM,UAAU;AAAA,QACjC;AACA,aAAK,aAAa;AAAA,MACtB;AAAA,IACJ;AAAA,IAEA,2BAA2B;AA1V/B;AA2VQ,UAAI,CAAC,KAAK,WAAW,KAAK,QAAQ,MAAM,YAAY,QAAQ;AACxD;AAAA,MACJ;AAEA,YAAM,iBAAe,UAAK,OAAO,UAAZ,mBAAmB,eAAc;AACtD,YAAM,SAAS,SAAS;AAExB,UAAI,CAAC,UAAU,CAAC,cAAc;AAE1B,aAAK,QAAQ,MAAM,SAAS;AAC5B;AAAA,MACJ;AAEA,YAAM,YAAW,UAAK,OAAO,eAAZ,mBAAwB;AACzC,UAAI,CAAC,UAAU;AACX;AAAA,MACJ;AAGA,4BAAsB,MAAM;AACxB,YAAI,CAAC,KAAK,WAAW,KAAK,QAAQ,MAAM,YAAY,QAAQ;AACxD;AAAA,QACJ;AAEA,cAAM,eAAe,SAAS,sBAAsB;AACpD,cAAM,cAAc,KAAK,OAAO,aAAa,sBAAsB;AACnE,cAAM,eAAe,YAAY,SAAS,aAAa,MAAM;AAE7D,aAAK,QAAQ,MAAM,SAAS,GAAG,qBAAY;AAE3C,YAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,kBAAQ,IAAI,8BAA8B;AAAA,YACtC;AAAA,YACA;AAAA,YACA,gBAAgB,aAAa;AAAA,YAC7B,cAAc,GAAG,qBAAY;AAAA,UACjC,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IAEA,mBAAmB,MAAM;AAErB,aAAO,KAAK,QAAQ,uBAAuB,uCAAuC;AAClF,aAAO,KAAK,QAAQ,kBAAkB,qBAAqB;AAC3D,aAAO,KAAK,QAAQ,kBAAkB,aAAa;AACnD,aAAO,KAAK,QAAQ,kBAAkB,WAAW;AAGjD,aAAO,KAAK,QAAQ,4BAA4B,uDAAuD;AAEvG,aAAO;AAAA,IACX;AAAA,IAEA,eAAe;AACX,UAAI,CAAC,KAAK,QAAS;AAEnB,YAAM,UAAU,KAAK,OAAO;AAE5B,WAAK,QAAQ,MAAM,WAAW,QAAQ;AACtC,WAAK,QAAQ,MAAM,aAAa,QAAQ;AACxC,WAAK,QAAQ,MAAM,QAAQ,QAAQ;AACnC,WAAK,QAAQ,MAAM,kBAAkB,KAAK;AAAA,QACtC,QAAQ;AAAA,QACR,QAAQ;AAAA,MACZ;AAAA,IACJ;AAAA,IAEA,UAAU,KAAK,OAAO;AAClB,YAAM,SAAS,4CAA4C,KAAK,GAAG;AACnE,UAAI,QAAQ;AACR,eAAO,QAAQ,gBAAS,OAAO,CAAC,GAAG,EAAE,GAAC,MAAK,gBAAS,OAAO,CAAC,GAAG,EAAE,GAAC,MAAK,gBAAS,OAAO,CAAC,GAAG,EAAE,GAAC,MAAK,cAAK;AAAA,MAC5G;AACA,aAAO;AAAA,IACX;AAAA,IAEA,gBAAgB,UAAU,OAAO;AAC7B,cAAQ,UAAU;AAAA,QACd,KAAK;AACD,eAAK,OAAO,QAAQ,mBAAmB;AACvC;AAAA,QACJ,KAAK;AACD,eAAK,OAAO,QAAQ,qBAAqB;AACzC;AAAA,QACJ,KAAK;AACD,eAAK,OAAO,QAAQ,gBAAgB;AACpC;AAAA,QACJ,KAAK;AACD,eAAK,OAAO,QAAQ,0BAA0B;AAC9C;AAAA,QACJ,KAAK;AACD,eAAK,OAAO,QAAQ,kBAAkB;AACtC;AAAA,MACR;AAEA,WAAK,aAAa;AAClB,WAAK,uBAAuB;AAC5B,WAAK,OAAO,KAAK,gBAAgB;AAAA,IACrC;AAAA,IAEA,qBAAqB;AACjB,aAAO,KAAK,OAAO,IAAI,CAAC,GAAG,WAAW;AAAA,QAClC;AAAA,QACA,UAAU,EAAE;AAAA,QACZ,OAAO,EAAE,SAAS,EAAE;AAAA,QACpB,MAAM,EAAE;AAAA,MACZ,EAAE;AAAA,IACN;AAAA,IAEA,YAAY,YAAY;AACpB,UAAI,cAAc,KAAK,aAAa,KAAK,OAAO,QAAQ;AACpD,aAAK,QAAQ;AACb,aAAK,OAAO,UAAU;AAAA,MAC1B;AAAA,IACJ;AAAA,IAEA,UAAU;AACN,WAAK,QAAQ;AAEb,UAAI,KAAK,WAAW,KAAK,QAAQ,YAAY;AACzC,aAAK,QAAQ,WAAW,YAAY,KAAK,OAAO;AAAA,MACpD;AAAA,IACJ;AAAA,EACJ;;;ACldO,MAAM,kBAAN,MAAsB;AAAA,IAC3B,YAAY,QAAQ;AAClB,WAAK,SAAS;AACd,WAAK,YAAY,OAAO,QAAQ;AAEhC,WAAK,KAAK;AAAA,IACZ;AAAA,IAEA,OAAO;AACL,WAAK,aAAa;AAAA,IACpB;AAAA,IAEA,eAAe;AAGb,WAAK,OAAO,UAAU,iBAAiB,WAAW,CAAC,MAAM;AACvD,aAAK,cAAc,CAAC;AAAA,MACtB,GAAG,IAAI;AAGP,UAAI,CAAC,KAAK,OAAO,UAAU,aAAa,UAAU,GAAG;AACnD,aAAK,OAAO,UAAU,aAAa,YAAY,GAAG;AAAA,MACpD;AAAA,IACF;AAAA,IAEA,cAAc,GAAG;AA7BnB;AA+BI,UAAI,EAAE,OAAO,YAAY,WAAW,EAAE,OAAO,YAAY,cAAc,EAAE,OAAO,YAAY,UAAU;AACpG;AAAA,MACF;AAGA,YAAM,gBAAgB,SAAS;AAC/B,UAAI,eAAe;AACjB,cAAM,OAAO,cAAc,QAAQ,6BAA6B;AAChE,YAAI,MAAM;AACR;AAAA,QACF;AAGE,cAAM,iBAAiB,cAAc,QAAQ,8BAA8B;AAC3E,YAAI,gBAAgB;AAClB;AAAA,QACF;AAIF,cAAM,cAAc,cAAc,QAAQ,+BAA+B;AACzE,YAAI,aAAa;AACf,gBAAM,aAAY,UAAK,OAAO,wBAAZ,mBAAiC;AACnD,eAAI,uCAAW,sBAAoB,uCAAW,qBAAoB;AAChE;AAAA,UACF;AAAA,QACF;AAGA,cAAM,mBAAmB,cAAc,QAAQ,2BAA2B;AAC1E,YAAI,kBAAkB;AACpB,gBAAM,aAAY,UAAK,OAAO,sBAAZ,mBAA+B;AACjD,eAAI,uCAAW,sBAAoB,uCAAW,qBAAoB;AAChE;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAEA,YAAM,MAAM,EAAE;AACd,UAAI,UAAU;AAGd,UAAI,QAAQ,YAAY,KAAK,OAAO,MAAM,YAAY;AACpD,aAAK,OAAO,eAAe;AAC3B,UAAE,eAAe;AACjB,UAAE,gBAAgB;AAClB;AAAA,MACF;AAGA,iBAAW,CAAC,QAAQ,IAAI,KAAK,OAAO,QAAQ,KAAK,SAAS,GAAG;AAC3D,YAAI,KAAK,SAAS,GAAG,GAAG;AACtB,oBAAU,KAAK,cAAc,QAAQ,CAAC;AACtC,cAAI,SAAS;AACX,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,eAAe,MAAM;AAC1B;AAAA,UACF;AAAA,QACF;AAAA,MACF;AAGA,UAAI,CAAC,WAAW,KAAK,OAAO,QAAQ,OAAO;AACzC,gBAAQ,IAAI,2BAA2B,EAAE,KAAK,SAAS,EAAE,MAAM,aAAa,EAAE,QAAQ;AAAA,MACxF;AAAA,IACF;AAAA,IAEA,cAAc,QAAQ,OAAO;AAC3B,cAAQ,QAAQ;AAAA,QACd,KAAK;AACH,eAAK,OAAO,OAAO;AACnB,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,UAAU,KAAK,IAAI,GAAG,KAAK,OAAO,MAAM,SAAS,GAAG,CAAC;AACjE,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,UAAU,KAAK,IAAI,GAAG,KAAK,OAAO,MAAM,SAAS,GAAG,CAAC;AACjE,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,YAAY;AACxB,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,aAAa;AACzB,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,WAAW;AACvB,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO,iBAAiB;AAC7B,iBAAO;AAAA,QAET,KAAK;AAGH,cAAI,KAAK,OAAO,kBAAkB,KAAK,OAAO,eAAe,OAAO,SAAS,GAAG;AAE9E,kBAAM,iBAAiB,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS;AACjF,gBAAI,gBAAgB;AAClB,mBAAK,OAAO,WAAW,iBAAiB,cAAc;AAAA,YACxD,OAAO;AAEL,mBAAK,OAAO,eAAe;AAAA,YAC7B;AAAA,UACF,OAAO;AACL,iBAAK,OAAO,eAAe;AAAA,UAC7B;AACA,iBAAO;AAAA,QAET,KAAK;AAEH,cAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,cAAc;AAC1E,iBAAK,OAAO,WAAW,qBAAqB,KAAK,OAAO,WAAW,SAAS,YAAY;AACxF,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO;AAAA,YACV,KAAK,IAAI,GAAG,KAAK,OAAO,MAAM,gBAAgB,IAAI;AAAA,UACpD;AACA,iBAAO;AAAA,QAET,KAAK;AACH,eAAK,OAAO;AAAA,YACV,KAAK,IAAI,MAAM,KAAK,OAAO,MAAM,gBAAgB,IAAI;AAAA,UACvD;AACA,iBAAO;AAAA,QAET,KAAK;AAEH,cAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,OAAO;AACnE,iBAAK,OAAO,WAAW,cAAc,KAAK,OAAO,WAAW,SAAS,KAAK;AAC1E,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET,KAAK;AAEH,cAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,SAAS;AACrE,iBAAK,OAAO,WAAW,gBAAgB,KAAK,OAAO,WAAW,SAAS,OAAO;AAC9E,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET,KAAK;AAEH,cAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,UAAU;AACtE,iBAAK,OAAO,WAAW,iBAAiB,KAAK,OAAO,WAAW,SAAS,QAAQ;AAChF,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET,KAAK;AAEH,cAAI,KAAK,OAAO,mBAAmB;AACjC,iBAAK,OAAO,kBAAkB,iBAAiB;AAC/C,mBAAO;AAAA,UACT;AACA,iBAAO;AAAA,QAET;AACE,iBAAO;AAAA,MACX;AAAA,IACF;AAAA,IAEA,eAAe,QAAQ;AACrB,UAAI,CAAC,KAAK,OAAO,QAAQ,0BAA2B;AAEpD,UAAI,UAAU;AAEd,cAAQ,QAAQ;AAAA,QACd,KAAK;AACH,oBAAU,KAAK,OAAO,MAAM,UAAU,YAAY;AAClD;AAAA,QACF,KAAK;AACH,oBAAU,UAAU,YAAK,MAAM,KAAK,OAAO,MAAM,SAAS,GAAG,GAAC;AAC9D;AAAA,QACF,KAAK;AACH,oBAAU,UAAU,YAAK,MAAM,KAAK,OAAO,MAAM,SAAS,GAAG,GAAC;AAC9D;AAAA,QACF,KAAK;AACH,oBAAU,KAAK,OAAO,MAAM,QAAQ,UAAU;AAC9C;AAAA,QACF,KAAK;AACH,oBAAU,KAAK,OAAO,MAAM,aAAa,eAAe;AACxD;AAAA,QACF,KAAK;AACH,oBAAU,KAAK,OAAO,MAAM,kBAAkB,gBAAgB;AAC9D;AAAA,QACF,KAAK;AAAA,QACL,KAAK;AACH,oBAAU,SAAS,YAAK,OAAO,MAAM,eAAa;AAClD;AAAA,MACJ;AAEA,UAAI,SAAS;AACX,aAAK,SAAS,OAAO;AAAA,MACvB;AAAA,IACF;AAAA,IAEA,SAAS,SAAS,WAAW,UAAU;AAErC,UAAI,YAAY,SAAS,eAAe,kBAAkB;AAE1D,UAAI,CAAC,WAAW;AACd,oBAAY,SAAS,cAAc,KAAK;AACxC,kBAAU,KAAK;AACf,kBAAU,YAAY;AACtB,kBAAU,aAAa,aAAa,QAAQ;AAC5C,kBAAU,aAAa,eAAe,MAAM;AAC5C,kBAAU,MAAM,UAAU;AAO1B,iBAAS,KAAK,YAAY,SAAS;AAAA,MACrC;AAGA,gBAAU,cAAc;AACxB,iBAAW,MAAM;AACf,kBAAU,cAAc;AAAA,MAC1B,GAAG,GAAG;AAAA,IACR;AAAA,IAEA,eAAe,QAAQ,MAAM;AAC3B,UAAI,MAAM,QAAQ,IAAI,GAAG;AACvB,aAAK,UAAU,MAAM,IAAI;AAAA,MAC3B;AAAA,IACF;AAAA,IAEA,UAAU;AAAA,IAEV;AAAA,EACF;;;ALxQA;AACA;AACA;AACA;AACA;AACA;AACA;;;AMTO,MAAM,0BAAN,MAA8B;AAAA,IACjC,YAAY,QAAQ;AAChB,WAAK,SAAS;AAGd,WAAK,UAAU;AACf,WAAK,eAAe;AAGpB,WAAK,MAAM,OAAO,QAAQ;AAC1B,WAAK,gBAAgB;AACrB,WAAK,iBAAiB;AACtB,WAAK,gBAAgB,CAAC;AAAA,IAC1B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,uBAAuB,gBAAgB,eAAe;AAElD,iBAAW,YAAY,gBAAgB;AACnC,cAAM,UAAU,SAAS,aAAa,eAAe;AACrD,cAAM,UAAU,SAAS,aAAa,eAAe;AAErD,YAAI,WAAW,SAAS;AACpB,cAAI,CAAC,KAAK,eAAe;AACrB,iBAAK,gBAAgB;AAAA,UACzB;AAEA,cAAI,SAAS;AACT,gBAAI,CAAC,KAAK,gBAAgB;AACtB,mBAAK,iBAAiB;AAAA,YAC1B;AACA,gBAAI,CAAC,KAAK,OAAO,aAAa;AAC1B,mBAAK,OAAO,cAAc;AAAA,YAC9B;AAAA,UACJ,OAAO;AACH,kBAAM,iBAAiB,SAAS,aAAa,KAAK;AAClD,gBAAI,CAAC,KAAK,kBAAkB,gBAAgB;AACxC,mBAAK,iBAAiB;AAAA,YAC1B;AACA,gBAAI,CAAC,KAAK,OAAO,eAAe,gBAAgB;AAC5C,mBAAK,OAAO,cAAc;AAAA,YAC9B;AAAA,UACJ;AAEA,cAAI,WAAW,CAAC,KAAK,KAAK;AACtB,iBAAK,MAAM;AAAA,UACf;AAAA,QACJ;AAAA,MACJ;AAGA,oBAAc,QAAQ,aAAW;AAC7B,cAAM,YAAY,QAAQ,aAAa,MAAM;AAC7C,cAAM,eAAe,QAAQ,aAAa,eAAe;AAEzD,aAAK,cAAc,cAAc,cAAc,eAC1C,cAAc,cAAc,cAAc,mBAAmB,cAAc;AAC5E,eAAK,cAAc,KAAK;AAAA,YACpB,cAAc;AAAA,YACd,aAAa,QAAQ,aAAa,KAAK;AAAA,YACvC,cAAc;AAAA,YACd,kBAAkB,QAAQ,aAAa,eAAe,KAAK,QAAQ,aAAa,KAAK;AAAA,YACrF,UAAU;AAAA,UACd,CAAC;AACD,eAAK,OAAO,IAAI,4BAA4B,kBAAS,YAAW,eAAQ,aAAa,KAAK,GAAC,QAAO,oBAAc;AAAA,QACpH;AAAA,MACJ,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc;AACV,YAAM,4BAA4B,KAAK,OAAO,eAAe;AAAA,QACzD,QAAM,GAAG,aAAa,eAAe;AAAA,MACzC;AACA,aAAO,CAAC,EAAE,KAAK,OAAO,6BAA6B,KAAK,cAAc,SAAS;AAAA,IACnF;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,SAAS;AACX,YAAM,4BAA4B,KAAK,OAAO,eAAe;AAAA,QACzD,QAAM,GAAG,aAAa,eAAe;AAAA,MACzC;AACA,YAAM,oBAAoB,KAAK,cAAc,SAAS;AAEtD,UAAI,CAAC,KAAK,OAAO,CAAC,6BAA6B,CAAC,mBAAmB;AAC/D,gBAAQ,KAAK,0EAA0E;AACvF;AAAA,MACJ;AAEA,WAAK,eAAe;AAGpB,YAAM,cAAc,KAAK,OAAO,MAAM;AACtC,YAAM,aAAa,KAAK,OAAO,MAAM;AACrC,YAAM,cAAc,KAAK,OAAO,QAAQ,UACrB,KAAK,OAAO,QAAQ,aAAa,QAAQ,KACzC,KAAK,OAAO,QAAQ;AACvC,YAAM,mBAAmB,cAAc,OAAO,CAAC;AAG/C,YAAM,qBAAqB,KAAK,uBAAuB;AAGvD,UAAI,KAAK,eAAe;AACpB,cAAM,KAAK,yBAAyB,aAAa,YAAY,aAAa,kBAAkB,kBAAkB;AAAA,MAClH,OAAO;AACH,cAAM,KAAK,qBAAqB,aAAa,YAAY,aAAa,gBAAgB;AAAA,MAC1F;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,UAAU;AACZ,UAAI,CAAC,KAAK,OAAO,aAAa;AAC1B;AAAA,MACJ;AAEA,WAAK,eAAe;AAGpB,YAAM,cAAc,KAAK,OAAO,MAAM;AACtC,YAAM,aAAa,KAAK,OAAO,MAAM;AACrC,YAAM,cAAc,KAAK,OAAO,QAAQ,UACrB,KAAK,OAAO,QAAQ,aAAa,QAAQ,KACzC,KAAK,OAAO,QAAQ;AACvC,YAAM,mBAAmB,cAAc,OAAO,CAAC;AAG/C,YAAM,qBAAqB,KAAK,uBAAuB;AAEvD,UAAI,KAAK,eAAe;AACpB,cAAM,KAAK,0BAA0B,aAAa,YAAY,aAAa,kBAAkB,kBAAkB;AAAA,MACnH,OAAO;AACH,cAAM,KAAK,sBAAsB,aAAa,YAAY,WAAW;AAAA,MACzE;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,SAAS;AACX,YAAM,mBAAmB,KAAK,OAAO,cAAc,cAAc;AACjE,YAAM,yBAAyB,KAAK,YAAY;AAEhD,UAAI,oBAAoB,CAAC,wBAAwB;AAE7C,YAAI,iBAAiB,SAAS,WAAW;AACrC,2BAAiB,OAAO;AACxB,eAAK,UAAU;AACf,eAAK,OAAO,KAAK,0BAA0B;AAAA,QAC/C,OAAO;AACH,2BAAiB,OAAO;AACxB,eAAK,UAAU;AACf,eAAK,OAAO,KAAK,yBAAyB;AAAA,QAC9C;AAAA,MACJ,WAAW,oBAAoB,wBAAwB;AAEnD,YAAI,KAAK,SAAS;AACd,eAAK,eAAe;AACpB,gBAAM,KAAK,QAAQ;AAAA,QACvB,OAAO;AACH,2BAAiB,OAAO;AACxB,eAAK,eAAe;AACpB,gBAAM,KAAK,OAAO;AAAA,QACtB;AAAA,MACJ,WAAW,wBAAwB;AAE/B,YAAI,KAAK,SAAS;AACd,eAAK,eAAe;AACpB,gBAAM,KAAK,QAAQ;AAAA,QACvB,OAAO;AACH,eAAK,eAAe;AACpB,gBAAM,KAAK,OAAO;AAAA,QACtB;AAAA,MACJ;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,yBAAyB;AACrB,UAAI,KAAK,OAAO,kBACZ,KAAK,OAAO,eAAe,gBAC3B,KAAK,OAAO,eAAe,YAAY;AACvC,eAAO,KAAK,OAAO,eAAe,WAAW;AAAA,MACjD;AACA,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,qBAAqB,KAAK;AAC5B,UAAI;AACA,cAAM,WAAW,MAAM,MAAM,KAAK,EAAE,QAAQ,OAAO,CAAC;AACpD,eAAO,SAAS;AAAA,MACpB,SAAQ;AACJ,eAAO;AAAA,MACX;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,mBAAmB,cAAc,MAAM;AACzC,UAAI,KAAK,cAAc,WAAW,EAAG,QAAO,CAAC;AAE7C,YAAM,gBAAgB,CAAC;AAEvB,YAAM,qBAAqB,KAAK,cAAc,IAAI,OAAO,cAAc;AACnE,YAAI,UAAU,gBAAgB,UAAU,cAAc;AAClD,cAAI,UAAU,aAAa,MAAM;AAC7B,gBAAI;AACA,oBAAM,SAAS,MAAM,KAAK;AAAA,gBACtB,cAAc,UAAU,eAAe,UAAU;AAAA,cACrD;AACA,qBAAO,EAAE,WAAW,OAAO;AAAA,YAC/B,SAAQ;AACJ,qBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,YACtC;AAAA,UACJ;AAAA,QACJ;AACA,eAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,MACtC,CAAC;AAED,YAAM,oBAAoB,MAAM,QAAQ,IAAI,kBAAkB;AAC9D,YAAM,eAAe,kBAAkB,OAAO,YAAU,OAAO,MAAM;AAErE,UAAI,aAAa,SAAS,GAAG;AAEzB,cAAM,aAAa,oBAAI,IAAI;AAC3B,qBAAa,QAAQ,CAAC,EAAE,UAAU,MAAM;AACpC,gBAAM,YAAY,UAAU,aAAa;AACzC,cAAI,WAAW;AACX,uBAAW,IAAI,WAAW;AAAA,cACtB,YAAY,UAAU,SAAS;AAAA,cAC/B,WAAW,UAAU,SAAS;AAAA,YAClC,CAAC;AAAA,UACL,OAAO;AACH,uBAAW,IAAI,WAAW,EAAE,YAAY,OAAO,WAAW,MAAM,CAAC;AAAA,UACrE;AAAA,QACJ,CAAC;AAGD,cAAM,gBAAgB,aAAa,IAAI,CAAC,EAAE,UAAU,MAAM;AACtD,gBAAM,aAAa,CAAC;AACpB,gBAAM,KAAK,UAAU,aAAa,UAAU,EAAE,QAAQ,UAAQ;AAC1D,uBAAW,KAAK,IAAI,IAAI,KAAK;AAAA,UACjC,CAAC;AAED,gBAAM,SAAS;AAAA,YACX;AAAA,YACA,QAAQ,UAAU,aAAa,aAAa,KAAK;AAAA,YACjD,QAAQ,UAAU,aAAa;AAAA,YAC/B,aAAa,UAAU,aAAa;AAAA,YACpC;AAAA,UACJ;AAEA,oBAAU,aAAa,OAAO;AAC9B,iBAAO;AAAA,QACX,CAAC;AAGD,aAAK,OAAO,QAAQ,KAAK;AAGzB,cAAM,IAAI,QAAQ,aAAW;AACzB,qBAAW,MAAM;AACb,0BAAc,QAAQ,CAAC,EAAE,WAAW,QAAQ,aAAa,WAAW,MAAM;AACtE,4BAAc,KAAK,SAAS;AAE5B,oBAAM,kBAAkB,SAAS,cAAc,OAAO;AACtD,oBAAM,SAAS,cAAc,UAAU,eAAe,UAAU;AAChE,8BAAgB,aAAa,OAAO,MAAM;AAE1C,qBAAO,KAAK,UAAU,EAAE,QAAQ,cAAY;AACxC,oBAAI,aAAa,SAAS,aAAa,iBAAiB;AACpD,kCAAgB,aAAa,UAAU,WAAW,QAAQ,CAAC;AAAA,gBAC/D;AAAA,cACJ,CAAC;AAGD,oBAAM,eAAe,UAAU,KAAK,OAAO;AAE3C,kBAAI,eAAe,YAAY,YAAY;AACvC,6BAAa,aAAa,iBAAiB,WAAW;AAAA,cAC1D,OAAO;AACH,6BAAa,YAAY,eAAe;AAAA,cAC5C;AAEA,wBAAU,eAAe;AAAA,YAC7B,CAAC;AAED,iBAAK,OAAO,qBAAqB;AAGjC,kBAAM,iBAAiB,MAAM;AACzB,mBAAK,OAAO,kBAAkB,MAAM;AAChC,8BAAc,QAAQ,CAAC,cAAc;AACjC,wBAAM,eAAe,UAAU,aAAa;AAC5C,sBAAI,cAAc;AACd,0BAAM,WAAW,WAAW,IAAI,SAAS,KAAK,EAAE,YAAY,OAAO,WAAW,MAAM;AACpF,iCAAa,OAAO;AAEpB,0BAAM,cAAc,MAAM;AACtB,0BAAI,SAAS,cAAc,SAAS,WAAW;AAC3C,qCAAa,OAAO;AAAA,sBACxB,OAAO;AACH,qCAAa,OAAO;AAAA,sBACxB;AAAA,oBACJ;AAEA,wBAAI,aAAa,cAAc,GAAG;AAC9B,kCAAY;AAAA,oBAChB,OAAO;AACH,mCAAa,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACjE,mCAAa,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAAA,oBACtE;AAAA,kBACJ;AAAA,gBACJ,CAAC;AAAA,cACL,GAAG,GAAG;AAAA,YACV;AAEA,gBAAI,KAAK,OAAO,QAAQ,cAAc,GAAG;AACrC,yBAAW,gBAAgB,GAAG;AAAA,YAClC,OAAO;AACH,mBAAK,OAAO,QAAQ,iBAAiB,kBAAkB,gBAAgB,EAAE,MAAM,KAAK,CAAC;AACrF,yBAAW,gBAAgB,GAAI;AAAA,YACnC;AAEA,oBAAQ;AAAA,UACZ,GAAG,GAAG;AAAA,QACV,CAAC;AAAA,MACL;AAEA,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,sBAAsB,cAAc,MAAM;AACtC,YAAM,iBAAiB,KAAK,OAAO;AACnC,YAAM,kBAAkB,CAAC;AAEzB,qBAAe,QAAQ,CAAC,aAAa;AACjC,cAAM,cAAc,SAAS,aAAa,eAAe;AACzD,cAAM,aAAa,SAAS,aAAa,KAAK;AAE9C,YAAI,aAAa;AACb,gBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,cAAI,UAAU,SAAS,aAAa,eAAe,KAAK;AAExD,0BAAgB,KAAK;AAAA,YACjB,KAAK,cAAc,cAAc;AAAA,YACjC;AAAA,YACA;AAAA,YACA,SAAS;AAAA,UACb,CAAC;AAAA,QACL,OAAO;AACH,0BAAgB,KAAK;AAAA,YACjB,KAAK,SAAS,aAAa,KAAK;AAAA,YAChC,MAAM,SAAS,aAAa,MAAM;AAAA,YAClC,SAAS;AAAA,YACT,SAAS;AAAA,UACb,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAGD,UAAI,KAAK,OAAO,QAAQ,aAAa,KAAK,GAAG;AACzC,aAAK,OAAO,QAAQ,gBAAgB,KAAK;AAAA,MAC7C;AAGA,qBAAe,QAAQ,cAAY,SAAS,OAAO,CAAC;AAGpD,sBAAgB,QAAQ,gBAAc;AAClC,cAAM,YAAY,SAAS,cAAc,QAAQ;AACjD,kBAAU,aAAa,OAAO,WAAW,GAAG;AAC5C,YAAI,WAAW,MAAM;AACjB,oBAAU,aAAa,QAAQ,WAAW,IAAI;AAAA,QAClD;AACA,YAAI,WAAW,SAAS;AACpB,oBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,QAC9D;AACA,YAAI,WAAW,SAAS;AACpB,oBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,QAC9D;AAEA,cAAM,aAAa,KAAK,OAAO,QAAQ,cAAc,OAAO;AAC5D,YAAI,YAAY;AACZ,eAAK,OAAO,QAAQ,aAAa,WAAW,UAAU;AAAA,QAC1D,OAAO;AACH,eAAK,OAAO,QAAQ,YAAY,SAAS;AAAA,QAC7C;AAAA,MACJ,CAAC;AAED,WAAK,OAAO,uBAAuB;AACnC,WAAK,OAAO,uBAAuB;AAAA,IACvC;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,mBAAmB,WAAW,OAAO;AAEvC,YAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,YAAI,KAAK,OAAO,QAAQ,cAAc,GAAG;AACrC,kBAAQ;AAAA,QACZ,OAAO;AACH,gBAAM,SAAS,MAAM;AACjB,iBAAK,OAAO,QAAQ,oBAAoB,kBAAkB,MAAM;AAChE,oBAAQ;AAAA,UACZ;AACA,eAAK,OAAO,QAAQ,iBAAiB,kBAAkB,MAAM;AAAA,QACjE;AAAA,MACJ,CAAC;AAGD,YAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,UAAI,UAAU;AACV,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,cAAI,KAAK,OAAO,QAAQ,cAAc,GAAG;AACrC,oBAAQ;AAAA,UACZ,OAAO;AACH,kBAAM,YAAY,MAAM;AACpB,mBAAK,OAAO,QAAQ,oBAAoB,WAAW,SAAS;AAC5D,mBAAK,OAAO,QAAQ,oBAAoB,kBAAkB,SAAS;AACnE,sBAAQ;AAAA,YACZ;AACA,iBAAK,OAAO,QAAQ,iBAAiB,WAAW,WAAW,EAAE,MAAM,KAAK,CAAC;AACzE,iBAAK,OAAO,QAAQ,iBAAiB,kBAAkB,WAAW,EAAE,MAAM,KAAK,CAAC;AAChF,uBAAW,MAAM;AACb,mBAAK,OAAO,QAAQ,oBAAoB,WAAW,SAAS;AAC5D,mBAAK,OAAO,QAAQ,oBAAoB,kBAAkB,SAAS;AACnE,sBAAQ;AAAA,YACZ,GAAG,GAAI;AAAA,UACX;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,sBAAsB,aAAa,YAAY,kBAAkB,oBAAoB;AAEvF,UAAI,WAAW;AACf,UAAI,sBAAsB,KAAK,OAAO,kBAAkB,KAAK,OAAO,eAAe,OAAO,SAAS,GAAG;AAClG,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AACrD,cAAM,eAAe,KAAK,OAAO;AAAA,UAC7B;AAAA,UACA,KAAK,OAAO,eAAe;AAAA,QAC/B;AACA,YAAI,iBAAiB,MAAM;AACvB,qBAAW;AACX,cAAI,KAAK,OAAO,QAAQ,OAAO;AAC3B,iBAAK,OAAO,IAAI,iCAAiC,oBAAW,SAAQ,iBAAQ,IAAG;AAAA,UACnF;AAAA,QACJ;AAAA,MACJ;AAGA,UAAI,WAAW,GAAG;AACd,aAAK,OAAO,KAAK,QAAQ;AACzB,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,MACzD;AAGA,UAAI,YAAY;AACZ,cAAM,KAAK,OAAO,KAAK;AACvB,aAAK,OAAO,kBAAkB,MAAM;AAChC,eAAK,OAAO,kBAAkB;AAAA,QAClC,GAAG,GAAG;AAAA,MACV,OAAO;AACH,aAAK,OAAO,MAAM;AAClB,YAAI,CAAC,kBAAkB;AACnB,eAAK,OAAO,kBAAkB;AAAA,QAClC;AAAA,MACJ;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,yBAAyB,aAAa,YAAY,aAAa,kBAAkB,oBAAoB;AAEvG,YAAM,KAAK,mBAAmB,IAAI;AAGlC,WAAK,sBAAsB,IAAI;AAG/B,UAAI,eAAe,KAAK,OAAO,QAAQ,YAAY,SAAS;AACxD,aAAK,OAAO,QAAQ,SAAS;AAAA,MACjC;AAGA,WAAK,OAAO,QAAQ,KAAK;AAGzB,YAAM,KAAK,mBAAmB,cAAc,KAAK,UAAU;AAG3D,YAAM,KAAK,sBAAsB,aAAa,YAAY,kBAAkB,kBAAkB;AAG9F,UAAI,CAAC,KAAK,aAAc;AACxB,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,0BAA0B;AAC5C,WAAK,OAAO,KAAK,yBAAyB;AAG1C,WAAK,kBAAkB;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,qBAAqB,aAAa,YAAY,aAAa,kBAAkB;AAE/E,YAAM,KAAK,mBAAmB,IAAI;AAGlC,UAAI,eAAe,KAAK,OAAO,QAAQ,YAAY,SAAS;AACxD,aAAK,OAAO,QAAQ,SAAS;AAAA,MACjC;AAGA,WAAK,OAAO,QAAQ,MAAM,KAAK;AAG/B,YAAM,KAAK,mBAAmB,cAAc,KAAK,UAAU;AAE3D,UAAI,cAAc,GAAG;AACjB,aAAK,OAAO,KAAK,WAAW;AAC5B,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,MACzD;AAEA,UAAI,YAAY;AACZ,cAAM,KAAK,OAAO,KAAK;AAAA,MAC3B,OAAO;AACH,aAAK,OAAO,MAAM;AAClB,YAAI,CAAC,kBAAkB;AACnB,eAAK,OAAO,kBAAkB;AAAA,QAClC;AAAA,MACJ;AAEA,UAAI,CAAC,KAAK,aAAc;AACxB,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,0BAA0B;AAC5C,WAAK,OAAO,KAAK,yBAAyB;AAG1C,WAAK,kBAAkB;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,0BAA0B,aAAa,YAAY,aAAa,kBAAkB,oBAAoB;AAExG,YAAM,KAAK,mBAAmB,KAAK;AAGnC,WAAK,sBAAsB,KAAK;AAGhC,UAAI,eAAe,KAAK,OAAO,QAAQ,YAAY,SAAS;AACxD,aAAK,OAAO,QAAQ,SAAS;AAAA,MACjC;AAGA,WAAK,OAAO,QAAQ,KAAK;AACzB,WAAK,OAAO,qBAAqB;AAGjC,YAAM,KAAK,mBAAmB,cAAc,KAAK,UAAU;AAG3D,YAAM,KAAK,sBAAsB,aAAa,YAAY,kBAAkB,kBAAkB;AAG9F,UAAI,KAAK,OAAO,gBAAgB;AAC5B,aAAK,OAAO,eAAe,QAAQ;AACnC,aAAK,OAAO,iBAAiB,IAAI,eAAe,KAAK,MAAM;AAAA,MAC/D;AAGA,UAAI,KAAK,aAAc;AACvB,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,0BAA0B;AAC5C,WAAK,OAAO,KAAK,0BAA0B;AAG3C,WAAK,kBAAkB;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,sBAAsB,aAAa,YAAY,aAAa;AAE9D,YAAM,KAAK,mBAAmB,KAAK;AAGnC,UAAI,eAAe,KAAK,OAAO,QAAQ,YAAY,SAAS;AACxD,aAAK,OAAO,QAAQ,SAAS;AAAA,MACjC;AAGA,YAAM,mBAAmB,KAAK,kBAAkB,KAAK,OAAO;AAC5D,WAAK,OAAO,QAAQ,MAAM;AAC1B,WAAK,OAAO,QAAQ,KAAK;AAGzB,YAAM,KAAK,mBAAmB,cAAc,KAAK,UAAU;AAE3D,UAAI,cAAc,GAAG;AACjB,aAAK,OAAO,KAAK,WAAW;AAAA,MAChC;AAEA,UAAI,YAAY;AACZ,cAAM,KAAK,OAAO,KAAK;AAAA,MAC3B;AAEA,UAAI,KAAK,aAAc;AACvB,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,0BAA0B;AAC5C,WAAK,OAAO,KAAK,0BAA0B;AAG3C,WAAK,kBAAkB;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AAChB,UAAI,KAAK,OAAO,qBAAqB,KAAK,OAAO,kBAAkB,WAAW;AAE1E,aAAK,OAAO,kBAAkB,MAAM;AAChC,cAAI,KAAK,OAAO,qBAAqB,KAAK,OAAO,kBAAkB,oBAAoB;AACnF,iBAAK,OAAO,kBAAkB,mBAAmB;AAAA,UACrD;AAAA,QACJ,GAAG,GAAG;AAAA,MACV;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc,qBAAqB;AAC/B,WAAK,MAAM,uBAAuB;AAElC,WAAK,UAAU;AACf,WAAK,eAAe;AACpB,WAAK,gBAAgB;AACrB,WAAK,iBAAiB;AACtB,WAAK,gBAAgB,CAAC;AAAA,IAC1B;AAAA;AAAA;AAAA;AAAA,IAKA,eAAe;AACX,WAAK,OAAO,qBAAqB;AACjC,WAAK,uBAAuB,KAAK,OAAO,gBAAgB,KAAK,OAAO,aAAa;AAAA,IACrF;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AACN,WAAK,UAAU;AACf,WAAK,eAAe;AACpB,WAAK,gBAAgB,CAAC;AACtB,WAAK,gBAAgB;AACrB,WAAK,iBAAiB;AAAA,IAC1B;AAAA,EACJ;;;ACtrBA;AACA;AACA;AACA;AACA;AACA;AAEO,MAAM,sBAAN,MAA0B;AAAA,IAC7B,YAAY,QAAQ;AAChB,WAAK,SAAS;AAGd,WAAK,MAAM,OAAO,QAAQ;AAC1B,WAAK,UAAU,OAAO,QAAQ,uBAAuB,CAAC;AACtD,WAAK,kBAAkB;AACvB,WAAK,kBAAkB,OAAO,QAAQ,wBAAwB;AAG9D,WAAK,UAAU;AACf,WAAK,SAAS;AACd,WAAK,QAAQ;AACb,WAAK,WAAW;AAChB,WAAK,iBAAiB;AACtB,WAAK,eAAe;AACpB,WAAK,gBAAgB,CAAC;AAGtB,WAAK,UAAU;AACf,WAAK,aAAa;AAClB,WAAK,sBAAsB;AAC3B,WAAK,0BAA0B;AAC/B,WAAK,2BAA2B;AAChC,WAAK,uBAAuB;AAC5B,WAAK,sBAAsB;AAC3B,WAAK,yBAAyB;AAC9B,WAAK,4BAA4B;AAGjC,WAAK,WAAW;AAChB,WAAK,mBAAmB;AACxB,WAAK,sBAAsB;AAC3B,WAAK,YAAY;AACjB,WAAK,uBAAuB;AAC5B,WAAK,yBAAyB;AAC9B,WAAK,mBAAmB;AAGxB,WAAK,mBAAmB;AACxB,WAAK,iBAAiB;AACtB,WAAK,qBAAqB;AAC1B,WAAK,mBAAmB;AAAA,IAC5B;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc;AACV,aAAO,OAAO,KAAK,KAAK,OAAO,EAAE,SAAS,KAAK,CAAC,CAAC,KAAK;AAAA,IAC1D;AAAA;AAAA;AAAA;AAAA,IAKA,SAAS;AACL,YAAM,qBAAqB,OAAO,KAAK,KAAK,OAAO,EAAE,SAAS;AAC9D,YAAM,kBAAkB,CAAC,CAAC,KAAK;AAE/B,UAAI,CAAC,sBAAsB,CAAC,iBAAiB;AACzC,gBAAQ,KAAK,wCAAwC;AACrD;AAAA,MACJ;AAEA,UAAI,KAAK,SAAS;AAEd,aAAK,QAAQ,MAAM,UAAU;AAC7B,aAAK,UAAU;AACf,aAAK,OAAO,MAAM,sBAAsB;AACxC,aAAK,OAAO,KAAK,qBAAqB;AAGtC,aAAK,OAAO,kBAAkB,MAAM;AAChC,cAAI,KAAK,kBAAkB,SAAS,SAAS,KAAK,cAAc,GAAG;AAC/D,iBAAK,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UACrD;AAAA,QACJ,GAAG,GAAG;AACN;AAAA,MACJ;AAGA,UAAI,cAAc;AAClB,UAAI,aAAa;AAEjB,UAAI,oBAAoB;AACpB,sBAAc,KAAK,0BAA0B;AAC7C,qBAAa,KAAK,QAAQ,WAAW;AACrC,aAAK,kBAAkB;AAAA,MAC3B,OAAO;AACH,qBAAa,KAAK;AAAA,MACtB;AAGA,WAAK,eAAe;AACpB,WAAK,cAAc,oBAAoB,WAAW;AAClD,WAAK,aAAa,UAAU;AAC5B,WAAK,qBAAqB;AAG1B,WAAK,QAAQ,YAAY,KAAK,MAAM;AACpC,WAAK,QAAQ,YAAY,KAAK,KAAK;AACnC,WAAK,cAAc,QAAQ,YAAU,KAAK,QAAQ,YAAY,MAAM,CAAC;AAGrE,WAAK,kBAAkB;AAGvB,WAAK,OAAO,UAAU,YAAY,KAAK,OAAO;AAG9C,4BAAsB,MAAM;AACxB,aAAK,kBAAkB;AAAA,MAC3B,CAAC;AAGD,WAAK,MAAM,cAAc,KAAK,OAAO,MAAM;AAC3C,UAAI,CAAC,KAAK,OAAO,MAAM,QAAQ;AAC3B,aAAK,MAAM,KAAK;AAAA,MACpB;AAGA,WAAK,kBAAkB;AAGvB,WAAK,oBAAoB,kBAAkB;AAE3C,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,sBAAsB;AACxC,WAAK,OAAO,KAAK,qBAAqB;AAGtC,WAAK,OAAO,kBAAkB,MAAM;AAChC,YAAI,KAAK,kBAAkB,SAAS,SAAS,KAAK,cAAc,GAAG;AAC/D,eAAK,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QACrD;AAAA,MACJ,GAAG,GAAG;AAAA,IACV;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AACN,UAAI,KAAK,qBAAqB;AAC1B,aAAK,iBAAiB,EAAE,aAAa,MAAM,CAAC;AAAA,MAChD;AAEA,UAAI,KAAK,SAAS;AACd,aAAK,QAAQ,MAAM,UAAU;AAAA,MACjC;AACA,WAAK,UAAU;AACf,WAAK,OAAO,MAAM,sBAAsB;AACxC,WAAK,OAAO,KAAK,sBAAsB;AAAA,IAC3C;AAAA;AAAA;AAAA;AAAA,IAKA,SAAS;AACL,UAAI,KAAK,SAAS;AACd,aAAK,QAAQ;AAAA,MACjB,OAAO;AACH,aAAK,OAAO;AAAA,MAChB;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,MAAM,mBAAmB;AACrB,YAAM,qBAAqB,OAAO,KAAK,KAAK,OAAO,EAAE,SAAS;AAC9D,YAAM,kBAAkB,CAAC,CAAC,KAAK;AAC/B,UAAI,CAAC,sBAAsB,CAAC,gBAAiB;AAC7C,UAAI,CAAC,KAAK,OAAO,WAAW,KAAK,OAAO,QAAQ,YAAY,QAAS;AACrE,UAAI,KAAK,WAAY;AAErB,UAAI;AACJ,UAAI,oBAAoB;AACpB,cAAM,cAAc,KAAK,0BAA0B;AACnD,aAAK,kBAAkB;AACvB,kBAAU,KAAK,QAAQ,WAAW;AAAA,MACtC,OAAO;AACH,kBAAU,KAAK;AAAA,MACnB;AAEA,YAAM,KAAK,KAAK,OAAO;AACvB,YAAM,cAAc,KAAK,OAAO,MAAM;AACtC,YAAM,aAAa,KAAK,OAAO,MAAM;AACrC,YAAM,cAAc,GAAG,UAAU,GAAG,aAAa,QAAQ,KAAK,KAAK,OAAO,QAAQ;AAClF,YAAM,mBAAmB,cAAc,OAAO,CAAC;AAE/C,YAAM,iBAAiB,MAAM,KAAK,GAAG,iBAAiB,QAAQ,CAAC;AAC/D,YAAM,cAAc,eAAe,CAAC;AACpC,WAAK,sBAAuB,GAAG,cAAc,GAAG,WAAW,SAAS,IAC9D,GAAG,aACF,GAAG,OAAO,GAAG,IAAI,SAAS,IACvB,GAAG,MACF,eAAe,YAAY,aAAa,KAAK,IAC1C,YAAY,aAAa,KAAK,IAC9B;AACd,WAAK,uBAAuB,KAAK,OAAO,MAAM;AAE9C,UAAI,eAAe,oBAAoB,GAAG,YAAY,SAAS;AAC3D,WAAG,SAAS;AAAA,MAChB;AACA,UAAI,eAAe,SAAS,GAAG;AAC3B,aAAK,0BAA0B;AAC/B,aAAK,wBAAwB,QAAQ,YAAU,OAAO,OAAO,CAAC;AAC9D,cAAM,aAAa,SAAS,cAAc,QAAQ;AAClD,mBAAW,aAAa,OAAO,OAAO;AACtC,cAAM,OAAO,KAAK,gBAAgB,OAAO;AACzC,YAAI,MAAM;AACN,qBAAW,aAAa,QAAQ,IAAI;AAAA,QACxC;AACA,cAAM,YAAY,GAAG,cAAc,OAAO;AAC1C,YAAI,WAAW;AACX,aAAG,aAAa,YAAY,SAAS;AAAA,QACzC,OAAO;AACH,aAAG,YAAY,UAAU;AAAA,QAC7B;AACA,aAAK,2BAA2B;AAAA,MACpC,OAAO;AACH,WAAG,MAAM;AACT,aAAK,2BAA2B;AAAA,MACpC;AACA,SAAG,QAAQ;AACX,WAAK,OAAO,gBAAgB;AAC5B,UAAI,OAAO,KAAK,OAAO,yBAAyB,YAAY;AACxD,aAAK,OAAO,qBAAqB;AAAA,MACrC;AACA,SAAG,KAAK;AAER,YAAM,KAAK,2BAA2B,cAAc,KAAK,UAAU;AAEnE,UAAI,cAAc,GAAG;AACjB,aAAK,OAAO,KAAK,WAAW;AAC5B,cAAM,IAAI,QAAQ,OAAK,WAAW,GAAG,GAAG,CAAC;AAAA,MAC7C;AACA,UAAI,YAAY;AACZ,cAAM,KAAK,OAAO,KAAK;AAAA,MAC3B,OAAO;AACH,aAAK,OAAO,MAAM;AAClB,YAAI,CAAC,oBAAoB,KAAK,OAAO,mBAAmB;AACpD,eAAK,OAAO,kBAAkB;AAAA,QAClC;AAAA,MACJ;AAEA,WAAK,aAAa;AAClB,WAAK,OAAO,MAAM,yBAAyB;AAC3C,UAAI,KAAK,OAAO,cAAc;AAC1B,aAAK,OAAO,aAAa,UAAU,IAAI,uCAAuC;AAAA,MAClF;AACA,WAAK,OAAO,KAAK,+BAA+B;AAAA,IACpD;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,oBAAoB;AA/Q9B;AAgRQ,UAAI,CAAC,KAAK,WAAY;AACtB,UAAI,CAAC,KAAK,uBAAuB,CAAC,KAAK,yBAAyB;AAC5D,aAAK,aAAa;AAClB,aAAK,OAAO,MAAM,yBAAyB;AAC3C,YAAI,KAAK,OAAO,cAAc;AAC1B,eAAK,OAAO,aAAa,UAAU,OAAO,uCAAuC;AAAA,QACrF;AACA,aAAK,OAAO,KAAK,gCAAgC;AACjD;AAAA,MACJ;AAEA,YAAM,KAAK,KAAK,OAAO;AACvB,YAAM,cAAc,KAAK,OAAO,MAAM;AACtC,YAAM,aAAa,KAAK,OAAO,MAAM;AACrC,YAAM,cAAc,GAAG,UAAU,GAAG,aAAa,QAAQ,KAAK,KAAK,OAAO,QAAQ;AAElF,UAAI,KAAK,4BAA4B,KAAK,2BAA2B,KAAK,wBAAwB,SAAS,GAAG;AAC1G,cAAM,KAAK,GAAG,iBAAiB,QAAQ,CAAC,EAAE,QAAQ,YAAU,OAAO,OAAO,CAAC;AAC3E,cAAM,YAAY,GAAG,cAAc,OAAO;AAC1C,aAAK,wBAAwB,QAAQ,YAAU;AAC3C,cAAI,WAAW;AACX,eAAG,aAAa,QAAQ,SAAS;AAAA,UACrC,OAAO;AACH,eAAG,YAAY,MAAM;AAAA,UACzB;AAAA,QACJ,CAAC;AACD,aAAK,2BAA2B;AAAA,MACpC,WAAW,KAAK,qBAAqB;AACjC,WAAG,MAAM,KAAK;AAAA,MAClB;AACA,SAAG,QAAQ,KAAK;AAChB,WAAK,OAAO,gBAAgB,KAAK,uBAAwB,GAAG,cAAc,QAAQ,KAAK,GAAG,cAAc,QAAQ,EAAE,OAAQ;AAC1H,UAAI,OAAO,KAAK,OAAO,yBAAyB,YAAY;AACxD,aAAK,OAAO,qBAAqB;AAAA,MACrC;AACA,SAAG,KAAK;AAER,YAAM,KAAK,2BAA2B,cAAc,KAAK,UAAU;AAEnE,UAAI,cAAc,GAAG;AACjB,aAAK,OAAO,KAAK,WAAW;AAAA,MAChC;AACA,UAAI,YAAY;AACZ,YAAI;AACA,gBAAM,KAAK,OAAO,KAAK;AAAA,QAC3B,SAAS,GAAG;AACR,2BAAK,QAAO,QAAZ,4BAAkB,sDAAsD,GAAG;AAAA,QAC/E;AAAA,MACJ;AAEA,WAAK,sBAAsB;AAC3B,WAAK,0BAA0B;AAC/B,WAAK,aAAa;AAClB,WAAK,OAAO,MAAM,yBAAyB;AAC3C,UAAI,KAAK,OAAO,cAAc;AAC1B,aAAK,OAAO,aAAa,UAAU,OAAO,uCAAuC;AAAA,MACrF;AACA,WAAK,OAAO,KAAK,gCAAgC;AAAA,IACrD;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,2BAA2B,WAAW,OAAO;AAC/C,YAAM,KAAK,KAAK,OAAO;AACvB,YAAM,oBAAoB,IAAI,QAAQ,CAAC,YAAY;AAC/C,YAAI,GAAG,cAAc,GAAG;AACpB,kBAAQ;AACR;AAAA,QACJ;AACA,cAAM,SAAS,MAAM;AACjB,aAAG,oBAAoB,kBAAkB,MAAM;AAC/C,aAAG,oBAAoB,SAAS,OAAO;AACvC,kBAAQ;AAAA,QACZ;AACA,cAAM,UAAU,MAAM;AAClB,aAAG,oBAAoB,kBAAkB,MAAM;AAC/C,aAAG,oBAAoB,SAAS,OAAO;AACvC,kBAAQ;AAAA,QACZ;AACA,WAAG,iBAAiB,kBAAkB,MAAM;AAC5C,WAAG,iBAAiB,SAAS,SAAS,EAAE,MAAM,KAAK,CAAC;AAAA,MACxD,CAAC;AACD,YAAM,iBAAiB,IAAI,QAAQ,OAAK,WAAW,GAAG,GAAK,CAAC;AAC5D,YAAM,QAAQ,KAAK,CAAC,mBAAmB,cAAc,CAAC;AACtD,YAAM,IAAI,QAAQ,OAAK,WAAW,GAAG,GAAG,CAAC;AACzC,UAAI,UAAU;AACV,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,cAAI,GAAG,cAAc,EAAG,SAAQ;AAAA,eAC3B;AACD,kBAAM,YAAY,MAAM;AACpB,iBAAG,oBAAoB,WAAW,SAAS;AAC3C,iBAAG,oBAAoB,kBAAkB,SAAS;AAClD,sBAAQ;AAAA,YACZ;AACA,eAAG,iBAAiB,WAAW,WAAW,EAAE,MAAM,KAAK,CAAC;AACxD,eAAG,iBAAiB,kBAAkB,WAAW,EAAE,MAAM,KAAK,CAAC;AAC/D,uBAAW,MAAM;AACb,iBAAG,oBAAoB,WAAW,SAAS;AAC3C,iBAAG,oBAAoB,kBAAkB,SAAS;AAClD,sBAAQ;AAAA,YACZ,GAAG,GAAI;AAAA,UACX;AAAA,QACJ,CAAC;AAAA,MACL;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB;AACf,UAAI,KAAK,YAAY;AACjB,aAAK,kBAAkB;AAAA,MAC3B,OAAO;AACH,aAAK,iBAAiB;AAAA,MAC1B;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,eAAe,UAAU;AACrB,UAAI,CAAC,KAAK,QAAQ,QAAQ,EAAG;AAE7B,WAAK,kBAAkB;AAEvB,UAAI,KAAK,OAAO;AACZ,cAAM,cAAc,KAAK,MAAM;AAC/B,cAAM,aAAa,CAAC,KAAK,MAAM;AAC/B,aAAK,MAAM,MAAM,KAAK,QAAQ,QAAQ;AACtC,aAAK,MAAM,cAAc;AACzB,YAAI,YAAY;AACZ,eAAK,MAAM,KAAK,EAAE,MAAM,MAAM;AAAA,UAAC,CAAC;AAAA,QACpC;AAAA,MACJ;AAEA,UAAI,KAAK,cAAc,KAAK,OAAO,WAAW,KAAK,OAAO,QAAQ,YAAY,SAAS;AACnF,cAAM,cAAc,KAAK,OAAO,MAAM;AACtC,cAAM,aAAa,KAAK,OAAO,MAAM;AACrC,YAAI,KAAK,0BAA0B;AAC/B,gBAAM,aAAa,KAAK,OAAO,QAAQ,cAAc,QAAQ;AAC7D,cAAI,YAAY;AACZ,uBAAW,aAAa,OAAO,KAAK,QAAQ,QAAQ,CAAC;AACrD,kBAAM,OAAO,KAAK,gBAAgB,KAAK,QAAQ,QAAQ,CAAC;AACxD,gBAAI,MAAM;AACN,yBAAW,aAAa,QAAQ,IAAI;AAAA,YACxC;AAAA,UACJ;AAAA,QACJ,OAAO;AACH,eAAK,OAAO,QAAQ,MAAM,KAAK,QAAQ,QAAQ;AAAA,QACnD;AACA,aAAK,OAAO,gBAAgB,KAAK,QAAQ,QAAQ;AACjD,YAAI,OAAO,KAAK,OAAO,yBAAyB,YAAY;AACxD,eAAK,OAAO,qBAAqB;AAAA,QACrC;AACA,aAAK,OAAO,QAAQ,KAAK;AACzB,aAAK,2BAA2B,IAAI,EAAE,KAAK,MAAM;AAC7C,cAAI,cAAc,EAAG,MAAK,OAAO,KAAK,WAAW;AACjD,cAAI,WAAY,MAAK,OAAO,KAAK;AAAA,QACrC,CAAC;AAAA,MACL;AAEA,WAAK,OAAO,KAAK,+BAA+B,QAAQ;AAAA,IAC5D;AAAA,IAEA,gBAAgB,KAAK;AACjB,UAAI,CAAC,IAAK,QAAO;AACjB,YAAM,WAAW,IAAI,MAAM,GAAG,EAAE,CAAC,EAAE,YAAY;AAC/C,UAAI,SAAS,SAAS,MAAM,EAAG,QAAO;AACtC,UAAI,SAAS,SAAS,OAAO,EAAG,QAAO;AACvC,UAAI,SAAS,SAAS,MAAM,KAAK,SAAS,SAAS,MAAM,EAAG,QAAO;AACnE,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB,UAAU;AACvB,YAAM,YAAY;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,MACV;AACA,aAAO,UAAU,QAAQ,KAAK,SAAS,YAAY;AAAA,IACvD;AAAA;AAAA;AAAA;AAAA,IAKA,4BAA4B;AAndhC;AAqdQ,UAAI,KAAK,OAAO,kBAAkB,KAAK,OAAO,eAAe,cAAc;AACvE,cAAM,eAAc,UAAK,OAAO,eAAe,aAAa,aAAxC,mBAAkD,cAAc,MAAM,KAAK;AAC/F,YAAI,eAAe,KAAK,QAAQ,WAAW,GAAG;AAC1C,iBAAO;AAAA,QACX;AAAA,MACJ;AAGA,UAAI,KAAK,OAAO,QAAQ,UAAU;AAC9B,cAAM,aAAa,KAAK,OAAO,QAAQ,SAAS,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC;AAC1E,YAAI,KAAK,QAAQ,UAAU,GAAG;AAC1B,iBAAO;AAAA,QACX;AAAA,MACJ;AAGA,aAAO,OAAO,KAAK,KAAK,OAAO,EAAE,CAAC;AAAA,IACtC;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB;AACb,WAAK,UAAU,SAAS,cAAc,KAAK;AAC3C,WAAK,QAAQ,YAAY;AACzB,WAAK,QAAQ,aAAa,YAAY,GAAG;AACzC,WAAK,QAAQ,aAAa,cAAc,KAAK,EAAE,+BAA+B,CAAC;AAAA,IACnF;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc,oBAAoB,aAAa;AAC3C,YAAM,cAAc,KAAK,OAAO,QAAQ;AAExC,WAAK,SAAS,SAAS,cAAc,OAAO;AAAA,QACxC,WAAW,GAAG,oBAAW;AAAA,QACzB,YAAY,EAAE,YAAY,IAAI;AAAA,MAClC,CAAC;AAED,YAAM,aAAa,SAAS,cAAc,OAAO;AAAA,QAC7C,WAAW,GAAG,oBAAW;AAAA,MAC7B,CAAC;AAED,YAAM,QAAQ,SAAS,cAAc,MAAM;AAAA,QACvC,aAAa,KAAK,EAAE,0BAA0B;AAAA,MAClD,CAAC;AAGD,WAAK,sBAAsB,UAAU;AAGrC,UAAI,oBAAoB;AACpB,aAAK,wBAAwB,YAAY,WAAW;AAAA,MACxD;AAEA,iBAAW,YAAY,KAAK;AAG5B,YAAM,cAAc,KAAK,mBAAmB;AAE5C,WAAK,OAAO,YAAY,UAAU;AAClC,WAAK,OAAO,YAAY,WAAW;AAGnC,WAAK,sBAAsB;AAC3B,WAAK,eAAe;AACpB,WAAK,yBAAyB;AAAA,IAClC;AAAA;AAAA;AAAA;AAAA,IAKA,sBAAsB,WAAW;AAC7B,YAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,YAAM,YAAY,KAAK,EAAE,6BAA6B;AAEtD,WAAK,iBAAiB,SAAS,cAAc,UAAU;AAAA,QACnD,WAAW,GAAG,oBAAW;AAAA,QACzB,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AACD,WAAK,eAAe,YAAY,kBAAkB,UAAU,CAAC;AAC7D,eAAS,cAAc,KAAK,gBAAgB,WAAW,WAAW;AAElE,WAAK,mBAAmB;AAAA,QACpB,OAAO,CAAC,MAAM;AACV,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,KAAK,sBAAsB;AAC3B,iBAAK,yBAAyB;AAC9B,uBAAW,MAAM;AAAE,mBAAK,yBAAyB;AAAA,YAAO,GAAG,GAAG;AAAA,UAClE;AACA,cAAI,KAAK,qBAAqB;AAC1B,iBAAK,iBAAiB;AAAA,UAC1B,OAAO;AACH,iBAAK,iBAAiB;AAAA,UAC1B;AAAA,QACJ;AAAA,QACA,SAAS,CAAC,MAAM;AACZ,cAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AAChC,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,uBAAuB;AAAA,UAChC,WAAW,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AACvC,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,iBAAiB;AAAA,UAC1B,WAAW,EAAE,QAAQ,YAAY,KAAK,qBAAqB;AACvD,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,iBAAiB;AAAA,UAC1B;AAAA,QACJ;AAAA,MACJ;AAEA,WAAK,eAAe,iBAAiB,SAAS,KAAK,iBAAiB,KAAK;AACzE,WAAK,eAAe,iBAAiB,WAAW,KAAK,iBAAiB,OAAO;AAC7E,gBAAU,YAAY,KAAK,cAAc;AAAA,IAC7C;AAAA;AAAA;AAAA;AAAA,IAKA,wBAAwB,WAAW,aAAa;AAC5C,YAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,YAAM,WAAW,GAAG,oBAAW,0BAAyB,YAAK,IAAI;AAEjE,YAAM,UAAU,OAAO,KAAK,KAAK,OAAO,EAAE,IAAI,eAAa;AAAA,QACvD,OAAO;AAAA,QACP,MAAM,KAAK,iBAAiB,QAAQ;AAAA,QACpC,UAAU,aAAa;AAAA,MAC3B,EAAE;AAEF,YAAM,EAAE,OAAO,OAAO,IAAI,oBAAoB;AAAA,QAC1C;AAAA,QACA,YAAY,GAAG,oBAAW;AAAA,QAC1B,aAAa,GAAG,oBAAW;AAAA,QAC3B,WAAW;AAAA,QACX;AAAA,QACA;AAAA,QACA,UAAU,CAAC,MAAM;AACb,YAAE,gBAAgB;AAClB,eAAK,eAAe,EAAE,OAAO,KAAK;AAAA,QACtC;AAAA,MACJ,CAAC;AAED,WAAK,WAAW;AAEhB,YAAM,kBAAkB,SAAS,cAAc,OAAO;AAAA,QAClD,WAAW,GAAG,oBAAW;AAAA,MAC7B,CAAC;AACD,sBAAgB,YAAY,KAAK;AACjC,sBAAgB,YAAY,KAAK,QAAQ;AAEzC,2BAAqB,eAAe;AACpC,gBAAU,YAAY,eAAe;AAAA,IACzC;AAAA;AAAA;AAAA;AAAA,IAKA,qBAAqB;AACjB,YAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,YAAM,YAAY,KAAK,EAAE,0BAA0B;AAEnD,YAAM,cAAc,SAAS,cAAc,UAAU;AAAA,QACjD,WAAW,GAAG,oBAAW;AAAA,QACzB,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,QAClB;AAAA,MACJ,CAAC;AACD,kBAAY,YAAY,kBAAkB,OAAO,CAAC;AAClD,eAAS,cAAc,aAAa,WAAW,WAAW;AAE1D,kBAAY,iBAAiB,SAAS,MAAM;AAxoBpD;AAyoBY,aAAK,QAAQ;AACb,aAAI,gBAAK,OAAO,eAAZ,mBAAwB,aAAxB,mBAAkC,cAAc;AAChD,qBAAW,MAAM;AACb,iBAAK,OAAO,WAAW,SAAS,aAAa,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UAC9E,GAAG,CAAC;AAAA,QACR;AAAA,MACJ,CAAC;AAED,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,aAAa,KAAK;AACd,WAAK,QAAQ,SAAS,cAAc,OAAO;AAC3C,WAAK,MAAM,YAAY;AACvB,WAAK,MAAM,MAAM;AACjB,WAAK,MAAM,aAAa,cAAc,KAAK,EAAE,qBAAqB,CAAC;AACnE,WAAK,MAAM,QAAQ;AACnB,WAAK,MAAM,aAAa,eAAe,EAAE;AAAA,IAC7C;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACnB,YAAM,cAAc,KAAK,OAAO,QAAQ;AAExC,WAAK,gBAAgB,CAAC,KAAK,KAAK,KAAK,KAAK,MAAM,MAAM,MAAM,IAAI,EAAE,IAAI,SAAO;AACzE,cAAM,SAAS,SAAS,cAAc,OAAO;AAAA,UACzC,WAAW,GAAG,oBAAW,wBAAuB,oBAAW,iBAAgB;AAAA,UAC3E,YAAY;AAAA,YACR,kBAAkB;AAAA,YAClB,8BAA8B;AAAA,YAC9B,eAAe;AAAA,UACnB;AAAA,QACJ,CAAC;AACD,eAAO,MAAM,UAAU;AACvB,eAAO;AAAA,MACX,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AAvrBxB;AAwrBQ,YAAM,QAAQ,KAAK,OAAO,QAAQ,2BAA2B;AAC7D,WAAI,oCAAO,SAAP,mBAAa,OAAO;AACpB,aAAK,QAAQ,MAAM,QAAQ,MAAM,KAAK;AAAA,MAC1C,OAAO;AACH,aAAK,QAAQ,MAAM,QAAQ;AAAA,MAC/B;AACA,WAAK,QAAQ,MAAM,SAAS;AAAA,IAChC;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AApsBxB;AAqsBQ,YAAMC,YAAW,OAAO,aAAa;AACrC,YAAM,eAAe,KAAK,OAAO,MAAM;AAKvC,UAAIA,aAAY,CAAC,kBAAgB,gBAAK,WAAL,mBAAa,YAAb,mBAAsB,8BAA6B,OAAO;AACvF,YAAI,KAAK,WAAW;AAChB,eAAK,UAAU,QAAQ;AACvB,eAAK,YAAY;AAAA,QACrB;AACA;AAAA,MACJ;AAEA,UAAI,KAAK,UAAW;AAEpB,YAAM,cAAc,KAAK,OAAO,QAAQ;AAExC,WAAK,YAAY,IAAI,mBAAmB,KAAK,SAAS;AAAA;AAAA;AAAA,QAGlD,YAAY,KAAK;AAAA,QACjB,eAAe,KAAK;AAAA,QACpB,qBAAqB;AAAA,QACrB,qBAAqB;AAAA,QACrB,UAAU;AAAA,QACV,WAAW;AAAA,QACX,aAAa,GAAG,oBAAW;AAAA,QAC3B,iBAAiB;AAAA,QACjB,mBAAmB;AAAA,QACnB,cAAc;AAAA,QACd,mBAAmB;AAAA,QACnB,4BAA4B,KAAK,EAAE,iCAAiC;AAAA,QACpE,uBAAuB,CAAC,YAAY;AAChC,eAAK,cAAc,QAAQ,YAAU;AACjC,mBAAO,MAAM,UAAU,UAAU,UAAU;AAAA,UAC/C,CAAC;AAAA,QACL;AAAA,QACA,aAAa,CAAC,MAAM;AAChB,cAAI,EAAE,OAAO,QAAQ,IAAI,oBAAW,uBAAsB,KACtD,EAAE,OAAO,QAAQ,IAAI,oBAAW,0BAAyB,KACzD,EAAE,OAAO,QAAQ,IAAI,oBAAW,wBAAuB,KACvD,EAAE,OAAO,QAAQ,IAAI,oBAAW,uBAAsB,KACtD,EAAE,OAAO,QAAQ,IAAI,oBAAW,+BAA8B,GAAG;AACjE,mBAAO;AAAA,UACX;AACA,iBAAO;AAAA,QACX;AAAA,MACJ,CAAC;AAED,WAAK,uBAAuB;AAE5B,WAAK,sBAAsB;AAAA,QACvB,WAAW,KAAK;AAAA,QAChB,kBAAkB,KAAK;AAAA,MAC3B;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,yBAAyB;AACrB,WAAK,mBAAmB,CAAC,MAAM;AAnwBvC;AAowBY,cAAM,MAAM,EAAE,IAAI,YAAY;AAE9B,YAAI,KAAK,oBAAqB;AAE9B,YAAI,QAAQ,QAAQ;AAChB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,KAAK,WAAW;AAChB,gBAAI,KAAK,UAAU,mBAAmB;AAClC,mBAAK,UAAU,yBAAyB;AAAA,YAC5C;AACA,iBAAK,UAAU,qBAAqB;AACpC,iBAAK,kBAAkB;AAAA,UAC3B;AACA;AAAA,QACJ;AAEA,YAAI,QAAQ,KAAK;AACb,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,KAAK,iBAAiB,GAAG;AACzB,iBAAK,QAAQ,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UAC9C;AACA;AAAA,QACJ;AAEA,YAAI,QAAQ,UAAU;AAClB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,eAAI,UAAK,cAAL,mBAAgB,mBAAmB;AACnC,iBAAK,UAAU,yBAAyB;AACxC;AAAA,UACJ;AACA,eAAI,UAAK,cAAL,mBAAgB,kBAAkB;AAClC,iBAAK,UAAU,wBAAwB;AACvC;AAAA,UACJ;AACA,eAAK,QAAQ;AACb,eAAI,gBAAK,OAAO,eAAZ,mBAAwB,aAAxB,mBAAkC,cAAc;AAChD,uBAAW,MAAM;AACb,mBAAK,OAAO,WAAW,SAAS,aAAa,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAC9E,GAAG,CAAC;AAAA,UACR;AAAA,QACJ;AAAA,MACJ;AAEA,WAAK,QAAQ,iBAAiB,WAAW,KAAK,gBAAgB;AAAA,IAClE;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB,oBAAoB;AACpC,WAAK,WAAW;AAAA,QACZ,MAAM,MAAM;AAAE,cAAI,KAAK,MAAO,MAAK,MAAM,KAAK;AAAA,QAAG;AAAA,QACjD,OAAO,MAAM;AAAE,cAAI,KAAK,MAAO,MAAK,MAAM,MAAM;AAAA,QAAG;AAAA,QACnD,YAAY,MAAM;AACd,cAAI,KAAK,SAAS,KAAK,IAAI,KAAK,MAAM,cAAc,KAAK,OAAO,MAAM,WAAW,IAAI,KAAK;AACtF,iBAAK,MAAM,cAAc,KAAK,OAAO,MAAM;AAAA,UAC/C;AAAA,QACJ;AAAA,QACA,YAAY,MAAM;AACd,cAAI,KAAK,MAAO,MAAK,MAAM,eAAe,KAAK,OAAO,MAAM;AAAA,QAChE;AAAA,MACJ;AAEA,WAAK,OAAO,GAAG,QAAQ,KAAK,SAAS,IAAI;AACzC,WAAK,OAAO,GAAG,SAAS,KAAK,SAAS,KAAK;AAC3C,WAAK,OAAO,GAAG,cAAc,KAAK,SAAS,UAAU;AACrD,WAAK,OAAO,GAAG,cAAc,KAAK,SAAS,UAAU;AAErD,UAAI,oBAAoB;AACpB,aAAK,SAAS,gBAAgB,MAAM;AA50BhD;AA60BgB,gBAAI,UAAK,OAAO,mBAAZ,mBAA4B,iBAAgB,KAAK,UAAU;AAC3D,kBAAM,eAAc,UAAK,OAAO,eAAe,aAAa,aAAxC,mBAAkD,cAAc,MAAM,KAAK;AAC/F,gBAAI,eAAe,KAAK,QAAQ,WAAW,KAAK,KAAK,oBAAoB,aAAa;AAClF,mBAAK,eAAe,WAAW;AAC/B,mBAAK,SAAS,QAAQ;AAAA,YAC1B;AAAA,UACJ;AAAA,QACJ;AACA,aAAK,OAAO,GAAG,mBAAmB,KAAK,SAAS,aAAa;AAAA,MACjE;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,oBAAoB;AA51BxB;AA61BQ,UAAI,CAAC,KAAK,WAAW,CAAC,KAAK,OAAO,aAAc;AAEhD,WAAI,UAAK,cAAL,mBAAgB,mBAAoB;AAExC,UAAI,CAAC,KAAK,QAAQ,MAAM,OAAO;AAC3B,aAAK,QAAQ,MAAM,QAAQ;AAAA,MAC/B;AAEA,YAAM,mBAAmB,KAAK,OAAO,aAAa,sBAAsB;AACxE,YAAM,gBAAgB,KAAK,OAAO,UAAU,sBAAsB;AAClE,YAAM,cAAc,KAAK,QAAQ,sBAAsB;AAEvD,YAAM,mBAAmB,iBAAiB,OAAO,cAAc;AAC/D,YAAM,kBAAkB,iBAAiB,MAAM,cAAc;AAC7D,YAAM,oBAAoB,iBAAiB;AAC3C,YAAM,qBAAqB,iBAAiB;AAE5C,UAAI,eAAe,YAAY,SAAS;AACxC,UAAI,gBAAgB,YAAY,UAAY,MAAM,IAAK;AAEvD,UAAI,MAAM;AACV,YAAM,SAAS;AACf,YAAM,iBAAiB;AAEvB,YAAM,WAAW,KAAK,mBAAmB;AAEzC,cAAQ,UAAU;AAAA,QACd,KAAK;AACD,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAC7D;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB;AAC1B,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAC7D;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB;AACxB;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB;AAC1B,gBAAM,kBAAkB;AACxB;AAAA,QACJ;AACI,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAAA,MACrE;AAEA,aAAO,KAAK,IAAI,kBAAkB,KAAK,IAAI,MAAM,mBAAmB,oBAAoB,YAAY,CAAC;AACrG,YAAM,KAAK,IAAI,iBAAiB,KAAK,IAAI,KAAK,kBAAkB,qBAAqB,gBAAgB,cAAc,CAAC;AAEpH,WAAK,QAAQ,MAAM,OAAO,GAAG,aAAI;AACjC,WAAK,QAAQ,MAAM,MAAM,GAAG,YAAG;AAC/B,WAAK,QAAQ,MAAM,QAAQ;AAC3B,WAAK,QAAQ,MAAM,SAAS;AAAA,IAChC;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB;AAz5BvB;AA05BQ,WAAK,yBAAyB;AAC9B,iBAAW,MAAM;AAAE,aAAK,yBAAyB;AAAA,MAAO,GAAG,GAAG;AAE9D,WAAK,yBAAyB;AAE9B,UAAI,KAAK,cAAc;AACnB,aAAK,aAAa,MAAM,UAAU;AAClC,aAAK,sBAAsB;AAC3B,mBAAK,mBAAL,mBAAqB,aAAa,iBAAiB;AACnD,aAAK,8BAA8B;AACnC,aAAK,sBAAsB;AAC3B,aAAK,uBAAuB;AAC5B,aAAK,yBAAyB;AAC9B,2BAAmB,KAAK,cAAc,IAAI,YAAK,OAAO,QAAQ,aAAW,+BAA8B;AACvG;AAAA,MACJ;AAEA,WAAK,oBAAoB;AAAA,IAC7B;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB,EAAE,cAAc,KAAK,IAAI,CAAC,GAAG;AAC1C,UAAI,KAAK,cAAc;AACnB,aAAK,aAAa,MAAM,UAAU;AAClC,aAAK,sBAAsB;AAC3B,aAAK,yBAAyB;AAE9B,YAAI,KAAK,wBAAwB;AAC7B,eAAK,aAAa,oBAAoB,WAAW,KAAK,sBAAsB;AAC5E,eAAK,yBAAyB;AAAA,QAClC;AAEA,cAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,cAAM,YAAY,MAAM,KAAK,KAAK,aAAa,iBAAiB,IAAI,oBAAW,+BAA8B,CAAC;AAC9G,kBAAU,QAAQ,UAAQ,KAAK,aAAa,YAAY,IAAI,CAAC;AAE7D,YAAI,KAAK,gBAAgB;AACrB,eAAK,eAAe,aAAa,iBAAiB,OAAO;AACzD,cAAI,aAAa;AACb,iBAAK,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UACrD;AAAA,QACJ;AAAA,MACJ;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,2BAA2B;AACvB,UAAI,KAAK,0BAA2B;AAEpC,WAAK,uBAAuB,CAAC,MAAM;AAC/B,YAAI,KAAK,uBAAwB;AAEjC,YAAI,KAAK,mBACJ,KAAK,mBAAmB,EAAE,UAAU,KAAK,eAAe,SAAS,EAAE,MAAM,IAAI;AAC9E;AAAA,QACJ;AAEA,YAAI,KAAK,gBAAgB,KAAK,aAAa,SAAS,EAAE,MAAM,GAAG;AAC3D;AAAA,QACJ;AAEA,YAAI,KAAK,qBAAqB;AAC1B,eAAK,iBAAiB;AAAA,QAC1B;AAAA,MACJ;AAEA,iBAAW,MAAM;AACb,iBAAS,iBAAiB,aAAa,KAAK,sBAAsB,IAAI;AACtE,aAAK,4BAA4B;AAAA,MACrC,GAAG,GAAG;AAAA,IACV;AAAA;AAAA;AAAA;AAAA,IAKA,sBAAsB;AAz+B1B;AA0+BQ,YAAM,cAAc,KAAK,OAAO,QAAQ;AAExC,WAAK,eAAe,SAAS,cAAc,OAAO;AAAA,QAC9C,WAAW,GAAG,oBAAW;AAAA,QACzB,YAAY,EAAE,QAAQ,OAAO;AAAA,MACjC,CAAC;AAGD,YAAM,aAAa,eAAe;AAAA,QAC9B;AAAA,QACA,WAAW,GAAG,oBAAW;AAAA,QACzB,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,SAAS,MAAM;AAx/B3B,cAAAC;AAy/BgB,eAAK,uBAAuB;AAE5B,eAAK,iBAAiB,EAAE,aAAa,MAAM,CAAC;AAE5C,eAAIA,MAAA,KAAK,cAAL,gBAAAA,IAAgB,kBAAkB;AAClC,uBAAW,MAAM;AA9/BrC,kBAAAA,KAAAC;AA+/BwB,eAAAA,OAAAD,MAAA,KAAK,YAAL,gBAAAA,IAAc,UAAd,gBAAAC,IAAA,KAAAD,KAAsB,EAAE,eAAe,KAAK;AAAA,YAChD,GAAG,EAAE;AAAA,UACT;AAAA,QACJ;AAAA,MACJ,CAAC;AAED,iBAAW,aAAa,gBAAgB,eAAe;AACvD,iBAAW,aAAa,QAAQ,QAAQ;AACxC,iBAAW,aAAa,gBAAgB,OAAO;AAC/C,WAAK,2BAA2B,UAAU;AAC1C,WAAK,mBAAmB;AACxB,WAAK,iBAAiB,WAAW,cAAc,IAAI,oBAAW,iBAAgB;AAC9E,WAAK,uBAAuB;AAG5B,YAAM,eAAe,eAAe;AAAA,QAChC;AAAA,QACA,WAAW,GAAG,oBAAW;AAAA,QACzB,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,SAAS,CAAC,UAAU;AAChB,gBAAM,eAAe;AACrB,gBAAM,gBAAgB;AAEtB,gBAAM,UAAU,KAAK,iBAAiB,EAAE,OAAO,MAAM,CAAC;AAEtD,cAAI,SAAS;AACT,iBAAK,iBAAiB,EAAE,aAAa,MAAM,CAAC;AAC5C,uBAAW,MAAM;AACb,kBAAI,KAAK,QAAS,MAAK,QAAQ,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YAChE,GAAG,EAAE;AAAA,UACT,OAAO;AACH,iBAAK,iBAAiB,EAAE,aAAa,KAAK,CAAC;AAAA,UAC/C;AAAA,QACJ;AAAA,MACJ,CAAC;AACD,mBAAa,aAAa,QAAQ,QAAQ;AAC1C,mBAAa,aAAa,gBAAgB,OAAO;AACjD,WAAK,2BAA2B,YAAY;AAC5C,WAAK,qBAAqB;AAC1B,WAAK,mBAAmB,aAAa,cAAc,IAAI,oBAAW,iBAAgB;AAClF,WAAK,yBAAyB;AAG9B,YAAM,cAAc,eAAe;AAAA,QAC/B;AAAA,QACA,WAAW,GAAG,oBAAW;AAAA,QACzB,MAAM;AAAA,QACN,OAAO;AAAA,QACP,SAAS,MAAM,KAAK,iBAAiB;AAAA,MACzC,CAAC;AACD,WAAK,2BAA2B,WAAW;AAE3C,WAAK,aAAa,YAAY,UAAU;AACxC,WAAK,aAAa,YAAY,YAAY;AAC1C,WAAK,aAAa,YAAY,WAAW;AAGzC,WAAK,aAAa,MAAM,aAAa;AACrC,WAAK,aAAa,MAAM,UAAU;AAElC,WAAI,UAAK,mBAAL,mBAAqB,YAAY;AACjC,aAAK,eAAe,sBAAsB,YAAY,KAAK,YAAY;AAAA,MAC3E,WAAW,KAAK,SAAS;AACrB,aAAK,QAAQ,YAAY,KAAK,YAAY;AAAA,MAC9C;AAEA,WAAK,+BAA+B;AAEpC,4BAAsB,MAAM;AACxB,YAAI,KAAK,cAAc;AACnB,eAAK,aAAa,MAAM,aAAa;AAAA,QACzC;AAAA,MACJ,CAAC;AAED,WAAK,8BAA8B;AAEnC,WAAK,sBAAsB;AAC3B,iBAAK,mBAAL,mBAAqB,aAAa,iBAAiB;AACnD,WAAK,uBAAuB;AAC5B,WAAK,yBAAyB;AAE9B,yBAAmB,KAAK,cAAc,IAAI,oBAAW,+BAA8B;AAAA,IACvF;AAAA;AAAA;AAAA;AAAA,IAKA,2BAA2B,MAAM;AAC7B,YAAM,cAAc,KAAK,OAAO,QAAQ;AACxC,YAAM,UAAU,KAAK,cAAc,IAAI,oBAAW,WAAU;AAC5D,UAAI,QAAS,SAAQ,OAAO;AAC5B,YAAM,aAAa,KAAK,cAAc,IAAI,oBAAW,eAAc;AACnE,UAAI,WAAY,YAAW,OAAO;AAAA,IACtC;AAAA;AAAA;AAAA;AAAA,IAKA,gCAAgC;AAC5B,UAAI,KAAK,wBAAwB;AAC7B,aAAK,aAAa,oBAAoB,WAAW,KAAK,sBAAsB;AAAA,MAChF;AAEA,WAAK,yBAAyB;AAAA,QAC1B,KAAK;AAAA,QACL,KAAK;AAAA,QACL,IAAI,YAAK,OAAO,QAAQ,aAAW;AAAA,QACnC,MAAM,KAAK,iBAAiB,EAAE,aAAa,KAAK,CAAC;AAAA,MACrD;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,iCAAiC;AAC7B,UAAI,CAAC,KAAK,gBAAgB,CAAC,KAAK,eAAgB;AAEhD,YAAM,aAAa,KAAK,eAAe,sBAAsB;AAC7D,YAAM,WAAW,KAAK,aAAa,sBAAsB;AACzD,YAAM,gBAAgB,OAAO;AAC7B,YAAM,iBAAiB,OAAO;AAE9B,YAAM,kBAAkB,KAAK,eAAe;AAC5C,UAAI,CAAC,gBAAiB;AAEtB,YAAM,aAAa,gBAAgB,sBAAsB;AAEzD,YAAM,gBAAgB,WAAW,OAAO,WAAW,QAAQ,IAAI,WAAW;AAC1E,YAAM,eAAe,WAAW,SAAS,WAAW;AACpD,YAAM,YAAY,WAAW,MAAM,WAAW;AAE9C,YAAM,aAAa,WAAW;AAC9B,YAAM,aAAa,iBAAiB,WAAW;AAE/C,UAAI,UAAU,eAAe;AAC7B,UAAI,aAAa;AAEjB,UAAI,aAAa,SAAS,SAAS,MAAM,aAAa,YAAY;AAC9D,kBAAU;AACV,cAAM,eAAe,WAAW,SAAS,WAAW;AACpD,qBAAa,eAAe,YAAY;AACxC,aAAK,aAAa,UAAU,IAAI,mBAAmB;AAAA,MACvD,OAAO;AACH,aAAK,aAAa,UAAU,OAAO,mBAAmB;AAAA,MAC1D;AAEA,UAAI,WAAW,gBAAgB,SAAS,QAAQ;AAChD,UAAI,YAAY;AAChB,UAAI,aAAa;AAEjB,YAAM,mBAAmB,WAAW,OAAO,WAAW,QAAQ,IAAI,SAAS,QAAQ;AACnF,UAAI,mBAAmB,IAAI;AACvB,mBAAW;AAAA,MACf,WAAW,mBAAmB,SAAS,QAAQ,gBAAgB,IAAI;AAC/D,mBAAW;AACX,oBAAY;AAAA,MAChB,OAAO;AACH,mBAAW;AACX,qBAAa;AAAA,MACjB;AAEA,UAAI,YAAY,MAAM;AAClB,aAAK,aAAa,MAAM,MAAM,GAAG,gBAAO;AACxC,aAAK,aAAa,MAAM,SAAS;AAAA,MACrC,WAAW,eAAe,MAAM;AAC5B,aAAK,aAAa,MAAM,MAAM;AAC9B,aAAK,aAAa,MAAM,SAAS,GAAG,mBAAU;AAAA,MAClD;AAEA,UAAI,aAAa,QAAQ;AACrB,aAAK,aAAa,MAAM,OAAO,GAAG,iBAAQ;AAC1C,aAAK,aAAa,MAAM,QAAQ;AAAA,MACpC,OAAO;AACH,aAAK,aAAa,MAAM,OAAO;AAC/B,aAAK,aAAa,MAAM,QAAQ,GAAG,kBAAS;AAAA,MAChD;AAEA,WAAK,aAAa,MAAM,YAAY;AAAA,IACxC;AAAA;AAAA;AAAA;AAAA,IAKA,wBAAwB;AACpB,4BAAsB,MAAM;AACxB,mBAAW,MAAM;AACb,eAAK,+BAA+B;AAAA,QACxC,GAAG,EAAE;AAAA,MACT,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA,IAKA,yBAAyB;AACrB,UAAI,KAAK,WAAW;AAChB,cAAM,aAAa,KAAK,UAAU;AAClC,aAAK,UAAU,uBAAuB;AACtC,cAAM,YAAY,KAAK,UAAU;AACjC,YAAI,CAAC,cAAc,WAAW;AAC1B,eAAK,gBAAgB;AAAA,QACzB;AACA,aAAK,uBAAuB;AAAA,MAChC;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,kBAAkB;AACd,WAAK,QAAQ,UAAU,IAAI,GAAG,YAAK,OAAO,QAAQ,aAAW,kBAAiB;AAC9E,WAAK,yBAAyB;AAC9B,iBAAW,MAAM;AACb,aAAK,QAAQ,UAAU,OAAO,GAAG,YAAK,OAAO,QAAQ,aAAW,kBAAiB;AAAA,MACrF,GAAG,GAAI;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB,EAAE,QAAQ,KAAK,IAAI,CAAC,GAAG;AACpC,UAAI,CAAC,KAAK,UAAW,QAAO;AAE5B,UAAI,KAAK,UAAU,mBAAmB;AAClC,aAAK,UAAU,yBAAyB,EAAE,MAAM,CAAC;AACjD,aAAK,yBAAyB;AAC9B,eAAO;AAAA,MACX;AAEA,WAAK,UAAU,wBAAwB,EAAE,MAAM,CAAC;AAChD,WAAK,yBAAyB;AAC9B,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA,IAKA,yBAAyB;AA9uC7B;AA+uCQ,UAAI,CAAC,KAAK,iBAAkB;AAE5B,YAAM,YAAY,CAAC,GAAE,UAAK,cAAL,mBAAgB;AACrC,YAAM,OAAO,YACP,KAAK,EAAE,4BAA4B,IACnC,KAAK,EAAE,2BAA2B;AACxC,YAAM,YAAY,YACZ,KAAK,EAAE,gCAAgC,IACvC,KAAK,EAAE,+BAA+B;AAE5C,WAAK,iBAAiB,aAAa,gBAAgB,YAAY,SAAS,OAAO;AAC/E,WAAK,iBAAiB,aAAa,cAAc,SAAS;AAE1D,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,cAAc;AAAA,MACtC;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,2BAA2B;AApwC/B;AAqwCQ,UAAI,CAAC,KAAK,mBAAoB;AAE9B,YAAM,YAAY,CAAC,GAAE,UAAK,cAAL,mBAAgB;AACrC,YAAM,OAAO,YACP,KAAK,EAAE,8BAA8B,IACrC,KAAK,EAAE,6BAA6B;AAC1C,YAAM,YAAY,YACZ,KAAK,EAAE,kCAAkC,IACzC,KAAK,EAAE,iCAAiC;AAE9C,WAAK,mBAAmB,aAAa,gBAAgB,YAAY,SAAS,OAAO;AACjF,WAAK,mBAAmB,aAAa,cAAc,SAAS;AAE5D,UAAI,KAAK,kBAAkB;AACvB,aAAK,iBAAiB,cAAc;AAAA,MACxC;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,kBAAkB;AACd,UAAI,CAAC,KAAK,QAAS;AAEnB,WAAK,OAAO,QAAQ,4BAA4B;AAAA,QAC5C,MAAM,EAAE,OAAO,KAAK,QAAQ,MAAM,MAAM;AAAA,MAC5C,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc,iBAAiB,qBAAqB;AAChD,WAAK,MAAM,mBAAmB;AAC9B,WAAK,UAAU,uBAAuB,CAAC;AAEvC,WAAK,kBAAkB;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AA/yCd;AAgzCQ,UAAI,KAAK,cAAc,KAAK,OAAO,SAAS;AACxC,cAAM,KAAK,KAAK,OAAO;AACvB,YAAI,KAAK,4BAA4B,KAAK,2BAA2B,KAAK,wBAAwB,SAAS,GAAG;AAC1G,gBAAM,KAAK,GAAG,iBAAiB,QAAQ,CAAC,EAAE,QAAQ,YAAU,OAAO,OAAO,CAAC;AAC3E,gBAAM,YAAY,GAAG,cAAc,OAAO;AAC1C,eAAK,wBAAwB,QAAQ,YAAU;AAC3C,gBAAI,WAAW;AACX,iBAAG,aAAa,QAAQ,SAAS;AAAA,YACrC,OAAO;AACH,iBAAG,YAAY,MAAM;AAAA,YACzB;AAAA,UACJ,CAAC;AACD,eAAK,2BAA2B;AAAA,QACpC,WAAW,KAAK,qBAAqB;AACjC,aAAG,MAAM,KAAK;AAAA,QAClB;AACA,WAAG,QAAQ,KAAK;AAChB,YAAI,OAAO,KAAK,OAAO,yBAAyB,YAAY;AACxD,eAAK,OAAO,qBAAqB;AAAA,QACrC;AACA,WAAG,KAAK;AACR,aAAK,sBAAsB;AAC3B,aAAK,0BAA0B;AAC/B,aAAK,aAAa;AAClB,aAAK,OAAO,MAAM,yBAAyB;AAC3C,YAAI,KAAK,OAAO,cAAc;AAC1B,eAAK,OAAO,aAAa,UAAU,OAAO,uCAAuC;AAAA,QACrF;AACA,aAAK,OAAO,KAAK,gCAAgC;AAAA,MACrD;AACA,UAAI,KAAK,qBAAqB;AAC1B,aAAK,iBAAiB,EAAE,aAAa,MAAM,CAAC;AAAA,MAChD;AAGA,UAAI,KAAK,wBAAwB,KAAK,2BAA2B;AAC7D,iBAAS,oBAAoB,aAAa,KAAK,sBAAsB,IAAI;AACzE,aAAK,4BAA4B;AACjC,aAAK,uBAAuB;AAAA,MAChC;AAGA,UAAI,KAAK,oBAAoB,KAAK,gBAAgB;AAC9C,aAAK,eAAe,oBAAoB,SAAS,KAAK,iBAAiB,KAAK;AAC5E,aAAK,eAAe,oBAAoB,WAAW,KAAK,iBAAiB,OAAO;AAAA,MACpF;AACA,WAAK,mBAAmB;AAGxB,UAAI,KAAK,UAAU;AACf,aAAK,OAAO,IAAI,QAAQ,KAAK,SAAS,IAAI;AAC1C,aAAK,OAAO,IAAI,SAAS,KAAK,SAAS,KAAK;AAC5C,aAAK,OAAO,IAAI,cAAc,KAAK,SAAS,UAAU;AACtD,aAAK,OAAO,IAAI,cAAc,KAAK,SAAS,UAAU;AACtD,YAAI,KAAK,SAAS,eAAe;AAC7B,eAAK,OAAO,IAAI,mBAAmB,KAAK,SAAS,aAAa;AAAA,QAClE;AACA,aAAK,WAAW;AAAA,MACpB;AAGA,UAAI,KAAK,WAAW,KAAK,kBAAkB;AACvC,aAAK,QAAQ,oBAAoB,WAAW,KAAK,gBAAgB;AAAA,MACrE;AAGA,UAAI,KAAK,WAAW;AAChB,YAAI,KAAK,UAAU,mBAAmB;AAClC,eAAK,UAAU,yBAAyB;AAAA,QAC5C;AACA,aAAK,UAAU,QAAQ;AACvB,aAAK,YAAY;AAAA,MACrB;AAEA,WAAK,sBAAsB;AAG3B,WAAI,UAAK,YAAL,mBAAc,YAAY;AAC1B,YAAI,KAAK,OAAO;AACZ,eAAK,MAAM,MAAM;AACjB,eAAK,MAAM,MAAM;AAAA,QACrB;AACA,aAAK,QAAQ,WAAW,YAAY,KAAK,OAAO;AAAA,MACpD;AAEA,WAAK,UAAU;AACf,WAAK,QAAQ;AACb,WAAK,iBAAiB;AACtB,WAAK,eAAe;AAAA,IACxB;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AACN,WAAK,QAAQ;AACb,WAAK,UAAU;AAAA,IACnB;AAAA,EACJ;;;AP33CA,MAAI,wBAAwB;AAErB,MAAM,SAAN,MAAM,gBAAe,aAAa;AAAA,IACrC,YAAY,SAAS,UAAU,CAAC,GAAG;AAC/B,YAAM;AAEN,WAAK,UAAU,OAAO,YAAY,WAAW,SAAS,cAAc,OAAO,IAAI;AAC/E,UAAI,CAAC,KAAK,SAAS;AACf,cAAM,IAAI,MAAM,2BAA2B;AAAA,MAC/C;AAGA;AACA,WAAK,aAAa;AAGlB,UAAI,KAAK,QAAQ,YAAY,WAAW,KAAK,QAAQ,YAAY,SAAS;AACtE,cAAM,YAAY,QAAQ,aAAa;AACvC,cAAM,eAAe,SAAS,cAAc,SAAS;AAGrD,cAAM,KAAK,KAAK,QAAQ,UAAU,EAAE,QAAQ,UAAQ;AAChD,cAAI,KAAK,SAAS,QAAQ,KAAK,SAAS,WAAW,CAAC,KAAK,KAAK,WAAW,OAAO,GAAG;AAC/E,yBAAa,aAAa,KAAK,MAAM,KAAK,KAAK;AAAA,UACnD;AAAA,QACJ,CAAC;AAGD,cAAM,SAAS,KAAK,QAAQ,iBAAiB,OAAO;AACpD,eAAO,QAAQ,WAAS;AACpB,uBAAa,YAAY,MAAM,UAAU,IAAI,CAAC;AAAA,QAClD,CAAC;AAGD,aAAK,QAAQ,YAAY;AACzB,aAAK,QAAQ,YAAY,YAAY;AAGrC,aAAK,UAAU;AAAA,MACnB;AAIA,WAAK,mBAAmB,KAAK;AAG7B,WAAK,UAAU;AAAA;AAAA,QAEX,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,QAAQ;AAAA,QACR,YAAY;AAAA,QACZ,eAAe;AAAA;AAAA,QAGf,UAAU;AAAA,QACV,MAAM;AAAA,QACN,OAAO;AAAA,QACP,QAAQ;AAAA,QACR,eAAe;AAAA,QACf,SAAS;AAAA;AAAA;AAAA,QAGT,iBAAiB;AAAA;AAAA;AAAA;AAAA;AAAA,QAKjB,WAAW;AAAA;AAAA;AAAA,QAGX,wCAAwC;AAAA,QACxC,WAAW;AAAA,QACX,aAAa;AAAA;AAAA;AAAA,QAGb,UAAU;AAAA,QACV,mBAAmB;AAAA,QACnB,iBAAiB;AAAA,QACjB,aAAa;AAAA,QACb,aAAa;AAAA,QACb,UAAU;AAAA,QACV,eAAe;AAAA,QACf,YAAY;AAAA,QACZ,gBAAgB;AAAA,QAChB,eAAe;AAAA,QACf,oBAAoB;AAAA,QACpB,aAAa;AAAA;AAAA,QAEb,iBAAiB;AAAA;AAAA;AAAA,QAGjB,sBAAsB;AAAA,QACtB,gBAAgB;AAAA,QAChB,kBAAkB;AAAA,QAClB,kBAAkB;AAAA,QAClB,WAAW;AAAA;AAAA,QAGX,cAAc;AAAA,QACd,mBAAmB;AAAA;AAAA,QAGnB,UAAU;AAAA,QACV,iBAAiB;AAAA,QACjB,kBAAkB;AAAA,QAClB,oBAAoB;AAAA,QACpB,eAAe;AAAA,QACf,yBAAyB;AAAA,QACzB,iBAAiB;AAAA;AAAA,QAGjB,kBAAkB;AAAA,QAClB,qBAAqB;AAAA;AAAA,QACrB,wBAAwB;AAAA;AAAA,QAGxB,cAAc;AAAA,QACd,iBAAiB;AAAA;AAAA,QACjB,oBAAoB;AAAA,QACpB,sBAAsB;AAAA;AAAA,QACtB,yBAAyB;AAAA;AAAA;AAAA,QAGzB,YAAY;AAAA,QACZ,oBAAoB;AAAA,QACpB,qBAAqB;AAAA;AAAA,QAGrB,UAAU;AAAA,QACV,mBAAmB;AAAA,UACf,cAAc,CAAC,KAAK,KAAK,GAAG;AAAA,UAC5B,aAAa,CAAC,SAAS;AAAA,UACvB,eAAe,CAAC,WAAW;AAAA,UAC3B,gBAAgB,CAAC,YAAY;AAAA,UAC7B,iBAAiB,CAAC,WAAW;AAAA,UAC7B,QAAQ,CAAC,GAAG;AAAA,UACZ,cAAc,CAAC,GAAG;AAAA,UAClB,YAAY,CAAC,GAAG;AAAA,UAChB,sBAAsB,CAAC,GAAG;AAAA,UAC1B,YAAY,CAAC,GAAG;AAAA,UAChB,cAAc,CAAC,GAAG;AAAA,UAClB,cAAc,CAAC,GAAG;AAAA,UAClB,gBAAgB,CAAC,GAAG;AAAA,UACpB,iBAAiB,CAAC,GAAG;AAAA,UACrB,qBAAqB,CAAC,GAAG;AAAA,QAC7B;AAAA;AAAA,QAGA,YAAY,CAAC;AAAA,QACb,2BAA2B;AAAA,QAC3B,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,gBAAgB,CAAC;AAAA,QACjB,kBAAkB,CAAC;AAAA;AAAA,QAGnB,UAAU;AAAA,QACV,WAAW,CAAC,IAAI;AAAA;AAAA,QAGhB,OAAO;AAAA,QACP,aAAa;AAAA,QACb,UAAU;AAAA,QACV,mBAAmB;AAAA;AAAA,QAGnB,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,SAAS;AAAA,QACT,SAAS;AAAA,QACT,cAAc;AAAA,QACd,gBAAgB;AAAA,QAChB,SAAS;AAAA,SAEN;AAGP,WAAK,QAAQ,iBAAiB,KAAK,QAAQ,kBAAkB,CAAC;AAC9D,WAAK,QAAQ,mBAAmB,KAAK,QAAQ,oBAAoB,CAAC;AAGlE,WAAK,gBAAgB;AACrB,WAAK,gBAAgB;AAGrB,WAAK,UAAU,IAAI,eAAe,QAAQ;AAG1C,YAAM,aAAa,KAAK,QAAQ,qBAAqB;AACrD,UAAI,YAAY;AACZ,YAAI,WAAW,WAAW,OAAW,MAAK,QAAQ,SAAS,WAAW;AACtE,YAAI,WAAW,kBAAkB,OAAW,MAAK,QAAQ,gBAAgB,WAAW;AACpF,YAAI,WAAW,UAAU,OAAW,MAAK,QAAQ,QAAQ,WAAW;AAAA,MACxE;AAGA,WAAK,QAAQ;AAAA,QACT,OAAO;AAAA,QACP,SAAS;AAAA,QACT,QAAQ;AAAA,QACR,OAAO;AAAA,QACP,WAAW;AAAA,QACX,SAAS;AAAA,QACT,oBAAoB;AAAA,QACpB,OAAO,KAAK,QAAQ;AAAA,QACpB,QAAQ,KAAK,QAAQ;AAAA,QACrB,aAAa;AAAA,QACb,UAAU,OAAO,KAAK,QAAQ,eAAe,IAAI,IAAI,OAAO,KAAK,QAAQ,eAAe,IAAI;AAAA,QAC5F,eAAe,KAAK,QAAQ;AAAA,QAC5B,YAAY;AAAA,QACZ,KAAK;AAAA,QACL,iBAAiB,KAAK,QAAQ;AAAA,QAC9B,gBAAgB;AAAA,QAChB,iBAAiB;AAAA,QACjB,yBAAyB;AAAA,QACzB,qBAAqB;AAAA,QACrB,wBAAwB;AAAA,MAC5B;AAGA,WAAK,cAAc;AACnB,WAAK,sBAAsB,KAAK,QAAQ;AACxC,WAAK,kBAAkB,KAAK,QAAQ;AACpC,WAAK,sBAAsB,KAAK,QAAQ,uBAAuB,CAAC;AAChE,WAAK,sBAAsB;AAC3B,WAAK,oBAAoB;AAEzB,WAAK,gCAAgC;AACrC,WAAK,iCAAiC;AAEtC,WAAK,gCAAgC,CAAC;AACtC,WAAK,gCAAgC;AAGrC,WAAK,mBAAmB;AACxB,WAAK,mBAAmB;AACxB,WAAK,uBAAuB;AAC5B,WAAK,uBAAuB;AAC5B,WAAK,sBAAsB;AAC3B,WAAK,sBAAsB;AAG3B,WAAK,WAAW,oBAAI,IAAI;AAGxB,WAAK,YAAY;AACjB,WAAK,WAAW;AAChB,WAAK,aAAa;AAClB,WAAK,iBAAiB;AACtB,WAAK,kBAAkB;AACvB,WAAK,iBAAiB;AAGtB,WAAK,2BAA2B;AAChC,WAAK,wBAAwB,oBAAI,IAAI;AAGrC,WAAK,0BAA0B,IAAI,wBAAwB,IAAI;AAC/D,WAAK,sBAAsB,IAAI,oBAAoB,IAAI;AAIvD,aAAO,iBAAiB,MAAM;AAAA,QAC1B,qBAAqB;AAAA,UACjB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,UAAU;AAAA,UAAG;AAAA,QACxD;AAAA,QACA,mBAAmB;AAAA,UACf,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,QAAQ;AAAA,UAAG;AAAA,QACtD;AAAA,QACA,oBAAoB;AAAA,UAChB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,SAAS;AAAA,UAAG;AAAA,QACvD;AAAA,QACA,4BAA4B;AAAA,UACxB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,iBAAiB;AAAA,UAAG;AAAA,QAC/D;AAAA,QACA,0BAA0B;AAAA,UACtB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,eAAe;AAAA,UAAG;AAAA,QAC7D;AAAA,QACA,iCAAiC;AAAA,UAC7B,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,sBAAsB;AAAA,UAAG;AAAA,QACpE;AAAA,QACA,uBAAuB;AAAA,UACnB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,YAAY;AAAA,UAAG;AAAA,QAC1D;AAAA,QACA,qBAAqB;AAAA,UACjB,KAAK,MAAM,KAAK,oBAAoB;AAAA,UACpC,KAAK,CAAC,MAAM;AAAE,iBAAK,oBAAoB,kBAAkB;AAAA,UAAG;AAAA,QAChE;AAAA,MACJ,CAAC;AAGD,WAAK,KAAK;AAAA,IACd;AAAA;AAAA;AAAA;AAAA,IAKA,WAAW,SAAS,EAAE,UAAU,MAAM,WAAW,SAAS,IAAI,CAAC,GAAG;AAxUtE;AAyUQ,UAAI;AACA,YAAI,CAAC,QAAS;AACd,YAAI,CAAC,KAAK,UAAW;AAGrB,aAAI,UAAK,oBAAL,mBAAsB,UAAU;AAChC,eAAK,gBAAgB,SAAS,SAAS,QAAQ;AAAA,QACnD;AAEA,YAAI,CAAC,KAAK,eAAe;AACrB,gBAAM,KAAK,SAAS,cAAc,KAAK;AACvC,aAAG,YAAY,GAAG,YAAK,QAAQ,aAAW;AAC1C,aAAG,aAAa,QAAQ,QAAQ;AAChC,aAAG,aAAa,aAAa,QAAQ;AACrC,aAAG,aAAa,eAAe,MAAM;AAErC,aAAG,MAAM,WAAW;AACpB,aAAG,MAAM,OAAO;AAChB,aAAG,MAAM,QAAQ;AACjB,aAAG,MAAM,MAAM;AACf,aAAG,MAAM,SAAS;AAClB,aAAG,MAAM,UAAU;AACnB,aAAG,MAAM,eAAe;AACxB,aAAG,MAAM,aAAa;AACtB,aAAG,MAAM,QAAQ;AACjB,aAAG,MAAM,WAAW;AACpB,aAAG,MAAM,aAAa;AACtB,aAAG,MAAM,gBAAgB;AACzB,eAAK,gBAAgB;AACrB,eAAK,UAAU,YAAY,EAAE;AAAA,QACjC;AAEA,aAAK,cAAc,cAAc;AACjC,aAAK,cAAc,MAAM,UAAU;AAEnC,YAAI,KAAK,eAAe;AACpB,uBAAa,KAAK,aAAa;AAC/B,eAAK,gBAAgB;AAAA,QACzB;AACA,aAAK,gBAAgB,WAAW,MAAM;AAClC,cAAI,KAAK,eAAe;AACpB,iBAAK,cAAc,MAAM,UAAU;AAAA,UACvC;AAAA,QACJ,GAAG,OAAO;AAAA,MACd,SAAS,GAAG;AAAA,MAEZ;AAAA,IACJ;AAAA,IAEA,MAAM,OAAO;AA1XjB;AA2XQ,UAAI;AACA,aAAK,IAAI,4BAA4B;AAGrC,YAAI,KAAK,QAAQ,eAAe;AAC5B,cAAI;AACA,kBAAM,KAAK,sBAAsB,KAAK,QAAQ,aAAa;AAAA,UAC/D,SAAS,OAAO;AACZ,oBAAQ,KAAK,uCAAuC,KAAK;AAAA,UAC7D;AAAA,QACJ;AAGA,YAAI,KAAK,QAAQ,gBAAgB,KAAK,QAAQ,iBAAiB;AAC3D,cAAI;AACA,kBAAM,KAAK,oBAAoB,KAAK,QAAQ,cAAc,KAAK,QAAQ,eAAe;AACtF,iBAAK,IAAI,mCAAmC,YAAK,QAAQ,aAAc;AAAA,UAC3E,SAAS,OAAO;AACZ,oBAAQ,KAAK,oCAAoC,YAAK,QAAQ,cAAY,MAAK,KAAK;AAAA,UACxF;AAAA,QACJ;AAGA,YAAI,CAAC,KAAK,QAAQ,YAAY,KAAK,QAAQ,aAAa,MAAM;AAC1D,gBAAM,WAAW,KAAK,mBAAmB;AACzC,cAAI,UAAU;AACV,iBAAK,QAAQ,WAAW;AACxB,iBAAK,IAAI,qCAAqC,gBAAU;AAAA,UAC5D;AAAA,QACJ;AAGA,YAAI,CAAC,KAAK,QAAQ,UAAU;AACxB,eAAK,QAAQ,WAAW;AAAA,QAC5B;AAGA,cAAM,KAAK,eAAe,KAAK,QAAQ,QAAQ;AAG/C,aAAK,YAAY,KAAK,QAAQ,QAAQ;AAGtC,aAAK,gBAAgB;AAGrB,cAAM,MAAM,KAAK,QAAQ,SAAO,UAAK,QAAQ,cAAc,QAAQ,MAAnC,mBAAsC;AACtE,YAAI,KAAK;AACL,gBAAM,KAAK,mBAAmB;AAAA,QAClC,OAAO;AACH,eAAK,IAAI,yDAAyD;AAAA,QACtE;AAGA,YAAI,KAAK,QAAQ,UAAU;AACvB,eAAK,aAAa,IAAI,WAAW,IAAI;AACrC,eAAK,aAAa,YAAY,KAAK,WAAW,OAAO;AAAA,QACzD;AAGA,YAAI,KAAK,QAAQ,UAAU;AACvB,eAAK,iBAAiB,IAAI,eAAe,IAAI;AAAA,QACjD;AAGA,YAAI,KAAK,QAAQ,YAAY;AACzB,gBAAM,KAAK,wBAAwB;AAAA,QACvC;AAGA,aAAK,sBAAsB;AAG3B,YAAI,KAAK,QAAQ,UAAU;AACvB,eAAK,kBAAkB,IAAI,gBAAgB,IAAI;AAAA,QACnD;AAGA,aAAK,wBAAwB;AAG7B,YAAI,KAAK,QAAQ,YAAY,GAAG;AAC5B,eAAK,KAAK,KAAK,QAAQ,SAAS;AAAA,QACpC;AAIA,8BAAsB,MAAM;AACxB,cAAI,KAAK,QAAQ,OAAO;AACpB,iBAAK,KAAK;AAAA,UACd,WAAW,KAAK,YAAY,KAAK,SAAS,OAAO;AAE7C,iBAAK,SAAS,SAAS,KAAK;AAAA,UAChC;AAEA,cAAI,KAAK,QAAQ,WAAW,KAAK;AAC7B,iBAAK,UAAU,KAAK,QAAQ,MAAM;AAAA,UACtC,WAAW,KAAK,YAAY,KAAK,SAAS,OAAO;AAE7C,iBAAK,SAAS,UAAU,KAAK,QAAQ,MAAM;AAAA,UAC/C;AAAA,QACJ,CAAC;AAGD,aAAK,MAAM,QAAQ;AACnB,aAAK,KAAK,OAAO;AAEjB,YAAI,KAAK,QAAQ,SAAS;AACtB,eAAK,QAAQ,QAAQ,KAAK,IAAI;AAAA,QAClC;AAGA,YAAI,KAAK,QAAQ,UAAU;AACvB,eAAK,KAAK;AAAA,QACd;AAEA,aAAK,IAAI,iCAAiC;AAAA,MAC9C,SAAS,OAAO;AACZ,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,MAAM,0BAA0B;AAC5B,UAAI,KAAK,mBAAmB;AACxB,eAAO,KAAK;AAAA,MAChB;AAEA,UAAI,CAAC,KAAK,QAAQ,cAAc,CAAC,KAAK,QAAQ,kBAAkB;AAC5D,eAAO;AAAA,MACX;AAEA,YAAM,SAAS,MAAM;AACrB,YAAM,UAAU,OAAO,qBAAqB,OAAO;AAEnD,UAAI,CAAC,SAAS;AACV,eAAO;AAAA,MACX;AAEA,WAAK,oBAAoB,IAAI,QAAQ,IAAI;AACzC,aAAO,KAAK;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,mBAAmB;AACrB,YAAM,UAAU,MAAM,KAAK,wBAAwB;AACnD,UAAI,CAAC,QAAS;AAEd,cAAQ,iBAAiB;AACzB,UAAI,KAAK,YAAY;AACjB,aAAK,WAAW,uBAAuB;AAAA,MAC3C;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,qBAAqB;AAEjB,YAAM,WAAW,SAAS,gBAAgB,QAAQ,SAAS,gBAAgB,aAAa,MAAM;AAE9F,UAAI,CAAC,UAAU;AACX,eAAO;AAAA,MACX;AAGA,YAAM,iBAAiB,SAAS,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC;AAG1D,UAAI,KAAK,aAAa,cAAc,GAAG;AACnC,eAAO;AAAA,MACX;AAGA,UAAI,KAAK,0BAA0B,KAAK,uBAAuB,cAAc,GAAG;AAC5E,eAAO;AAAA,MACX;AAGA,WAAK,IAAI,aAAa,iBAAQ,6CAA4C;AAC1E,aAAO;AAAA,IACX;AAAA,IAEA,kBAAkB;AAEd,YAAM,cAAc,KAAK,aAAa,IAChC,GAAG,YAAK,EAAE,cAAc,GAAC,KAAI,YAAK,cAClC,KAAK,EAAE,cAAc;AAE3B,WAAK,YAAY,SAAS,cAAc,OAAO;AAAA,QAC3C,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AAGD,YAAM,YAAY,KAAK,QAAQ,QAAQ,YAAY;AACnD,WAAK,UAAU,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,KAAI,iBAAW;AAGvE,UAAI,KAAK,QAAQ,YAAY;AACzB,aAAK,UAAU,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,cAAa;AAAA,MACzE;AAIA,WAAK,eAAe,SAAS,cAAc,OAAO;AAAA,QAC9C,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,MAC1C,CAAC;AAGD,WAAK,QAAQ,WAAW,aAAa,KAAK,WAAW,KAAK,OAAO;AAIjE,UAAI,KAAK,QAAQ,YAAY,WAAW,KAAK,QAAQ,QAAQ;AACzD,aAAK,sBAAsB,SAAS,cAAc,OAAO;AAAA,UACrD,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,UACtC,YAAY;AAAA,YACR,eAAe;AAAA,UACnB;AAAA,QACJ,CAAC;AACD,aAAK,oBAAoB,MAAM,kBAAkB,OAAO,YAAK,QAAQ,QAAM;AAC3E,aAAK,UAAU,YAAY,KAAK,mBAAmB;AAAA,MACvD;AAEA,WAAK,UAAU,YAAY,KAAK,YAAY;AAC5C,WAAK,aAAa,YAAY,KAAK,OAAO;AAG1C,WAAK,QAAQ,WAAW;AACxB,WAAK,QAAQ,gBAAgB,UAAU;AACvC,WAAK,QAAQ,aAAa,YAAY,IAAI;AAC1C,WAAK,QAAQ,MAAM,QAAQ;AAC3B,WAAK,QAAQ,MAAM,SAAS;AAI5B,UAAI,KAAK,QAAQ,YAAY,WAAW,KAAK,QAAQ,aAAa;AAC9D,aAAK,QAAQ,aAAa,eAAe,EAAE;AAC3C,aAAK,QAAQ,cAAc;AAAA,MAC/B;AAGA,UAAI,KAAK,QAAQ,OAAO;AACpB,aAAK,UAAU,MAAM,QAAQ,OAAO,KAAK,QAAQ,UAAU,WACrD,GAAG,YAAK,QAAQ,OAAK,QACrB,KAAK,QAAQ;AAAA,MACvB;AAEA,UAAI,KAAK,QAAQ,QAAQ;AACrB,aAAK,UAAU,MAAM,SAAS,OAAO,KAAK,QAAQ,WAAW,WACvD,GAAG,YAAK,QAAQ,QAAM,QACtB,KAAK,QAAQ;AAAA,MACvB;AAGA,UAAI,KAAK,QAAQ,UAAU,KAAK,QAAQ,YAAY,SAAS;AACzD,cAAM,iBAAiB,KAAK,kBAAkB,KAAK,QAAQ,MAAM;AACjE,aAAK,QAAQ,SAAS;AAAA,MAC1B;AAGA,UAAI,KAAK,QAAQ,YAAY,SAAS;AAClC,aAAK,wBAAwB;AAAA,MACjC;AAGA,WAAK,QAAQ,SAAS;AAGtB,cAAO,UAAU,KAAK,IAAI;AAG1B,WAAK,QAAQ,MAAM,SAAS;AAC5B,WAAK,QAAQ,iBAAiB,SAAS,CAAC,MAAM;AAE1C,YAAI,EAAE,WAAW,KAAK,SAAS;AAC3B,eAAK,OAAO;AAAA,QAChB;AAAA,MACJ,CAAC;AAED,WAAK,GAAG,QAAQ,MAAM;AAClB,aAAK,MAAM,qBAAqB;AAEhC,aAAK,kBAAkB;AAAA,MAC3B,CAAC;AAED,WAAK,GAAG,cAAc,MAAM;AAExB,YAAI,KAAK,MAAM,cAAc,GAAG;AAC5B,eAAK,kBAAkB;AAAA,QAC3B;AAAA,MACJ,CAAC;AAGD,WAAK,QAAQ,iBAAiB,cAAc,MAAM;AAC9C,YAAI,KAAK,MAAM,WAAW,KAAK,MAAM,cAAc,GAAG;AAClD,eAAK,kBAAkB;AAAA,QAC3B;AAAA,MACJ,GAAG,EAAE,MAAM,KAAK,CAAC;AAAA,IACrB;AAAA,IAEA,0BAA0B;AAEtB,WAAK,oBAAoB,kBAAkB;AAG3C,WAAK,kBAAkB,iBAAiB,SAAS,MAAM;AACnD,aAAK,OAAO;AAAA,MAChB,CAAC;AAGD,WAAK,aAAa,YAAY,KAAK,iBAAiB;AAGpD,WAAK,GAAG,QAAQ,MAAM;AAClB,aAAK,kBAAkB,MAAM,UAAU;AACvC,aAAK,kBAAkB,MAAM,gBAAgB;AAAA,MACjD,CAAC;AAED,WAAK,GAAG,SAAS,MAAM;AACnB,aAAK,kBAAkB,MAAM,UAAU;AACvC,aAAK,kBAAkB,MAAM,gBAAgB;AAC7C,aAAK,4BAA4B;AAAA,MACrC,CAAC;AAED,WAAK,GAAG,SAAS,MAAM;AACnB,aAAK,kBAAkB,MAAM,UAAU;AACvC,aAAK,kBAAkB,MAAM,gBAAgB;AAC7C,aAAK,4BAA4B;AAAA,MACrC,CAAC;AAGD,WAAK,+BAA+B,SAAS,MAAM;AAC/C,aAAK,4BAA4B;AAAA,MACrC,GAAG,GAAG;AAEN,aAAO,iBAAiB,UAAU,KAAK,4BAA4B;AAEnE,WAAK,GAAG,kBAAkB,MAAM;AAC5B,aAAK,4BAA4B;AAAA,MACrC,CAAC;AAGD,WAAK,GAAG,mBAAmB,MAAM;AAC7B,uBAAe,MAAM,KAAK,4BAA4B,GAAG,GAAG;AAAA,MAChE,CAAC;AAED,WAAK,GAAG,kBAAkB,MAAM;AAC5B,uBAAe,MAAM,KAAK,4BAA4B,GAAG,GAAG;AAAA,MAChE,CAAC;AAAA,IACL;AAAA,IAEA,8BAA8B;AAC1B,UAAI,CAAC,KAAK,qBAAqB,KAAK,QAAQ,YAAY,SAAS;AAC7D;AAAA,MACJ;AAEA,YAAM,SAAS,SAAS;AAExB,UAAI,CAAC,QAAQ;AAET,aAAK,kBAAkB,MAAM,MAAM;AACnC;AAAA,MACJ;AAEA,YAAM,YAAY,KAAK,QAAQ,sBAAsB;AACrD,YAAM,cAAc,KAAK,aAAa,sBAAsB;AAC5D,YAAM,cAAe,UAAU,MAAM,YAAY,MAAQ,UAAU,SAAS;AAE5E,WAAK,kBAAkB,MAAM,MAAM,GAAG,oBAAW;AAAA,IACrD;AAAA,IAEA,MAAM,qBAAqB;AA1vB/B;AA4vBQ,UAAI,MAAM,KAAK,kBAAkB,KAAK,QAAQ,SAAO,UAAK,QAAQ,cAAc,QAAQ,MAAnC,mBAAsC;AAE3F,UAAI,CAAC,KAAK;AACN,cAAM,IAAI,MAAM,uBAAuB;AAAA,MAC3C;AAGA,WAAK,gBAAgB;AAGrB,WAAK,iBAAiB;AAGtB,WAAK,wBAAwB,uBAAuB,KAAK,gBAAgB,KAAK,aAAa;AAG3F,UAAI,CAAC,KAAK,aAAa;AACnB,aAAK,cAAc;AAAA,MACvB;AAGA,UAAI,gBAAgB;AAEpB,UAAI,IAAI,SAAS,aAAa,KAAK,IAAI,SAAS,UAAU,GAAG;AACzD,cAAM,SAAS,MAAM;AACrB,wBAAgB,OAAO,mBAAmB,OAAO;AAAA,MACrD,WAAW,IAAI,SAAS,WAAW,GAAG;AAClC,cAAM,SAAS,MAAM;AACrB,wBAAgB,OAAO,iBAAiB,OAAO;AAAA,MACnD,WAAW,IAAI,SAAS,OAAO,GAAG;AAC9B,cAAM,SAAS,MAAM;AACrB,wBAAgB,OAAO,eAAe,OAAO;AAAA,MACjD,WAAW,IAAI,SAAS,gBAAgB,KAAK,IAAI,SAAS,oBAAoB,GAAG;AAC7E,cAAM,SAAS,MAAM;AACrB,wBAAgB,OAAO,sBAAsB,OAAO;AAAA,MACxD;AAEA,WAAK,IAAI,SAAS,uDAAe,SAAQ,iBAAe,YAAW;AACnE,WAAK,WAAW,IAAI,cAAc,IAAI;AACtC,YAAM,KAAK,SAAS,KAAK;AAGzB,WAAK,qBAAqB;AAAA,IAC9B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,IAAI,aAAa;AACb,UAAI,CAAC,KAAK,oBAAoB,KAAK,kBAAkB;AACjD,aAAK,mBAAmB,MAAM,KAAK,KAAK,QAAQ,cAAc,CAAC,CAAC;AAChE,aAAK,mBAAmB;AAAA,MAC5B;AACA,aAAO,KAAK;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,IAAI,iBAAiB;AACjB,UAAI,CAAC,KAAK,wBAAwB,KAAK,sBAAsB;AACzD,aAAK,uBAAuB,MAAM,KAAK,KAAK,QAAQ,iBAAiB,QAAQ,CAAC;AAC9E,aAAK,uBAAuB;AAAA,MAChC;AACA,aAAO,KAAK;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,IAAI,gBAAgB;AAChB,UAAI,CAAC,KAAK,uBAAuB,KAAK,qBAAqB;AACvD,aAAK,sBAAsB,MAAM,KAAK,KAAK,QAAQ,iBAAiB,OAAO,CAAC;AAC5E,aAAK,sBAAsB;AAAA,MAC/B;AACA,aAAO,KAAK;AAAA,IAChB;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACnB,WAAK,mBAAmB;AACxB,WAAK,sBAAsB;AAC3B,WAAK,uBAAuB;AAAA,IAChC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQA,cAAc,MAAM,WAAW,MAAM;AACjC,YAAM,SAAS,KAAK;AACpB,UAAI,UAAU;AACV,eAAO,OAAO,KAAK,OAAK,EAAE,SAAS,QAAQ,EAAE,aAAa,QAAQ;AAAA,MACtE;AACA,aAAO,OAAO,KAAK,OAAK,EAAE,SAAS,IAAI;AAAA,IAC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQA,kBAAkB,WAAW,QAAQ,MAAM;AACvC,YAAM,UAAU,KAAK;AACrB,UAAI,OAAO;AACP,eAAO,QAAQ,KAAK,QAAM,GAAG,aAAa,SAAS,MAAM,KAAK;AAAA,MAClE;AACA,aAAO,QAAQ,KAAK,QAAM,GAAG,aAAa,SAAS,CAAC;AAAA,IACxD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,iBAAiB,OAAO;AACpB,aAAO,KAAK,cAAc,KAAK,QAAM,GAAG,UAAU,KAAK;AAAA,IAC3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,kBAAkB,YAAY;AAC1B,UAAI,CAAC,YAAY;AACb,eAAO;AAAA,MACX;AAGA,UAAI,WAAW,MAAM,eAAe,GAAG;AACnC,eAAO;AAAA,MACX;AAGA,UAAI;AACA,cAAM,YAAY,IAAI,IAAI,YAAY,OAAO,SAAS,IAAI;AAC1D,eAAO,UAAU;AAAA,MACrB,SAAS,GAAG;AAER,eAAO;AAAA,MACX;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,MAAM,wBAAwB,OAAO,IAAI;AAErC,UAAI,KAAK,QAAQ,YAAY,SAAS;AAClC,eAAO;AAAA,MACX;AAGA,YAAM,WAAW,KAAK;AACtB,UAAI,CAAC,YAAY,CAAC,SAAS,SAAS,SAAS,MAAM,YAAY,SAAS;AACpE,eAAO;AAAA,MACX;AAEA,YAAM,QAAQ,SAAS;AAGvB,UAAI,CAAC,MAAM,YAAY,MAAM,WAAW,MAAM;AAE1C,eAAO,KAAK,IAAI,MAAM,KAAK,IAAI,GAAG,MAAM,WAAW,GAAG,CAAC;AAAA,MAC3D;AAGA,UAAI,aAAa;AACjB,UAAI,KAAK,cAAc,KAAK,WAAW,gBAAgB,KAAK,WAAW,kBAAkB;AACrF,qBAAa,KAAK,WAAW;AAAA,MACjC;AAIA,YAAM,eAAe,eAAe;AACpC,aAAO,MAAM,kBAAkB,YAAY,MAAM;AAAA,QAC7C;AAAA,QACA,SAAS;AAAA,MACb,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA,IAKA,MAAM,qBAAqB;AAEvB,YAAM,YACF,KAAK,QAAQ,aAAa,QAAQ,KAClC,KAAK,QAAQ,UACb,KAAK,QAAQ;AAEjB,UAAI,WAAW;AACX;AAAA,MACJ;AAGA,UAAI,KAAK,QAAQ,YAAY,SAAS;AAClC;AAAA,MACJ;AAGA,UAAI,CAAC,KAAK,MAAM,YAAY,KAAK,MAAM,aAAa,GAAG;AAEnD,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,gBAAM,mBAAmB,MAAM;AAC3B,iBAAK,QAAQ,oBAAoB,kBAAkB,gBAAgB;AACnE,oBAAQ;AAAA,UACZ;AAEA,cAAI,KAAK,QAAQ,cAAc,GAAG;AAC9B,oBAAQ;AAAA,UACZ,OAAO;AACH,iBAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB;AAAA,UACpE;AAAA,QACJ,CAAC;AAAA,MACL;AAGA,YAAM,gBAAgB,MAAM,KAAK,wBAAwB,EAAE;AAE3D,UAAI,eAAe;AAEf,aAAK,QAAQ,SAAS;AACtB,aAAK,IAAI,wDAAwD,MAAM;AAGvE,aAAK,kBAAkB;AAAA,MAC3B;AAAA,IACJ;AAAA,IAEA,oBAAoB;AAChB,UAAI,CAAC,KAAK,gBAAgB,KAAK,QAAQ,YAAY,SAAS;AACxD;AAAA,MACJ;AAEA,YAAM,SACF,KAAK,QAAQ,aAAa,QAAQ,KAClC,KAAK,QAAQ,UACb,KAAK,QAAQ;AAEjB,UAAI,CAAC,QAAQ;AACT;AAAA,MACJ;AAGA,YAAM,iBAAiB,OAAO,WAAW,OAAO,IAC1C,SACA,KAAK,kBAAkB,MAAM;AACnC,WAAK,aAAa,MAAM,YAAY,yBAAyB,QAAQ,uBAAc,KAAI;AACvF,WAAK,aAAa,UAAU,IAAI,sBAAsB;AAGtD,UAAI,KAAK,mBAAmB,KAAK,WAAW;AACxC,aAAK,UAAU,UAAU,IAAI,sBAAsB;AAAA,MACvD,WAAW,KAAK,WAAW;AACvB,aAAK,UAAU,UAAU,OAAO,sBAAsB;AAAA,MAC1D;AAAA,IACJ;AAAA,IAEA,oBAAoB;AAChB,UAAI,CAAC,KAAK,cAAc;AACpB;AAAA,MACJ;AAEA,WAAK,aAAa,UAAU,OAAO,sBAAsB;AACzD,WAAK,aAAa,MAAM,eAAe,uBAAuB;AAAA,IAIlE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQA,kBAAkB,UAAU,OAAO;AAC/B,YAAM,YAAY,WAAW,MAAM;AAC/B,aAAK,SAAS,OAAO,SAAS;AAC9B,iBAAS;AAAA,MACb,GAAG,KAAK;AACR,WAAK,SAAS,IAAI,SAAS;AAC3B,aAAO;AAAA,IACX;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,oBAAoB,WAAW;AAC3B,UAAI,WAAW;AACX,qBAAa,SAAS;AACtB,aAAK,SAAS,OAAO,SAAS;AAAA,MAClC;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAiBA,sBAAsB,KAAK;AACvB,UAAI,CAAC,IAAK,QAAO;AACjB,aAAO,IAAI,SAAS,aAAa,KAC1B,IAAI,SAAS,UAAU,KACvB,IAAI,SAAS,WAAW,KACxB,IAAI,SAAS,gBAAgB,KAC7B,IAAI,SAAS,oBAAoB,KACjC,IAAI,SAAS,OAAO;AAAA,IAC/B;AAAA,IAEA,MAAM,KAAK,QAAQ;AAzkCvB;AA0kCQ,UAAI;AACA,aAAK,IAAI,sBAAsB,OAAO,GAAG;AAGzC,YAAI,KAAK,UAAU;AACf,eAAK,MAAM;AAAA,QACf;AAGA,cAAM,UAAU,OAAO,WAAW,OAAO;AACzC,cAAM,UAAU,OAAO,WAAW,OAAO;AAGzC,cAAM,iBAAiB,KAAK;AAC5B,uBAAe,QAAQ,WAAS,MAAM,OAAO,CAAC;AAC9C,aAAK,qBAAqB;AAG1B,cAAM,qBAAqB,KAAK,sBAAsB,OAAO,GAAG;AAIhE,YAAI,oBAAoB;AACpB,eAAK,qBAAqB;AAAA,QAC9B;AAIA,YAAI,CAAC,oBAAoB;AACrB,eAAK,QAAQ,MAAM,OAAO;AAE1B,cAAI,OAAO,MAAM;AACb,iBAAK,QAAQ,OAAO,OAAO;AAAA,UAC/B;AAAA,QACJ,OAAO;AAIH,eAAK,QAAQ,gBAAgB,KAAK;AAElC,gBAAM,UAAU,KAAK,QAAQ,iBAAiB,QAAQ;AACtD,kBAAQ,QAAQ,OAAK,EAAE,gBAAgB,KAAK,CAAC;AAAA,QACjD;AAGA,aAAK,iBAAiB,OAAO;AAG7B,aAAK,kBAAkB,OAAO,QAAQ,OAAO,KAAK,WAAW,QAAQ;AAGrE,YAAI,KAAK,WAAW;AAChB,cAAI,KAAK,iBAAiB;AACtB,iBAAK,UAAU,UAAU,IAAI,sBAAsB;AAAA,UACvD,OAAO;AACH,iBAAK,UAAU,UAAU,OAAO,sBAAsB;AAAA,UAC1D;AAAA,QACJ;AAGA,YAAI,OAAO,UAAU,KAAK,QAAQ,YAAY,SAAS;AACnD,cAAI,KAAK,iBAAiB;AAEtB,iBAAK,QAAQ,gBAAgB,QAAQ;AACrC,gBAAI,KAAK,cAAc;AACnB,oBAAM,iBAAiB,KAAK,kBAAkB,OAAO,MAAM;AAC3D,mBAAK,aAAa,MAAM,YAAY,yBAAyB,QAAQ,uBAAc,KAAI;AACvF,mBAAK,aAAa,UAAU,IAAI,sBAAsB;AAAA,YAC1D;AAAA,UACJ,OAAO;AAEH,iBAAK,QAAQ,SAAS,KAAK,kBAAkB,OAAO,MAAM;AAC1D,gBAAI,KAAK,cAAc;AACnB,mBAAK,aAAa,UAAU,OAAO,sBAAsB;AACzD,mBAAK,aAAa,MAAM,eAAe,uBAAuB;AAAA,YAClE;AAAA,UACJ;AAAA,QACJ;AAGA,YAAI,OAAO,UAAU,OAAO,OAAO,SAAS,GAAG;AAC3C,iBAAO,OAAO,QAAQ,iBAAe;AACjC,kBAAM,QAAQ,SAAS,cAAc,OAAO;AAC5C,kBAAM,MAAM,YAAY;AACxB,kBAAM,OAAO,YAAY,QAAQ;AACjC,kBAAM,UAAU,YAAY,WAAW;AACvC,kBAAM,QAAQ,YAAY,SAAS,YAAY;AAE/C,gBAAI,YAAY,SAAS;AACrB,oBAAM,UAAU;AAAA,YACpB;AAGA,gBAAI,YAAY,cAAc;AAC1B,oBAAM,aAAa,iBAAiB,YAAY,YAAY;AAAA,YAChE;AAGA,kBAAM,aAAa,KAAK,QAAQ;AAChC,gBAAI,cAAc,WAAW,aAAa,KAAK,gBAAgB,WAAW,YAAY,SAAS;AAC3F,mBAAK,QAAQ,aAAa,OAAO,UAAU;AAAA,YAC/C,OAAO;AACH,mBAAK,QAAQ,YAAY,KAAK;AAAA,YAClC;AAAA,UACJ,CAAC;AACD,eAAK,qBAAqB;AAAA,QAC9B;AAGA,cAAM,yBAAyB,KAAK,MAAM;AAC1C,cAAM,6BAA6B,KAAK,MAAM;AAG9C,aAAK,sBAAsB,OAAO,uBAAuB;AACzD,aAAK,kBAAkB,OAAO,mBAAmB;AAGjD,aAAK,cAAc,OAAO;AAG1B,YAAI,KAAK,yBAAyB;AAC9B,eAAK,wBAAwB,cAAc,OAAO,mBAAmB;AAErE,eAAK,wBAAwB,aAAa;AAAA,QAC9C;AACA,YAAI,KAAK,qBAAqB;AAC1B,eAAK,oBAAoB,cAAc,OAAO,iBAAiB,OAAO,mBAAmB;AAAA,QAC7F;AAGA,YAAI,4BAA4B;AAC5B,eAAK,wBAAwB;AAAA,QACjC;AACA,YAAI,wBAAwB;AACxB,eAAK,oBAAoB;AAAA,QAC7B;AAGA,cAAM,uBAAuB,KAAK,qBAAqB,OAAO,GAAG;AAGjE,YAAI,wBAAwB,KAAK,UAAU;AACvC,eAAK,SAAS,QAAQ;AACtB,eAAK,WAAW;AAAA,QACpB;AAGA,YAAI,CAAC,KAAK,YAAY,sBAAsB;AACxC,gBAAM,KAAK,mBAAmB;AAAA,QAClC,OAAO;AAEH,eAAK,SAAS,QAAQ,KAAK;AAC3B,cAAI,KAAK,QAAQ,WAAW;AACxB,gBAAI;AAGA,mBAAK,QAAQ,UAAU,KAAK,QAAQ,WAAW;AAAA,YACnD,SAAS,GAAG;AAAA,YAEZ;AAEA,gBAAI,KAAK,UAAU;AACf,kBAAI,OAAO,KAAK,SAAS,qBAAqB,WAAW;AACrD,qBAAK,SAAS,mBAAmB;AAAA,cACrC;AACA,kBAAI,OAAO,KAAK,SAAS,qBAAqB,WAAW;AACrD,qBAAK,SAAS,mBAAmB;AAAA,cACrC;AACA,kBAAI,iBAAiB,KAAK,UAAU;AAEhC,qBAAK,SAAS,cAAc,KAAK,kBAAkB,KAAK,iBAAiB;AAAA,cAC7E;AAAA,YACJ;AAAA,UACJ,OAAO;AACH,iBAAK,QAAQ,KAAK;AAAA,UACtB;AAAA,QACJ;AAIA,YAAI,oBAAoB;AACpB,qBAAW,MAAM;AACb,iBAAK,qBAAqB;AAAA,UAC9B,GAAG,GAAG;AAAA,QACV,OAAO;AACH,eAAK,qBAAqB;AAAA,QAC9B;AAGA,eAAO,SAAS,SAAS,OAAO;AAGhC,YAAI,KAAK,gBAAgB;AACrB,eAAK,eAAe,QAAQ;AAC5B,eAAK,iBAAiB,IAAI,eAAe,IAAI;AAAA,QACjD;AAGA,YAAI,KAAK,mBAAmB;AACxB,gBAAM,uBAAuB,KAAK,kBAAkB;AACpD,eAAK,kBAAkB,QAAQ;AAC/B,eAAK,oBAAoB;AAEzB,gBAAM,KAAK,wBAAwB;AAGnC,cAAI,wBAAwB,KAAK,cAAc,KAAK,WAAW,iBAAiB,GAAG;AAC/E,uBAAK,sBAAL,mBAAwB;AAAA,UAC5B;AAAA,QACJ;AAGA,YAAI,KAAK,YAAY;AACjB,eAAK,iBAAiB;AAAA,QAC1B;AAGA,eAAO,SAAS,SAAS,OAAO;AAGhC,YAAI,0BAA0B,KAAK,iBAAiB;AAEhD,qBAAW,MAAM;AACb,iBAAK,mBAAmB;AAExB,mBAAO,SAAS,SAAS,OAAO;AAAA,UACpC,GAAG,GAAG;AAAA,QACV;AAEA,YAAI,8BAA8B,KAAK,qBAAqB;AAExD,qBAAW,MAAM;AACb,iBAAK,uBAAuB;AAE5B,mBAAO,SAAS,SAAS,OAAO;AAAA,UACpC,GAAG,GAAG;AAAA,QACV;AAEA,aAAK,KAAK,gBAAgB,MAAM;AAChC,aAAK,IAAI,2BAA2B;AAAA,MAExC,SAAS,OAAO;AACZ,aAAK,YAAY,KAAK;AAAA,MAC1B;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,eAAe;AACX,UAAI;AACA,YAAI,CAAC,KAAK,SAAU;AACpB,YAAI,OAAO,KAAK,SAAS,iBAAiB,YAAY;AAClD,eAAK,SAAS,aAAa;AAAA,QAC/B;AAAA,MACJ,SAAS,GAAG;AAAA,MAEZ;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUA,mBAAmB;AACf,UAAI,CAAC,KAAK,WAAY;AAEtB,YAAM,aAAa,KAAK;AAGxB,iBAAW,QAAQ,YAAY;AAG/B,iBAAW,eAAe;AAG1B,iBAAW,aAAa;AACxB,iBAAW,cAAc;AACzB,iBAAW,uBAAuB;AAAA,IACtC;AAAA,IAEA,qBAAqB,KAAK;AACtB,UAAI,CAAC,KAAK,SAAU,QAAO;AAE3B,YAAM,YAAY,IAAI,SAAS,aAAa,KAAK,IAAI,SAAS,UAAU;AACxE,YAAM,UAAU,IAAI,SAAS,WAAW;AACxC,YAAM,QAAQ,IAAI,SAAS,OAAO;AAClC,YAAM,eAAe,IAAI,SAAS,gBAAgB,KAAK,IAAI,SAAS,oBAAoB;AAExF,YAAM,sBAAsB,KAAK,SAAS,YAAY;AAEtD,UAAI,aAAa,wBAAwB,kBAAmB,QAAO;AACnE,UAAI,WAAW,wBAAwB,gBAAiB,QAAO;AAC/D,UAAI,SAAS,wBAAwB,cAAe,QAAO;AAC3D,UAAI,gBAAgB,wBAAwB,qBAAsB,QAAO;AACzE,UAAI,CAAC,aAAa,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAgB,wBAAwB,gBAAiB,QAAO;AAEzG,aAAO;AAAA,IACX;AAAA;AAAA,IAGA,OAAO;AACH,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,KAAK;AACnB;AAAA,MACJ;AAIA,UAAI,KAAK,mBAAmB,MAAM,QAAQ,KAAK,gBAAgB,MAAM,KAAK,KAAK,gBAAgB,OAAO,SAAS,GAAG;AAC9G,cAAM,QAAQ,KAAK,gBAAgB,gBAAgB,IAAI,KAAK,gBAAgB,eAAe;AAC3F,aAAK,gBAAgB,KAAK,OAAO,IAAI;AAAA,MACzC;AAAA,IACJ;AAAA,IAEA,QAAQ;AACJ,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,MAAM;AAAA,MACxB;AAAA,IACJ;AAAA,IAEA,OAAO;AACH,WAAK,MAAM;AACX,WAAK,KAAK,CAAC;AAAA,IACf;AAAA,IAEA,SAAS;AACL,UAAI,KAAK,MAAM,SAAS;AACpB,aAAK,MAAM;AAAA,MACf,OAAO;AACH,aAAK,KAAK;AAAA,MACd;AAAA,IACJ;AAAA,IAEA,KAAK,MAAM;AACP,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,KAAK,IAAI;AAAA,MAC3B;AAAA,IACJ;AAAA,IAEA,YAAY,WAAW,KAAK,QAAQ,cAAc;AAC9C,WAAK,KAAK,KAAK,IAAI,KAAK,MAAM,cAAc,UAAU,KAAK,MAAM,QAAQ,CAAC;AAAA,IAC9E;AAAA,IAEA,aAAa,WAAW,KAAK,QAAQ,cAAc;AAC/C,WAAK,KAAK,KAAK,IAAI,KAAK,MAAM,cAAc,UAAU,CAAC,CAAC;AAAA,IAC5D;AAAA;AAAA,IAGA,UAAU,QAAQ;AACd,YAAM,YAAY,KAAK,IAAI,GAAG,KAAK,IAAI,GAAG,MAAM,CAAC;AACjD,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,UAAU,SAAS;AAAA,MACrC;AACA,WAAK,MAAM,SAAS;AAGpB,UAAI,YAAY,KAAK,KAAK,MAAM,OAAO;AACnC,aAAK,MAAM,QAAQ;AACnB,YAAI,KAAK,UAAU;AACf,eAAK,SAAS,SAAS,KAAK;AAAA,QAChC;AACA,aAAK,KAAK,cAAc;AAAA,MAC5B;AAEA,WAAK,sBAAsB;AAAA,IAC/B;AAAA,IAEA,YAAY;AACR,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,OAAO;AACH,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,SAAS,IAAI;AAAA,MAC/B;AACA,WAAK,MAAM,QAAQ;AACnB,WAAK,sBAAsB;AAC3B,WAAK,KAAK,cAAc;AAAA,IAC5B;AAAA,IAEA,SAAS;AACL,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,SAAS,KAAK;AAAA,MAChC;AACA,WAAK,MAAM,QAAQ;AACnB,WAAK,sBAAsB;AAC3B,WAAK,KAAK,cAAc;AAAA,IAC5B;AAAA,IAEA,aAAa;AACT,UAAI,KAAK,MAAM,OAAO;AAClB,aAAK,OAAO;AAAA,MAChB,OAAO;AACH,aAAK,KAAK;AAAA,MACd;AAAA,IACJ;AAAA;AAAA,IAGA,iBAAiB,OAAO;AACpB,YAAM,WAAW,KAAK,IAAI,MAAM,KAAK,IAAI,GAAG,KAAK,CAAC;AAClD,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,iBAAiB,QAAQ;AAAA,MAC3C;AACA,WAAK,MAAM,gBAAgB;AAC3B,WAAK,sBAAsB;AAC3B,WAAK,KAAK,uBAAuB,QAAQ;AAAA,IAC7C;AAAA,IAEA,mBAAmB;AACf,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA;AAAA,IAGA,wBAAwB;AACpB,WAAK,QAAQ,sBAAsB;AAAA,QAC/B,QAAQ,KAAK,MAAM;AAAA,QACnB,OAAO,KAAK,MAAM;AAAA,QAClB,eAAe,KAAK,MAAM;AAAA,MAC9B,CAAC;AAAA,IACL;AAAA;AAAA,IAGA,kBAAkB;AACd,YAAM,OAAO,KAAK;AAClB,UAAI,oBAAoB;AAGxB,YAAM,QAAQ,mBAAmB,KAAK,UAAU,SAAS,KAC3C,UAAU,aAAa,cAAc,UAAU,iBAAiB;AAG9E,UAAI,OAAO;AACP,aAAK,wBAAwB;AAC7B;AAAA,MACJ;AAGA,UAAI,KAAK,mBAAmB;AACxB,4BAAoB,KAAK,kBAAkB;AAAA,MAC/C,WAAW,KAAK,yBAAyB;AACrC,4BAAoB,KAAK,wBAAwB;AAAA,MACrD,WAAW,KAAK,sBAAsB;AAClC,4BAAoB,KAAK,qBAAqB;AAAA,MAClD,WAAW,KAAK,qBAAqB;AACjC,4BAAoB,KAAK,oBAAoB;AAAA,MACjD;AAGA,UAAI,qBAAqB,kBAAkB,OAAO;AAC9C,0BAAkB,MAAM,CAAC,QAAQ;AAE7B,eAAK,IAAI,mDAAmD,IAAI,OAAO;AACvE,eAAK,wBAAwB;AAAA,QACjC,CAAC;AAAA,MACL;AAGA,UAAI,CAAC,KAAK,qBAAqB,CAAC,KAAK,2BACjC,CAAC,KAAK,wBAAwB,CAAC,KAAK,qBAAqB;AACzD,aAAK,wBAAwB;AAAA,MACjC,OAAO;AAEH,aAAK,MAAM,aAAa;AACxB,aAAK,UAAU,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,cAAa;AACrE,aAAK,KAAK,oBAAoB,IAAI;AAAA,MACtC;AAAA,IACJ;AAAA,IAEA,iBAAiB;AAEb,YAAM,uBAAuB,CAAC,EAC1B,SAAS,qBACT,SAAS,2BACT,SAAS,wBACT,SAAS;AAGb,UAAI,sBAAsB;AAEtB,YAAI,SAAS,gBAAgB;AACzB,mBAAS,eAAe;AAAA,QAC5B,WAAW,SAAS,sBAAsB;AACtC,mBAAS,qBAAqB;AAAA,QAClC,WAAW,SAAS,qBAAqB;AACrC,mBAAS,oBAAoB;AAAA,QACjC,WAAW,SAAS,kBAAkB;AAClC,mBAAS,iBAAiB;AAAA,QAC9B;AAAA,MACJ,OAAO;AAEH,aAAK,yBAAyB;AAAA,MAClC;AAEA,WAAK,MAAM,aAAa;AACxB,WAAK,UAAU,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,cAAa;AACxE,WAAK,KAAK,oBAAoB,KAAK;AAAA,IACvC;AAAA,IAEA,mBAAmB;AACf,UAAI,KAAK,MAAM,YAAY;AACvB,aAAK,eAAe;AAAA,MACxB,OAAO;AACH,aAAK,gBAAgB;AAAA,MACzB;AAAA,IACJ;AAAA;AAAA,IAGA,0BAA0B;AA5kD9B;AA6kDQ,WAAK,MAAM,aAAa;AACxB,WAAK,UAAU,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,cAAa;AAGrE,eAAS,KAAK,UAAU,IAAI,0BAA0B;AAGtD,WAAK,mBAAmB,OAAO,WAAW,OAAO;AACjD,WAAK,mBAAmB,OAAO,WAAW,OAAO;AAGjD,WAAK,wBAAwB,SAAS,KAAK,MAAM;AACjD,WAAK,wBAAwB,SAAS,KAAK,MAAM;AACjD,WAAK,qBAAqB,SAAS,KAAK,MAAM;AAC9C,WAAK,sBAAsB,SAAS,KAAK,MAAM;AAC/C,WAAK,wBAAwB,SAAS,gBAAgB,MAAM;AAC5D,WAAK,0BAA0B,SAAS,KAAK,MAAM;AACnD,WAAK,0BAA0B,SAAS,gBAAgB,MAAM;AAE9D,eAAS,KAAK,MAAM,WAAW;AAC/B,eAAS,KAAK,MAAM,QAAQ;AAC5B,eAAS,KAAK,MAAM,SAAS;AAC7B,eAAS,KAAK,MAAM,aAAa;AACjC,eAAS,gBAAgB,MAAM,WAAW;AAC1C,eAAS,gBAAgB,MAAM,aAAa;AAG5C,WAAK,qBAAoB,cAAS,cAAc,uBAAuB,MAA9C,mBAAiD,aAAa;AACvF,YAAM,WAAW,SAAS,cAAc,uBAAuB;AAC/D,UAAI,UAAU;AACV,iBAAS,aAAa,WAAW,4EAA4E;AAAA,MACjH;AAGA,aAAO,SAAS,GAAG,CAAC;AAGpB,WAAK,qBAAqB;AAE1B,WAAK,KAAK,oBAAoB,IAAI;AAClC,WAAK,KAAK,iBAAiB;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,uBAAuB;AACnB,WAAK,iBAAiB,CAAC;AAGvB,UAAI,UAAU,KAAK;AACnB,aAAO,WAAW,YAAY,SAAS,QAAQ,YAAY,SAAS,iBAAiB;AACjF,cAAM,SAAS,QAAQ;AACvB,YAAI,QAAQ;AAER,gBAAM,KAAK,OAAO,QAAQ,EAAE,QAAQ,aAAW;AAC3C,gBAAI,YAAY,WACZ,QAAQ,aAAa,KAAK,gBAC1B,CAAC,QAAQ,aAAa,OAAO,KAC7B,QAAQ,YAAY,YACpB,QAAQ,YAAY,WACpB,QAAQ,YAAY,UACpB,QAAQ,YAAY,QAAQ;AAC5B,sBAAQ,aAAa,SAAS,EAAE;AAChC,mBAAK,eAAe,KAAK,OAAO;AAAA,YACpC;AAAA,UACJ,CAAC;AAAA,QACL;AACA,kBAAU;AAAA,MACd;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA,IAKA,kCAAkC;AAC9B,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,QAAQ,QAAM;AAC9B,aAAG,gBAAgB,OAAO;AAAA,QAC9B,CAAC;AACD,aAAK,iBAAiB,CAAC;AAAA,MAC3B;AAAA,IACJ;AAAA,IAEA,2BAA2B;AAEvB,eAAS,KAAK,UAAU,OAAO,0BAA0B;AAGzD,WAAK,gCAAgC;AAGrC,UAAI,KAAK,0BAA0B,QAAW;AAC1C,iBAAS,KAAK,MAAM,WAAW,KAAK;AACpC,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,0BAA0B,QAAW;AAC1C,iBAAS,KAAK,MAAM,WAAW,KAAK;AACpC,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,uBAAuB,QAAW;AACvC,iBAAS,KAAK,MAAM,QAAQ,KAAK;AACjC,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,wBAAwB,QAAW;AACxC,iBAAS,KAAK,MAAM,SAAS,KAAK;AAClC,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,0BAA0B,QAAW;AAC1C,iBAAS,gBAAgB,MAAM,WAAW,KAAK;AAC/C,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,4BAA4B,QAAW;AAC5C,iBAAS,KAAK,MAAM,aAAa,KAAK;AACtC,eAAO,KAAK;AAAA,MAChB;AACA,UAAI,KAAK,4BAA4B,QAAW;AAC5C,iBAAS,gBAAgB,MAAM,aAAa,KAAK;AACjD,eAAO,KAAK;AAAA,MAChB;AAGA,UAAI,KAAK,sBAAsB,QAAW;AACtC,cAAM,WAAW,SAAS,cAAc,uBAAuB;AAC/D,YAAI,UAAU;AACV,mBAAS,aAAa,WAAW,KAAK,iBAAiB;AAAA,QAC3D;AACA,eAAO,KAAK;AAAA,MAChB;AAGA,UAAI,KAAK,qBAAqB,UAAa,KAAK,qBAAqB,QAAW;AAC5E,eAAO,SAAS,KAAK,kBAAkB,KAAK,gBAAgB;AAC5D,eAAO,KAAK;AACZ,eAAO,KAAK;AAAA,MAChB;AAEA,WAAK,KAAK,gBAAgB;AAAA,IAC9B;AAAA;AAAA,IAGA,WAAW;AACP,UAAI,KAAK,QAAQ,yBAAyB;AACtC,aAAK,QAAQ,wBAAwB;AACrC,aAAK,MAAM,MAAM;AACjB,aAAK,KAAK,aAAa,IAAI;AAAA,MAC/B;AAAA,IACJ;AAAA,IAEA,UAAU;AACN,UAAI,SAAS,yBAAyB;AAClC,iBAAS,qBAAqB;AAC9B,aAAK,MAAM,MAAM;AACjB,aAAK,KAAK,aAAa,KAAK;AAAA,MAChC;AAAA,IACJ;AAAA,IAEA,YAAY;AACR,UAAI,KAAK,MAAM,KAAK;AAChB,aAAK,QAAQ;AAAA,MACjB,OAAO;AACH,aAAK,SAAS;AAAA,MAClB;AAAA,IACJ;AAAA;AAAA,IAGA,iBAAiB;AACb,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,OAAO;AAC3B,aAAK,MAAM,kBAAkB;AAAA,MACjC;AAAA,IACJ;AAAA,IAEA,kBAAkB;AACd,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,QAAQ;AAC5B,aAAK,MAAM,kBAAkB;AAAA,MACjC;AAAA,IACJ;AAAA,IAEA,iBAAiB;AACb,UAAI,KAAK,MAAM,iBAAiB;AAC5B,aAAK,gBAAgB;AAAA,MACzB,OAAO;AACH,aAAK,eAAe;AAAA,MACxB;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,MAAM,oBAAoB,KAAK;AAC3B,UAAI;AACA,cAAM,WAAW,MAAM,MAAM,KAAK,EAAE,QAAQ,QAAQ,OAAO,WAAW,CAAC;AACvE,eAAO,SAAS;AAAA,MACpB,SAAS,OAAO;AACZ,eAAO;AAAA,MACX;AAAA,IACJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,mBAAmB,MAAM;AACrB,UAAI,CAAC,KAAM,QAAO;AAClB,aAAO,KACF,QAAQ,YAAY,EAAE,EACtB,QAAQ,OAAO,GAAG,EAClB,KAAK,EACL,YAAY;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IASA,wBAAwB,YAAY,QAAQ;AACxC,UAAI,CAAC,cAAc,CAAC,UAAU,OAAO,WAAW,GAAG;AAC/C,eAAO;AAAA,MACX;AAEA,YAAM,mBAAmB,KAAK,mBAAmB,UAAU;AAG3D,iBAAW,aAAa,QAAQ;AAC5B,YAAI,UAAU,SAAS,cAAc,UAAU,SAAS,aAAa;AACjE;AAAA,QACJ;AAEA,cAAM,QAAQ,UAAU;AACxB,YAAI,CAAC,SAAS,CAAC,MAAM,MAAM;AACvB;AAAA,QACJ;AAGA,iBAAS,IAAI,GAAG,IAAI,MAAM,KAAK,QAAQ,KAAK;AACxC,gBAAM,MAAM,MAAM,KAAK,CAAC;AACxB,gBAAM,UAAU,KAAK,mBAAmB,IAAI,IAAI;AAGhD,cAAI,YAAY,kBAAkB;AAC9B,mBAAO,IAAI;AAAA,UACf;AAGA,gBAAM,cAAc,iBAAiB,MAAM,KAAK,EAAE,OAAO,OAAK,EAAE,SAAS,CAAC;AAC1E,gBAAM,WAAW,QAAQ,MAAM,KAAK,EAAE,OAAO,OAAK,EAAE,SAAS,CAAC;AAE9D,cAAI,YAAY,SAAS,KAAK,SAAS,SAAS,GAAG;AAC/C,kBAAM,gBAAgB,YAAY,OAAO,UAAQ,SAAS,SAAS,IAAI,CAAC;AACxE,kBAAM,aAAa,cAAc,SAAS,YAAY;AAGtD,gBAAI,cAAc,KAAK;AACnB,qBAAO,IAAI;AAAA,YACf;AAAA,UACJ;AAAA,QACJ;AAAA,MACJ;AAEA,aAAO;AAAA,IACX;AAAA;AAAA,IAGA,MAAM,yBAAyB;AAC3B,aAAO,KAAK,wBAAwB,OAAO;AAAA,IAC/C;AAAA;AAAA,IAGA,MAAM,gCAAgC;AAElC,YAAM,4BAA4B,KAAK,eAAe,KAAK,QAAM,GAAG,aAAa,eAAe,CAAC;AACjG,YAAM,oBAAoB,KAAK,8BAA8B,SAAS;AAEtE,UAAI,CAAC,KAAK,uBAAuB,CAAC,6BAA6B,CAAC,mBAAmB;AAC/E,gBAAQ,KAAK,0EAA0E;AACvF;AAAA,MACJ;AAIA,YAAM,cAAc,KAAK,QAAQ;AACjC,YAAM,aAAa,KAAK,MAAM;AAC9B,YAAM,mBAAmB,CAAC,cAAc,gBAAgB;AAIxD,UAAI,qBAAqB;AACzB,UAAI,KAAK,kBAAkB,KAAK,eAAe,cAAc;AACzD,cAAM,QAAQ,KAAK,eAAe,aAAa;AAC/C,YAAI,SAAS,MAAM,cAAc,MAAM,WAAW,SAAS,GAAG;AAC1D,gBAAM,YAAY,MAAM,WAAW,CAAC;AACpC,+BAAqB,KAAK,mBAAmB,UAAU,IAAI;AAAA,QAC/D;AAAA,MACJ;AAIA,YAAM,cAAc,KAAK;AAAA,QACrB,KAAK,QAAQ,aAAa,QAAQ,KAClC,KAAK,QAAQ,UACb,KAAK,QAAQ;AAAA,MACjB;AAEA,UAAI,kBAAkB;AAClB,aAAK,kBAAkB;AAAA,MAC3B;AAGA,UAAI,6BAA6B,CAAC;AAIlC,UAAI,KAAK,+BAA+B;AACpC,cAAM,aAAa,KAAK,QAAQ,cAAc,KAAK,QAAQ;AAG3D,cAAM,iBAAiB,KAAK;AAC5B,YAAI,wBAAwB;AAC5B,YAAI,UAAU,KAAK;AAEnB,mBAAW,YAAY,gBAAgB;AACnC,gBAAM,YAAY,SAAS,aAAa,KAAK;AAC7C,gBAAM,cAAc,SAAS,aAAa,eAAe;AAIzD,gBAAM,iBAAiB,YAAY,UAAU,MAAM,GAAG,EAAE,IAAI,IAAI;AAChE,gBAAM,kBAAkB,aAAa,WAAW,MAAM,GAAG,EAAE,IAAI,IAAI;AAEnE,cAAI,eAAe,eAAe,aAC9B,WAAW,SAAS,SAAS,KAC7B,WAAW,SAAS,cAAc,KACjC,kBAAkB,oBAAoB,iBAAkB;AACzD,oCAAwB;AACxB,gBAAI,aAAa;AACb,wBAAU;AAAA,YACd,WAAW,WAAW;AAGlB,wBAAU,KAAK,uBAAuB;AAAA,YAC1C;AACA;AAAA,UACJ;AAAA,QACJ;AAGA,YAAI,CAAC,uBAAuB;AACxB,kCAAwB,KAAK;AAE7B,gBAAM,gBAAgB,sBAAsB,aAAa,eAAe;AACxE,cAAI,eAAe;AACf,sBAAU;AAAA,UACd;AAAA,QACJ;AAGA,YAAI,KAAK,8BAA8B,SAAS,GAAG;AAG/C,gBAAM,qBAAqB,KAAK,8BAA8B,IAAI,OAAO,cAAc;AACnF,gBAAI,UAAU,gBAAgB,UAAU,cAAc;AAGlD,kBAAI,UAAU,aAAa,MAAM;AAC7B,oBAAI;AACA,wBAAM,SAAS,MAAM,KAAK,oBAAoB,UAAU,YAAY;AACpE,yBAAO,EAAE,WAAW,OAAO;AAAA,gBAC/B,SAAS,OAAO;AAEZ,yBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,gBACtC;AAAA,cACJ,OAAO;AAGH,uBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,cACtC;AAAA,YACJ;AACA,mBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,UACtC,CAAC;AAED,gBAAM,oBAAoB,MAAM,QAAQ,IAAI,kBAAkB;AAC9D,gBAAM,eAAe,kBAAkB,OAAO,YAAU,OAAO,MAAM;AAErE,cAAI,aAAa,SAAS,GAAG;AAEzB,kBAAM,aAAa,oBAAI,IAAI;AAC3B,yBAAa,QAAQ,CAAC,EAAE,UAAU,MAAM;AACpC,oBAAM,YAAY,UAAU,aAAa;AACzC,kBAAI,WAAW;AACX,2BAAW,IAAI,WAAW;AAAA,kBACtB,YAAY,UAAU,SAAS;AAAA,kBAC/B,WAAW,UAAU,SAAS;AAAA,gBAClC,CAAC;AAAA,cACL,OAAO;AACH,2BAAW,IAAI,WAAW;AAAA,kBACtB,YAAY;AAAA,kBACZ,WAAW;AAAA,gBACf,CAAC;AAAA,cACL;AAAA,YACJ,CAAC;AAGD,kBAAM,gBAAgB,aAAa,IAAI,CAAC,EAAE,UAAU,MAAM;AACtD,oBAAM,SAAS,UAAU,aAAa,aAAa,KAAK;AACxD,oBAAM,SAAS,UAAU,aAAa;AACtC,oBAAM,cAAc,UAAU,aAAa;AAG3C,oBAAM,aAAa,CAAC;AACpB,oBAAM,KAAK,UAAU,aAAa,UAAU,EAAE,QAAQ,UAAQ;AAC1D,2BAAW,KAAK,IAAI,IAAI,KAAK;AAAA,cACjC,CAAC;AAED,qBAAO;AAAA,gBACH;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,cACJ;AAAA,YACJ,CAAC;AAGD,0BAAc,QAAQ,CAAC,EAAE,UAAU,MAAM;AACrC,wBAAU,aAAa,OAAO;AAAA,YAClC,CAAC;AAGD,iBAAK,QAAQ,KAAK;AAIlB,kBAAM,IAAI,QAAQ,aAAW;AACzB,yBAAW,MAAM;AACb,8BAAc,QAAQ,CAAC,EAAE,WAAW,QAAQ,QAAQ,aAAa,WAAW,MAAM;AAC9E,6CAA2B,KAAK,SAAS;AAGzC,wBAAM,kBAAkB,SAAS,cAAc,OAAO;AACtD,kCAAgB,aAAa,OAAO,UAAU,YAAY;AAG1D,yBAAO,KAAK,UAAU,EAAE,QAAQ,cAAY;AACxC,wBAAI,aAAa,SAAS,aAAa,iBAAiB;AACpD,sCAAgB,aAAa,UAAU,WAAW,QAAQ,CAAC;AAAA,oBAC/D;AAAA,kBACJ,CAAC;AAGD,sBAAI,eAAe,YAAY,YAAY;AACvC,2BAAO,aAAa,iBAAiB,WAAW;AAAA,kBACpD,OAAO;AACH,2BAAO,YAAY,eAAe;AAAA,kBACtC;AAGA,4BAAU,eAAe;AAAA,gBAC7B,CAAC;AAED,qBAAK,qBAAqB;AAG1B,sBAAM,iBAAiB,MAAM;AAEzB,uBAAK,kBAAkB,MAAM;AACzB,+CAA2B,QAAQ,CAAC,cAAc;AAC9C,4BAAM,eAAe,UAAU;AAC/B,4BAAM,eAAe,aAAa;AAElC,0BAAI,cAAc;AAEd,8BAAM,WAAW,WAAW,IAAI,SAAS,KAAK,EAAE,YAAY,OAAO,WAAW,MAAM;AAGpF,qCAAa,OAAO;AAIpB,8BAAM,cAAc,MAAM;AACtB,8BAAI,SAAS,YAAY;AAErB,yCAAa,OAAO;AAAA,0BACxB,WAAW,SAAS,WAAW;AAC3B,yCAAa,OAAO;AAAA,0BACxB,OAAO;AACH,yCAAa,OAAO;AAAA,0BACxB;AAAA,wBACJ;AAGA,4BAAI,aAAa,cAAc,GAAG;AAC9B,sCAAY;AAAA,wBAChB,OAAO;AACH,uCAAa,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACjE,uCAAa,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAAA,wBACtE;AAAA,sBACJ;AAAA,oBACJ,CAAC;AAAA,kBACL,GAAG,GAAG;AAAA,gBACV;AAGA,oBAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,6BAAW,gBAAgB,GAAG;AAAA,gBAClC,OAAO;AACH,uBAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB,EAAE,MAAM,KAAK,CAAC;AAE9E,6BAAW,gBAAgB,GAAI;AAAA,gBACnC;AAEA,wBAAQ;AAAA,cACZ,GAAG,GAAG;AAAA,YACV,CAAC;AAED,kBAAM,eAAe,kBAAkB,SAAS,aAAa;AAAA,UACjE;AAAA,QACJ;AAKA,cAAM,oBAAoB,KAAK;AAC/B,cAAM,kBAAkB,CAAC;AAEzB,0BAAkB,QAAQ,CAAC,aAAa;AACpC,gBAAM,cAAc,SAAS,aAAa,eAAe;AACzD,gBAAME,cAAa,SAAS,aAAa,KAAK;AAE9C,cAAI,aAAa;AACb,kBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,gBAAI,UAAU,SAAS,aAAa,eAAe;AAGnD,gBAAI,CAAC,SAAS;AACV,wBAAUA;AAAA,YACd;AAGA,4BAAgB,KAAK;AAAA,cACjB,KAAK;AAAA;AAAA,cACL;AAAA,cACA;AAAA,cACA,SAAS;AAAA,YACb,CAAC;AAAA,UACL,OAAO;AAEH,kBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,kBAAM,MAAM,SAAS,aAAa,KAAK;AACvC,4BAAgB,KAAK;AAAA,cACjB;AAAA,cACA;AAAA,cACA,SAAS;AAAA,cACT,SAAS;AAAA,YACb,CAAC;AAAA,UACL;AAAA,QACJ,CAAC;AAGD,cAAM,kBAAkB,KAAK,QAAQ,aAAa,KAAK;AACvD,cAAM,WAAW,kBAAkB,KAAK,QAAQ,aAAa,KAAK,IAAI;AACtE,YAAI,iBAAiB;AACjB,eAAK,QAAQ,gBAAgB,KAAK;AAAA,QACtC;AAGA,0BAAkB,QAAQ,cAAY;AAClC,mBAAS,OAAO;AAAA,QACpB,CAAC;AAGD,wBAAgB,QAAQ,gBAAc;AAClC,gBAAM,YAAY,SAAS,cAAc,QAAQ;AACjD,oBAAU,aAAa,OAAO,WAAW,GAAG;AAC5C,cAAI,WAAW,MAAM;AACjB,sBAAU,aAAa,QAAQ,WAAW,IAAI;AAAA,UAClD;AACA,cAAI,WAAW,SAAS;AACpB,sBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,UAC9D;AACA,cAAI,WAAW,SAAS;AACpB,sBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,UAC9D;AACA,gBAAM,aAAa,KAAK,QAAQ,cAAc,OAAO;AACrD,cAAI,YAAY;AACZ,iBAAK,QAAQ,aAAa,WAAW,UAAU;AAAA,UACnD,OAAO;AACH,iBAAK,QAAQ,YAAY,SAAS;AAAA,UACtC;AAAA,QACJ,CAAC;AAGD,aAAK,uBAAuB;AAC5B,aAAK,uBAAuB;AAG5B,YAAI,eAAe,KAAK,QAAQ,YAAY,SAAS;AACjD,eAAK,QAAQ,SAAS;AAAA,QAC1B;AAKA,aAAK,QAAQ,KAAK;AAGlB,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,gBAAM,mBAAmB,MAAM;AAC3B,iBAAK,QAAQ,oBAAoB,kBAAkB,gBAAgB;AACnE,oBAAQ;AAAA,UACZ;AAEA,cAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,oBAAQ;AAAA,UACZ,OAAO;AACH,iBAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB;AAAA,UACpE;AAAA,QACJ,CAAC;AAGD,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,YAAI,cAAc,KAAK,YAAY;AAC/B,gBAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,kBAAM,YAAY,MAAM;AACpB,mBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,mBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,sBAAQ;AAAA,YACZ;AAGA,gBAAI,KAAK,QAAQ,cAAc,GAAG;AAC9B,sBAAQ;AAAA,YACZ,OAAO;AAEH,mBAAK,QAAQ,iBAAiB,WAAW,WAAW,EAAE,MAAM,KAAK,CAAC;AAClE,mBAAK,QAAQ,iBAAiB,kBAAkB,WAAW,EAAE,MAAM,KAAK,CAAC;AAGzE,yBAAW,MAAM;AACb,qBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,qBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,wBAAQ;AAAA,cACZ,GAAG,GAAI;AAAA,YACX;AAAA,UACJ,CAAC;AAAA,QACL;AAGA,YAAIC,YAAW;AACf,YAAI,sBAAsB,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,GAAG;AAEpF,gBAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,gBAAM,eAAe,KAAK,wBAAwB,oBAAoB,KAAK,eAAe,MAAM;AAChG,cAAI,iBAAiB,MAAM;AACvB,YAAAA,YAAW;AACX,gBAAI,KAAK,QAAQ,OAAO;AACpB,sBAAQ,IAAI,iCAAiC,oBAAW,SAAQ,OAAAA,WAAQ,IAAG;AAAA,YAC/E;AAAA,UACJ;AAAA,QACJ;AAGA,YAAIA,YAAW,GAAG;AACd,eAAK,KAAKA,SAAQ;AAElB,gBAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,QACzD;AAEA,YAAI,YAAY;AACZ,gBAAM,KAAK,KAAK;AAEhB,eAAK,kBAAkB,MAAM;AACzB,iBAAK,kBAAkB;AAAA,UAC3B,GAAG,GAAG;AAAA,QACV,OAAO;AAGH,eAAK,MAAM;AACX,cAAI,CAAC,kBAAkB;AACnB,iBAAK,kBAAkB;AAAA,UAC3B;AAAA,QACJ;AAGA,YAAI,CAAC,KAAK,+BAA+B;AACrC;AAAA,QACJ;AACA,aAAK,MAAM,0BAA0B;AACrC,aAAK,KAAK,yBAAyB;AAAA,MACvC,OAAO;AAGH,YAAI,KAAK,8BAA8B,SAAS,GAAG;AAE/C,gBAAM,qBAAqB,KAAK,8BAA8B,IAAI,OAAO,cAAc;AACnF,gBAAI,UAAU,gBAAgB,UAAU,cAAc;AAGlD,kBAAI,UAAU,aAAa,MAAM;AAC7B,oBAAI;AACA,wBAAM,SAAS,MAAM,KAAK,oBAAoB,UAAU,YAAY;AACpE,yBAAO,EAAE,WAAW,OAAO;AAAA,gBAC/B,SAAS,OAAO;AACZ,yBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,gBACtC;AAAA,cACJ,OAAO;AAEH,uBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,cACtC;AAAA,YACJ;AACA,mBAAO,EAAE,WAAW,QAAQ,MAAM;AAAA,UACtC,CAAC;AAED,gBAAM,oBAAoB,MAAM,QAAQ,IAAI,kBAAkB;AAC9D,gBAAM,eAAe,kBAAkB,OAAO,YAAU,OAAO,MAAM;AAErE,cAAI,aAAa,SAAS,GAAG;AAEzB,kBAAM,aAAa,oBAAI,IAAI;AAC3B,yBAAa,QAAQ,CAAC,EAAE,UAAU,MAAM;AACpC,oBAAM,YAAY,UAAU,aAAa;AACzC,kBAAI,WAAW;AACX,2BAAW,IAAI,WAAW;AAAA,kBACtB,YAAY,UAAU,SAAS;AAAA,kBAC/B,WAAW,UAAU,SAAS;AAAA,gBAClC,CAAC;AAAA,cACL,OAAO;AACH,2BAAW,IAAI,WAAW;AAAA,kBACtB,YAAY;AAAA,kBACZ,WAAW;AAAA,gBACf,CAAC;AAAA,cACL;AAAA,YACJ,CAAC;AAGD,kBAAM,gBAAgB,aAAa,IAAI,CAAC,EAAE,UAAU,MAAM;AACtD,oBAAM,SAAS,UAAU,aAAa,aAAa,KAAK;AACxD,oBAAM,SAAS,UAAU,aAAa;AACtC,oBAAM,cAAc,UAAU,aAAa;AAG3C,oBAAM,aAAa,CAAC;AACpB,oBAAM,KAAK,UAAU,aAAa,UAAU,EAAE,QAAQ,UAAQ;AAC1D,2BAAW,KAAK,IAAI,IAAI,KAAK;AAAA,cACjC,CAAC;AAED,qBAAO;AAAA,gBACH;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,gBACA;AAAA,cACJ;AAAA,YACJ,CAAC;AAGD,0BAAc,QAAQ,CAAC,EAAE,UAAU,MAAM;AACrC,wBAAU,aAAa,OAAO;AAAA,YAClC,CAAC;AAGD,iBAAK,QAAQ,KAAK;AAGlB,uBAAW,MAAM;AACb,4BAAc,QAAQ,CAAC,EAAE,WAAW,QAAQ,QAAQ,aAAa,WAAW,MAAM;AAC9E,2CAA2B,KAAK,SAAS;AAGzC,sBAAM,kBAAkB,SAAS,cAAc,OAAO;AACtD,gCAAgB,aAAa,OAAO,UAAU,YAAY;AAG1D,uBAAO,KAAK,UAAU,EAAE,QAAQ,cAAY;AACxC,sBAAI,aAAa,SAAS,aAAa,iBAAiB;AACpD,oCAAgB,aAAa,UAAU,WAAW,QAAQ,CAAC;AAAA,kBAC/D;AAAA,gBACJ,CAAC;AAGD,sBAAM,aAAa,OAAO;AAC1B,oBAAI,cAAc,WAAW,aAAa,KAAK,gBAAgB,WAAW,YAAY,SAAS;AAC3F,yBAAO,aAAa,iBAAiB,UAAU;AAAA,gBACnD,WAAW,eAAe,YAAY,YAAY;AAC9C,yBAAO,aAAa,iBAAiB,WAAW;AAAA,gBACpD,OAAO;AACH,yBAAO,YAAY,eAAe;AAAA,gBACtC;AAGA,0BAAU,eAAe;AAAA,cAC7B,CAAC;AAGD,mBAAK,QAAQ,KAAK;AAGlB,oBAAM,iBAAiB,MAAM;AAEzB,2BAAW,MAAM;AACb,6CAA2B,QAAQ,CAAC,cAAc;AAC9C,0BAAM,eAAe,UAAU;AAC/B,0BAAM,eAAe,aAAa;AAElC,wBAAI,cAAc;AAEd,4BAAM,WAAW,WAAW,IAAI,SAAS,KAAK,EAAE,YAAY,OAAO,WAAW,MAAM;AAGpF,mCAAa,OAAO;AAGpB,4BAAM,cAAc,MAAM;AACtB,4BAAI,SAAS,YAAY;AAErB,uCAAa,OAAO;AAAA,wBACxB,WAAW,SAAS,WAAW;AAC3B,uCAAa,OAAO;AAAA,wBACxB,OAAO;AACH,uCAAa,OAAO;AAAA,wBACxB;AAAA,sBACJ;AAGA,0BAAI,aAAa,cAAc,GAAG;AAC9B,oCAAY;AAAA,sBAChB,OAAO;AACH,qCAAa,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACjE,qCAAa,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAAA,sBACtE;AAAA,oBACJ;AAAA,kBACJ,CAAC;AAAA,gBACL,GAAG,GAAG;AAAA,cACV;AAGA,kBAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,2BAAW,gBAAgB,GAAG;AAAA,cAClC,OAAO;AACH,qBAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB,EAAE,MAAM,KAAK,CAAC;AAE9E,2BAAW,gBAAgB,GAAI;AAAA,cACnC;AAAA,YACJ,GAAG,GAAG;AAAA,UACV;AAAA,QACJ;AAGA,cAAM,yBAAyB,KAAK;AACpC,cAAMC,6BAA4B,uBAAuB,KAAK,QAAM,GAAG,aAAa,eAAe,CAAC;AAEpG,YAAIA,4BAA2B;AAC3B,gBAAM,0BAA0B,CAAC;AAEjC,iCAAuB,QAAQ,CAAC,aAAa;AACzC,kBAAM,cAAc,SAAS,aAAa,eAAe;AACzD,kBAAM,aAAa,SAAS,aAAa,KAAK;AAE9C,gBAAI,aAAa;AACb,oBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,kBAAI,UAAU,SAAS,aAAa,eAAe;AAEnD,kBAAI,CAAC,SAAS;AACV,0BAAU;AAAA,cACd;AAEA,sCAAwB,KAAK;AAAA,gBACzB,KAAK;AAAA,gBACL;AAAA,gBACA;AAAA,gBACA,SAAS;AAAA,cACb,CAAC;AAAA,YACL,OAAO;AACH,oBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,oBAAM,MAAM,SAAS,aAAa,KAAK;AACvC,sCAAwB,KAAK;AAAA,gBACzB;AAAA,gBACA;AAAA,gBACA,SAAS;AAAA,gBACT,SAAS;AAAA,cACb,CAAC;AAAA,YACL;AAAA,UACJ,CAAC;AAGD,iCAAuB,QAAQ,cAAY;AACvC,qBAAS,OAAO;AAAA,UACpB,CAAC;AAGD,kCAAwB,QAAQ,gBAAc;AAC1C,kBAAM,YAAY,SAAS,cAAc,QAAQ;AACjD,sBAAU,aAAa,OAAO,WAAW,GAAG;AAC5C,gBAAI,WAAW,MAAM;AACjB,wBAAU,aAAa,QAAQ,WAAW,IAAI;AAAA,YAClD;AACA,gBAAI,WAAW,SAAS;AACpB,wBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,YAC9D;AACA,gBAAI,WAAW,SAAS;AACpB,wBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,YAC9D;AACA,iBAAK,QAAQ,YAAY,SAAS;AAAA,UACtC,CAAC;AAGD,cAAI,eAAe,KAAK,QAAQ,YAAY,SAAS;AACjD,iBAAK,QAAQ,SAAS;AAAA,UAC1B;AAGA,eAAK,QAAQ,KAAK;AAClB,eAAK,qBAAqB;AAAA,QAC9B,OAAO;AAGH,cAAI,eAAe,KAAK,QAAQ,YAAY,SAAS;AACjD,iBAAK,QAAQ,SAAS;AAAA,UAC1B;AACA,eAAK,QAAQ,MAAM,KAAK;AAAA,QAC5B;AAAA,MACJ;AAGA,YAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,cAAM,mBAAmB,MAAM;AAC3B,eAAK,QAAQ,oBAAoB,kBAAkB,gBAAgB;AACnE,kBAAQ;AAAA,QACZ;AAEA,YAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,kBAAQ;AAAA,QACZ,OAAO;AACH,eAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB;AAAA,QACpE;AAAA,MACJ,CAAC;AAGD,UAAI,cAAc,KAAK,YAAY;AAC/B,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,gBAAM,YAAY,MAAM;AACpB,iBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,iBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,oBAAQ;AAAA,UACZ;AAGA,cAAI,KAAK,QAAQ,cAAc,GAAG;AAC9B,oBAAQ;AAAA,UACZ,OAAO;AAEH,iBAAK,QAAQ,iBAAiB,WAAW,WAAW,EAAE,MAAM,KAAK,CAAC;AAClE,iBAAK,QAAQ,iBAAiB,kBAAkB,WAAW,EAAE,MAAM,KAAK,CAAC;AAGzE,uBAAW,MAAM;AACb,mBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,mBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,sBAAQ;AAAA,YACZ,GAAG,GAAI;AAAA,UACX;AAAA,QACJ,CAAC;AAAA,MACL;AAGA,UAAI,KAAK,QAAQ,YAAY,WAAW,gBAAgB,KAAK,CAAC,YAAY;AAGtE,YAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,eAAK,QAAQ,cAAc;AAE3B,eAAK,kBAAkB,MAAM;AACzB,iBAAK,QAAQ,cAAc;AAAA,UAC/B,GAAG,EAAE;AAAA,QACT;AAAA,MACJ;AAGA,UAAI,WAAW;AACf,UAAI,sBAAsB,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,GAAG;AAEpF,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,cAAM,eAAe,KAAK,wBAAwB,oBAAoB,KAAK,eAAe,MAAM;AAChG,YAAI,iBAAiB,MAAM;AACvB,qBAAW;AACX,cAAI,KAAK,QAAQ,OAAO;AACpB,oBAAQ,IAAI,iCAAiC,oBAAW,SAAQ,iBAAQ,IAAG;AAAA,UAC/E;AAAA,QACJ;AAAA,MACJ;AAGA,UAAI,WAAW,GAAG;AACd,aAAK,KAAK,QAAQ;AAElB,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,MACzD;AAEA,UAAI,YAAY;AACZ,cAAM,KAAK,KAAK;AAEhB,aAAK,kBAAkB,MAAM;AACzB,eAAK,kBAAkB;AAAA,QAC3B,GAAG,GAAG;AAAA,MACV,OAAO;AAGH,aAAK,MAAM;AACX,YAAI,CAAC,kBAAkB;AACnB,eAAK,kBAAkB;AAAA,QAC3B;AAAA,MACJ;AAGA,UAAI,2BAA2B,SAAS,KAAK,KAAK,gBAAgB;AAE9D,cAAM,qBAAqB,KAAK,MAAM;AACtC,YAAI,mBAAmB;AACvB,YAAI,KAAK,eAAe,cAAc;AAClC,gBAAM,oBAAoB,KAAK,eAAe,OAAO,UAAU,OAAK,EAAE,UAAU,KAAK,eAAe,aAAa,KAAK;AACtH,cAAI,qBAAqB,GAAG;AACxB,+BAAmB;AAAA,cACf,UAAU,KAAK,eAAe,OAAO,iBAAiB,EAAE;AAAA,cACxD,MAAM,KAAK,eAAe,OAAO,iBAAiB,EAAE;AAAA,YACxD;AAAA,UACJ;AAAA,QACJ;AAIA,cAAM,eAAe,MAAM;AAEvB,eAAK,eAAe,SAAS,CAAC;AAC9B,eAAK,eAAe,WAAW;AAG/B,cAAI,sBAAsB,oBAAoB,KAAK,eAAe,OAAO,SAAS,GAAG;AAEjF,kBAAM,qBAAqB,KAAK,eAAe,OAAO;AAAA,cAAU,OAC5D,EAAE,aAAa,iBAAiB,YAAY,EAAE,SAAS,iBAAiB;AAAA,YAC5E;AAEA,gBAAI,sBAAsB,GAAG;AACzB,oBAAM,gBAAgB,KAAK,eAAe,OAAO,kBAAkB;AAEnE,kBAAI,cAAc,MAAM,cAAc,GAAG;AAErC,qBAAK,eAAe,OAAO,kBAAkB;AAAA,cACjD,OAAO;AAEH,sBAAM,cAAc,MAAM;AACtB,gCAAc,MAAM,oBAAoB,QAAQ,WAAW;AAC3D,gCAAc,MAAM,oBAAoB,SAAS,WAAW;AAC5D,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,aAAa,GAAG;AAC3E,yBAAK,eAAe,OAAO,kBAAkB;AAAA,kBACjD;AAAA,gBACJ;AACA,8BAAc,MAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACxE,8BAAc,MAAM,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAEzE,8BAAc,MAAM,OAAO;AAE3B,2BAAW,MAAM;AACb,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,aAAa,GAAG;AAC3E,yBAAK,eAAe,OAAO,kBAAkB;AAAA,kBACjD;AAAA,gBACJ,GAAG,GAAI;AAAA,cACX;AAAA,YACJ,WAAW,KAAK,eAAe,OAAO,SAAS,GAAG;AAE9C,oBAAM,aAAa,KAAK,eAAe,OAAO,CAAC;AAC/C,kBAAI,WAAW,MAAM,cAAc,GAAG;AAClC,qBAAK,eAAe,OAAO,CAAC;AAAA,cAChC,OAAO;AACH,sBAAM,cAAc,MAAM;AACtB,6BAAW,MAAM,oBAAoB,QAAQ,WAAW;AACxD,6BAAW,MAAM,oBAAoB,SAAS,WAAW;AACzD,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,UAAU,GAAG;AACxE,yBAAK,eAAe,OAAO,CAAC;AAAA,kBAChC;AAAA,gBACJ;AACA,2BAAW,MAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACrE,2BAAW,MAAM,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AACtE,2BAAW,MAAM,OAAO;AACxB,2BAAW,MAAM;AACb,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,UAAU,GAAG;AACxE,yBAAK,eAAe,OAAO,CAAC;AAAA,kBAChC;AAAA,gBACJ,GAAG,GAAI;AAAA,cACX;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAGA,mBAAW,cAAc,GAAG;AAAA,MAChC;AAIA,UAAI,KAAK,qBAAqB,KAAK,kBAAkB,WAAW;AAG5D,cAAM,gBAAgB,OAAO,+BAA+B,cAAc,6BAA6B,CAAC;AAExG,YAAI,cAAc,SAAS,GAAG;AAI1B,gBAAM,mBAAmB,MAAM;AAI3B,iBAAK,qBAAqB;AAC1B,kBAAM,gBAAgB,KAAK;AAI3B,kBAAM,cAAc,cAAc,IAAI,CAAC,cAAc;AACjD,oBAAM,UAAU,UAAU;AAC1B,oBAAM,cAAc,QAAQ,aAAa,KAAK;AAC9C,oBAAM,UAAU,QAAQ,aAAa,SAAS;AAC9C,oBAAM,OAAO,QAAQ,aAAa,MAAM;AAIxC,kBAAI,aAAa,cAAc,KAAK,WAAS,QAAQ,UAAU,KAAK;AAGpE,kBAAI,CAAC,YAAY;AACb,6BAAa,cAAc,KAAK,WAAS;AACrC,sBAAI,MAAM,aAAa,YAClB,MAAM,SAAS,QAAS,SAAS,cAAc,MAAM,SAAS,cAAe;AAE9E,0BAAM,uBAAuB,KAAK,iBAAiB,KAAK;AACxD,wBAAI,sBAAsB;AACtB,4BAAM,YAAY,qBAAqB,aAAa,KAAK;AACzD,0BAAI,cAAc,aAAa;AAC3B,+BAAO;AAAA,sBACX;AAAA,oBACJ;AAAA,kBACJ;AACA,yBAAO;AAAA,gBACX,CAAC;AAAA,cACL;AAGA,kBAAI,YAAY;AACZ,sBAAM,eAAe,KAAK,iBAAiB,UAAU;AACrD,oBAAI,gBAAgB,aAAa,aAAa,KAAK,MAAM,aAAa;AAClE,yBAAO;AAAA,gBACX;AAAA,cACJ;AAEA,qBAAO;AAAA,YACX,CAAC,EAAE,OAAO,OAAO;AAEjB,gBAAI,YAAY,WAAW,GAAG;AAE1B,mBAAK,kBAAkB,MAAM;AACzB,oBAAI,KAAK,qBAAqB,KAAK,kBAAkB,oBAAoB;AACrE,uBAAK,kBAAkB,mBAAmB;AAAA,gBAC9C;AAAA,cACJ,GAAG,GAAI;AACP;AAAA,YACJ;AAGA,wBAAY,QAAQ,WAAS;AACzB,kBAAI,MAAM,SAAS,YAAY;AAC3B,sBAAM,OAAO;AAAA,cACjB;AAAA,YACJ,CAAC;AAED,gBAAI,cAAc;AAClB,kBAAM,cAAc,MAAM;AACtB;AACA,kBAAI,eAAe,YAAY,QAAQ;AAGnC,qBAAK,kBAAkB,MAAM;AACzB,sBAAI,KAAK,qBAAqB,KAAK,kBAAkB,oBAAoB;AAOrE,yBAAK,qBAAqB;AAC1B,0BAAMC,iBAAgB,KAAK;AAC3B,0BAAM,mBAAmB,cAAc,IAAI,OAAK,EAAE,YAAY;AAC9D,0BAAM,mBAAmB,YAAY,KAAK,WAAS;AAC/C,4BAAM,UAAU,KAAK,iBAAiB,KAAK;AAC3C,6BAAO,WAAW,iBAAiB,SAAS,QAAQ,aAAa,KAAK,CAAC;AAAA,oBAC3E,CAAC;AAED,wBAAI,oBAAoB,YAAY,SAAS,GAAG;AAC5C,2BAAK,kBAAkB,mBAAmB;AAAA,oBAC9C;AAAA,kBACJ;AAAA,gBACJ,GAAG,GAAG;AAAA,cACV;AAAA,YACJ;AAEA,wBAAY,QAAQ,WAAS;AAEzB,kBAAI,MAAM,SAAS,YAAY;AAC3B,sBAAM,OAAO;AAAA,cACjB;AAIA,oBAAM,uBAAuB,KAAK,iBAAiB,KAAK;AACxD,oBAAM,YAAY,uBAAuB,qBAAqB,aAAa,KAAK,IAAI;AAGpF,oBAAM,oBAAoB,cAAc,KAAK,OAAK;AAC9C,sBAAM,MAAM,EAAE;AACd,uBAAO,QAAQ,IAAI,UAAU,SACxB,IAAI,aAAa,SAAS,MAAM,MAAM,YACtC,IAAI,aAAa,MAAM,MAAM,MAAM;AAAA,cAC5C,CAAC;AACD,oBAAM,cAAc,oBAAoB,kBAAkB,eAAe;AAGzE,kBAAI,eAAe,aAAa,cAAc,aAAa;AAEvD,4BAAY;AACZ;AAAA,cACJ;AAEA,kBAAI,MAAM,cAAc,KAAK,MAAM,QAAQ,MAAM,KAAK,SAAS,GAAG;AAE9D,4BAAY;AAAA,cAChB,OAAO;AAEH,oBAAI,MAAM,SAAS,YAAY;AAC3B,wBAAM,OAAO;AAAA,gBACjB;AAGA,sBAAM,cAAc,MAAM;AAEtB,uBAAK,kBAAkB,aAAa,GAAG;AAAA,gBAC3C;AAEA,oBAAI,MAAM,cAAc,GAAG;AAGvB,uBAAK,kBAAkB,MAAM;AACzB,wBAAI,MAAM,QAAQ,MAAM,KAAK,SAAS,GAAG;AACrC,kCAAY;AAAA,oBAChB,OAAO;AAEH,4BAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AAAA,oBAC9D;AAAA,kBACJ,GAAG,GAAG;AAAA,gBACV,OAAO;AACH,wBAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AAC1D,wBAAM,iBAAiB,SAAS,MAAM;AAElC,gCAAY;AAAA,kBAChB,GAAG,EAAE,MAAM,KAAK,CAAC;AAAA,gBACrB;AAAA,cACJ;AAAA,YACJ,CAAC;AAAA,UACL;AAIA,gBAAM,gBAAgB,MAAM;AAEpB,iBAAK,kBAAkB,MAAM;AACzB,kBAAI,KAAK,QAAQ,cAAc,GAAG;AAC9B,iCAAiB;AAAA,cACrB,OAAO;AACH,qBAAK,QAAQ,iBAAiB,kBAAkB,kBAAkB,EAAE,MAAM,KAAK,CAAC;AAEhF,qBAAK,kBAAkB,kBAAkB,GAAI;AAAA,cACjD;AAAA,YACJ,GAAG,GAAG;AAAA,UACd;AAEA,wBAAc;AAGd,qBAAW,MAAM;AACb,gBAAI,KAAK,qBAAqB,KAAK,kBAAkB,oBAAoB;AACrE,mBAAK,kBAAkB,mBAAmB;AAAA,YAC9C;AAAA,UACJ,GAAG,GAAI;AAAA,QACX,OAAO;AAEH,qBAAW,MAAM;AACb,gBAAI,KAAK,qBAAqB,KAAK,kBAAkB,oBAAoB;AACrE,mBAAK,kBAAkB,mBAAmB;AAAA,YAC9C;AAAA,UACJ,GAAG,GAAG;AAAA,QACV;AAAA,MACJ;AAEA,UAAI,CAAC,kBAAkB;AACnB,aAAK,kBAAkB;AAAA,MAC3B;AAEA,UAAI,CAAC,KAAK,+BAA+B;AACrC;AAAA,MACJ;AAEA,WAAK,MAAM,0BAA0B;AACrC,WAAK,KAAK,yBAAyB;AAAA,IACvC;AAAA,IAEA,MAAM,0BAA0B;AAC5B,aAAO,KAAK,wBAAwB,QAAQ;AAAA,IAChD;AAAA;AAAA,IAGA,MAAM,iCAAiC;AACnC,UAAI,CAAC,KAAK,aAAa;AACnB;AAAA,MACJ;AAIA,YAAM,cAAc,KAAK,QAAQ;AACjC,YAAM,aAAa,KAAK,MAAM;AAI9B,UAAI,qBAAqB;AACzB,UAAI,KAAK,kBAAkB,KAAK,eAAe,cAAc;AACzD,cAAM,QAAQ,KAAK,eAAe,aAAa;AAC/C,YAAI,SAAS,MAAM,cAAc,MAAM,WAAW,SAAS,GAAG;AAC1D,gBAAM,YAAY,MAAM,WAAW,CAAC;AACpC,+BAAqB,KAAK,mBAAmB,UAAU,IAAI;AAAA,QAC/D;AAAA,MACJ;AAIA,YAAM,cAAc,KAAK;AAAA,QACrB,KAAK,QAAQ,aAAa,QAAQ,KAClC,KAAK,QAAQ,UACb,KAAK,QAAQ;AAAA,MACjB;AAIA,UAAI,6BAA6B,CAAC;AAClC,UAAI,KAAK,8BAA8B,SAAS,GAAG;AAE/C,cAAM,kBAAkB,KAAK,8BAA8B,IAAI,CAAC,cAAc;AAC1E,gBAAM,eAAe,UAAU;AAC/B,cAAI,CAAC,gBAAgB,CAAC,aAAa,YAAY;AAC3C,mBAAO;AAAA,UACX;AAEA,gBAAM,SAAS,aAAa;AAC5B,gBAAM,cAAc,aAAa;AAGjC,gBAAM,aAAa,CAAC;AACpB,gBAAM,KAAK,aAAa,UAAU,EAAE,QAAQ,UAAQ;AAChD,uBAAW,KAAK,IAAI,IAAI,KAAK;AAAA,UACjC,CAAC;AAED,iBAAO;AAAA,YACH;AAAA,YACA;AAAA,YACA;AAAA,YACA;AAAA,UACJ;AAAA,QACJ,CAAC,EAAE,OAAO,OAAO;AAGjB,wBAAgB,QAAQ,CAAC,EAAE,UAAU,MAAM;AACvC,cAAI,UAAU,gBAAgB,UAAU,aAAa,YAAY;AAC7D,sBAAU,aAAa,OAAO;AAAA,UAClC;AAAA,QACJ,CAAC;AAGD,aAAK,QAAQ,KAAK;AAIlB,cAAM,IAAI,QAAQ,aAAW;AACzB,qBAAW,MAAM;AACb,4BAAgB,QAAQ,CAAC,EAAE,WAAW,QAAQ,aAAa,WAAW,MAAM;AACxE,yCAA2B,KAAK,SAAS;AAGzC,oBAAM,kBAAkB,SAAS,cAAc,OAAO;AACtD,8BAAgB,aAAa,OAAO,UAAU,gBAAgB;AAG9D,qBAAO,KAAK,UAAU,EAAE,QAAQ,cAAY;AACxC,oBAAI,aAAa,SAAS,aAAa,iBAAiB;AACpD,kCAAgB,aAAa,UAAU,WAAW,QAAQ,CAAC;AAAA,gBAC/D;AAAA,cACJ,CAAC;AAGD,kBAAI,UAAU,cAAc;AACxB,gCAAgB,aAAa,iBAAiB,UAAU,YAAY;AAAA,cACxE;AAGA,kBAAI,eAAe,YAAY,YAAY;AACvC,uBAAO,aAAa,iBAAiB,WAAW;AAAA,cACpD,OAAO;AACH,uBAAO,YAAY,eAAe;AAAA,cACtC;AAGA,wBAAU,eAAe;AAAA,YAC7B,CAAC;AAED,iBAAK,qBAAqB;AAC1B,oBAAQ;AAAA,UACZ,GAAG,GAAG;AAAA,QACV,CAAC;AAAA,MACL;AAIA,YAAM,oBAAoB,KAAK;AAC/B,YAAM,0BAA0B,kBAAkB,KAAK,QAAM,GAAG,aAAa,eAAe,CAAC;AAE7F,UAAI,yBAAyB;AACzB,cAAM,mBAAmB,CAAC;AAE1B,0BAAkB,QAAQ,CAAC,aAAa;AACpC,gBAAM,cAAc,SAAS,aAAa,eAAe;AACzD,gBAAM,cAAc,SAAS,aAAa,eAAe;AAEzD,cAAI,aAAa;AAEb,kBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,6BAAiB,KAAK;AAAA,cAClB,KAAK;AAAA;AAAA,cACL;AAAA,cACA,SAAS;AAAA,cACT,SAAS;AAAA;AAAA,YACb,CAAC;AAAA,UACL,OAAO;AAEH,kBAAM,OAAO,SAAS,aAAa,MAAM;AACzC,kBAAM,MAAM,SAAS,aAAa,KAAK;AACvC,6BAAiB,KAAK;AAAA,cAClB;AAAA,cACA;AAAA,cACA,SAAS;AAAA,cACT,SAAS;AAAA,YACb,CAAC;AAAA,UACL;AAAA,QACJ,CAAC;AAGD,cAAM,kBAAkB,KAAK,QAAQ,aAAa,KAAK;AACvD,cAAM,WAAW,kBAAkB,KAAK,QAAQ,aAAa,KAAK,IAAI;AACtE,YAAI,iBAAiB;AACjB,eAAK,QAAQ,gBAAgB,KAAK;AAAA,QACtC;AAGA,0BAAkB,QAAQ,cAAY;AAClC,mBAAS,OAAO;AAAA,QACpB,CAAC;AAGD,yBAAiB,QAAQ,gBAAc;AACnC,gBAAM,YAAY,SAAS,cAAc,QAAQ;AACjD,oBAAU,aAAa,OAAO,WAAW,GAAG;AAC5C,cAAI,WAAW,MAAM;AACjB,sBAAU,aAAa,QAAQ,WAAW,IAAI;AAAA,UAClD;AACA,cAAI,WAAW,SAAS;AACpB,sBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,UAC9D;AACA,cAAI,WAAW,SAAS;AACpB,sBAAU,aAAa,iBAAiB,WAAW,OAAO;AAAA,UAC9D;AACA,gBAAM,aAAa,KAAK,QAAQ,cAAc,OAAO;AACrD,cAAI,YAAY;AACZ,iBAAK,QAAQ,aAAa,WAAW,UAAU;AAAA,UACnD,OAAO;AACH,iBAAK,QAAQ,YAAY,SAAS;AAAA,UACtC;AAAA,QACJ,CAAC;AAGD,aAAK,uBAAuB;AAC5B,aAAK,uBAAuB;AAG5B,YAAI,eAAe,KAAK,QAAQ,YAAY,SAAS;AACjD,eAAK,QAAQ,SAAS;AAAA,QAC1B;AAGA,aAAK,QAAQ,KAAK;AAAA,MACtB,OAAO;AAGH,YAAI,eAAe,KAAK,QAAQ,YAAY,SAAS;AACjD,eAAK,QAAQ,SAAS;AAAA,QAC1B;AACA,cAAM,mBAAmB,KAAK,kCAAkC,KAAK;AACrE,aAAK,QAAQ,MAAM;AACnB,aAAK,QAAQ,KAAK;AAAA,MACtB;AAGA,YAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,cAAM,mBAAmB,MAAM;AAC3B,eAAK,QAAQ,oBAAoB,kBAAkB,gBAAgB;AACnE,kBAAQ;AAAA,QACZ;AAEA,YAAI,KAAK,QAAQ,cAAc,GAAG;AAE9B,kBAAQ;AAAA,QACZ,OAAO;AACH,eAAK,QAAQ,iBAAiB,kBAAkB,gBAAgB;AAAA,QACpE;AAAA,MACJ,CAAC;AAGD,UAAI,cAAc,KAAK,YAAY;AAC/B,cAAM,IAAI,QAAQ,CAAC,YAAY;AAC3B,gBAAM,YAAY,MAAM;AACpB,iBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,iBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,oBAAQ;AAAA,UACZ;AAGA,cAAI,KAAK,QAAQ,cAAc,GAAG;AAC9B,oBAAQ;AAAA,UACZ,OAAO;AAEH,iBAAK,QAAQ,iBAAiB,WAAW,WAAW,EAAE,MAAM,KAAK,CAAC;AAClE,iBAAK,QAAQ,iBAAiB,kBAAkB,WAAW,EAAE,MAAM,KAAK,CAAC;AAGzE,uBAAW,MAAM;AACb,mBAAK,QAAQ,oBAAoB,WAAW,SAAS;AACrD,mBAAK,QAAQ,oBAAoB,kBAAkB,SAAS;AAC5D,sBAAQ;AAAA,YACZ,GAAG,GAAI;AAAA,UACX;AAAA,QACJ,CAAC;AAAA,MACL;AAGA,UAAI,WAAW;AACf,UAAI,sBAAsB,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,GAAG;AAEpF,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAGrD,cAAM,eAAe,KAAK,wBAAwB,oBAAoB,KAAK,eAAe,MAAM;AAChG,YAAI,iBAAiB,MAAM;AACvB,qBAAW;AACX,cAAI,KAAK,QAAQ,OAAO;AACpB,oBAAQ,IAAI,iCAAiC,oBAAW,SAAQ,iBAAQ,IAAG;AAAA,UAC/E;AAAA,QACJ;AAAA,MACJ;AAEA,UAAI,WAAW,GAAG;AACd,aAAK,KAAK,QAAQ;AAElB,cAAM,IAAI,QAAQ,aAAW,WAAW,SAAS,GAAG,CAAC;AAAA,MACzD;AAEA,UAAI,YAAY;AACZ,cAAM,KAAK,KAAK;AAChB,aAAK,kBAAkB;AAAA,MAC3B,OAAO;AAGH,aAAK,MAAM;AACX,YAAI,CAAC,cAAc,aAAa,GAAG;AAC/B,eAAK,kBAAkB;AAAA,QAC3B,OAAO;AACH,eAAK,kBAAkB;AAAA,QAC3B;AAAA,MACJ;AAGI,UAAI,2BAA2B,SAAS,KAAK,KAAK,gBAAgB;AAE9D,cAAM,qBAAqB,KAAK,MAAM;AACtC,YAAI,mBAAmB;AACvB,YAAI,KAAK,eAAe,cAAc;AAClC,gBAAM,oBAAoB,KAAK,eAAe,OAAO,UAAU,OAAK,EAAE,UAAU,KAAK,eAAe,aAAa,KAAK;AACtH,cAAI,qBAAqB,GAAG;AACxB,+BAAmB;AAAA,cACf,UAAU,KAAK,eAAe,OAAO,iBAAiB,EAAE;AAAA,cACxD,MAAM,KAAK,eAAe,OAAO,iBAAiB,EAAE;AAAA,YACxD;AAAA,UACJ;AAAA,QACJ;AAGA,cAAM,eAAe,MAAM;AAEvB,eAAK,eAAe,SAAS,CAAC;AAC9B,eAAK,eAAe,WAAW;AAG/B,cAAI,sBAAsB,oBAAoB,KAAK,eAAe,OAAO,SAAS,GAAG;AAEjF,kBAAM,qBAAqB,KAAK,eAAe,OAAO;AAAA,cAAU,OAC5D,EAAE,aAAa,iBAAiB,YAAY,EAAE,SAAS,iBAAiB;AAAA,YAC5E;AAEA,gBAAI,sBAAsB,GAAG;AACzB,oBAAM,gBAAgB,KAAK,eAAe,OAAO,kBAAkB;AAEnE,kBAAI,cAAc,MAAM,cAAc,GAAG;AAErC,qBAAK,eAAe,OAAO,kBAAkB;AAAA,cACjD,OAAO;AAEH,sBAAM,cAAc,MAAM;AACtB,gCAAc,MAAM,oBAAoB,QAAQ,WAAW;AAC3D,gCAAc,MAAM,oBAAoB,SAAS,WAAW;AAC5D,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,aAAa,GAAG;AAC3E,yBAAK,eAAe,OAAO,kBAAkB;AAAA,kBACjD;AAAA,gBACJ;AACA,8BAAc,MAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACxE,8BAAc,MAAM,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AAEzE,8BAAc,MAAM,OAAO;AAE3B,2BAAW,MAAM;AACb,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,aAAa,GAAG;AAC3E,yBAAK,eAAe,OAAO,kBAAkB;AAAA,kBACjD;AAAA,gBACJ,GAAG,GAAI;AAAA,cACX;AAAA,YACJ,WAAW,KAAK,eAAe,OAAO,SAAS,GAAG;AAE9C,oBAAM,aAAa,KAAK,eAAe,OAAO,CAAC;AAC/C,kBAAI,WAAW,MAAM,cAAc,GAAG;AAClC,qBAAK,eAAe,OAAO,CAAC;AAAA,cAChC,OAAO;AACH,sBAAM,cAAc,MAAM;AACtB,6BAAW,MAAM,oBAAoB,QAAQ,WAAW;AACxD,6BAAW,MAAM,oBAAoB,SAAS,WAAW;AACzD,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,UAAU,GAAG;AACxE,yBAAK,eAAe,OAAO,CAAC;AAAA,kBAChC;AAAA,gBACJ;AACA,2BAAW,MAAM,iBAAiB,QAAQ,aAAa,EAAE,MAAM,KAAK,CAAC;AACrE,2BAAW,MAAM,iBAAiB,SAAS,aAAa,EAAE,MAAM,KAAK,CAAC;AACtE,2BAAW,MAAM,OAAO;AACxB,2BAAW,MAAM;AACb,sBAAI,KAAK,kBAAkB,KAAK,eAAe,OAAO,SAAS,UAAU,GAAG;AACxE,yBAAK,eAAe,OAAO,CAAC;AAAA,kBAChC;AAAA,gBACJ,GAAG,GAAI;AAAA,cACX;AAAA,YACJ;AAAA,UACJ;AAAA,QACJ;AAGA,mBAAW,cAAc,GAAG;AAAA,MAChC;AAIA,UAAI,KAAK,qBAAqB,KAAK,kBAAkB,WAAW;AAE5D,aAAK,kBAAkB,MAAM;AACzB,cAAI,KAAK,qBAAqB,KAAK,kBAAkB,oBAAoB;AACrE,iBAAK,kBAAkB,mBAAmB;AAAA,UAC9C;AAAA,QACJ,GAAG,GAAG;AAAA,MACV;AAEJ,UAAI,KAAK,+BAA+B;AACpC;AAAA,MACJ;AAEA,WAAK,MAAM,0BAA0B;AACrC,WAAK,KAAK,0BAA0B;AAAA,IACxC;AAAA,IAEA,MAAM,yBAAyB;AA/vGnC;AAgwGQ,UAAI,KAAK,QAAQ,0CAA0C,CAAC,KAAK,cAAY,gBAAK,oBAAL,mBAAsB,WAAtB,mBAA8B,SAAQ;AAC/G,aAAK,WAAW,KAAK,EAAE,yCAAyC,CAAC;AACjE;AAAA,MACJ;AAIA,UAAI,CAAC,KAAK,YAAY,KAAK,qBAAmB,UAAK,gBAAgB,WAArB,mBAA6B,SAAQ;AAC/E,aAAK,wBAAwB,eAAe,CAAC,KAAK,wBAAwB;AAC1E,aAAK,MAAM,0BAA0B,KAAK,wBAAwB;AAClE,aAAK,KAAK,KAAK,wBAAwB,eAAe,4BAA4B,0BAA0B;AAE5G,aAAK,KAAK;AACV;AAAA,MACJ;AAEA,aAAO,KAAK,wBAAwB,OAAO;AAAA,IAC/C;AAAA;AAAA,IAGA,qBAAqB;AACjB,aAAO,KAAK,oBAAoB,OAAO;AAAA,IAC3C;AAAA;AAAA,IAGA,4BAA4B;AAzxGhC;AA2xGQ,YAAM,qBAAqB,OAAO,KAAK,KAAK,mBAAmB,EAAE,SAAS;AAC1E,YAAM,kBAAkB,CAAC,CAAC,KAAK;AAE/B,UAAI,CAAC,sBAAsB,CAAC,iBAAiB;AACzC,gBAAQ,KAAK,wCAAwC;AACrD;AAAA,MACJ;AAEA,UAAI,KAAK,qBAAqB;AAE1B,aAAK,oBAAoB,MAAM,UAAU;AACzC,aAAK,MAAM,sBAAsB;AACjC,aAAK,KAAK,qBAAqB;AAI/B,aAAK,kBAAkB,MAAM;AACzB,cAAI,KAAK,8BAA8B,SAAS,SAAS,KAAK,0BAA0B,GAAG;AACvF,iBAAK,2BAA2B,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UACjE;AAAA,QACJ,GAAG,GAAG;AACN;AAAA,MACJ;AAGA,UAAI,cAAc;AAClB,UAAI,aAAa;AAEjB,UAAI,oBAAoB;AAEpB,YAAI,KAAK,kBAAkB,KAAK,eAAe,cAAc;AACzD,gBAAM,eAAc,UAAK,eAAe,aAAa,aAAjC,mBAA2C,cAAc,MAAM,KAAK;AACxF,cAAI,eAAe,KAAK,oBAAoB,WAAW,GAAG;AACtD,0BAAc;AACd,yBAAa,KAAK,oBAAoB,WAAW;AAAA,UACrD;AAAA,QACJ;AAGA,YAAI,CAAC,eAAe,KAAK,QAAQ,UAAU;AACvC,gBAAM,aAAa,KAAK,QAAQ,SAAS,YAAY,EAAE,MAAM,GAAG,EAAE,CAAC;AACnE,cAAI,KAAK,oBAAoB,UAAU,GAAG;AACtC,0BAAc;AACd,yBAAa,KAAK,oBAAoB,UAAU;AAAA,UACpD;AAAA,QACJ;AAGA,YAAI,CAAC,aAAa;AACd,wBAAc,OAAO,KAAK,KAAK,mBAAmB,EAAE,CAAC;AACrD,uBAAa,KAAK,oBAAoB,WAAW;AAAA,QACrD;AAEA,aAAK,sBAAsB;AAAA,MAC/B,OAAO;AAEH,qBAAa,KAAK;AAAA,MACtB;AAGA,WAAK,sBAAsB,SAAS,cAAc,KAAK;AACvD,WAAK,oBAAoB,YAAY;AACrC,WAAK,oBAAoB,aAAa,YAAY,GAAG;AACrD,WAAK,oBAAoB,aAAa,cAAc,KAAK,EAAE,+BAA+B,CAAC;AAG3F,WAAK,qBAAqB,SAAS,cAAc,OAAO;AAAA,QACpD,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,YAAY;AAAA,UACR,YAAY;AAAA,QAChB;AAAA,MACJ,CAAC;AAGD,YAAM,aAAa,SAAS,cAAc,OAAO;AAAA,QAC7C,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,MAC1C,CAAC;AAED,YAAM,QAAQ,SAAS,cAAc,MAAM;AAAA,QACvC,aAAa,KAAK,EAAE,0BAA0B;AAAA,MAClD,CAAC;AAGD,YAAM,oBAAoB,KAAK,EAAE,6BAA6B;AAC9D,WAAK,6BAA6B,SAAS,cAAc,UAAU;AAAA,QAC/D,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,UACd,iBAAiB;AAAA,QACrB;AAAA,MACJ,CAAC;AACD,WAAK,2BAA2B,YAAY,kBAAkB,UAAU,CAAC;AACzE,eAAS,cAAc,KAAK,4BAA4B,mBAAmB,KAAK,QAAQ,WAAW;AACnG,WAAK,+BAA+B;AAAA,QAChC,eAAe,CAAC,MAAM;AAClB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,cAAI,KAAK,kCAAkC;AAEvC,kBAAM,gBAAgB,KAAK;AAC3B,iBAAK,qCAAqC;AAC1C,uBAAW,MAAM;AACb,mBAAK,qCAAqC;AAAA,YAC9C,GAAG,GAAG;AAAA,UACV;AACA,cAAI,KAAK,iCAAiC;AACtC,iBAAK,6BAA6B;AAAA,UACtC,OAAO;AACH,iBAAK,6BAA6B;AAAA,UACtC;AAAA,QACJ;AAAA,QACA,iBAAiB,CAAC,MAAM;AAEpB,cAAI,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AAChC,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,mCAAmC;AAAA,UAC5C,WAES,EAAE,QAAQ,OAAO,EAAE,QAAQ,KAAK;AACrC,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,6BAA6B;AAAA,UACtC,WAES,EAAE,QAAQ,YAAY,KAAK,iCAAiC;AACjE,cAAE,eAAe;AACjB,cAAE,gBAAgB;AAClB,iBAAK,6BAA6B;AAAA,UACtC;AAAA,QACJ;AAAA,MACJ;AACA,WAAK,2BAA2B,iBAAiB,SAAS,KAAK,6BAA6B,aAAa;AACzG,WAAK,2BAA2B,iBAAiB,WAAW,KAAK,6BAA6B,eAAe;AAC7G,iBAAW,YAAY,KAAK,0BAA0B;AAGtD,WAAK,uBAAuB;AAC5B,UAAI,oBAAoB;AACpB,cAAM,WAAW,GAAG,YAAK,QAAQ,aAAW,0BAAyB,YAAK,IAAI;AAG9E,cAAM,UAAU,OAAO,KAAK,KAAK,mBAAmB,EAAE,IAAI,eAAa;AAAA,UACnE,OAAO;AAAA,UACP,MAAM,KAAK,qBAAqB,QAAQ;AAAA,UACxC,UAAU,aAAa;AAAA,QAC3B,EAAE;AAEF,cAAM,EAAE,OAAO,mBAAmB,QAAQ,qBAAqB,IAAI,oBAAoB;AAAA,UACnF,aAAa,KAAK,QAAQ;AAAA,UAC1B,YAAY,GAAG,YAAK,QAAQ,aAAW;AAAA,UACvC,aAAa,GAAG,YAAK,QAAQ,aAAW;AAAA,UACxC,WAAW;AAAA,UACX;AAAA,UACA;AAAA,UACA,UAAU,CAAC,MAAM;AACb,cAAE,gBAAgB;AAClB,kBAAM,eAAe,EAAE,OAAO;AAC9B,iBAAK,mBAAmB,YAAY;AAAA,UACxC;AAAA,QACJ,CAAC;AAED,aAAK,uBAAuB;AAG5B,cAAM,8BAA8B,SAAS,cAAc,OAAO;AAAA,UAC9D,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QAC1C,CAAC;AACD,oCAA4B,YAAY,iBAAiB;AACzD,oCAA4B,YAAY,KAAK,oBAAoB;AAGjE,6BAAqB,2BAA2B;AAEhD,mBAAW,YAAY,2BAA2B;AAAA,MACtD;AAEA,iBAAW,YAAY,KAAK;AAG5B,YAAM,iBAAiB,KAAK,EAAE,0BAA0B;AACxD,YAAM,cAAc,SAAS,cAAc,UAAU;AAAA,QACjD,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,YAAY;AAAA,UACR,QAAQ;AAAA,UACR,cAAc;AAAA,QAClB;AAAA,MACJ,CAAC;AACD,kBAAY,YAAY,kBAAkB,OAAO,CAAC;AAClD,eAAS,cAAc,aAAa,gBAAgB,KAAK,QAAQ,WAAW;AAC5E,kBAAY,iBAAiB,SAAS,MAAM;AACxC,aAAK,oBAAoB;AAEzB,YAAI,KAAK,cAAc,KAAK,WAAW,YAAY,KAAK,WAAW,SAAS,cAAc;AACtF,qBAAW,MAAM;AACb,iBAAK,WAAW,SAAS,aAAa,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UACvE,GAAG,CAAC;AAAA,QACR;AAAA,MACJ,CAAC;AAED,WAAK,mBAAmB,YAAY,UAAU;AAC9C,WAAK,mBAAmB,YAAY,WAAW;AAG/C,WAAK,kCAAkC;AACvC,WAAK,2BAA2B;AAChC,WAAK,qCAAqC;AAC1C,WAAK,iCAAiC;AACtC,WAAK,+BAA+B;AACpC,WAAK,+BAA+B;AACpC,WAAK,6BAA6B;AAClC,WAAK,mCAAmC;AACxC,WAAK,wCAAwC;AAG7C,WAAK,oBAAoB,SAAS,cAAc,OAAO;AACvD,WAAK,kBAAkB,YAAY;AACnC,WAAK,kBAAkB,MAAM;AAC7B,WAAK,kBAAkB,aAAa,cAAc,KAAK,EAAE,qBAAqB,CAAC;AAC/E,WAAK,kBAAkB,QAAQ;AAG/B,WAAK,kBAAkB,aAAa,eAAe,EAAE;AAGrD,WAAK,4BAA4B,CAAC,KAAK,KAAK,KAAK,KAAK,MAAM,MAAM,MAAM,IAAI,EAAE,IAAI,SAAO;AACrF,cAAM,SAAS,SAAS,cAAc,OAAO;AAAA,UACzC,WAAW,GAAG,YAAK,QAAQ,aAAW,wBAAuB,YAAK,QAAQ,aAAW,iBAAgB;AAAA,UACrG,YAAY;AAAA,YACR,kBAAkB;AAAA,YAClB,8BAA8B;AAAA,YAC9B,eAAe;AAAA,UACnB;AAAA,QACJ,CAAC;AACD,eAAO,MAAM,UAAU;AACvB,eAAO;AAAA,MACX,CAAC;AAGD,WAAK,oBAAoB,YAAY,KAAK,kBAAkB;AAC5D,WAAK,oBAAoB,YAAY,KAAK,iBAAiB;AAC3D,WAAK,0BAA0B,QAAQ,YAAU,KAAK,oBAAoB,YAAY,MAAM,CAAC;AAG7F,YAAM,QAAQ,KAAK,QAAQ,2BAA2B;AACtD,UAAI,SAAS,MAAM,QAAQ,MAAM,KAAK,OAAO;AACzC,aAAK,oBAAoB,MAAM,QAAQ,MAAM,KAAK;AAAA,MACtD,OAAO;AACH,aAAK,oBAAoB,MAAM,QAAQ;AAAA,MAC3C;AAEA,WAAK,oBAAoB,MAAM,SAAS;AAGxC,WAAK,8BAA8B,KAAK,QAAQ,wBAAwB;AAGxE,WAAK,UAAU,YAAY,KAAK,mBAAmB;AAGnD,4BAAsB,MAAM;AACxB,aAAK,8BAA8B;AAAA,MACvC,CAAC;AAGD,WAAK,kBAAkB,cAAc,KAAK,MAAM;AAChD,UAAI,CAAC,KAAK,MAAM,QAAQ;AACpB,aAAK,kBAAkB,KAAK;AAAA,MAChC;AAGA,WAAK,6BAA6B;AAGlC,WAAK,uBAAuB;AAAA,QACxB,MAAM,MAAM;AACR,cAAI,KAAK,mBAAmB;AACxB,iBAAK,kBAAkB,KAAK;AAAA,UAChC;AAAA,QACJ;AAAA,QACA,OAAO,MAAM;AACT,cAAI,KAAK,mBAAmB;AACxB,iBAAK,kBAAkB,MAAM;AAAA,UACjC;AAAA,QACJ;AAAA,QACA,YAAY,MAAM;AACd,cAAI,KAAK,qBAAqB,KAAK,IAAI,KAAK,kBAAkB,cAAc,KAAK,MAAM,WAAW,IAAI,KAAK;AACvG,iBAAK,kBAAkB,cAAc,KAAK,MAAM;AAAA,UACpD;AAAA,QACJ;AAAA,QACA,YAAY,MAAM;AACd,cAAI,KAAK,mBAAmB;AACxB,iBAAK,kBAAkB,eAAe,KAAK,MAAM;AAAA,UACrD;AAAA,QACJ;AAAA,MACJ;AAGA,WAAK,GAAG,QAAQ,KAAK,qBAAqB,IAAI;AAC9C,WAAK,GAAG,SAAS,KAAK,qBAAqB,KAAK;AAChD,WAAK,GAAG,cAAc,KAAK,qBAAqB,UAAU;AAC1D,WAAK,GAAG,cAAc,KAAK,qBAAqB,UAAU;AAG1D,UAAI,oBAAoB;AACpB,aAAK,qBAAqB,gBAAgB,MAAM;AA9kH5D,cAAAC;AA+kHgB,cAAI,KAAK,kBAAkB,KAAK,eAAe,gBAAgB,KAAK,sBAAsB;AACtF,kBAAM,eAAcA,MAAA,KAAK,eAAe,aAAa,aAAjC,gBAAAA,IAA2C,cAAc,MAAM,KAAK;AACxF,gBAAI,eAAe,KAAK,oBAAoB,WAAW,KAAK,KAAK,wBAAwB,aAAa;AAClG,mBAAK,mBAAmB,WAAW;AAEnC,mBAAK,qBAAqB,QAAQ;AAAA,YACtC;AAAA,UACJ;AAAA,QACJ;AAEA,aAAK,GAAG,mBAAmB,KAAK,qBAAqB,aAAa;AAAA,MACtE;AAEA,WAAK,MAAM,sBAAsB;AACjC,WAAK,KAAK,qBAAqB;AAI/B,WAAK,kBAAkB,MAAM;AACzB,YAAI,KAAK,8BAA8B,SAAS,SAAS,KAAK,0BAA0B,GAAG;AACvF,eAAK,2BAA2B,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QACjE;AAAA,MACJ,GAAG,GAAG;AAAA,IACV;AAAA,IAEA,sBAAsB;AAClB,aAAO,KAAK,oBAAoB,QAAQ;AAAA,IAC5C;AAAA,IAEA,qBAAqB;AA5mHzB;AA6mHQ,UAAI,KAAK,QAAQ,0CAA0C,CAAC,KAAK,cAAY,gBAAK,oBAAL,mBAAsB,WAAtB,mBAA8B,SAAQ;AAC/G,aAAK,WAAW,KAAK,EAAE,qCAAqC,CAAC;AAC7D;AAAA,MACJ;AAIA,UAAI,CAAC,KAAK,YAAY,KAAK,qBAAmB,UAAK,gBAAgB,WAArB,mBAA6B,SAAQ;AAC/E,cAAM,aAAa,KAAK,oBAAoB;AAC5C,cAAM,SAAS,KAAK,oBAAoB,OAAO;AAC/C,YAAI,CAAC,cAAc,KAAK,oBAAoB,SAAS;AACjD,eAAK,KAAK;AAAA,QACd;AACA,eAAO;AAAA,MACX;AAEA,aAAO,KAAK,oBAAoB,OAAO;AAAA,IAC3C;AAAA,IAEA,+BAA+B;AAC3B,aAAO,KAAK,oBAAoB,kBAAkB;AAAA,IACtD;AAAA;AAAA,IAGA,sCAAsC;AAClC,UAAI,CAAC,KAAK,oBAAqB;AAG/B,YAAMC,YAAW,OAAO,aAAa;AACrC,YAAM,eAAe,KAAK,MAAM;AAIhC,UAAIA,aAAY,CAAC,cAAc;AAE3B,YAAI,KAAK,uBAAuB;AAC5B,eAAK,sBAAsB,QAAQ;AACnC,eAAK,wBAAwB;AAAA,QACjC;AACA;AAAA,MACJ;AAGA,UAAI,KAAK,uBAAuB;AAC5B;AAAA,MACJ;AAIA,WAAK,wBAAwB,IAAI,mBAAmB,KAAK,qBAAqB;AAAA,QAC1E,YAAY,KAAK;AAAA,QACjB,eAAe,KAAK;AAAA,QACpB,qBAAqB;AAAA,QACrB,qBAAqB;AAAA,QACrB,UAAU;AAAA,QACV,WAAW;AAAA,QACX,aAAa,GAAG,YAAK,QAAQ,aAAW;AAAA,QACxC,iBAAiB;AAAA,QACjB,mBAAmB;AAAA,QACnB,cAAc;AAAA,QACd,mBAAmB;AAAA,QACnB,4BAA4B,KAAK,EAAE,iCAAiC;AAAA,QACpE,uBAAuB,CAAC,YAAY;AAEhC,eAAK,0BAA0B,QAAQ,YAAU;AAC7C,mBAAO,MAAM,UAAU,UAAU,UAAU;AAAA,UAC/C,CAAC;AAAA,QACL;AAAA,QACA,aAAa,CAAC,MAAM;AAEhB,cAAI,EAAE,OAAO,QAAQ,IAAI,YAAK,QAAQ,aAAW,uBAAsB,KACnE,EAAE,OAAO,QAAQ,IAAI,YAAK,QAAQ,aAAW,0BAAyB,KACtE,EAAE,OAAO,QAAQ,IAAI,YAAK,QAAQ,aAAW,wBAAuB,KACpE,EAAE,OAAO,QAAQ,IAAI,YAAK,QAAQ,aAAW,uBAAsB,KACnE,EAAE,OAAO,QAAQ,IAAI,YAAK,QAAQ,aAAW,+BAA8B,GAAG;AAC9E,mBAAO;AAAA,UACX;AACA,iBAAO;AAAA,QACX;AAAA,MACJ,CAAC;AAGD,WAAK,+BAA+B,CAAC,MAAM;AACvC,cAAM,MAAM,EAAE,IAAI,YAAY;AAG9B,YAAI,KAAK,iCAAiC;AACtC;AAAA,QACJ;AAEA,YAAI,QAAQ,QAAQ;AAChB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,cAAI,KAAK,uBAAuB;AAC5B,gBAAI,KAAK,sBAAsB,mBAAmB;AAC9C,mBAAK,sBAAsB,yBAAyB;AAAA,YACxD;AACA,iBAAK,sBAAsB,qBAAqB;AAChD,iBAAK,8BAA8B;AAAA,UACvC;AACA;AAAA,QACJ;AAEA,YAAI,QAAQ,KAAK;AACb,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB,gBAAM,UAAU,KAAK,6BAA6B;AAClD,cAAI,SAAS;AACT,iBAAK,oBAAoB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UAC1D;AACA;AAAA,QACJ;AAEA,YAAI,QAAQ,UAAU;AAClB,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,cAAI,KAAK,yBAAyB,KAAK,sBAAsB,mBAAmB;AAC5E,iBAAK,sBAAsB,yBAAyB;AACpD;AAAA,UACJ;AAEA,cAAI,KAAK,yBAAyB,KAAK,sBAAsB,kBAAkB;AAC3E,iBAAK,sBAAsB,wBAAwB;AACnD;AAAA,UACJ;AAEA,eAAK,oBAAoB;AAEzB,cAAI,KAAK,cAAc,KAAK,WAAW,YAAY,KAAK,WAAW,SAAS,cAAc;AACtF,uBAAW,MAAM;AACb,mBAAK,WAAW,SAAS,aAAa,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YACvE,GAAG,CAAC;AAAA,UACR;AACA;AAAA,QACJ;AAAA,MACJ;AAEA,WAAK,oBAAoB,iBAAiB,WAAW,KAAK,4BAA4B;AAGtF,WAAK,kCAAkC;AAAA,QACnC,WAAW,KAAK;AAAA,QAChB,kBAAkB,KAAK;AAAA,QACvB,kBAAkB,KAAK;AAAA,MAC3B;AAAA,IACJ;AAAA,IAEA,qCAAqC;AACjC,UAAI,KAAK,uBAAuB;AAC5B,cAAM,aAAa,KAAK,sBAAsB;AAC9C,aAAK,sBAAsB,uBAAuB;AAClD,cAAM,YAAY,KAAK,sBAAsB;AAC7C,YAAI,CAAC,cAAc,WAAW;AAC1B,eAAK,2BAA2B;AAAA,QACpC;AAEA,aAAK,kCAAkC;AAAA,MAC3C;AAAA,IACJ;AAAA,IAEA,6BAA6B;AAEzB,WAAK,oBAAoB,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,kBAAiB;AAGnF,WAAK,oCAAoC;AAGzC,iBAAW,MAAM;AACb,aAAK,oBAAoB,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,kBAAiB;AAAA,MAC1F,GAAG,GAAI;AAAA,IACX;AAAA,IAEA,6BAA6B,EAAE,QAAQ,KAAK,IAAI,CAAC,GAAG;AAChD,UAAI,CAAC,KAAK,uBAAuB;AAC7B,eAAO;AAAA,MACX;AAEA,UAAI,KAAK,sBAAsB,mBAAmB;AAC9C,aAAK,sBAAsB,yBAAyB,EAAE,MAAM,CAAC;AAC7D,aAAK,oCAAoC;AACzC,eAAO;AAAA,MACX;AAEA,WAAK,sBAAsB,wBAAwB,EAAE,MAAM,CAAC;AAC5D,WAAK,oCAAoC;AACzC,aAAO;AAAA,IACX;AAAA,IAEA,qBAAqB,UAAU;AAE3B,YAAM,YAAY;AAAA,QACd,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,QACN,MAAM;AAAA,MACV;AACA,aAAO,UAAU,QAAQ,KAAK,SAAS,YAAY;AAAA,IACvD;AAAA,IAEA,mBAAmB,UAAU;AACzB,aAAO,KAAK,oBAAoB,eAAe,QAAQ;AAAA,IAC3D;AAAA;AAAA,IAGA,0BAA0B,UAAU;AAChC,UAAI,CAAC,KAAK,oBAAoB,QAAQ,KAAK,CAAC,KAAK,mBAAmB;AAChE;AAAA,MACJ;AAEA,YAAM,cAAc,KAAK,kBAAkB;AAC3C,YAAM,aAAa,CAAC,KAAK,kBAAkB;AAE3C,WAAK,kBAAkB,MAAM,KAAK,oBAAoB,QAAQ;AAC9D,WAAK,sBAAsB;AAG3B,WAAK,kBAAkB,cAAc;AACrC,UAAI,YAAY;AACZ,aAAK,kBAAkB,KAAK,EAAE,MAAM,MAAM;AAAA,QAE1C,CAAC;AAAA,MACL;AAEA,WAAK,KAAK,+BAA+B,QAAQ;AAAA,IACrD;AAAA,IAEA,+BAA+B;AAC3B,aAAO,KAAK,oBAAoB,iBAAiB;AAAA,IACrD;AAAA;AAAA,IAGA,sCAAsC;AAElC,WAAK,qCAAqC;AAC1C,iBAAW,MAAM;AACb,aAAK,qCAAqC;AAAA,MAC9C,GAAG,GAAG;AAGN,UAAI,CAAC,KAAK,uCAAuC;AAC7C,aAAK,mCAAmC,CAAC,MAAM;AAE3C,cAAI,KAAK,oCAAoC;AACzC;AAAA,UACJ;AAGA,cAAI,KAAK,+BACJ,KAAK,+BAA+B,EAAE,UAAU,KAAK,2BAA2B,SAAS,EAAE,MAAM,IAAI;AACtG;AAAA,UACJ;AAGA,cAAI,KAAK,4BAA4B,KAAK,yBAAyB,SAAS,EAAE,MAAM,GAAG;AACnF;AAAA,UACJ;AAGA,cAAI,KAAK,iCAAiC;AACtC,iBAAK,6BAA6B;AAAA,UACtC;AAAA,QACJ;AACA,mBAAW,MAAM;AACb,mBAAS,iBAAiB,aAAa,KAAK,kCAAkC,IAAI;AAClF,eAAK,wCAAwC;AAAA,QACjD,GAAG,GAAG;AAAA,MACV;AAEA,UAAI,KAAK,0BAA0B;AAC/B,aAAK,yBAAyB,MAAM,UAAU;AAC9C,aAAK,kCAAkC;AACvC,YAAI,KAAK,4BAA4B;AACjC,eAAK,2BAA2B,aAAa,iBAAiB,MAAM;AAAA,QACxE;AAEA,aAAK,qCAAqC;AAAA,UACtC,KAAK;AAAA,UACL,KAAK;AAAA,UACL,IAAI,YAAK,QAAQ,aAAW;AAAA,UAC5B,MAAM,KAAK,6BAA6B,EAAE,aAAa,KAAK,CAAC;AAAA,QACjE;AAEA,aAAK,iCAAiC;AACtC,aAAK,kCAAkC;AACvC,aAAK,oCAAoC;AACzC,2BAAmB,KAAK,0BAA0B,IAAI,YAAK,QAAQ,aAAW,+BAA8B;AAC5G;AAAA,MACJ;AAGA,WAAK,2BAA2B,SAAS,cAAc,OAAO;AAAA,QAC1D,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,YAAY;AAAA,UACR,QAAQ;AAAA,QACZ;AAAA,MACJ,CAAC;AAGD,YAAM,qBAAqB,eAAe;AAAA,QACtC,aAAa,KAAK,QAAQ;AAAA,QAC1B,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,SAAS,MAAM;AACX,eAAK,mCAAmC;AACxC,eAAK,6BAA6B;AAAA,QACtC;AAAA,MACJ,CAAC;AACD,yBAAmB,aAAa,QAAQ,QAAQ;AAChD,yBAAmB,aAAa,gBAAgB,OAAO;AAEvD,YAAM,cAAc,mBAAmB,cAAc,IAAI,YAAK,QAAQ,aAAW,WAAU;AAC3F,UAAI,YAAa,aAAY,OAAO;AACpC,YAAM,iBAAiB,mBAAmB,cAAc,IAAI,YAAK,QAAQ,aAAW,eAAc;AAClG,UAAI,eAAgB,gBAAe,OAAO;AAC1C,WAAK,+BAA+B;AACpC,WAAK,6BAA6B,mBAAmB,cAAc,IAAI,YAAK,QAAQ,aAAW,iBAAgB;AAC/G,WAAK,kCAAkC;AAGvC,YAAM,eAAe,eAAe;AAAA,QAChC,aAAa,KAAK,QAAQ;AAAA,QAC1B,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,cAAc;AAAA,QACd,SAAS,CAAC,UAAU;AAChB,gBAAM,eAAe;AACrB,gBAAM,gBAAgB;AAEtB,gBAAM,UAAU,KAAK,6BAA6B,EAAE,OAAO,MAAM,CAAC;AAElE,cAAI,SAAS;AACT,iBAAK,6BAA6B,EAAE,aAAa,MAAM,CAAC;AAExD,uBAAW,MAAM;AACb,kBAAI,KAAK,qBAAqB;AAC1B,qBAAK,oBAAoB,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,cAC1D;AAAA,YACJ,GAAG,EAAE;AAAA,UACT,OAAO;AACH,iBAAK,6BAA6B,EAAE,aAAa,KAAK,CAAC;AAAA,UAC3D;AAAA,QACJ;AAAA,MACJ,CAAC;AACD,mBAAa,aAAa,QAAQ,QAAQ;AAC1C,mBAAa,aAAa,gBAAgB,OAAO;AAEjD,YAAM,gBAAgB,aAAa,cAAc,IAAI,YAAK,QAAQ,aAAW,WAAU;AACvF,UAAI,cAAe,eAAc,OAAO;AACxC,YAAM,mBAAmB,aAAa,cAAc,IAAI,YAAK,QAAQ,aAAW,eAAc;AAC9F,UAAI,iBAAkB,kBAAiB,OAAO;AAC9C,WAAK,iCAAiC;AACtC,WAAK,+BAA+B,aAAa,cAAc,IAAI,YAAK,QAAQ,aAAW,iBAAgB;AAC3G,WAAK,oCAAoC;AAGzC,YAAM,cAAc,eAAe;AAAA,QAC/B,aAAa,KAAK,QAAQ;AAAA,QAC1B,WAAW,GAAG,YAAK,QAAQ,aAAW;AAAA,QACtC,MAAM;AAAA,QACN,OAAO;AAAA,QACP,SAAS,MAAM;AACX,eAAK,6BAA6B;AAAA,QACtC;AAAA,MACJ,CAAC;AAED,YAAM,eAAe,YAAY,cAAc,IAAI,YAAK,QAAQ,aAAW,WAAU;AACrF,UAAI,aAAc,cAAa,OAAO;AACtC,YAAM,kBAAkB,YAAY,cAAc,IAAI,YAAK,QAAQ,aAAW,eAAc;AAC5F,UAAI,gBAAiB,iBAAgB,OAAO;AAE5C,WAAK,yBAAyB,YAAY,kBAAkB;AAC5D,WAAK,yBAAyB,YAAY,YAAY;AACtD,WAAK,yBAAyB,YAAY,WAAW;AAIrD,WAAK,yBAAyB,MAAM,aAAa;AACjD,WAAK,yBAAyB,MAAM,UAAU;AAG9C,UAAI,KAAK,8BAA8B,KAAK,2BAA2B,YAAY;AAC/E,aAAK,2BAA2B,sBAAsB,YAAY,KAAK,wBAAwB;AAAA,MACnG,WAAW,KAAK,qBAAqB;AAEjC,aAAK,oBAAoB,YAAY,KAAK,wBAAwB;AAAA,MACtE;AAGA,WAAK,0CAA0C;AAG/C,4BAAsB,MAAM;AACxB,YAAI,KAAK,0BAA0B;AAC/B,eAAK,yBAAyB,MAAM,aAAa;AAAA,QACrD;AAAA,MACJ,CAAC;AAGD,WAAK,qCAAqC;AAAA,QACtC,KAAK;AAAA,QACL,KAAK;AAAA,QACL,IAAI,YAAK,QAAQ,aAAW;AAAA,QAC5B,MAAM,KAAK,6BAA6B,EAAE,aAAa,KAAK,CAAC;AAAA,MACjE;AAGA,WAAK,kCAAkC;AAIvC,UAAI,KAAK,4BAA4B;AACjC,aAAK,2BAA2B,aAAa,iBAAiB,MAAM;AAAA,MACxE;AACA,WAAK,kCAAkC;AACvC,WAAK,oCAAoC;AAGzC,yBAAmB,KAAK,0BAA0B,IAAI,YAAK,QAAQ,aAAW,+BAA8B;AAAA,IAChH;AAAA,IAEA,6BAA6B,EAAE,cAAc,KAAK,IAAI,CAAC,GAAG;AACtD,aAAO,KAAK,oBAAoB,iBAAiB,EAAE,YAAY,CAAC;AAAA,IACpE;AAAA,IAEA,4CAA4C;AACxC,UAAI,CAAC,KAAK,4BAA4B,CAAC,KAAK,2BAA4B;AAGxE,YAAM,aAAa,KAAK,2BAA2B,sBAAsB;AACzE,YAAM,WAAW,KAAK,yBAAyB,sBAAsB;AACrE,YAAM,gBAAgB,OAAO;AAC7B,YAAM,iBAAiB,OAAO;AAG9B,YAAM,kBAAkB,KAAK,2BAA2B;AACxD,UAAI,CAAC,gBAAiB;AAEtB,YAAM,aAAa,gBAAgB,sBAAsB;AAGzD,YAAM,gBAAgB,WAAW,OAAO,WAAW,QAAQ,IAAI,WAAW;AAC1E,YAAM,eAAe,WAAW,SAAS,WAAW;AACpD,YAAM,YAAY,WAAW,MAAM,WAAW;AAE9C,YAAM,aAAa,WAAW;AAC9B,YAAM,aAAa,iBAAiB,WAAW;AAG/C,UAAI,UAAU,eAAe;AAC7B,UAAI,aAAa;AAGjB,UAAI,aAAa,SAAS,SAAS,MAAM,aAAa,YAAY;AAC9D,kBAAU;AACV,cAAM,eAAe,WAAW,SAAS,WAAW;AACpD,qBAAa,eAAe,YAAY;AACxC,aAAK,yBAAyB,UAAU,IAAI,mBAAmB;AAAA,MACnE,OAAO;AACH,aAAK,yBAAyB,UAAU,OAAO,mBAAmB;AAAA,MACtE;AAGA,UAAI,WAAW,gBAAgB,SAAS,QAAQ;AAChD,UAAI,YAAY;AAChB,UAAI,aAAa;AAEjB,YAAM,mBAAmB,WAAW,OAAO,WAAW,QAAQ,IAAI,SAAS,QAAQ;AACnF,UAAI,mBAAmB,IAAI;AACvB,mBAAW;AACX,qBAAa;AAAA,MACjB,WAAW,mBAAmB,SAAS,QAAQ,gBAAgB,IAAI;AAC/D,mBAAW;AACX,oBAAY;AACZ,qBAAa;AAAA,MACjB,OAAO;AACH,mBAAW;AACX,qBAAa;AAAA,MACjB;AAGA,UAAI,YAAY,MAAM;AAClB,aAAK,yBAAyB,MAAM,MAAM,GAAG,gBAAO;AACpD,aAAK,yBAAyB,MAAM,SAAS;AAAA,MACjD,WAAW,eAAe,MAAM;AAC5B,aAAK,yBAAyB,MAAM,MAAM;AAC1C,aAAK,yBAAyB,MAAM,SAAS,GAAG,mBAAU;AAAA,MAC9D;AAEA,UAAI,aAAa,QAAQ;AACrB,aAAK,yBAAyB,MAAM,OAAO,GAAG,iBAAQ;AACtD,aAAK,yBAAyB,MAAM,QAAQ;AAAA,MAChD,OAAO;AACH,aAAK,yBAAyB,MAAM,OAAO;AAC3C,aAAK,yBAAyB,MAAM,QAAQ,GAAG,kBAAS;AAAA,MAC5D;AAEA,WAAK,yBAAyB,MAAM,YAAY;AAAA,IACpD;AAAA,IAEA,mCAAmC;AAC/B,UAAI,CAAC,KAAK,4BAA4B,CAAC,KAAK,8BAA8B,CAAC,KAAK,oBAAqB;AAGrG,4BAAsB,MAAM;AACxB,mBAAW,MAAM;AACb,eAAK,0CAA0C;AAAA,QACnD,GAAG,EAAE;AAAA,MACT,CAAC;AAAA,IACL;AAAA,IAEA,mDAAmD;AAC/C,UAAI,CAAC,KAAK,yBAA0B;AAGpC,UAAI,KAAK,oCAAoC;AACzC,aAAK,yBAAyB,oBAAoB,WAAW,KAAK,kCAAkC;AAAA,MACxG;AAEA,WAAK,qCAAqC;AAAA,QACtC,KAAK;AAAA,QACL,KAAK;AAAA,QACL,IAAI,YAAK,QAAQ,aAAW;AAAA,QAC5B,MAAM,KAAK,6BAA6B,EAAE,aAAa,KAAK,CAAC;AAAA,MACjE;AAAA,IACJ;AAAA,IAEA,oCAAoC;AAChC,UAAI,CAAC,KAAK,8BAA8B;AACpC;AAAA,MACJ;AAEA,YAAM,YAAY,CAAC,EAAE,KAAK,yBAAyB,KAAK,sBAAsB;AAC9E,YAAM,OAAO,YACP,KAAK,EAAE,4BAA4B,IACnC,KAAK,EAAE,2BAA2B;AACxC,YAAM,YAAY,YACZ,KAAK,EAAE,gCAAgC,IACvC,KAAK,EAAE,+BAA+B;AAE5C,WAAK,6BAA6B,aAAa,gBAAgB,YAAY,SAAS,OAAO;AAC3F,WAAK,6BAA6B,aAAa,cAAc,SAAS;AAEtE,UAAI,KAAK,4BAA4B;AACjC,aAAK,2BAA2B,cAAc;AAAA,MAClD;AAAA,IACJ;AAAA,IAEA,sCAAsC;AAClC,UAAI,CAAC,KAAK,gCAAgC;AACtC;AAAA,MACJ;AAEA,YAAM,YAAY,CAAC,EAAE,KAAK,yBAAyB,KAAK,sBAAsB;AAC9E,YAAM,OAAO,YACP,KAAK,EAAE,8BAA8B,IACrC,KAAK,EAAE,6BAA6B;AAC1C,YAAM,YAAY,YACZ,KAAK,EAAE,kCAAkC,IACzC,KAAK,EAAE,iCAAiC;AAE9C,WAAK,+BAA+B,aAAa,gBAAgB,YAAY,SAAS,OAAO;AAC7F,WAAK,+BAA+B,aAAa,cAAc,SAAS;AAExE,UAAI,KAAK,8BAA8B;AACnC,aAAK,6BAA6B,cAAc;AAAA,MACpD;AAAA,IACJ;AAAA,IAEA,gCAAgC;AAC5B,aAAO,KAAK,oBAAoB,kBAAkB;AAAA,IACtD;AAAA,IAEA,8BAA8B;AAC1B,aAAO,KAAK,oBAAoB,gBAAgB;AAAA,IACpD;AAAA;AAAA,IAGA,uCAAuC;AACnC,UAAI,CAAC,KAAK,uBAAuB,CAAC,KAAK,aAAc;AAGrD,UAAI,KAAK,yBAAyB,KAAK,sBAAsB,oBAAoB;AAC7E;AAAA,MACJ;AAGA,UAAI,CAAC,KAAK,oBAAoB,MAAM,SAAS,KAAK,oBAAoB,MAAM,UAAU,IAAI;AACtF,aAAK,oBAAoB,MAAM,QAAQ;AAAA,MAC3C;AAGA,YAAM,mBAAmB,KAAK,aAAa,sBAAsB;AACjE,YAAM,gBAAgB,KAAK,UAAU,sBAAsB;AAC3D,YAAM,cAAc,KAAK,oBAAoB,sBAAsB;AAGnE,YAAM,mBAAmB,iBAAiB,OAAO,cAAc;AAC/D,YAAM,kBAAkB,iBAAiB,MAAM,cAAc;AAC7D,YAAM,oBAAoB,iBAAiB;AAC3C,YAAM,qBAAqB,iBAAiB;AAG5C,UAAI,eAAe,YAAY,SAAS;AACxC,UAAI,gBAAgB,YAAY,UAAY,MAAM,IAAK;AAEvD,UAAI,MAAM;AACV,YAAM,SAAS;AACf,YAAM,iBAAiB;AAGvB,YAAM,WAAW,KAAK,+BAA+B;AAErD,cAAQ,UAAU;AAAA,QACd,KAAK;AACD,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAC7D;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB;AAC1B,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAC7D;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB;AACxB;AAAA,QACJ,KAAK;AACD,iBAAO,mBAAmB;AAC1B,gBAAM,kBAAkB;AACxB;AAAA,QACJ;AACI,iBAAO,mBAAmB,oBAAoB,eAAe;AAC7D,gBAAM,kBAAkB,qBAAqB,gBAAgB;AAAA,MACrE;AAGA,aAAO,KAAK,IAAI,kBAAkB,KAAK,IAAI,MAAM,mBAAmB,oBAAoB,YAAY,CAAC;AACrG,YAAM,KAAK,IAAI,iBAAiB,KAAK,IAAI,KAAK,kBAAkB,qBAAqB,gBAAgB,cAAc,CAAC;AAGpH,WAAK,oBAAoB,MAAM,OAAO,GAAG,aAAI;AAC7C,WAAK,oBAAoB,MAAM,MAAM,GAAG,YAAG;AAC3C,WAAK,oBAAoB,MAAM,QAAQ;AACvC,WAAK,oBAAoB,MAAM,SAAS;AAExC,WAAK,oBAAoB,UAAU,OAAO,GAAG,MAAM,KAAK,KAAK,oBAAoB,SAAS,EAAE,OAAO,OAAK,EAAE,WAAW,uBAAuB,CAAC,CAAC;AAAA,IAClJ;AAAA,IAEA,qCAAqC;AACjC,UAAI,CAAC,KAAK,oBAAqB;AAG/B,WAAK,QAAQ,4BAA4B;AAAA,QACrC,MAAM;AAAA,UACF,OAAO,KAAK,oBAAoB,MAAM;AAAA;AAAA,QAE1C;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,IAEA,sBAAsB;AAClB,aAAO,KAAK,oBAAoB,QAAQ;AAAA,IAC5C;AAAA;AAAA;AAAA,IAIA,eAAe;AACX,cAAQ,KAAK,mGAAmG;AAAA,IACpH;AAAA,IAEA,eAAe;AAAA,IAEf;AAAA;AAAA,IAGA,iBAAiB;AACb,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,cAAc;AACV,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,YAAY;AACR,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,WAAW;AACP,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,UAAU;AACN,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,UAAU;AACN,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA,IAEA,eAAe;AACX,aAAO,KAAK,MAAM;AAAA,IACtB;AAAA;AAAA,IAGA,YAAY,OAAO;AAGf,UAAI,KAAK,oBAAoB;AACzB,aAAK,IAAI,6CAA6C,OAAO,OAAO;AACpE;AAAA,MACJ;AAEA,WAAK,IAAI,UAAU,OAAO,OAAO;AACjC,WAAK,KAAK,SAAS,KAAK;AAExB,UAAI,KAAK,QAAQ,SAAS;AACtB,aAAK,QAAQ,QAAQ,KAAK,MAAM,KAAK;AAAA,MACzC;AAAA,IACJ;AAAA;AAAA,IAGA,OAAO,UAAU;AACb,UAAI,CAAC,KAAK,QAAQ,OAAO;AACrB;AAAA,MACJ;AAEA,UAAI,OAAO;AACX,UAAI,SAAS,SAAS,GAAG;AACrB,cAAM,gBAAgB,SAAS,SAAS,SAAS,CAAC;AAClD,YAAI,OAAO,kBAAkB,YAAY,QAAQ,aAAa,GAAG;AAC7D,iBAAO;AACP,qBAAW,SAAS,MAAM,GAAG,EAAE;AAAA,QACnC;AAAA,MACJ;AAEA,UAAI,SAAS,WAAW,GAAG;AACvB,mBAAW,CAAC,EAAE;AAAA,MAClB;AAEA,UAAI,OAAO,QAAQ,IAAI,MAAM,YAAY;AACrC,gBAAQ,IAAI,EAAE,YAAY,GAAG,QAAQ;AAAA,MACzC,OAAO;AACH,gBAAQ,IAAI,YAAY,GAAG,QAAQ;AAAA,MACvC;AAAA,IACJ;AAAA;AAAA,IAGA,0BAA0B;AAEtB,UAAI,OAAO,mBAAmB,aAAa;AACvC,aAAK,iBAAiB,IAAI,eAAe,CAAC,YAAY;AAClD,qBAAW,SAAS,SAAS;AACzB,kBAAM,QAAQ,MAAM,YAAY;AAGhC,gBAAI,KAAK,cAAc,OAAO,KAAK,WAAW,8BAA8B,YAAY;AACpF,mBAAK,WAAW,0BAA0B,KAAK;AAAA,YACnD;AAGA,gBAAI,KAAK,qBAAqB,KAAK,kBAAkB,WAAW;AAC5D,mBAAK,kBAAkB,mBAAmB;AAAA,YAC9C;AAAA,UACJ;AAAA,QACJ,CAAC;AAED,aAAK,eAAe,QAAQ,KAAK,SAAS;AAAA,MAC9C,OAAO;AAEH,aAAK,gBAAgB,MAAM;AACvB,gBAAM,QAAQ,KAAK,UAAU;AAE7B,cAAI,KAAK,cAAc,OAAO,KAAK,WAAW,8BAA8B,YAAY;AACpF,iBAAK,WAAW,0BAA0B,KAAK;AAAA,UACnD;AAEA,cAAI,KAAK,qBAAqB,KAAK,kBAAkB,WAAW;AAE5D,gBAAI,CAAC,KAAK,kBAAkB,sBAAsB,CAAC,KAAK,kBAAkB,mBAAmB,oBAAoB;AAC7G,mBAAK,kBAAkB,mBAAmB;AAAA,YAC9C;AAAA,UACJ;AAAA,QACJ;AAEA,eAAO,iBAAiB,UAAU,KAAK,aAAa;AAAA,MACxD;AAGA,UAAI,OAAO,YAAY;AACnB,aAAK,qBAAqB,CAAC,MAAM;AAE7B,qBAAW,MAAM;AACb,gBAAI,KAAK,qBAAqB,KAAK,kBAAkB,WAAW;AAE5D,kBAAI,CAAC,KAAK,kBAAkB,sBAAsB,CAAC,KAAK,kBAAkB,mBAAmB,oBAAoB;AAC7G,qBAAK,kBAAkB,mBAAmB;AAAA,cAC9C;AAAA,YACJ;AAAA,UACJ,GAAG,GAAG;AAAA,QACV;AAEA,cAAM,mBAAmB,OAAO,WAAW,yBAAyB;AACpE,YAAI,iBAAiB,kBAAkB;AACnC,2BAAiB,iBAAiB,UAAU,KAAK,kBAAkB;AAAA,QACvE,WAAW,iBAAiB,aAAa;AAErC,2BAAiB,YAAY,KAAK,kBAAkB;AAAA,QACxD;AAEA,aAAK,mBAAmB;AAAA,MAC5B;AAGA,WAAK,0BAA0B,MAAM;AACjC,cAAM,eAAe,CAAC,EAClB,SAAS,qBACT,SAAS,2BACT,SAAS,wBACT,SAAS;AAIb,YAAI,KAAK,MAAM,eAAe,cAAc;AACxC,eAAK,MAAM,aAAa;AAExB,cAAI,cAAc;AACd,iBAAK,UAAU,UAAU,IAAI,GAAG,YAAK,QAAQ,aAAW,cAAa;AAErE,qBAAS,KAAK,UAAU,IAAI,0BAA0B;AAEtD,iBAAK,qBAAqB;AAAA,UAC9B,OAAO;AACH,iBAAK,UAAU,UAAU,OAAO,GAAG,YAAK,QAAQ,aAAW,cAAa;AAExE,qBAAS,KAAK,UAAU,OAAO,0BAA0B;AAEzD,iBAAK,gCAAgC;AAErC,iBAAK,yBAAyB;AAAA,UAClC;AAEA,eAAK,KAAK,oBAAoB,YAAY;AAG1C,cAAI,KAAK,YAAY;AACjB,iBAAK,WAAW,uBAAuB;AAAA,UAC3C;AAGA,cAAI,KAAK,uBAAuB,KAAK,oBAAoB,MAAM,YAAY,QAAQ;AAG/E,kBAAMA,YAAW,OAAO,aAAa;AACrC,gBAAIA,WAAU;AACV,mBAAK,6BAA6B;AAAA,YACtC;AAIA,iBAAK,kBAAkB,MAAM;AAEzB,oCAAsB,MAAM;AAExB,qBAAK,QAAQ,4BAA4B,EAAE,MAAM,KAAK,CAAC;AACvD,qBAAK,8BAA8B;AAEnC,qBAAK,oBAAoB,MAAM,QAAQ,eAAe,UAAU;AAChE,qBAAK,8BAA8B;AAAA,cACvC,CAAC;AAAA,YACL,GAAG,GAAG;AAAA,UACV;AAAA,QACJ;AAAA,MACJ;AAGA,eAAS,iBAAiB,oBAAoB,KAAK,uBAAuB;AAC1E,eAAS,iBAAiB,0BAA0B,KAAK,uBAAuB;AAChF,eAAS,iBAAiB,uBAAuB,KAAK,uBAAuB;AAC7E,eAAS,iBAAiB,sBAAsB,KAAK,uBAAuB;AAAA,IAChF;AAAA;AAAA,IAGA,UAAU;AACN,WAAK,IAAI,mBAAmB;AAE5B,UAAI,KAAK,UAAU;AACf,aAAK,SAAS,QAAQ;AAAA,MAC1B;AAEA,UAAI,KAAK,YAAY;AACjB,aAAK,WAAW,QAAQ;AAAA,MAC5B;AAEA,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,QAAQ;AAAA,MAChC;AAEA,UAAI,KAAK,iBAAiB;AACtB,aAAK,gBAAgB,QAAQ;AAAA,MACjC;AAEA,UAAI,KAAK,mBAAmB;AACxB,aAAK,kBAAkB,QAAQ;AAAA,MACnC;AAGA,WAAK,oBAAoB;AAGzB,UAAI,KAAK,qBAAqB,KAAK,kBAAkB,YAAY;AAC7D,aAAK,kBAAkB,OAAO;AAC9B,aAAK,oBAAoB;AAAA,MAC7B;AAGA,UAAI,KAAK,gBAAgB;AACrB,aAAK,eAAe,WAAW;AAC/B,aAAK,iBAAiB;AAAA,MAC1B;AAGA,UAAI,KAAK,eAAe;AACpB,eAAO,oBAAoB,UAAU,KAAK,aAAa;AACvD,aAAK,gBAAgB;AAAA,MACzB;AAGA,UAAI,KAAK,oBAAoB,KAAK,oBAAoB;AAClD,YAAI,KAAK,iBAAiB,qBAAqB;AAC3C,eAAK,iBAAiB,oBAAoB,UAAU,KAAK,kBAAkB;AAAA,QAC/E,WAAW,KAAK,iBAAiB,gBAAgB;AAC7C,eAAK,iBAAiB,eAAe,KAAK,kBAAkB;AAAA,QAChE;AACA,aAAK,mBAAmB;AACxB,aAAK,qBAAqB;AAAA,MAC9B;AAGA,UAAI,KAAK,yBAAyB;AAC9B,iBAAS,oBAAoB,oBAAoB,KAAK,uBAAuB;AAC7E,iBAAS,oBAAoB,0BAA0B,KAAK,uBAAuB;AACnF,iBAAS,oBAAoB,uBAAuB,KAAK,uBAAuB;AAChF,iBAAS,oBAAoB,sBAAsB,KAAK,uBAAuB;AAC/E,aAAK,0BAA0B;AAAA,MACnC;AAGA,WAAK,SAAS,QAAQ,eAAa,aAAa,SAAS,CAAC;AAC1D,WAAK,SAAS,MAAM;AAGpB,UAAI,KAAK,0BAA0B;AAC/B,cAAM,aAAa,KAAK;AACxB,cAAM,gBAAgB,WAAW,KAAK,WAAS,MAAM,SAAS,UAAU;AACxE,YAAI,eAAe;AACf,wBAAc,oBAAoB,aAAa,KAAK,wBAAwB;AAAA,QAChF;AACA,aAAK,2BAA2B;AAAA,MACpC;AAEA,UAAI,KAAK,yBAAyB,KAAK,sBAAsB,OAAO,GAAG;AACnE,aAAK,sBAAsB,QAAQ,CAAC,EAAE,QAAQ,QAAQ,MAAM;AACxD,cAAI,UAAU,SAAS;AACnB,mBAAO,oBAAoB,SAAS,OAAO;AAAA,UAC/C;AAAA,QACJ,CAAC;AACD,aAAK,sBAAsB,MAAM;AAAA,MACrC;AAGA,UAAI,KAAK,aAAa,KAAK,UAAU,YAAY;AAC7C,aAAK,UAAU,WAAW,aAAa,KAAK,SAAS,KAAK,SAAS;AACnE,aAAK,UAAU,WAAW,YAAY,KAAK,SAAS;AAAA,MACxD;AAEA,WAAK,mBAAmB;AAAA,IAC5B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,wBAAwB;AACpB,YAAM,gBAAgB,MAAM;AACxB,cAAM,aAAa,KAAK;AACxB,cAAM,gBAAgB,WAAW,KAAK,WAAS,MAAM,SAAS,UAAU;AAExE,YAAI,eAAe;AAGf,cAAI,cAAc,SAAS,YAAY;AACnC,0BAAc,OAAO;AAAA,UACzB;AAGA,cAAI,KAAK,0BAA0B;AAC/B,0BAAc,oBAAoB,aAAa,KAAK,wBAAwB;AAAA,UAChF;AAGA,eAAK,2BAA2B,MAAM;AAClC,kBAAM,aAAa,MAAM,KAAK,cAAc,cAAc,CAAC,CAAC;AAC5D,gBAAI,WAAW,SAAS,GAAG;AAEvB,kBAAI,KAAK,QAAQ,OAAO;AACpB,qBAAK,IAAI,2BAA2B,WAAW,IAAI,QAAM;AAAA,kBACrD,OAAO,EAAE;AAAA,kBACT,KAAK,EAAE;AAAA,kBACP,MAAM,EAAE;AAAA,gBACZ,EAAE,CAAC;AAAA,cACP;AAAA,YACJ;AACA,uBAAW,QAAQ,SAAO;AACtB,mBAAK,kBAAkB,GAAG;AAAA,YAC9B,CAAC;AAAA,UACL;AAEA,wBAAc,iBAAiB,aAAa,KAAK,wBAAwB;AAGzE,cAAI,KAAK,QAAQ,OAAO;AACpB,kBAAM,WAAW,cAAc,OAAO,cAAc,KAAK,SAAS;AAClE,iBAAK,IAAI,6BAA6B,UAAU,gBAAgB;AAAA,UACpE;AAAA,QACJ,WAAW,KAAK,QAAQ,OAAO;AAC3B,eAAK,IAAI,oCAAoC;AAAA,QACjD;AAAA,MACJ;AAGA,oBAAc;AAGd,WAAK,GAAG,kBAAkB,aAAa;AAAA,IAC3C;AAAA,IAEA,0BAA0B,UAAU;AAChC,UAAI,CAAC,UAAU;AACX,eAAO;AAAA,MACX;AACA,YAAM,UAAU,SAAS,KAAK;AAC9B,UAAI,CAAC,SAAS;AACV,eAAO;AAAA,MACX;AACA,UAAI,QAAQ,WAAW,GAAG,KAAK,QAAQ,WAAW,GAAG,KAAK,QAAQ,WAAW,GAAG,GAAG;AAC/E,eAAO;AAAA,MACX;AACA,aAAO,IAAI;AAAA,IACf;AAAA,IAEA,sBAAsB,KAAK,KAAK;AAC5B,UAAI,CAAC,OAAO,CAAC,KAAK;AACd,eAAO;AAAA,MACX;AACA,UAAI,OAAO,UAAU,eAAe,KAAK,KAAK,GAAG,GAAG;AAChD,eAAO,IAAI,GAAG;AAAA,MAClB;AACA,YAAM,cAAc,IAAI,QAAQ,MAAM,EAAE;AACxC,UAAI,OAAO,UAAU,eAAe,KAAK,KAAK,WAAW,GAAG;AACxD,eAAO,IAAI,WAAW;AAAA,MAC1B;AACA,aAAO;AAAA,IACX;AAAA,IAEA,0BAA0B,SAAS,SAAS,CAAC,GAAG;AAC5C,UAAI,CAAC,SAAS;AACV;AAAA,MACJ;AACA,YAAM,gBAAgB,OAAO,iBAAiB;AAC9C,YAAM,kBAAkB,OAAO,mBAAmB;AAElD,YAAM,UAAU,QAAQ,cAAc,aAAa;AACnD,UAAI,WAAW,CAAC,QAAQ,QAAQ,0BAA0B;AACtD,gBAAQ,QAAQ,2BAA2B,QAAQ,YAAY,KAAK;AAAA,MACxE;AAEA,YAAM,YAAY,QAAQ,cAAc,eAAe;AACvD,UAAI,aAAa,CAAC,UAAU,QAAQ,4BAA4B;AAC5D,kBAAU,QAAQ,6BAA6B,UAAU,YAAY,KAAK;AAAA,MAC9E;AAAA,IACJ;AAAA,IAEA,4BAA4B,SAAS,SAAS,CAAC,GAAG;AAC9C,UAAI,CAAC,SAAS;AACV;AAAA,MACJ;AACA,YAAM,gBAAgB,OAAO,iBAAiB;AAC9C,YAAM,kBAAkB,OAAO,mBAAmB;AAElD,YAAM,UAAU,QAAQ,cAAc,aAAa;AACnD,UAAI,WAAW,QAAQ,QAAQ,0BAA0B;AACrD,gBAAQ,cAAc,QAAQ,QAAQ;AAAA,MAC1C;AAEA,YAAM,YAAY,QAAQ,cAAc,eAAe;AACvD,UAAI,aAAa,UAAU,QAAQ,4BAA4B;AAC3D,kBAAU,cAAc,UAAU,QAAQ;AAAA,MAC9C;AAAA,IACJ;AAAA,IAEA,oBAAoB,QAAQ,kBAAkB,MAAM;AAlsJxD;AAmsJQ,UAAI,CAAC,UAAU,WAAW,QAAQ;AAC9B;AAAA,MACJ;AAEA,UAAI,WAAW,WAAW,iBAAiB;AACvC,wBAAgB,MAAM,EAAE,eAAe,KAAK,CAAC;AAC7C;AAAA,MACJ;AAEA,UAAI,WAAW,UAAU;AACrB,YAAI,KAAK,WAAW;AAChB,eAAK,UAAU,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAChD;AACA;AAAA,MACJ;AAEA,UAAI,WAAW,SAAS;AACpB,aAAK,QAAQ,MAAM,EAAE,eAAe,KAAK,CAAC;AAC1C;AAAA,MACJ;AAEA,UAAI,WAAW,cAAc;AACzB,cAAM,cAAa,gBAAK,eAAL,mBAAiB,aAAjB,mBAA2B;AAC9C,YAAI,YAAY;AACZ,qBAAW,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAC5C;AACA;AAAA,MACJ;AAEA,UAAI,OAAO,WAAW,UAAU;AAC5B,cAAM,gBAAgB,SAAS,cAAc,MAAM;AACnD,YAAI,eAAe;AACf,cAAI,cAAc,aAAa,MAAM,CAAC,cAAc,aAAa,UAAU,GAAG;AAC1E,0BAAc,aAAa,YAAY,IAAI;AAAA,UAC/C;AACA,wBAAc,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAC/C;AAAA,MACJ;AAAA,IACJ;AAAA,IAEA,oBAAoB,UAAU,UAAU,CAAC,GAAG;AA3uJhD;AA4uJQ,UAAI,CAAC,UAAU;AACX;AAAA,MACJ;AAEA,YAAM,SAAS,KAAK,sBAAsB,KAAK,QAAQ,gBAAgB,QAAQ,KAAK,CAAC;AACrF,YAAM,UAAU,QAAQ,WAAW,SAAS,cAAc,QAAQ;AAElE,UAAI,CAAC,SAAS;AACV,YAAI,KAAK,QAAQ,OAAO;AACpB,eAAK,IAAI,uCAAuC,QAAQ;AAAA,QAC5D;AACA;AAAA,MACJ;AAEA,UAAI,KAAK,QAAQ,OAAO;AACpB,aAAK,IAAI,6BAA6B,UAAU,EAAE,QAAQ,QAAQ,QAAQ,OAAO,CAAC;AAAA,MACtF;AAEA,WAAK,0BAA0B,SAAS,MAAM;AAE9C,UAAI,CAAC,QAAQ,QAAQ,4BAA4B;AAC7C,gBAAQ,QAAQ,6BAA6B,QAAQ,MAAM,WAAW;AAAA,MAC1E;AAEA,UAAI,CAAC,QAAQ,QAAQ,oBAAoB;AACrC,gBAAQ,QAAQ,qBAAqB,OAAO,WAAW;AAAA,MAC3D;AAEA,YAAM,aAAa,QAAQ,SAAS,SAAY,QAAQ,OAAQ,OAAO,SAAS;AAChF,UAAI,YAAY;AACZ,cAAM,eAAe,OAAO,WAAW,QAAQ,QAAQ,sBAAsB;AAC7E,gBAAQ,MAAM,UAAU;AACxB,gBAAQ,SAAS;AACjB,gBAAQ,gBAAgB,QAAQ;AAChC,gBAAQ,aAAa,eAAe,OAAO;AAC3C,gBAAQ,aAAa,4BAA4B,MAAM;AAAA,MAC3D;AAEA,YAAM,cAAc,OAAO,iBAAiB,SAAS,QAAQ,WAAW;AACxE,UAAI,aAAa;AACb,aAAK,4BAA4B,SAAS,MAAM;AAAA,MACpD;AAEA,YAAM,cAAc,QAAQ,UAAU,SAChC,QAAQ,SACP,YAAO,gBAAP,YAAuB,QAAQ,WAAW;AAEjD,UAAI,cAAc,aAAa;AAC3B,YAAI,QAAQ,aAAa,MAAM,CAAC,QAAQ,aAAa,UAAU,GAAG;AAC9D,kBAAQ,aAAa,YAAY,IAAI;AAAA,QACzC;AACA,gBAAQ,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,MACzC;AAEA,UAAI,cAAc,OAAO,eAAe,SAAS,QAAQ,eAAe,OAAO;AAC3E,gBAAQ,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAAA,MACnE;AAEA,YAAM,mBAAmB,OAAO;AAChC,UAAI,kBAAkB;AAClB,YAAI,iBAAiB;AACrB,YAAI,qBAAqB,QAAQ;AAC7B,2BAAiB;AAAA,QACrB,WAAW,QAAQ,QAAQ,gBAAgB,GAAG;AAC1C,2BAAiB;AAAA,QACrB,OAAO;AACH,2BAAiB,QAAQ,cAAc,gBAAgB,KAAK,SAAS,cAAc,gBAAgB;AAAA,QACvG;AAEA,YAAI,kBAAkB,CAAC,KAAK,sBAAsB,IAAI,QAAQ,GAAG;AAC7D,gBAAM,UAAU,MAAM;AAlzJtC,gBAAAD;AAmzJoB,kBAAM,iBAAiB,OAAO,mBAAmB;AACjD,gBAAI,gBAAgB;AAChB,oBAAM,kBAAkB,QAAQ,QAAQ,8BAA8B;AACtE,sBAAQ,MAAM,UAAU,OAAO,eAAe,mBAAmB;AACjE,sBAAQ,aAAa,eAAe,MAAM;AAC1C,sBAAQ,gBAAgB,0BAA0B;AAAA,YACtD;AAEA,gBAAI,OAAO,WAAW,SAAS,KAAK,MAAM,QAAQ;AAC9C,mBAAK,KAAK;AAAA,YACd;AAEA,kBAAM,cAAc,OAAO,eAAe;AAC1C,iBAAK,kBAAkB,MAAM;AACzB,mBAAK,oBAAoB,aAAa,OAAO;AAAA,YACjD,IAAGA,MAAA,OAAO,eAAP,OAAAA,MAAqB,GAAG;AAAA,UAC/B;AAEA,yBAAe,iBAAiB,SAAS,OAAO;AAChD,eAAK,sBAAsB,IAAI,UAAU,EAAE,QAAQ,gBAAgB,QAAQ,CAAC;AAAA,QAChF;AAAA,MACJ;AAEA,aAAO;AAAA,IACX;AAAA,IAEA,uBAAuB,UAAU;AAC7B,UAAI,CAAC,MAAM,QAAQ,QAAQ,KAAK,SAAS,WAAW,GAAG;AACnD;AAAA,MACJ;AAEA,YAAM,YAAY,KAAK,QAAQ;AAC/B,UAAI,CAAC,WAAW;AACZ;AAAA,MACJ;AAEA,eAAS,QAAQ,SAAO;AACpB,cAAM,SAAS,KAAK,sBAAsB,WAAW,GAAG;AACxD,YAAI,CAAC,QAAQ;AACT;AAAA,QACJ;AAEA,cAAM,WAAW,KAAK,0BAA0B,OAAO,SAAS,OAAO,YAAY,OAAO,MAAM;AAChG,YAAI,CAAC,UAAU;AACX;AAAA,QACJ;AAEA,cAAM,UAAU,SAAS,cAAc,QAAQ;AAC/C,YAAI,CAAC,SAAS;AACV,cAAI,KAAK,QAAQ,OAAO;AACpB,iBAAK,IAAI,wCAAwC,QAAQ;AAAA,UAC7D;AACA;AAAA,QACJ;AAEJ,YAAI,KAAK,QAAQ,OAAO;AACpB,eAAK,IAAI,+BAA+B,KAAK,EAAE,UAAU,OAAO,CAAC;AAAA,QACrE;AAEI,aAAK,0BAA0B,SAAS,MAAM;AAE9C,YAAI,OAAO,OAAO;AACd,gBAAM,gBAAgB,OAAO,iBAAiB;AAC9C,gBAAM,UAAU,QAAQ,cAAc,aAAa;AACnD,cAAI,SAAS;AACT,oBAAQ,cAAc,OAAO;AAAA,UACjC;AAAA,QACJ;AAEA,YAAI,OAAO,SAAS;AAChB,gBAAM,kBAAkB,OAAO,mBAAmB;AAClD,gBAAM,YAAY,QAAQ,cAAc,eAAe;AACvD,cAAI,WAAW;AACX,sBAAU,cAAc,OAAO;AAAA,UACnC;AAAA,QACJ;AAEA,cAAM,OAAO,OAAO,SAAS;AAC7B,cAAM,QAAQ,OAAO,UAAU,SAAY,OAAO,QAAQ;AAE1D,aAAK,oBAAoB,UAAU;AAAA,UAC/B;AAAA,UACA;AAAA,UACA;AAAA,UACA,YAAY,OAAO;AAAA,UACnB,QAAQ;AAAA,QACZ,CAAC;AAAA,MACL,CAAC;AAAA,IACL;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,kBAAkB,KAAK;AACnB,YAAM,OAAO,IAAI,KAAK,KAAK;AAG3B,UAAI,KAAK,QAAQ,OAAO;AACpB,aAAK,IAAI,8BAA8B;AAAA,UACnC,MAAM,IAAI;AAAA,UACV;AAAA,QACJ,CAAC;AAAA,MACL;AAGA,WAAK,KAAK,YAAY;AAAA,QAClB,MAAM,IAAI;AAAA,QACV,SAAS,IAAI;AAAA,QACb;AAAA,QACA;AAAA,MACJ,CAAC;AAGD,UAAI,KAAK,SAAS,OAAO,GAAG;AAExB,YAAI,CAAC,KAAK,MAAM,QAAQ;AACpB,cAAI,KAAK,QAAQ,OAAO;AACpB,iBAAK,IAAI,+BAA+B,IAAI,SAAS;AAAA,UACzD;AACA,eAAK,MAAM;AAAA,QACf;AAEA,aAAK,KAAK,kBAAkB,EAAE,MAAM,IAAI,WAAW,KAAW,CAAC;AAAA,MACnE;AAGA,YAAM,aAAa,KAAK,MAAM,iBAAiB;AAC/C,UAAI,YAAY;AACZ,cAAM,iBAAiB,WAAW,CAAC;AACnC,cAAM,qBAAqB,KAAK,0BAA0B,cAAc;AAExE,cAAM,gBAAgB,qBAAqB,SAAS,cAAc,kBAAkB,IAAI;AACxF,YAAI,eAAe;AACf,cAAI,KAAK,QAAQ,OAAO;AACpB,iBAAK,IAAI,gCAAgC,kBAAkB;AAAA,UAC/D;AAEA,cAAI,cAAc,aAAa,MAAM,CAAC,cAAc,aAAa,UAAU,GAAG;AAC1E,0BAAc,aAAa,YAAY,IAAI;AAAA,UAC/C;AAEA,eAAK,kBAAkB,MAAM;AACzB,0BAAc,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,UAC/C,GAAG,EAAE;AAAA,QACT,WAAW,KAAK,QAAQ,OAAO;AAC3B,eAAK,IAAI,iCAAiC,sBAAsB,cAAc;AAAA,QAClF;AAEA,aAAK,KAAK,kBAAkB;AAAA,UACxB,MAAM,IAAI;AAAA,UACV,QAAQ;AAAA,UACR,UAAU;AAAA,UACV,SAAS;AAAA,UACT;AAAA,QACJ,CAAC;AAED,YAAI,oBAAoB;AACpB,eAAK,oBAAoB,oBAAoB;AAAA,YACzC,SAAS;AAAA,YACT,QAAQ;AAAA,UACZ,CAAC;AAAA,QACL;AAAA,MACJ;AAGA,YAAM,WAAW,KAAK,MAAM,UAAU;AACtC,UAAI,UAAU;AACV,YAAI,KAAK,QAAQ,OAAO;AACpB,eAAK,IAAI,8BAA8B,QAAQ;AAAA,QACnD;AACA,aAAK,KAAK,qBAAqB;AAAA,UAC3B,MAAM,IAAI;AAAA,UACV;AAAA,UACA;AAAA,QACJ,CAAC;AAED,aAAK,uBAAuB,QAAQ;AAAA,MACxC;AAAA,IACJ;AAAA,EACJ;AAGA,SAAO,YAAY,CAAC;;;AQr+JpB;AACA;AACA;AACA;AAGA,MAAI,0BAA0B;AAEvB,MAAM,kBAAN,MAAsB;AAAA,IAC3B,YAAY,QAAQ,UAAU,CAAC,GAAG;AAChC,WAAK,SAAS;AACd,WAAK,SAAS,CAAC;AACf,WAAK,gBAAgB,MAAM,QAAQ,QAAQ,MAAM,IAAI,QAAQ,SAAS,CAAC;AACvE,WAAK,eAAe;AAGpB,WAAK,aAAa,EAAE;AACpB,WAAK,WAAW,mBAAmB,YAAK;AAGxC,WAAK,UAAU;AAAA,QACb,aAAa,QAAQ,gBAAgB;AAAA;AAAA,QACrC,eAAe,QAAQ,kBAAkB;AAAA;AAAA,QACzC,MAAM,QAAQ,QAAQ;AAAA,QACtB,WAAW,QAAQ,cAAc;AAAA;AAAA,QACjC,iBAAiB,QAAQ,mBAAmB;AAAA,SACzC;AAIL,WAAK,YAAY;AACjB,WAAK,gBAAgB;AACrB,WAAK,mBAAmB;AACxB,WAAK,qBAAqB;AAC1B,WAAK,iBAAiB,KAAK,QAAQ,cAAc;AAGjD,WAAK,kBAAkB;AAGvB,WAAK,cAAc,QAAQ,eAAe;AAC1C,WAAK,cAAc,QAAQ,eAAe;AAG1C,WAAK,iBAAiB,KAAK,eAAe,KAAK,IAAI;AACnD,WAAK,mBAAmB,KAAK,iBAAiB,KAAK,IAAI;AAGvD,WAAK,OAAO,kBAAkB;AAG9B,WAAK,KAAK;AAGV,WAAK,qBAAqB;AAG1B,UAAI,KAAK,cAAc,SAAS,GAAG;AACjC,aAAK,aAAa,KAAK,aAAa;AAAA,MACtC;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,kBAAkB,OAAO;AACvB,YAAM,MAAM,MAAM,OAAO;AAEzB,UAAI,IAAI,SAAS,aAAa,KAAK,IAAI,SAAS,UAAU,GAAG;AAC3D,eAAO;AAAA,MACT;AACA,UAAI,IAAI,SAAS,WAAW,GAAG;AAC7B,eAAO;AAAA,MACT;AACA,UAAI,IAAI,SAAS,gBAAgB,KAAK,IAAI,SAAS,oBAAoB,GAAG;AACxE,eAAO;AAAA,MACT;AACA,UAAI,IAAI,SAAS,OAAO,GAAG;AACzB,eAAO;AAAA,MACT;AACA,UAAI,MAAM,QAAQ,MAAM,KAAK,WAAW,QAAQ,GAAG;AACjD,eAAO;AAAA,MACT;AAEA,aAAO;AAAA,IACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,MAAM,uBAAuB,OAAO,WAAW,OAAO;AAnGxD;AAoGI,UAAI,CAAC,KAAK,eAAe,CAAC,KAAK,aAAa;AAC1C,gBAAQ,KAAK,8EAA8E;AAC3F,eAAO;AAAA,MACT;AAEA,YAAM,YAAY,KAAK,kBAAkB,KAAK;AAG9C,YAAM,cAAe,cAAc,UAAW,UAAU;AAGxD,YAAM,aAAa,KAAK;AACxB,YAAM,cAAc,CAAC,GAAG,KAAK,MAAM;AACnC,YAAM,aAAa,KAAK;AAIxB,UAAI,KAAK,uBAAuB,KAAK,oBAAoB,YAAY;AACnE,aAAK,oBAAoB,WAAW,YAAY,KAAK,mBAAmB;AAAA,MAC1E;AACA,UAAI,KAAK,oBAAoB,KAAK,iBAAiB,YAAY;AAC7D,aAAK,iBAAiB,WAAW,YAAY,KAAK,gBAAgB;AAAA,MACpE;AACA,UAAI,KAAK,sBAAsB,KAAK,mBAAmB,YAAY;AACjE,aAAK,mBAAmB,WAAW,YAAY,KAAK,kBAAkB;AAAA,MACxE;AACA,UAAI,KAAK,iBAAiB,KAAK,cAAc,YAAY;AACvD,aAAK,cAAc,WAAW,YAAY,KAAK,aAAa;AAAA,MAC9D;AAGA,YAAM,2BAAyB,UAAK,WAAL,mBAAa,WAAU,mBAAK,KAAK,OAAO,WAAY,CAAC;AAGpF,UAAI,KAAK,QAAQ;AACf,aAAK,OAAO,IAAI,SAAS,KAAK,cAAc;AAC5C,aAAK,OAAO,IAAI,SAAS,KAAK,gBAAgB;AAC9C,aAAK,OAAO,QAAQ;AAAA,MACtB;AAGA,WAAK,YAAY,YAAY;AAG7B,YAAM,eAAe,SAAS,cAAc,WAAW;AAEvD,YAAM,eAAe,uBAAuB,WAAW;AACvD,mBAAa,aAAa,WAAW,YAAY;AAGjD,UAAI,gBAAgB,WAAW,MAAM,WAChC,cAAc,WAAW,cAAc,QAAQ;AAClD,qBAAa,aAAa,UAAU,MAAM,MAAM;AAAA,MAClD;AAIA,YAAM,qBAAqB,CAAC,WAAW,SAAS,cAAc,KAAK,EAAE,SAAS,SAAS;AAEvF,UAAI,CAAC,oBAAoB;AAEvB,cAAM,SAAS,SAAS,cAAc,QAAQ;AAC9C,eAAO,MAAM,MAAM;AACnB,YAAI,MAAM,MAAM;AACd,iBAAO,OAAO,MAAM;AAAA,QACtB;AACA,qBAAa,YAAY,MAAM;AAG/B,YAAI,MAAM,UAAU,MAAM,OAAO,SAAS,GAAG;AAC3C,gBAAM,OAAO,QAAQ,iBAAe;AAClC,kBAAM,UAAU,SAAS,cAAc,OAAO;AAC9C,oBAAQ,MAAM,YAAY;AAC1B,oBAAQ,OAAO,YAAY,QAAQ;AACnC,oBAAQ,UAAU,YAAY,WAAW;AACzC,oBAAQ,QAAQ,YAAY,SAAS,YAAY;AACjD,gBAAI,YAAY,SAAS;AACvB,sBAAQ,UAAU;AAAA,YACpB;AACA,yBAAa,YAAY,OAAO;AAAA,UAClC,CAAC;AAAA,QACH;AAAA,MACF;AAEA,WAAK,YAAY,YAAY,YAAY;AAIzC,YAAM,gBAAgB;AAAA,QACpB,WAAW;AAAA,QACX,QAAQ,MAAM;AAAA,QACd,qBAAqB,MAAM,uBAAuB;AAAA,QAClD,0BAA0B,MAAM,4BAA4B;AAAA,QAC5D,iBAAiB,MAAM,mBAAmB;AAAA,MAC5C;AAEA,aAAO,OAAO,eAAe,sBAAsB;AAEnD,WAAK,SAAS,IAAI,KAAK,YAAY,cAAc,aAAa;AAG9D,WAAK,OAAO,kBAAkB;AAG9B,YAAM,IAAI,QAAQ,aAAW;AAC3B,aAAK,OAAO,GAAG,SAAS,OAAO;AAAA,MACjC,CAAC;AAGD,WAAK,OAAO,GAAG,SAAS,KAAK,cAAc;AAC3C,WAAK,OAAO,GAAG,SAAS,KAAK,gBAAgB;AAG7C,UAAI,KAAK,OAAO,WAAW;AAEzB,YAAI,KAAK,qBAAqB;AAC5B,gBAAM,eAAe,KAAK,OAAO,UAAU,cAAc,uBAAuB;AAChF,cAAI,cAAc;AAChB,iBAAK,OAAO,UAAU,aAAa,KAAK,qBAAqB,YAAY;AAAA,UAC3E,OAAO;AACL,iBAAK,OAAO,UAAU,YAAY,KAAK,mBAAmB;AAAA,UAC5D;AAAA,QACF;AAEA,YAAI,KAAK,kBAAkB;AACzB,eAAK,OAAO,UAAU,YAAY,KAAK,gBAAgB;AAAA,QACzD;AAEA,YAAI,KAAK,oBAAoB;AAC3B,eAAK,OAAO,UAAU,YAAY,KAAK,kBAAkB;AAAA,QAC3D;AAEA,YAAI,KAAK,eAAe;AACtB,eAAK,OAAO,UAAU,YAAY,KAAK,aAAa;AAAA,QACtD;AAAA,MACF;AAGA,WAAK,YAAY,KAAK,OAAO;AAG7B,WAAK,qBAAqB;AAG1B,WAAK,SAAS;AACd,WAAK,eAAe;AAGpB,WAAK,iBAAiB;AAGtB,WAAK,iBAAiB;AACtB,UAAI,KAAK,eAAe;AACtB,aAAK,cAAc,MAAM,UAAU,aAAa,KAAK;AAAA,MACvD;AAIA,UAAI,oBAAoB;AACtB,aAAK,OAAO,KAAK;AAAA,UACf,KAAK,MAAM;AAAA,UACX,MAAM,MAAM;AAAA,UACZ,QAAQ,MAAM;AAAA,UACd,QAAQ,MAAM,UAAU,CAAC;AAAA,UACzB,qBAAqB,MAAM,uBAAuB;AAAA,UAClD,iBAAiB,MAAM,mBAAmB;AAAA,QAC5C,CAAC;AAAA,MACH,OAAO;AAEL,aAAK,OAAO,KAAK;AAAA,UACf,KAAK,MAAM;AAAA,UACX,MAAM,MAAM;AAAA,UACZ,QAAQ,MAAM;AAAA,UACd,QAAQ,MAAM,UAAU,CAAC;AAAA,UACzB,qBAAqB,MAAM,uBAAuB;AAAA,UAClD,iBAAiB,MAAM,mBAAmB;AAAA,QAC5C,CAAC;AAAA,MACH;AAGA,UAAI,UAAU;AACZ,mBAAW,MAAM;AACf,eAAK,OAAO,KAAK;AAAA,QACnB,GAAG,GAAG;AAAA,MACR;AAEA,aAAO;AAAA,IACT;AAAA,IAEA,OAAO;AAEL,WAAK,OAAO,GAAG,SAAS,KAAK,cAAc;AAC3C,WAAK,OAAO,GAAG,SAAS,KAAK,gBAAgB;AAG7C,WAAK,OAAO,GAAG,QAAQ,KAAK,0BAA0B,KAAK,IAAI,CAAC;AAChE,WAAK,OAAO,GAAG,SAAS,KAAK,0BAA0B,KAAK,IAAI,CAAC;AACjE,WAAK,OAAO,GAAG,SAAS,KAAK,0BAA0B,KAAK,IAAI,CAAC;AAEjE,WAAK,OAAO,GAAG,oBAAoB,KAAK,uBAAuB,KAAK,IAAI,CAAC;AAGzE,WAAK,OAAO,GAAG,2BAA2B,KAAK,6BAA6B,KAAK,IAAI,CAAC;AACtF,WAAK,OAAO,GAAG,4BAA4B,KAAK,6BAA6B,KAAK,IAAI,CAAC;AAGvF,UAAI,KAAK,QAAQ,WAAW;AAC1B,aAAK,SAAS;AAAA,MAChB;AAGA,UAAI,KAAK,OAAO,WAAW,KAAK,KAAK,cAAc,WAAW,GAAG;AAC/D,aAAK,0BAA0B;AAAA,MACjC;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,4BAA4B;AAI1B,UAAI,CAAC,KAAK,OAAO,WAAW,CAAC,KAAK,OAAO,QAAQ,eAAe;AAC9D,gBAAQ,IAAI,0CAA0C;AACtD;AAAA,MACF;AAEA,YAAM,eAAe,KAAK,OAAO,QAAQ;AACzC,YAAM,kBAAkB,aAAa;AACrC,YAAM,kBAAkB,kBAAkB,gBAAgB,gBAAgB;AAE1E,UAAI,CAAC,iBAAiB;AACpB,gBAAQ,IAAI,4CAA4C;AACxD;AAAA,MACF;AAGA,WAAK,0BAA0B,eAAe;AAE9C,YAAM,eAAe,gBAAgB,aAAa,eAAe;AACjE,UAAI,CAAC,cAAc;AACjB,gBAAQ,IAAI,mDAAmD;AAC/D;AAAA,MACF;AAEA,cAAQ,IAAI,4DAA4D;AACxE,UAAI;AACF,cAAM,SAAS,KAAK,MAAM,YAAY;AACtC,YAAI,MAAM,QAAQ,MAAM,KAAK,OAAO,SAAS,GAAG;AAC9C,kBAAQ,IAAI,2BAA2B,cAAO,QAAM,6BAA4B;AAChF,eAAK,aAAa,MAAM;AAAA,QAC1B,OAAO;AACL,kBAAQ,KAAK,iEAAiE;AAAA,QAChF;AAAA,MACF,SAAS,OAAO;AACd,gBAAQ,MAAM,4DAA4D,KAAK;AAAA,MACjF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,0BAA0B,SAAS;AAEjC,YAAM,cAAc,QAAQ,aAAa,4BAA4B;AACrE,UAAI,gBAAgB,MAAM;AACxB,aAAK,QAAQ,cAAc,gBAAgB;AAAA,MAC7C;AAGA,YAAM,gBAAgB,QAAQ,aAAa,+BAA+B;AAC1E,UAAI,kBAAkB,MAAM;AAC1B,aAAK,QAAQ,gBAAgB,kBAAkB;AAAA,MACjD;AAGA,YAAM,OAAO,QAAQ,aAAa,oBAAoB;AACtD,UAAI,SAAS,MAAM;AACjB,aAAK,QAAQ,OAAO,SAAS;AAAA,MAC/B;AAGA,YAAM,YAAY,QAAQ,aAAa,0BAA0B;AACjE,UAAI,cAAc,MAAM;AACtB,aAAK,QAAQ,YAAY,cAAc;AAAA,MACzC;AAEA,cAAQ,IAAI,6CAA6C,KAAK,OAAO;AAAA,IACvE;AAAA;AAAA;AAAA;AAAA,IAKA,uBAAuB;AACrB,UAAI,CAAC,KAAK,OAAO,WAAY;AAE7B,YAAM,aAAa,KAAK,OAAO;AAG/B,iBAAW,QAAQ,YAAY;AAG/B,iBAAW,eAAe;AAG1B,iBAAW,aAAa;AACxB,iBAAW,cAAc;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,aAAa,QAAQ;AACnB,WAAK,SAAS;AACd,WAAK,eAAe;AAGpB,UAAI,KAAK,WAAW;AAClB,aAAK,UAAU,UAAU,IAAI,qBAAqB;AAAA,MACpD;AAGA,UAAI,KAAK,eAAe;AACtB,aAAK,eAAe;AAAA,MACtB;AAGA,UAAI,OAAO,SAAS,GAAG;AACrB,YAAI,KAAK,QAAQ,eAAe;AAC9B,eAAK,KAAK,CAAC;AAAA,QACb,OAAO;AAGL,eAAK,KAAK,UAAU,CAAC,EAAE,MAAM,MAAM;AAAA,UAEnC,CAAC;AAAA,QACH;AAAA,MACF;AAGA,WAAK,qCAAqC;AAAA,IAC5C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IASA,MAAM,UAAU,OAAO;AArczB;AAscI,UAAI,QAAQ,KAAK,SAAS,KAAK,OAAO,QAAQ;AAC5C,gBAAQ,KAAK,wCAAwC,KAAK;AAC1D;AAAA,MACF;AAEA,YAAM,QAAQ,KAAK,OAAO,KAAK;AAI/B,WAAK,YAAY,KAAK;AAGtB,WAAK,kBAAkB;AAGvB,UAAI,KAAK,QAAQ,mBAAmB,KAAK,eAAe,KAAK,aAAa;AACxE,cAAM,mBAAmB,KAAK,SAC3B,KAAK,OAAO,QAAQ,YAAY,UAAU,UAAU,UAAW;AAClE,cAAM,eAAe,KAAK,kBAAkB,KAAK;AACjD,cAAM,iBAAkB,iBAAiB,WAAW,iBAAiB,eAAgB,UAAU;AAG/F,YAAI,qBAAqB,gBAAgB;AACvC,gBAAM,KAAK,uBAAuB,OAAO,KAAK;AAE9C,eAAK,YAAY,KAAK;AAGtB,eAAK,OAAO,KAAK,uBAAuB;AAAA,YACtC;AAAA,YACA,MAAM;AAAA,YACN,OAAO,KAAK,OAAO;AAAA,UACrB,CAAC;AAGD,qBAAW,MAAM;AACf,iBAAK,kBAAkB;AAAA,UACzB,GAAG,GAAG;AACN;AAAA,QACF;AAAA,MACF;AAGA,YAAM,cAAc,KAAK,OAAO,KAAK;AAAA,QACnC,KAAK,MAAM;AAAA,QACX,MAAM,MAAM;AAAA,QACZ,QAAQ,MAAM;AAAA,QACd,QAAQ,MAAM,UAAU,CAAC;AAAA,QACzB,qBAAqB,MAAM,uBAAuB;AAAA,QAClD,iBAAiB,MAAM,mBAAmB;AAAA,QAC1C,qBAAqB,MAAM,uBAAuB,CAAC;AAAA,MACrD,CAAC;AAID,YAAI,gBAAK,WAAL,mBAAa,YAAb,mBAAsB,cAAa,OAAO,KAAK,OAAO,iBAAiB,YAAY;AACrF,gBAAQ,QAAQ,WAAW,EACxB,KAAK,MAAG;AA/fjB,cAAAE,KAAAC;AA+foB,kBAAAA,OAAAD,MAAA,KAAK,WAAL,gBAAAA,IAAa,iBAAb,gBAAAC,IAAA,KAAAD;AAAA,SAA6B,EACxC,MAAM,MAAM;AAAA,QAEb,CAAC;AAAA,MACL;AAGA,WAAK,OAAO,KAAK,uBAAuB;AAAA,QACtC;AAAA,QACA,MAAM;AAAA,QACN,OAAO,KAAK,OAAO;AAAA,MACrB,CAAC;AAGD,iBAAW,MAAM;AACf,aAAK,kBAAkB;AAAA,MACzB,GAAG,GAAG;AAAA,IACR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAUA,YAAY,OAAO;AA1hBrB;AA2hBI,UAAI,QAAQ,KAAK,SAAS,KAAK,OAAO,QAAQ;AAC5C,gBAAQ,KAAK,wCAAwC,KAAK;AAC1D;AAAA,MACF;AAEA,YAAM,QAAQ,KAAK,OAAO,KAAK;AAC/B,WAAK,eAAe;AAKpB,UAAI;AAEF,cAAI,gBAAK,WAAL,mBAAa,YAAb,mBAAsB,aAAY,SAAS;AAC7C,cAAI,MAAM,QAAQ;AAChB,kBAAM,YAAY,OAAO,KAAK,OAAO,sBAAsB,aACvD,KAAK,OAAO,kBAAkB,MAAM,MAAM,IAC1C,MAAM;AACV,iBAAK,OAAO,QAAQ,SAAS;AAC7B,6BAAK,QAAO,2BAAZ,4BAAqC;AAAA,UACvC,OAAO;AACL,iBAAK,OAAO,QAAQ,gBAAgB,QAAQ;AAAA,UAC9C;AAAA,QACF;AAGA,aAAK,OAAO,sBAAsB,MAAM,uBAAuB;AAC/D,aAAK,OAAO,kBAAkB,MAAM,mBAAmB;AACvD,aAAK,OAAO,sBAAsB,MAAM,uBAAuB,CAAC;AAGhE,YAAI,MAAM,YAAY,OAAO,MAAM,QAAQ,IAAI,GAAG;AAChD,eAAK,OAAO,MAAM,WAAW,OAAO,MAAM,QAAQ;AAAA,QACpD;AAEA,YAAI,KAAK,OAAO,yBAAyB;AACvC,eAAK,OAAO,wBAAwB,MAAM,MAAM,uBAAuB;AAEvE,eAAK,OAAO,wBAAwB,iBAAiB,MAAM,OAAO,KAAK,OAAO,eAAe;AAAA,QAC/F;AACA,YAAI,KAAK,OAAO,qBAAqB;AACnC,eAAK,OAAO,oBAAoB,MAAM,MAAM,mBAAmB;AAC/D,eAAK,OAAO,oBAAoB,UAAU,MAAM,uBAAuB,CAAC;AACxE,eAAK,OAAO,oBAAoB,kBAAkB;AAAA,QACpD;AAGA,YAAI,MAAM,OAAO,CAAC,KAAK,OAAO,aAAa;AACzC,eAAK,OAAO,cAAc,MAAM;AAAA,QAClC;AAGA,cAAM,WAAW,MAAM,KAAK,KAAK,OAAO,QAAQ,iBAAiB,OAAO,CAAC;AACzE,iBAAS,QAAQ,OAAK,EAAE,OAAO,CAAC;AAEhC,YAAI,MAAM,QAAQ,MAAM,MAAM,GAAG;AAC/B,gBAAM,OAAO,QAAQ,QAAM;AACzB,gBAAI,EAAC,yBAAI,KAAK;AACd,kBAAM,KAAK,SAAS,cAAc,OAAO;AACzC,eAAG,MAAM,GAAG;AACZ,eAAG,OAAO,GAAG,QAAQ;AACrB,eAAG,UAAU,GAAG,WAAW;AAC3B,eAAG,QAAQ,GAAG,SAAS,GAAG,WAAW;AACrC,gBAAI,GAAG,QAAS,IAAG,UAAU;AAC7B,gBAAI,GAAG,cAAc;AACnB,iBAAG,aAAa,iBAAiB,GAAG,YAAY;AAAA,YAClD;AACA,iBAAK,OAAO,QAAQ,YAAY,EAAE;AAAA,UACpC,CAAC;AAAA,QACH;AAEA,YAAI,OAAO,KAAK,OAAO,yBAAyB,YAAY;AAC1D,eAAK,OAAO,qBAAqB;AAAA,QACnC;AAGA,YAAI,KAAK,OAAO,2BAA2B,OAAO,KAAK,OAAO,wBAAwB,2BAA2B,YAAY;AAC3H,cAAI;AACF,iBAAK,OAAO,wBAAwB,gBAAgB,CAAC;AACrD,iBAAK,OAAO,wBAAwB,uBAAuB,KAAK,OAAO,gBAAgB,KAAK,OAAO,aAAa;AAAA,UAClH,SAAS,GAAG;AAAA,UAEZ;AAAA,QACF;AAIA,YAAI,KAAK,OAAO,kBAAkB,OAAO,KAAK,OAAO,eAAe,eAAe,YAAY;AAC7F,cAAI;AACF,iBAAK,OAAO,eAAe,SAAS,CAAC;AACrC,iBAAK,OAAO,eAAe,eAAe;AAC1C,iBAAK,OAAO,eAAe,WAAW;AAAA,UACxC,SAAS,GAAG;AAAA,UAEZ;AAAA,QACF;AAMA,YAAI,OAAO,KAAK,OAAO,qBAAqB,YAAY;AACtD,eAAK,OAAO,iBAAiB;AAAA,QAC/B;AAAA,MACF,SAAS,GAAG;AAAA,MAEZ;AAEA,WAAK,gBAAgB,KAAK;AAC1B,WAAK,iBAAiB;AAEtB,WAAK,OAAO,KAAK,uBAAuB;AAAA,QACtC;AAAA,QACA,MAAM;AAAA,QACN,OAAO,KAAK,OAAO;AAAA,MACrB,CAAC;AAAA,IACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,MAAM,KAAK,OAAO,gBAAgB,OAAO;AAtpB3C;AAupBI,UAAI,QAAQ,KAAK,SAAS,KAAK,OAAO,QAAQ;AAC5C,gBAAQ,KAAK,wCAAwC,KAAK;AAC1D;AAAA,MACF;AAEA,YAAM,QAAQ,KAAK,OAAO,KAAK;AAG/B,WAAK,kBAAkB;AAGvB,WAAK,eAAe;AAGpB,UAAI,KAAK,QAAQ,mBAAmB,KAAK,eAAe,KAAK,aAAa;AACxE,cAAM,mBAAmB,KAAK,SAC3B,KAAK,OAAO,QAAQ,YAAY,UAAU,UAAU,UAAW;AAClE,cAAM,eAAe,KAAK,kBAAkB,KAAK;AACjD,cAAM,iBAAkB,iBAAiB,WAAW,iBAAiB,eAAgB,UAAU;AAG/F,YAAI,qBAAqB,gBAAgB;AACvC,gBAAM,KAAK,uBAAuB,OAAO,IAAI;AAE7C,eAAK,gBAAgB,KAAK;AAC1B,eAAK,iBAAiB;AAGtB,eAAK,OAAO,KAAK,uBAAuB;AAAA,YACtC;AAAA,YACA,MAAM;AAAA,YACN,OAAO,KAAK,OAAO;AAAA,UACrB,CAAC;AAGD,qBAAW,MAAM;AACf,iBAAK,kBAAkB;AAAA,UACzB,GAAG,GAAG;AACN;AAAA,QACF;AAAA,MACF;AAIA,UAAI,YAAY,MAAM;AACtB,YAAI,gBAAK,WAAL,mBAAa,4BAAb,mBAAsC,iBAAgB,MAAM,qBAAqB;AAEnF,aAAK,OAAO,cAAc,MAAM;AAChC,aAAK,OAAO,wBAAwB,iBAAiB,MAAM;AAC3D,aAAK,OAAO,wBAAwB,MAAM,MAAM;AAChD,oBAAY,MAAM;AAAA,MACpB;AAEA,WAAK,OAAO,KAAK;AAAA,QACf,KAAK;AAAA,QACL,MAAM,MAAM;AAAA,QACZ,QAAQ,MAAM;AAAA,QACd,QAAQ,MAAM,UAAU,CAAC;AAAA,QACzB,qBAAqB,MAAM,uBAAuB;AAAA,QAClD,iBAAiB,MAAM,mBAAmB;AAAA,QAC1C,qBAAqB,MAAM,uBAAuB,CAAC;AAAA,MACrD,CAAC;AAGD,WAAK,gBAAgB,KAAK;AAC1B,WAAK,iBAAiB;AAGtB,WAAK,OAAO,KAAK,uBAAuB;AAAA,QACtC;AAAA,QACA,MAAM;AAAA,QACN,OAAO,KAAK,OAAO;AAAA,MACrB,CAAC;AAGD,iBAAW,MAAM;AACf,aAAK,OAAO,KAAK;AAEjB,mBAAW,MAAM;AACf,eAAK,kBAAkB;AAAA,QACzB,GAAG,EAAE;AAAA,MACP,GAAG,GAAG;AAAA,IACR;AAAA;AAAA;AAAA;AAAA,IAKA,OAAO;AACL,UAAI,YAAY,KAAK,eAAe;AAEpC,UAAI,aAAa,KAAK,OAAO,QAAQ;AACnC,YAAI,KAAK,QAAQ,MAAM;AACrB,sBAAY;AAAA,QACd,OAAO;AACL;AAAA,QACF;AAAA,MACF;AAEA,WAAK,KAAK,SAAS;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKA,WAAW;AACT,UAAI,YAAY,KAAK,eAAe;AAEpC,UAAI,YAAY,GAAG;AACjB,YAAI,KAAK,QAAQ,MAAM;AACrB,sBAAY,KAAK,OAAO,SAAS;AAAA,QACnC,OAAO;AACL;AAAA,QACF;AAAA,MACF;AAEA,WAAK,KAAK,SAAS;AAAA,IACrB;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB;AAGf,UAAI,KAAK,iBAAiB;AACxB;AAAA,MACF;AAEA,UAAI,KAAK,QAAQ,aAAa;AAC5B,aAAK,KAAK;AAAA,MACZ;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,sBAAsB,KAAK;AACzB,UAAI,CAAC,IAAK,QAAO;AACjB,aAAO,IAAI,SAAS,aAAa,KAC1B,IAAI,SAAS,UAAU,KACvB,IAAI,SAAS,WAAW,KACxB,IAAI,SAAS,gBAAgB,KAC7B,IAAI,SAAS,oBAAoB,KACjC,IAAI,SAAS,OAAO;AAAA,IAC7B;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB,GAAG;AAIlB,YAAM,eAAe,KAAK,gBAAgB;AAC1C,UAAI,gBAAgB,aAAa,OAAO,KAAK,sBAAsB,aAAa,GAAG,GAAG;AAEpF;AAAA,MACF;AAIA,UAAI,KAAK,iBAAiB;AACxB;AAAA,MACF;AAEA,cAAQ,MAAM,gCAAgC,CAAC;AAG/C,UAAI,KAAK,QAAQ,aAAa;AAC5B,mBAAW,MAAM;AACf,eAAK,KAAK;AAAA,QACZ,GAAG,GAAI;AAAA,MACT;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,4BAA4B;AAC1B,WAAK,qCAAqC;AAAA,IAC5C;AAAA;AAAA;AAAA;AAAA,IAKA,yBAAyB;AAEvB,iBAAW,MAAM;AACf,aAAK,qCAAqC;AAAA,MAC5C,GAAG,EAAE;AAAA,IACP;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,+BAA+B;AAC7B,YAAM,eAAe,KAAK,gBAAgB;AAC1C,UAAI,CAAC,aAAc;AAGnB,WAAK,gBAAgB,YAAY;AAGjC,WAAK,iBAAiB;AAGtB,WAAK,wBAAwB;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA;AAAA,IAMA,0BAA0B;AACxB,UAAI,CAAC,KAAK,cAAe;AAEzB,YAAM,QAAQ,KAAK,cAAc,iBAAiB,uBAAuB;AAEzE,YAAM,QAAQ,CAAC,MAAM,UAAU;AAC7B,cAAM,QAAQ,KAAK,OAAO,KAAK;AAC/B,YAAI,CAAC,MAAO;AAEZ,cAAM,oBAAoB,KAAK,qBAAqB,KAAK;AACzD,cAAM,gBAAgB,oBAAoB,UAAU,WAAW,iBAAiB,IAAI;AAGpF,cAAM,gBAAgB,KAAK,cAAc,iCAAiC;AAC1E,YAAI,eAAe;AACjB,wBAAc,cAAc;AAAA,QAC9B;AAGA,cAAM,iBAAiB,KAAK,cAAc,gCAAgC;AAC1E,YAAI,gBAAgB;AAClB,yBAAe,cAAc;AAAA,QAC/B;AAAA,MACF,CAAC;AAAA,IACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,qBAAqB,OAAO;AAC1B,UAAI,CAAC,MAAO,QAAO;AAEnB,YAAM,4BAA4B,KAAK,OAAO,MAAM;AAGpD,UAAI,6BAA6B,MAAM,0BAA0B;AAC/D,eAAO,MAAM;AAAA,MACf;AAGA,aAAO,MAAM,YAAY;AAAA,IAC3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,uCAAuC;AACrC,UAAI,CAAC,KAAK,iBAAiB,CAAC,KAAK,OAAO,OAAQ;AAEhD,YAAM,eAAe,KAAK,OAAO,MAAM;AACvC,YAAM,YAAY,KAAK,OAAO,MAAM;AAEpC,UAAI,cAAc;AAGhB,YAAI,CAAC,WAAW;AACd,eAAK,cAAc,UAAU,IAAI,oCAAoC;AACrE,eAAK,cAAc,MAAM,UAAU;AAAA,QACrC,OAAO;AACL,eAAK,cAAc,UAAU,OAAO,oCAAoC;AAExE,qBAAW,MAAM;AAEf,gBAAI,KAAK,OAAO,MAAM,WAAW,KAAK,OAAO,MAAM,YAAY;AAC7D,mBAAK,cAAc,MAAM,UAAU;AAAA,YACrC;AAAA,UACF,GAAG,GAAG;AAAA,QACR;AAAA,MACF,OAAO;AAEL,aAAK,cAAc,UAAU,OAAO,oCAAoC;AACxE,YAAI,KAAK,kBAAkB,KAAK,OAAO,SAAS,GAAG;AACjD,eAAK,cAAc,MAAM,UAAU;AAAA,QACrC,OAAO;AACL,eAAK,cAAc,MAAM,UAAU;AAAA,QACrC;AAAA,MACF;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,WAAW;AAET,WAAK,YAAY,KAAK,OAAO;AAE7B,UAAI,CAAC,KAAK,WAAW;AACnB,gBAAQ,KAAK,qCAAqC;AAClD;AAAA,MACF;AAOA,WAAK,mBAAmB,SAAS,cAAc,OAAO;AAAA,QACpD,WAAW;AAAA,QACX,YAAY;AAAA,UACV,MAAM;AAAA,QACR;AAAA,MACF,CAAC;AACD,WAAK,iBAAiB,MAAM,UAAU;AAEtC,WAAK,UAAU,YAAY,KAAK,gBAAgB;AAGhD,WAAK,qBAAqB,SAAS,cAAc,OAAO;AAAA,QACtD,WAAW;AAAA,QACX,YAAY;AAAA,UACV,MAAM;AAAA,UACN,aAAa;AAAA,UACb,eAAe;AAAA,QACjB;AAAA,MACF,CAAC;AACD,WAAK,UAAU,YAAY,KAAK,kBAAkB;AAGlD,WAAK,gBAAgB,SAAS,cAAc,OAAO;AAAA,QACjD,WAAW;AAAA,QACX,YAAY;AAAA,UACV,IAAI,GAAG,YAAK,UAAQ;AAAA,UACpB,MAAM;AAAA,UACN,cAAc,KAAK,EAAE,gBAAgB;AAAA,UACrC,mBAAmB,GAAG,YAAK,UAAQ;AAAA,QACrC;AAAA,MACF,CAAC;AACD,WAAK,cAAc,MAAM,UAAU,KAAK,iBAAiB,SAAS;AAElE,WAAK,UAAU,YAAY,KAAK,aAAa;AAAA,IAC/C;AAAA;AAAA;AAAA;AAAA,IAKA,gBAAgB,OAAO;AACrB,UAAI,CAAC,KAAK,iBAAkB;AAE5B,YAAM,cAAc,KAAK,eAAe;AACxC,YAAM,cAAc,KAAK,OAAO;AAChC,YAAM,aAAa,MAAM,SAAS,KAAK,EAAE,mBAAmB;AAC5D,YAAM,cAAc,MAAM,UAAU;AAGpC,YAAM,oBAAoB,KAAK,qBAAqB,KAAK;AACzD,YAAM,gBAAgB,oBAAoB,UAAU,WAAW,iBAAiB,IAAI;AACpF,YAAM,wBAAwB,oBAAoB,UAAU,eAAe,iBAAiB,IAAI;AAGhG,YAAM,aAAa,cAAc,KAAK,EAAE,aAAa,IAAI,cAAc;AACvE,YAAM,eAAe,wBAAwB,KAAK,gCAA0B;AAC5E,YAAM,eAAe,KAAK,EAAE,uBAAuB;AAAA,QACjD,SAAS;AAAA,QACT,OAAO;AAAA,QACP,OAAO;AAAA,QACP,QAAQ;AAAA,MACV,CAAC,IAAI;AAEL,YAAM,cAAc,KAAK,EAAE,oBAAoB;AAAA,QAC7C,SAAS;AAAA,QACT,OAAO;AAAA,MACT,CAAC;AAGD,YAAM,eAAe,gBACjB,0DAA0D,gBAAS,WAAW,aAAa,GAAC,aAC5F;AAGJ,YAAM,mBAAmB,MAAM,eAAe;AAE9C,WAAK,iBAAiB,YAAY,wCACD,gBAAS,WAAW,YAAY,GAAC,mHAE1B,gBAAS,WAAW,WAAW,GAAC,qBAClE,qBAAY,6EAEqC,gBAAS,WAAW,UAAU,GAAC,kBAClF,qBAAc,uDAAuD,gBAAS,WAAW,WAAW,GAAC,YAAW,IAAE,YAClH,0BAAmB,4DAA4D,gBAAS,WAAW,gBAAgB,GAAC,YAAW,IAAE;AAGrI,WAAK,iBAAiB,MAAM,UAAU;AAGtC,WAAK,mBAAmB,KAAK;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB,OAAO;AAljC5B;AAqjCI,YAAI,gBAAK,WAAL,mBAAa,YAAb,mBAAsB,aAAY,SAAS;AAC7C,YAAI,KAAK,qBAAqB;AAC5B,eAAK,oBAAoB,MAAM,UAAU;AAAA,QAC3C;AACA;AAAA,MACF;AAGA,UAAI,CAAC,KAAK,uBAAuB,KAAK,WAAW;AAC/C,aAAK,sBAAsB,SAAS,cAAc,OAAO;AAAA,UACvD,WAAW;AAAA,UACX,YAAY;AAAA,YACV,eAAe;AAAA,UACjB;AAAA,QACF,CAAC;AACD,aAAK,oBAAoB,MAAM,UAAU;AAGzC,cAAM,eAAe,KAAK,UAAU,cAAc,uBAAuB;AACzE,YAAI,cAAc;AAChB,eAAK,UAAU,aAAa,KAAK,qBAAqB,YAAY;AAAA,QACpE,OAAO;AACL,eAAK,UAAU,YAAY,KAAK,mBAAmB;AAAA,QACrD;AAAA,MACF;AAEA,UAAI,CAAC,KAAK,oBAAqB;AAG/B,UAAI,MAAM,QAAQ;AAChB,aAAK,oBAAoB,MAAM,kBAAkB,OAAO,aAAM,QAAM;AACpE,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC3C,OAAO;AAEL,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC3C;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,iBAAiB;AACf,UAAI,CAAC,KAAK,cAAe;AAGzB,WAAK,cAAc,YAAY;AAG/B,YAAM,SAAS,SAAS,cAAc,MAAM;AAAA,QAC1C,WAAW;AAAA,QACX,YAAY;AAAA,UACV,IAAI,GAAG,YAAK,UAAQ;AAAA,QACtB;AAAA,MACF,CAAC;AACD,aAAO,cAAc,GAAG,YAAK,EAAE,gBAAgB,GAAC,MAAK,YAAK,OAAO,QAAM;AACvE,WAAK,cAAc,YAAY,MAAM;AAGrC,YAAM,eAAe,SAAS,cAAc,OAAO;AAAA,QACjD,WAAW;AAAA,QACX,YAAY;AAAA,UACV,IAAI,GAAG,YAAK,UAAQ;AAAA,QACtB;AAAA,MACF,CAAC;AACD,mBAAa,cAAc,KAAK,EAAE,+BAA+B;AACjE,WAAK,cAAc,YAAY,YAAY;AAG3C,YAAM,OAAO,SAAS,cAAc,MAAM;AAAA,QACxC,WAAW;AAAA,QACX,YAAY;AAAA,UACV,MAAM;AAAA,UACN,mBAAmB,GAAG,YAAK,UAAQ;AAAA,UACnC,oBAAoB,GAAG,YAAK,UAAQ;AAAA,QACtC;AAAA,MACF,CAAC;AAED,WAAK,OAAO,QAAQ,CAAC,OAAO,UAAU;AACpC,cAAM,OAAO,KAAK,mBAAmB,OAAO,KAAK;AACjD,aAAK,YAAY,IAAI;AAAA,MACvB,CAAC;AAED,WAAK,cAAc,YAAY,IAAI;AAGnC,UAAI,KAAK,gBAAgB;AACvB,aAAK,cAAc,MAAM,UAAU;AAAA,MACrC;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB,OAAO,OAAO;AAC/B,YAAM,gBAAgB,KAAK,EAAE,oBAAoB;AAAA,QAC/C,SAAS,QAAQ;AAAA,QACjB,OAAO,KAAK,OAAO;AAAA,MACrB,CAAC;AACD,YAAM,aAAa,MAAM,SAAS,KAAK,EAAE,0BAA0B,EAAE,QAAQ,QAAQ,EAAE,CAAC;AACxF,YAAM,cAAc,MAAM,SAAS,KAAK,EAAE,aAAa,IAAI,MAAM,SAAS;AAG1E,YAAM,oBAAoB,KAAK,qBAAqB,KAAK;AACzD,YAAM,gBAAgB,oBAAoB,UAAU,WAAW,iBAAiB,IAAI;AACpF,YAAM,wBAAwB,oBAAoB,UAAU,eAAe,iBAAiB,IAAI;AAChG,YAAM,WAAW,UAAU,KAAK;AAMhC,UAAI,YAAY,GAAG,mBAAa;AAChC,UAAI,uBAAuB;AACzB,qBAAa,KAAK;AAAA,MACpB;AAGA,YAAM,OAAO,SAAS,cAAc,MAAM;AAAA,QACxC,WAAW,WAAW,qDAAqD;AAAA,QAC3E,YAAY;AAAA,UACV,uBAAuB;AAAA,QACzB;AAAA,MACF,CAAC;AAGD,YAAM,SAAS,SAAS,cAAc,UAAU;AAAA,QAC9C,WAAW;AAAA,QACX,YAAY;AAAA,UACV,MAAM;AAAA,UACN,MAAM;AAAA,UACN,UAAU,UAAU,IAAI,IAAI;AAAA;AAAA,UAC5B,cAAc;AAAA,UACd,iBAAiB,QAAQ;AAAA,UACzB,gBAAgB,KAAK,OAAO;AAAA,UAC5B,gBAAgB,WAAW,SAAS;AAAA,QACtC;AAAA,MACF,CAAC;AAGD,UAAI,UAAU;AACZ,eAAO,aAAa,gBAAgB,MAAM;AAC1C,eAAO,aAAa,YAAY,GAAG;AAAA,MACrC;AAGA,YAAM,qBAAqB,SAAS,cAAc,QAAQ;AAAA,QACxD,WAAW;AAAA,QACX,YAAY;AAAA,UACV,eAAe;AAAA,QACjB;AAAA,MACF,CAAC;AAGD,YAAM,YAAY,SAAS,cAAc,QAAQ;AAAA,QAC/C,WAAW;AAAA,MACb,CAAC;AAED,UAAI,MAAM,QAAQ;AAChB,kBAAU,MAAM,kBAAkB,OAAO,aAAM,QAAM;AAAA,MACvD,OAAO;AAEL,cAAM,OAAO,kBAAkB,OAAO;AACtC,aAAK,UAAU,IAAI,gCAAgC;AACnD,kBAAU,YAAY,IAAI;AAAA,MAC5B;AAEA,yBAAmB,YAAY,SAAS;AAGxC,UAAI,iBAAiB,MAAM,QAAQ;AACjC,cAAM,gBAAgB,SAAS,cAAc,QAAQ;AAAA,UACnD,WAAW;AAAA,QACb,CAAC;AACD,sBAAc,cAAc;AAC5B,2BAAmB,YAAY,aAAa;AAAA,MAC9C;AAEA,aAAO,YAAY,kBAAkB;AAGrC,YAAM,OAAO,SAAS,cAAc,QAAQ;AAAA,QAC1C,WAAW;AAAA,QACX,YAAY;AAAA,UACV,eAAe;AAAA,QACjB;AAAA,MACF,CAAC;AAGD,YAAM,WAAW,SAAS,cAAc,QAAQ;AAAA,QAC9C,WAAW;AAAA,MACb,CAAC;AAED,YAAM,QAAQ,SAAS,cAAc,QAAQ;AAAA,QAC3C,WAAW;AAAA,MACb,CAAC;AACD,YAAM,cAAc;AACpB,eAAS,YAAY,KAAK;AAG1B,UAAI,iBAAiB,CAAC,MAAM,QAAQ;AAClC,cAAM,iBAAiB,SAAS,cAAc,QAAQ;AAAA,UACpD,WAAW;AAAA,QACb,CAAC;AACD,uBAAe,cAAc;AAC7B,iBAAS,YAAY,cAAc;AAAA,MACrC;AAEA,WAAK,YAAY,QAAQ;AAGzB,UAAI,MAAM,QAAQ;AAChB,cAAM,SAAS,SAAS,cAAc,QAAQ;AAAA,UAC5C,WAAW;AAAA,QACb,CAAC;AACD,eAAO,cAAc,MAAM;AAC3B,aAAK,YAAY,MAAM;AAAA,MACzB;AAGA,UAAI,MAAM,aAAa;AACrB,cAAM,cAAc,SAAS,cAAc,QAAQ;AAAA,UACjD,WAAW;AAAA,QACb,CAAC;AACD,oBAAY,cAAc,MAAM;AAChC,aAAK,YAAY,WAAW;AAAA,MAC9B;AAEA,aAAO,YAAY,IAAI;AAGvB,YAAM,WAAW,kBAAkB,MAAM;AACzC,eAAS,UAAU,IAAI,2BAA2B;AAClD,eAAS,aAAa,eAAe,MAAM;AAC3C,aAAO,YAAY,QAAQ;AAG3B,aAAO,iBAAiB,SAAS,MAAM;AACrC,cAAME,SAAQ,KAAK,OAAO,KAAK;AAC/B,cAAM,qBAAqB,KAAK,sBAAsBA,UAAA,gBAAAA,OAAO,GAAG;AAIhE,YAAI,sBAAsB,KAAK,OAAO,MAAM,YAAY;AACtD,eAAK,OAAO,eAAe;AAE3B,qBAAW,MAAM;AACf,iBAAK,KAAK,OAAO,IAAI;AAAA,UACvB,GAAG,GAAG;AAAA,QACR,OAAO;AACL,eAAK,KAAK,OAAO,IAAI;AAAA,QACvB;AAAA,MACF,CAAC;AAGD,aAAO,iBAAiB,WAAW,CAAC,MAAM;AACxC,aAAK,0BAA0B,GAAG,KAAK;AAAA,MACzC,CAAC;AAGD,WAAK,YAAY,MAAM;AAEvB,aAAO;AAAA,IACT;AAAA;AAAA;AAAA;AAAA,IAKA,0BAA0B,GAAG,OAAO;AAClC,YAAM,UAAU,MAAM,KAAK,KAAK,cAAc,iBAAiB,8BAA8B,CAAC;AAC9F,UAAI,WAAW;AACf,UAAI,eAAe;AAEnB,cAAO,EAAE,KAAK;AAAA,QACZ,KAAK;AAAA,QACL,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAClB;AACE,kBAAM,QAAQ,KAAK,OAAO,KAAK;AAC/B,kBAAM,qBAAqB,KAAK,sBAAsB,+BAAO,GAAG;AAGhE,gBAAI,sBAAsB,KAAK,OAAO,MAAM,YAAY;AACtD,mBAAK,OAAO,eAAe;AAC3B,yBAAW,MAAM;AACf,qBAAK,KAAK,OAAO,IAAI;AAAA,cACvB,GAAG,GAAG;AAAA,YACR,OAAO;AACL,mBAAK,KAAK,OAAO,IAAI;AAAA,YACvB;AAAA,UACF;AACA;AAAA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,cAAI,QAAQ,QAAQ,SAAS,GAAG;AAC9B,uBAAW,QAAQ;AAAA,UACrB,OAAO;AAEL,2BAAe,KAAK,EAAE,0BAA0B,EAAE,SAAS,QAAQ,QAAQ,OAAO,QAAQ,OAAO,CAAC;AAAA,UACpG;AACA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,cAAI,QAAQ,GAAG;AACb,uBAAW,QAAQ;AAAA,UACrB,OAAO;AAEL,2BAAe,KAAK,EAAE,gCAAgC,EAAE,OAAO,QAAQ,OAAO,CAAC;AAAA,UACjF;AACA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,qBAAW,KAAK,IAAI,QAAQ,GAAG,QAAQ,SAAS,CAAC;AACjD,cAAI,aAAa,QAAQ,SAAS,KAAK,UAAU,UAAU;AACzD,2BAAe,KAAK,EAAE,8BAA8B,EAAE,SAAS,WAAW,GAAG,OAAO,QAAQ,OAAO,CAAC;AAAA,UACtG;AACA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,qBAAW,KAAK,IAAI,QAAQ,GAAG,CAAC;AAChC,cAAI,aAAa,KAAK,UAAU,UAAU;AACxC,2BAAe,KAAK,EAAE,+BAA+B,EAAE,OAAO,QAAQ,OAAO,CAAC;AAAA,UAChF;AACA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,qBAAW;AACX,cAAI,UAAU,GAAG;AACf,2BAAe,KAAK,EAAE,uBAAuB,EAAE,OAAO,QAAQ,OAAO,CAAC;AAAA,UACxE;AACA;AAAA,QAEF,KAAK;AACH,YAAE,eAAe;AACjB,YAAE,gBAAgB;AAElB,qBAAW,QAAQ,SAAS;AAC5B,cAAI,UAAU,QAAQ,SAAS,GAAG;AAChC,2BAAe,KAAK,EAAE,sBAAsB,EAAE,SAAS,QAAQ,QAAQ,OAAO,QAAQ,OAAO,CAAC;AAAA,UAChG;AACA;AAAA,MACJ;AAGA,UAAI,aAAa,MAAM,aAAa,OAAO;AACzC,gBAAQ,KAAK,EAAE,aAAa,YAAY,IAAI;AAC5C,gBAAQ,QAAQ,EAAE,aAAa,YAAY,GAAG;AAC9C,gBAAQ,QAAQ,EAAE,MAAM,EAAE,eAAe,MAAM,CAAC;AAGhD,cAAM,OAAO,QAAQ,QAAQ,EAAE,QAAQ,uBAAuB;AAC9D,YAAI,MAAM;AACR,eAAK,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAAA,QAC9D;AAAA,MACF;AAGA,UAAI,gBAAgB,KAAK,oBAAoB;AAC3C,aAAK,mBAAmB,cAAc;AAEtC,mBAAW,MAAM;AACf,cAAI,KAAK,oBAAoB;AAC3B,iBAAK,mBAAmB,cAAc;AAAA,UACxC;AAAA,QACF,GAAG,GAAI;AAAA,MACT;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,mBAAmB;AACjB,UAAI,CAAC,KAAK,cAAe;AAEzB,YAAM,QAAQ,KAAK,cAAc,iBAAiB,uBAAuB;AACzE,YAAM,UAAU,KAAK,cAAc,iBAAiB,8BAA8B;AAElF,YAAM,QAAQ,CAAC,MAAM,UAAU;AAC7B,cAAM,SAAS,QAAQ,KAAK;AAC5B,YAAI,CAAC,OAAQ;AAEb,cAAM,QAAQ,KAAK,OAAO,KAAK;AAC/B,cAAM,gBAAgB,KAAK,EAAE,oBAAoB;AAAA,UAC/C,SAAS,QAAQ;AAAA,UACjB,OAAO,KAAK,OAAO;AAAA,QACrB,CAAC;AACD,cAAM,aAAa,MAAM,SAAS,KAAK,EAAE,0BAA0B,EAAE,QAAQ,QAAQ,EAAE,CAAC;AACxF,cAAM,cAAc,MAAM,SAAS,KAAK,EAAE,aAAa,IAAI,MAAM,SAAS;AAG1E,cAAM,oBAAoB,KAAK,qBAAqB,KAAK;AACzD,cAAM,wBAAwB,oBAAoB,UAAU,eAAe,iBAAiB,IAAI;AAEhG,YAAI,UAAU,KAAK,cAAc;AAE/B,eAAK,UAAU,IAAI,6BAA6B;AAGhD,iBAAO,aAAa,gBAAgB,MAAM;AAC1C,iBAAO,aAAa,gBAAgB,MAAM;AAC1C,iBAAO,aAAa,YAAY,GAAG;AAGnC,cAAI,YAAY,GAAG,mBAAa;AAChC,cAAI,uBAAuB;AACzB,yBAAa,KAAK;AAAA,UACpB;AACA,iBAAO,aAAa,cAAc,SAAS;AAG3C,eAAK,eAAe,EAAE,UAAU,UAAU,OAAO,UAAU,CAAC;AAAA,QAC9D,OAAO;AAEL,eAAK,UAAU,OAAO,6BAA6B;AAGnD,iBAAO,gBAAgB,cAAc;AACrC,iBAAO,aAAa,gBAAgB,OAAO;AAC3C,iBAAO,aAAa,YAAY,IAAI;AAGpC,cAAI,YAAY,GAAG,mBAAa;AAChC,cAAI,uBAAuB;AACzB,yBAAa,KAAK;AAAA,UACpB;AACA,iBAAO,aAAa,cAAc,SAAS;AAAA,QAC7C;AAAA,MACF,CAAC;AAAA,IACH;AAAA;AAAA;AAAA;AAAA,IAKA,kBAAkB;AAChB,aAAO,KAAK,OAAO,KAAK,YAAY,KAAK;AAAA,IAC3C;AAAA;AAAA;AAAA;AAAA,IAKA,kBAAkB;AAChB,aAAO;AAAA,QACL,cAAc,KAAK;AAAA,QACnB,aAAa,KAAK,OAAO;AAAA,QACzB,cAAc,KAAK,gBAAgB;AAAA,QACnC,SAAS,KAAK,QAAQ;AAAA,QACtB,aAAa,KAAK,YAAY;AAAA,MAChC;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AACR,UAAI,KAAK,QAAQ,KAAM,QAAO;AAC9B,aAAO,KAAK,eAAe,KAAK,OAAO,SAAS;AAAA,IAClD;AAAA;AAAA;AAAA;AAAA,IAKA,cAAc;AACZ,UAAI,KAAK,QAAQ,KAAM,QAAO;AAC9B,aAAO,KAAK,eAAe;AAAA,IAC7B;AAAA;AAAA;AAAA;AAAA,IAKA,SAAS,OAAO;AACd,WAAK,OAAO,KAAK,KAAK;AAEtB,UAAI,KAAK,eAAe;AACtB,aAAK,eAAe;AAAA,MACtB;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,YAAY,OAAO;AACjB,UAAI,QAAQ,KAAK,SAAS,KAAK,OAAO,OAAQ;AAE9C,WAAK,OAAO,OAAO,OAAO,CAAC;AAG3B,UAAI,QAAQ,KAAK,cAAc;AAC7B,aAAK;AAAA,MACP,WAAW,UAAU,KAAK,cAAc;AAEtC,YAAI,KAAK,gBAAgB,KAAK,OAAO,QAAQ;AAC3C,eAAK,eAAe,KAAK,OAAO,SAAS;AAAA,QAC3C;AAEA,YAAI,KAAK,gBAAgB,GAAG;AAC1B,eAAK,KAAK,KAAK,YAAY;AAAA,QAC7B;AAAA,MACF;AAEA,UAAI,KAAK,eAAe;AACtB,aAAK,eAAe;AAAA,MACtB;AAAA,IACF;AAAA;AAAA;AAAA;AAAA,IAKA,QAAQ;AACN,WAAK,SAAS,CAAC;AACf,WAAK,eAAe;AAEpB,UAAI,KAAK,eAAe;AACtB,aAAK,cAAc,YAAY;AAC/B,aAAK,cAAc,MAAM,UAAU;AAAA,MACrC;AAEA,UAAI,KAAK,kBAAkB;AACzB,aAAK,iBAAiB,YAAY;AAClC,aAAK,iBAAiB,MAAM,UAAU;AAAA,MACxC;AAEA,UAAI,KAAK,qBAAqB;AAC5B,aAAK,oBAAoB,MAAM,kBAAkB;AACjD,aAAK,oBAAoB,MAAM,UAAU;AAAA,MAC3C;AAAA,IACF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAOA,YAAY,MAAM;AAChB,UAAI,CAAC,KAAK,cAAe,QAAO;AAGhC,YAAM,aAAa,SAAS,SAAY,OAAO,KAAK,cAAc,MAAM,YAAY;AAEpF,UAAI,YAAY;AACd,aAAK,cAAc,MAAM,UAAU;AACnC,aAAK,iBAAiB;AAGtB,YAAI,KAAK,OAAO,SAAS,GAAG;AAC1B,qBAAW,MAAM;AACf,kBAAM,YAAY,KAAK,cAAc,cAAc,qCAAqC;AACxF,gBAAI,WAAW;AACb,wBAAU,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,YACzC;AAAA,UACF,GAAG,GAAG;AAAA,QACR;AAGA,YAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,gBAAgB;AAC5E,eAAK,OAAO,WAAW,SAAS,eAAe,aAAa,iBAAiB,MAAM;AACnF,eAAK,OAAO,WAAW,SAAS,eAAe,aAAa,gBAAgB,MAAM;AAAA,QACpF;AAAA,MACF,OAAO;AACL,aAAK,cAAc,MAAM,UAAU;AACnC,aAAK,iBAAiB;AAGtB,YAAI,KAAK,OAAO,cAAc,KAAK,OAAO,WAAW,SAAS,gBAAgB;AAC5E,eAAK,OAAO,WAAW,SAAS,eAAe,aAAa,iBAAiB,OAAO;AACpF,eAAK,OAAO,WAAW,SAAS,eAAe,aAAa,gBAAgB,OAAO;AAGnF,eAAK,OAAO,WAAW,SAAS,eAAe,MAAM,EAAE,eAAe,KAAK,CAAC;AAAA,QAC9E;AAAA,MACF;AAEA,aAAO,KAAK;AAAA,IACd;AAAA;AAAA;AAAA;AAAA,IAKA,YAAY;AACV,aAAO,KAAK,YAAY,IAAI;AAAA,IAC9B;AAAA;AAAA;AAAA;AAAA,IAKA,YAAY;AACV,aAAO,KAAK,YAAY,KAAK;AAAA,IAC/B;AAAA;AAAA;AAAA;AAAA,IAKA,UAAU;AAER,WAAK,OAAO,IAAI,SAAS,KAAK,cAAc;AAC5C,WAAK,OAAO,IAAI,SAAS,KAAK,gBAAgB;AAG9C,UAAI,KAAK,qBAAqB;AAC5B,aAAK,oBAAoB,OAAO;AAAA,MAClC;AAEA,UAAI,KAAK,kBAAkB;AACzB,aAAK,iBAAiB,OAAO;AAAA,MAC/B;AAEA,UAAI,KAAK,eAAe;AACtB,aAAK,cAAc,OAAO;AAAA,MAC5B;AAGA,WAAK,MAAM;AAAA,IACb;AAAA,EACF;;;AC/pDA,WAAS,oBAAoB;AAC3B,UAAM,WAAW,SAAS,iBAAiB,eAAe;AAE1D,aAAS,QAAQ,aAAW;AAE1B,YAAM,UAAU,QAAQ,QAAQ,gBAC5B,KAAK,MAAM,QAAQ,QAAQ,aAAa,IACxC,CAAC;AAIL,YAAM,cAAc,oBAAoB,QAAQ,OAAO;AACvD,YAAM,gBAAgB,kCAAK,cAAgB;AAG3C,UAAI,OAAO,SAAS,aAAa;AAAA,IACnC,CAAC;AAAA,EACH;AAGA,WAAS,oBAAoB,SAAS;AACpC,UAAM,UAAU,CAAC;AAGjB,UAAM,eAAe;AAAA;AAAA,MAEnB,mBAAmB;AAAA,MACnB,sBAAsB;AAAA,MACtB,wBAAwB;AAAA,MACxB,2BAA2B;AAAA;AAAA,MAG3B,uBAAuB;AAAA,MACvB,0BAA0B;AAAA;AAAA,MAG1B,YAAY;AAAA,MACZ,QAAQ;AAAA,MACR,SAAS;AAAA,MACT,YAAY;AAAA,MACZ,UAAU;AAAA,MACV,SAAS;AAAA,MACT,UAAU;AAAA,MACV,YAAY;AAAA,MACZ,YAAY;AAAA,MACZ,mBAAmB;AAAA,MACnB,cAAc;AAAA,MACd,oBAAoB;AAAA,MACpB,YAAY;AAAA,MACZ,cAAc;AAAA,MACd,aAAa;AAAA,MACb,oBAAoB;AAAA;AAAA,IAGtB;AAGA,WAAO,KAAK,YAAY,EAAE,QAAQ,aAAW;AAC3C,YAAM,YAAY,aAAa,OAAO;AACtC,YAAM,QAAQ,QAAQ,OAAO;AAE7B,UAAI,UAAU,QAAW;AAEvB,YAAI,UAAU,QAAQ;AACpB,kBAAQ,SAAS,IAAI;AAAA,QACvB,WAAW,UAAU,SAAS;AAC5B,kBAAQ,SAAS,IAAI;AAAA,QACvB,WAAW,CAAC,MAAM,KAAK,KAAK,UAAU,IAAI;AACxC,kBAAQ,SAAS,IAAI,OAAO,KAAK;AAAA,QACnC,OAAO;AACL,kBAAQ,SAAS,IAAI;AAAA,QACvB;AAAA,MACF;AAAA,IACF,CAAC;AAID,UAAM,sBAAsB,CAAC;AAC7B,WAAO,KAAK,OAAO,EAAE,QAAQ,SAAO;AAClC,UAAI,IAAI,WAAW,iBAAiB,KAAK,QAAQ,mBAAmB;AAGlE,cAAM,YAAY,IAAI,MAAM,gCAAgC;AAC5D,YAAI,WAAW;AACb,gBAAM,WAAW,UAAU,CAAC,EAAE,YAAY;AAC1C,8BAAoB,QAAQ,IAAI,QAAQ,GAAG;AAAA,QAC7C;AAAA,MACF;AAAA,IACF,CAAC;AAED,QAAI,OAAO,KAAK,mBAAmB,EAAE,SAAS,GAAG;AAC/C,cAAQ,sBAAsB;AAE9B,UAAI,QAAQ,mBAAmB,CAAC,QAAQ,iBAAiB;AACvD,gBAAQ,kBAAkB,QAAQ;AAAA,MACpC;AAAA,IACF;AAIA,QAAI,QAAQ,qBAAqB;AAC/B,UAAI;AACF,gBAAQ,gBAAgB,KAAK,MAAM,QAAQ,mBAAmB;AAAA,MAChE,SAAS,GAAG;AACV,gBAAQ,KAAK,+CAA+C,CAAC;AAAA,MAC/D;AAAA,IACF;AAIA,QAAI,QAAQ,oBAAoB;AAC9B,UAAI;AACF,cAAM,SAAS,KAAK,MAAM,QAAQ,kBAAkB;AAEpD,YAAI,OAAO,WAAW,YAAY,WAAW,MAAM;AACjD,kBAAQ,gBAAgB;AAAA,QAC1B;AAAA,MACF,SAAS,GAAG;AAEV,YAAI,QAAQ,0BAA0B,QAAQ,uBAAuB;AACnE,kBAAQ,eAAe,QAAQ;AAC/B,kBAAQ,kBAAkB,QAAQ;AAAA,QACpC;AAAA,MACF;AAAA,IACF,WAAW,QAAQ,0BAA0B,QAAQ,uBAAuB;AAE1E,cAAQ,eAAe,QAAQ;AAC/B,cAAQ,kBAAkB,QAAQ;AAAA,IACpC;AAEA,WAAO;AAAA,EACT;AAGA,MAAI,SAAS,eAAe,WAAW;AACrC,aAAS,iBAAiB,oBAAoB,iBAAiB;AAAA,EACjE,OAAO;AACL,sBAAkB;AAAA,EACpB;AAIA,MAAO,gBAAQ;",
  "names": ["translations", "e", "isMobile", "HTML5Renderer", "currentTime", "isSmallScreen", "isMobile", "_a", "_b", "currentSrc", "syncTime", "hasSourceElementsWithDesc", "allTextTracks", "_a", "isMobile", "_a", "_b", "track"]
}
