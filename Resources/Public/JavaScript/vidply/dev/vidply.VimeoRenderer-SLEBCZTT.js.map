{
  "version": 3,
  "sources": ["../../src/renderers/VimeoRenderer.js"],
  "sourcesContent": ["/**\r\n * Vimeo Renderer\r\n */\r\n\r\nexport class VimeoRenderer {\r\n  constructor(player) {\r\n    this.player = player;\r\n    this.vimeo = null;\r\n    this.videoId = null;\r\n    this.isReady = false;\r\n    this.iframe = null;\r\n  }\r\n\r\n  async init() {\r\n    // Extract video ID from URL - use currentSource which works for external renderers\r\n    const src = this.player.currentSource || this.player.element.src;\r\n    this.videoId = this.extractVideoId(src);\r\n    \r\n    if (!this.videoId) {\r\n      throw new Error('Invalid Vimeo URL');\r\n    }\r\n\r\n    // Load Vimeo Player API\r\n    await this.loadVimeoAPI();\r\n\r\n    // Create iframe\r\n    this.createIframe();\r\n\r\n    // Initialize player\r\n    await this.initializePlayer();\r\n  }\r\n\r\n  extractVideoId(url) {\r\n    const patterns = [\r\n      /vimeo\\.com\\/(\\d+)/,\r\n      /vimeo\\.com\\/video\\/(\\d+)/,\r\n      /player\\.vimeo\\.com\\/video\\/(\\d+)/\r\n    ];\r\n\r\n    for (const pattern of patterns) {\r\n      const match = url.match(pattern);\r\n      if (match && match[1]) {\r\n        return match[1];\r\n      }\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  async loadVimeoAPI() {\r\n    // Check if API is already loaded\r\n    if (window.Vimeo && window.Vimeo.Player) {\r\n      return Promise.resolve();\r\n    }\r\n\r\n    return new Promise((resolve, reject) => {\r\n      const script = document.createElement('script');\r\n      script.src = 'https://player.vimeo.com/api/player.js';\r\n      script.onload = () => resolve();\r\n      script.onerror = () => reject(new Error('Failed to load Vimeo API'));\r\n      document.head.appendChild(script);\r\n    });\r\n  }\r\n\r\n  createIframe() {\r\n    // Hide original element\r\n    this.player.element.style.display = 'none';\r\n\r\n    // Create container for iframe\r\n    this.iframe = document.createElement('div');\r\n    this.iframe.id = `vimeo-player-${Math.random().toString(36).substr(2, 9)}`;\r\n    this.iframe.style.width = '100%';\r\n    this.iframe.style.maxHeight = '100%';\r\n    \r\n    this.player.element.parentNode.insertBefore(this.iframe, this.player.element);\r\n  }\r\n\r\n  async initializePlayer() {\r\n    const options = {\r\n      id: this.videoId,\r\n      width: '100%',\r\n      height: '100%',\r\n      controls: true, // Use Vimeo native controls\r\n      autoplay: this.player.options.autoplay,\r\n      muted: this.player.options.muted,\r\n      loop: this.player.options.loop,\r\n      keyboard: false\r\n    };\r\n\r\n    if (this.player.options.startTime > 0) {\r\n      options.startTime = this.player.options.startTime;\r\n    }\r\n\r\n    this.vimeo = new window.Vimeo.Player(this.iframe.id, options);\r\n\r\n    // Wait for player to be ready\r\n    await this.vimeo.ready();\r\n    this.isReady = true;\r\n    \r\n    // Ensure the iframe has 100% width and height\r\n    const vimeoIframe = this.iframe.querySelector('iframe');\r\n    if (vimeoIframe) {\r\n      vimeoIframe.style.width = '100%';\r\n      vimeoIframe.style.height = '100%';\r\n      vimeoIframe.setAttribute('width', '100%');\r\n      vimeoIframe.setAttribute('height', '100%');\r\n    }\r\n    \r\n    // Hide VidPly controls - Vimeo has its own\r\n    if (this.player.container) {\r\n      this.player.container.classList.add('vidply-external-controls');\r\n    }\r\n\r\n    this.attachEvents();\r\n\r\n    // Get initial duration\r\n    try {\r\n      const duration = await this.vimeo.getDuration();\r\n      this.player.state.duration = duration;\r\n      this.player.emit('loadedmetadata');\r\n    } catch (error) {\r\n      this.player.log('Error getting duration:', error, 'warn');\r\n    }\r\n  }\r\n\r\n  attachEvents() {\r\n    this.vimeo.on('play', () => {\r\n      this.player.state.playing = true;\r\n      this.player.state.paused = false;\r\n      this.player.state.ended = false;\r\n      this.player.emit('play');\r\n      \r\n      if (this.player.options.onPlay) {\r\n        this.player.options.onPlay.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('pause', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.emit('pause');\r\n      \r\n      if (this.player.options.onPause) {\r\n        this.player.options.onPause.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('ended', () => {\r\n      this.player.state.playing = false;\r\n      this.player.state.paused = true;\r\n      this.player.state.ended = true;\r\n      this.player.emit('ended');\r\n      \r\n      if (this.player.options.onEnded) {\r\n        this.player.options.onEnded.call(this.player);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('timeupdate', (data) => {\r\n      this.player.state.currentTime = data.seconds;\r\n      this.player.state.duration = data.duration;\r\n      this.player.emit('timeupdate', data.seconds);\r\n      \r\n      if (this.player.options.onTimeUpdate) {\r\n        this.player.options.onTimeUpdate.call(this.player, data.seconds);\r\n      }\r\n    });\r\n\r\n    this.vimeo.on('volumechange', (data) => {\r\n      this.player.state.volume = data.volume;\r\n      this.player.emit('volumechange', data.volume);\r\n    });\r\n\r\n    this.vimeo.on('bufferstart', () => {\r\n      this.player.state.buffering = true;\r\n      this.player.emit('waiting');\r\n    });\r\n\r\n    this.vimeo.on('bufferend', () => {\r\n      this.player.state.buffering = false;\r\n      this.player.emit('canplay');\r\n    });\r\n\r\n    this.vimeo.on('seeking', () => {\r\n      this.player.state.seeking = true;\r\n      this.player.emit('seeking');\r\n    });\r\n\r\n    this.vimeo.on('seeked', () => {\r\n      this.player.state.seeking = false;\r\n      this.player.emit('seeked');\r\n    });\r\n\r\n    this.vimeo.on('playbackratechange', (data) => {\r\n      this.player.state.playbackSpeed = data.playbackRate;\r\n      this.player.emit('ratechange', data.playbackRate);\r\n    });\r\n\r\n    this.vimeo.on('error', (error) => {\r\n      this.player.handleError(new Error(`Vimeo error: ${error.message}`));\r\n    });\r\n  }\r\n\r\n  play() {\r\n    if (this.isReady && this.vimeo) {\r\n      // Save scroll position to prevent browser from scrolling to video\r\n      const scrollX = window.scrollX;\r\n      const scrollY = window.scrollY;\r\n      \r\n      this.vimeo.play().catch(error => {\r\n        this.player.log('Play error:', error, 'warn');\r\n      });\r\n      \r\n      // Restore scroll position immediately to prevent auto-scroll\r\n      window.scrollTo(scrollX, scrollY);\r\n    }\r\n  }\r\n\r\n  pause() {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.pause().catch(error => {\r\n        this.player.log('Pause error:', error, 'warn');\r\n      });\r\n    }\r\n  }\r\n\r\n  seek(time) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setCurrentTime(time).catch(error => {\r\n        this.player.log('Seek error:', error, 'warn');\r\n      });\r\n    }\r\n  }\r\n\r\n  setVolume(volume) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setVolume(volume).catch(error => {\r\n        this.player.log('Volume error:', error, 'warn');\r\n      });\r\n      this.player.state.volume = volume;\r\n    }\r\n  }\r\n\r\n  setMuted(muted) {\r\n    if (this.isReady && this.vimeo) {\r\n      if (muted) {\r\n        this.vimeo.setVolume(0);\r\n      } else {\r\n        this.vimeo.setVolume(this.player.state.volume);\r\n      }\r\n      this.player.state.muted = muted;\r\n    }\r\n  }\r\n\r\n  setPlaybackSpeed(speed) {\r\n    if (this.isReady && this.vimeo) {\r\n      this.vimeo.setPlaybackRate(speed).catch(error => {\r\n        this.player.log('Playback rate error:', error, 'warn');\r\n      });\r\n      this.player.state.playbackSpeed = speed;\r\n    }\r\n  }\r\n\r\n  destroy() {\r\n    if (this.vimeo && this.vimeo.destroy) {\r\n      this.vimeo.destroy();\r\n    }\r\n\r\n    if (this.iframe && this.iframe.parentNode) {\r\n      this.iframe.parentNode.removeChild(this.iframe);\r\n    }\r\n\r\n    // Show original element\r\n    if (this.player.element) {\r\n      this.player.element.style.display = '';\r\n    }\r\n  }\r\n}\r\n\r\n"],
  "mappings": "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",
  "names": []
}
