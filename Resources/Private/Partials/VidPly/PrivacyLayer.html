<html data-namespace-typo3-fluid="true" xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers">

<f:variable name="settings" value="{privacySettings.{service}}" />
<f:variable name="headline" value="{settings.headline}" />
<f:variable name="introText" value="{settings.intro_text}" />
<f:variable name="outroText" value="{settings.outro_text}" />
<f:variable name="policyLink" value="{settings.policy_link}" />
<f:variable name="linkText" value="{settings.link_text -> f:format.trim()}" />
<f:variable name="buttonLabel" value="{settings.button_label}" />

<div class="vidply-privacy-layer vidply-privacy-{service}" 
     data-vidply-privacy="{service}"
     data-vidply-url="{videoUrl}"
     data-vidply-id="{uniqueId}"
     <f:if condition="{poster}">style="background-image: url('{poster}'); background-size: cover; background-position: center;"</f:if>>
    
    <f:variable name="finalButtonLabel">
        <f:if condition="{buttonLabel}">
            <f:then>{buttonLabel}</f:then>
            <f:else>{f:translate(key: 'privacy.load_content', arguments: {0: service}, extensionName: 'mpc_vidply')}</f:else>
        </f:if>
    </f:variable>
    <button class="vidply-privacy-button" 
            type="button"
            aria-label="{finalButtonLabel}">
        <svg class="vidply-play-overlay" viewBox="0 0 80 80" width="80" height="80" aria-hidden="true" role="presentation">
            <defs>
                <filter id="vidply-play-shadow-privacy-{uniqueId}" x="-50%" y="-50%" width="200%" height="200%">
                    <feGaussianBlur in="SourceAlpha" stdDeviation="3"></feGaussianBlur>
                    <feOffset dx="0" dy="2" result="offsetblur"></feOffset>
                    <feComponentTransfer><feFuncA type="linear" slope="0.3"></feFuncA></feComponentTransfer>
                    <feMerge><feMergeNode></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge>
                </filter>
            </defs>
            <circle cx="40" cy="40" r="40" fill="rgba(255, 255, 255, 0.95)" filter="url(#vidply-play-shadow-privacy-{uniqueId})" class="vidply-play-overlay-bg"></circle>
            <polygon points="32,28 32,52 54,40" fill="#0a406e" class="vidply-play-overlay-icon"></polygon>
        </svg>
    </button>
    
    <div class="vidply-privacy-text">

        <p>
            <f:if condition="{headline}">
                <span class="h6">{headline}</span>
            </f:if>
            <f:if condition="{introText}">
                <f:then>{introText}</f:then>
                <f:else>
                    <f:if condition="{service} == 'soundcloud'">
                        <f:then><f:translate key="privacy.activate_intro_widget" extensionName="mpc_vidply" /></f:then>
                        <f:else><f:translate key="privacy.activate_intro" extensionName="mpc_vidply" /></f:else>
                    </f:if>
                </f:else>
            </f:if>
            <f:variable name="finalPolicyLink">
                <f:if condition="{policyLink}">
                    <f:then>{policyLink}</f:then>
                    <f:else>
                        <f:switch expression="{service}">
                            <f:case value="youtube">https://policies.google.com/privacy</f:case>
                            <f:case value="vimeo">https://vimeo.com/privacy</f:case>
                            <f:case value="soundcloud">https://soundcloud.com/pages/privacy</f:case>
                        </f:switch>
                    </f:else>
                </f:if>
            </f:variable>
            <a href="{finalPolicyLink}" class="external-link" target="_blank" rel="noreferrer"><f:if condition="{linkText}"><f:then>{linkText}</f:then><f:else><f:switch expression="{service}"><f:case value="youtube"><f:translate key="privacy.youtube.policy_link" extensionName="mpc_vidply" /></f:case><f:case value="vimeo"><f:translate key="privacy.vimeo.policy_link" extensionName="mpc_vidply" /></f:case><f:case value="soundcloud"><f:translate key="privacy.soundcloud.policy_link" extensionName="mpc_vidply" /></f:case></f:switch></f:else></f:if></a>
            <f:if condition="{outroText}">
                <f:then>{outroText}</f:then>
                <f:else><f:translate key="privacy.activate_outro" extensionName="mpc_vidply" /></f:else>
            </f:if>
        </p>
    </div>
</div>

</html>
